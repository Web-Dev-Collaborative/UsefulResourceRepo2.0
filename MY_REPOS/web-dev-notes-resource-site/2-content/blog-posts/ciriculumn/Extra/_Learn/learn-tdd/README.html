<h1 id="learn-test-driven-development-tdd">Learn <strong>T</strong>est <strong>D</strong>riven <strong>D</strong>evelopment (<strong>TDD</strong>)</h1>
<p>A brief introduction to <strong>T</strong>est <strong>D</strong>riven <strong>D</strong>evelopment (<strong>TDD</strong>) in JavaScript for people who want to write <em><strong>more reliable code</strong></em>.</p>
<p><a href="https://travis-ci.org/dwyl/learn-tdd"><img src="https://img.shields.io/travis/dwyl/learn-tdd/master.svg?style=flat-square" alt="Build Status" /></a> <a href="http://codecov.io/github/dwyl/learn-tdd?branch=master"><img src="https://img.shields.io/codecov/c/github/dwyl/learn-tdd/master.svg?style=flat-square" alt="codecov.io" /></a> <a href="https://david-dm.org/dwyl/learn-tdd"><img src="https://david-dm.org/dwyl/learn-tdd/status.svg?style=flat-square" alt="Dependencies Status" /></a> <a href="https://david-dm.org/dwyl/learn-tdd?type=dev"><img src="https://david-dm.org/dwyl/learn-tdd/dev-status.svg?style=flat-square" alt="devDependencies Status" /></a> <a href="https://github.com/dwyl/learn-tdd/issues"><img src="https://img.shields.io/badge/contributions-welcome-brightgreen.svg?style=flat-square" alt="contributions welcome" /></a> <a href="http://hits.dwyl.io/dwyl/learn-tdd"><img src="http://hits.dwyl.io/dwyl/learn-tdd.svg" alt="HitCount" /></a></p>
<h2 id="why">Why?</h2>
<p><em>Project(s) without tests</em> often end up looking like they are stuck together with <em><strong>duct tape</strong></em> …</p>
<figure>
<img src="http://i.imgur.com/9cNriGK.jpg" alt="duct tape car fail" /><figcaption>duct tape car fail</figcaption>
</figure>
<p>Change <em>one</em> part and <em>another</em> stops working? “<em>Fixing</em>” one bug, creates another?</p>
<p>Wouldn’t you <em>prefer</em> it if everything was <strong><em>consistent</em></strong> and beautifully integrated? <br /> What if <em>everyone</em> on your team worked <em>like <strong>clock-work</strong></em> in a disciplined order… like a <em><strong>Formula 1 Crew</strong></em> …</p>
<figure>
<img src="http://i.imgur.com/0NDbaam.jpg" alt="formula 1 pit stop" /><figcaption>formula 1 pit stop</figcaption>
</figure>
<p>Test Driven Development (TDD) makes your team a well-oiled machine which means you can go <em><strong>faster</strong></em>.</p>
<p>Once you have a <strong><em>suite</em></strong> of tests that run on every change, you will begin to develop a whole other level of <strong><em>confidence</em></strong> in your codebase and will discover a new freedom to be <strong><em>creative</em></strong> without fear of “<em>breaking</em>” anything unexpectedly; truly <em>game-changing</em>.</p>
<h2 id="what">What?</h2>
<p>This tutorial will help you get started with <strong>T</strong>est <strong>D</strong>riven <strong>D</strong>evelopment (<strong>TDD</strong>) <em>today</em>! <br /> In the next <strong><em>30 minutes</em></strong> you will learn <em>everything</em><sup>1</sup> you need to write tests for your web project!</p>
<h3 id="pre-requisites">Pre-Requisites</h3>
<ul>
<li><strong>A computer</strong> with a web browser</li>
<li><strong>Internet access</strong> to download the starter files</li>
<li><strong>30 minutes</strong> of your time</li>
<li><strong><em>Basic</em> Programming Skills</strong> (HTML &amp; JavaScript)</li>
<li>(<em><strong>Optional</strong></em>) <em><strong>Bonus Levels requires</strong></em> you to <a href="https://nodejs.org/download/"><em>install</em> <strong>Node.js</strong></a></li>
</ul>
<h3 id="what-is-software-testing">What is Software Testing?</h3>
<blockquote>
<p>Software testing is the process of evaluating a software item to detect differences between the expected output and the actual output. Testing assesses the quality of the product. Software testing is a process that should be done during the development process. In other words software testing is a verification and validation process.</p>
</blockquote>
<h3 id="what-is-tdd">What is TDD?</h3>
<blockquote>
<p>Test-driven development (TDD) is an evolutionary approach to development which combines test-first development, where you write a test before you write just enough production code to fulfil that test, and refactoring. In other words, it’s one way to think through your requirements or design before your write your functional code.</p>
</blockquote>
<p><em>From <a href="http://agiledata.org/essays/tdd.html">Introduction to Test Driven Development (TDD)</a></em></p>
<h4 id="further-resources">Further resources</h4>
<ul>
<li>Software Testing - http://en.wikipedia.org/wiki/Software_testing</li>
<li>“What is Software Testing” video (from 5:56 onwards) - https://youtu.be/UZy1Dj9JIg4?t=356</li>
<li>Video intro to Software Development Lifecycle (from 0:52 onwards): https://youtu.be/qMkV_TDdDeA?t=52</li>
<li>How to Write Clean, Testable Code - http://youtu.be/XcT4yYu_TTs (ignore the Java code focus on the general principles)</li>
<li><a href="http://www.codeproject.com/Tips/351122/What-is-software-testing-What-are-the-different-ty">What is software testing?</a> by <em>Rehman Zafar</em> <!-- - Practical Full-Stack JavaScript Web Application Test Driven Development - https://github.com/nelsonic/practical-js-tdd --></li>
</ul>
<h2 id="how">How?</h2>
<p>The <em>first</em> thing you need to <em>understand</em> is that writing code following TDD (<em>discipline</em>) is a (<em>slightly</em>) different approach from simply diving into solving the problem (<em>without a test</em>).</p>
<p>When reading about TDD you will usually see the expression: “<strong><em>Red, Green, Refactor</em></strong>”:</p>
<figure>
<img src="http://i.imgur.com/RQe2NQT.jpg" alt="TDD Cycle: Red, Green, Refactor" /><figcaption>TDD Cycle: Red, Green, Refactor</figcaption>
</figure>
<p>What this means is that TDD follows a <strong>3-step process</strong>:</p>
<ol type="1">
<li><p><strong><em>Write a Failing Test</em></strong> - Understand the (user) requirements/story well enough to write a test for what you expect. (<em>the test should <strong>fail</strong> initially - hence it being “Red”</em>)</p></li>
<li><p><strong><em>Make the (failing) Test Pass</em></strong> - Write (<em>only</em>) the code you need to make the (<em>failing</em>) test pass, while ensuring your existing/previous tests all still pass (<em>no regressions</em>).</p></li>
<li><p><strong><em>Refactor the code you wrote</em></strong> take the time to tidy up the code <em>you</em> wrote to make it simpler (<em>for your future self or colleagues to understand</em>) before you need to ship the current feature, do it.</p></li>
</ol>
<blockquote>
<p>Thankfully, because you will have good tests, you don’t <em>need</em> to do any refactoring up-front, you can always do refactoring <em>later</em> if performance bottlenecks are discovered. Most programming languages have very efficient compilers/interpreters that remove much of the need for refactoring. And if you use a linter your code will be naturally “tidy”.</p>
</blockquote>
<p>To develop the <em>habit(s)</em> you will need to be successful with TDD (<em>and software engineering in general</em>) we need to <strong><em>write</em></strong> a <strong><em>test first</em></strong> (<em>and watch it fail</em>) and <em>then</em> write the code required to make the test pass.</p>
<p>Writing a <em><strong>failing test</strong></em>, before writing the code may seem <em>counter-intuitive</em>, <em>time consuming</em> or even “<em>tedious</em>” at <em><strong>first</strong></em>. But we <em>urge</em> you to think of it this way:</p>
<blockquote>
<p>The <strong><em>test</em></strong> is the <strong><em>question</em></strong> you are asking <br /> your code is the <strong><em>answer</em></strong> to the question. <br /> By having a <em>clear</em> question, you can always check that your code is working, <br /> because it <em><strong>consistently</strong></em> gives you the same answer(s) … <em>no surprises</em>, even when you’re working with a large, inter-dependent code base!</p>
</blockquote>
<h2 id="practical">Practical</h2>
<blockquote>
<p><em><strong>Note</strong>: This tutorial is meant to be a beginner-friendly introduction to TDD. The Vending Machine example is <em>intentionally</em> simple so you can focus on the principles of testing. Once you understand the basics, we encourage you to follow our <em>complete</em> Todo List Tutorial (<a href="https://github.com/dwyl/todo-list-javascript-tutorial">https://github.com/dwyl/<strong>todo-list-javascript-tutorial</strong></a>), which is a step-by-step guide to building an App following testing and documentation-first best practices.</em></p>
</blockquote>
<h3 id="scenario-vending-machine-change-calculator-micro-project">Scenario: Vending Machine <em>Change Calculator</em> Micro-Project</h3>
<figure>
<img src="http://i.imgur.com/HbwMqDa.jpg" alt="vending machine" /><figcaption>vending machine</figcaption>
</figure>
<p>Imagine you are building a <strong>Vending Machine</strong> that allows people to buy any item it contains. The machine accepts coins and calculates the change to be returned to the customer, given the item <strong>price</strong> and the <strong>cash</strong> received.</p>
<h3 id="single-file-app">Single <em>File</em> App</h3>
<p>We can build the <em>entire</em> “project” in a <em><strong>single file</strong></em>: <code>index.html</code></p>
<blockquote>
<p><em><strong>Note</strong>: In practice you want to split your JavaScript, CSS and HTML (Templates) into <strong>separate</strong> files, but for this example we are keeping everything in <code>index.html</code> for simplicity. If you make it to the “Bonus Levels” you will split things out!</em></p>
</blockquote>
<p>Create a directory on your computer called <strong>vending-machine</strong>:</p>
<p>In your <strong>terminal</strong> type this command:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="fu">mkdir</span> vending-machine <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> vending-machine</a></code></pre></div>
<p>(<em>This will create the directory and move you into it</em>)</p>
<p>Next create a file called <strong>index.html</strong> e.g: <code>atom index.html</code> (which creates and opens the file in the <a href="https://atom.io/">Atom text editor</a> if you have it installed)</p>
<p>(<em><strong>Note</strong>: The “atom” command is not installed by default. In the Atom menu bar there is a command named “Install Shell Commands” which installs a new command in your Terminal called “atom”.</em>)</p>
<p>Now copy-paste the following <em>sample code</em> into the newly created <code>index.html</code> file to get started:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="kw">&lt;title&gt;</span>Vending Machine Change Calculator TDD Tutorial<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="co">&lt;!-- Load the QUnit CSS file from CDN - Require to display our tests attractively --&gt;</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;https://code.jquery.com/qunit/qunit-1.18.0.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb2-7" title="7">    <span class="co">&lt;!-- Pure CSS is a minimalist CSS file we have included to make things look nicer --&gt;</span></a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;http://yui.yahooapis.com/pure/0.6.0/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb2-9" title="9">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="kw">&lt;body</span><span class="ot"> style=</span><span class="st">&#39;margin: 0 1em;&#39;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&#39;main&#39;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb2-12" title="12">      <span class="kw">&lt;h1&gt;</span>Vending Machine <span class="kw">&lt;em&gt;</span>Change Calculator<span class="kw">&lt;/em&gt;&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb2-13" title="13">      <span class="kw">&lt;h2&gt;</span>Calculate the change (<span class="kw">&lt;em&gt;</span>coins<span class="kw">&lt;/em&gt;</span>) to return to a customer when they buy something.<span class="kw">&lt;/h2&gt;</span></a>
<a class="sourceLine" id="cb2-14" title="14">    <span class="kw">&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb2-15" title="15"></a>
<a class="sourceLine" id="cb2-16" title="16">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;qunit&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb2-17" title="17">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;qunit-fixture&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb2-18" title="18">    <span class="co">&lt;!-- Load the QUnit Testing Framework from CDN - this is the important bit ... --&gt;</span></a>
<a class="sourceLine" id="cb2-19" title="19">    <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;https://code.jquery.com/qunit/qunit-1.18.0.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb2-20" title="20">    <span class="kw">&lt;script&gt;</span></a>
<a class="sourceLine" id="cb2-21" title="21">      <span class="co">// This is what a simple unit test looks like:</span></a>
<a class="sourceLine" id="cb2-22" title="22">      <span class="at">test</span>(<span class="st">&#39;This sample test should always pass!&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-23" title="23">        <span class="kw">var</span> result <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-24" title="24">        <span class="va">assert</span>.<span class="at">equal</span>(result<span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span> <span class="co">// just so we know everything loaded ok</span></a>
<a class="sourceLine" id="cb2-25" title="25">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-26" title="26">      <span class="co">// A failing test will be RED:</span></a>
<a class="sourceLine" id="cb2-27" title="27">      <span class="at">test</span>(<span class="st">&#39;This is what a failing test looks like!&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-28" title="28">        <span class="kw">var</span> result <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span>].<span class="at">indexOf</span>(<span class="dv">1</span>)<span class="op">;</span>  <span class="co">// this should be 0</span></a>
<a class="sourceLine" id="cb2-29" title="29">        <span class="va">assert</span>.<span class="at">equal</span>(result<span class="op">,</span> <span class="dv">-1</span>)<span class="op">;</span> <span class="co">// we *expect* this to fail</span></a>
<a class="sourceLine" id="cb2-30" title="30">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-31" title="31">    <span class="kw">&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb2-32" title="32">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb2-33" title="33"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<h4 id="open-index.html-in-your-browser">Open index.html in your Browser</h4>
<p>When you <strong><em>open</em></strong> <code>index.html</code> in your <strong><em>web browser</em></strong> you should expect to see something like this: (<em>without the annotation pointing out the qunit div, and the green and red annotations pointing out the Passing and Failing tests</em>)</p>
<figure>
<img src="images/initial-index-html-showing-failing-test.png" alt="learn-tdd-initial-index-html-showing-failing-test" /><figcaption>learn-tdd-initial-index-html-showing-failing-test</figcaption>
</figure>
<h5 id="explanation">Explanation</h5>
<p>There is quite a lot of code in the <strong>index.html</strong> you just created, let’s step through it to understand the parts:</p>
<p>The first part of <strong>index.html</strong> is a standard HTML head and body:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">&lt;title&gt;</span>Vending Machine Change Calculator TDD<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="co">&lt;!-- Load the QUnit CSS file from CDN - Require to display our tests attractively --&gt;</span></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;https://code.jquery.com/qunit/qunit-1.18.0.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-7" title="7">    <span class="co">&lt;!-- Pure CSS is a minimalist CSS file we have included to make things look nicer --&gt;</span></a>
<a class="sourceLine" id="cb3-8" title="8">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;http://yui.yahooapis.com/pure/0.6.0/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-9" title="9">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb3-10" title="10">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb3-11" title="11">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&#39;main&#39;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-12" title="12">      <span class="kw">&lt;h1&gt;</span>Vending Machine Change Calculator<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb3-13" title="13">      <span class="kw">&lt;h2&gt;</span>Calculate the Change for a Given Price and Cash Received<span class="kw">&lt;/h2&gt;</span></a>
<a class="sourceLine" id="cb3-14" title="14">    <span class="kw">&lt;/div&gt;</span></a></code></pre></div>
<p>Nothing special here, we are simply setting up the page and loading the CSS files.</p>
<p>Next we see the <strong>qunit divs</strong> (<em>where the <strong>test results</strong> will be <strong>displayed</strong></em>) and load the JQuery and QUnit Libraries from CDN:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb4-1" title="1">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;qunit&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb4-2" title="2">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;qunit-fixture&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="co">&lt;!-- Load the QUnit Library from CDN - this is the important bit ... --&gt;</span></a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;https://code.jquery.com/qunit/qunit-1.18.0.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a></code></pre></div>
<p>Finally we see our test(s) - the interesting part of the file:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb5-1" title="1">    <span class="kw">&lt;script&gt;</span></a>
<a class="sourceLine" id="cb5-2" title="2">      <span class="co">// This is what a simple unit test looks like:</span></a>
<a class="sourceLine" id="cb5-3" title="3">      <span class="at">test</span>(<span class="st">&#39;This sample test should always pass!&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-4" title="4">        <span class="kw">var</span> result <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-5" title="5">        <span class="va">assert</span>.<span class="at">equal</span>(result<span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-6" title="6">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-7" title="7"></a>
<a class="sourceLine" id="cb5-8" title="8">      <span class="co">// A failing test will be RED:</span></a>
<a class="sourceLine" id="cb5-9" title="9">      <span class="at">test</span>(<span class="st">&#39;This is what a failing test looks like!&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-10" title="10">        <span class="kw">var</span> result <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span>].<span class="at">indexOf</span>(<span class="dv">1</span>)<span class="op">;</span>  <span class="co">// this should be 0</span></a>
<a class="sourceLine" id="cb5-11" title="11">        <span class="va">assert</span>.<span class="at">equal</span>(result<span class="op">,</span> <span class="dv">-1</span>)<span class="op">;</span> <span class="co">// we *expect* this to fail</span></a>
<a class="sourceLine" id="cb5-12" title="12">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-13" title="13"></a>
<a class="sourceLine" id="cb5-14" title="14">    <span class="kw">&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb5-15" title="15">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p>If you are new to writing <strong><em>automated tests</em></strong>, don’t worry - they are really simple. There are <strong>3 parts</strong>:</p>
<ol type="1">
<li><strong>Description</strong> - usually the <em>first</em> parameter to QUnit’s test() method, describing what is expected to happen in the test</li>
<li><strong>Computation</strong> - executes a function/method (<em>which invokes the method you will write to make your test pass</em>)</li>
<li><strong>Assertion</strong> - verifies that the result of your computation is what you <strong><em>expect</em></strong> it to be.</li>
</ol>
<figure>
<img src="images/anatomy-of-a-unit-test.png" alt="anatomy-of-a-unit-test" /><figcaption>anatomy-of-a-unit-test</figcaption>
</figure>
<p>In the above screenshot, the assertion is <code>assert.equal(result, 2)</code> <br /> We are giving the <code>equal</code> method two arguments; the <code>result</code> of our computation and our expected value - in this case <strong>2</strong>. <em>That’s it</em>.</p>
<p><em><strong>Note</strong></em>: The latest version of QUnit uses the <code>QUnit.test()</code> function to run tests. Later in this workshop we use <a href="http://blanketjs.org/">blanket.js</a> which is not compatible with the latest version of QUnit. It is for this reason that we are calling <code>test()</code> to run the tests in this workshop.</p>
<h5 id="further-reading">Further Reading:</h5>
<ul>
<li>Test assertion: https://en.wikipedia.org/wiki/Test_assertion</li>
<li>What are Test Assertions and how do they work?: http://www.thoughtworks.com/insights/blog/test-assertions-how-do-they-work</li>
</ul>
<h2 id="requirements">Requirements</h2>
<p>As a customer, I want to buy a selected item from the <strong>vending machine</strong> and see what my change is as a <strong>result</strong> into the various <strong>coins</strong> so that I can select one of the options and receive my change.</p>
<p>Acceptance criteria: - A successful call of a function <code>getChange</code> should return the change value in the various <strong>coins</strong> available - Unit Tests should exist when the function is ready - The selection of the desired return is out of scope</p>
<h5 id="complementary-user-story-view">Complementary User Story view</h5>
<blockquote>
<p>Given a <strong>Price</strong> and an amount of <strong>Cash</strong> from the Customer Return: <strong>Change</strong> to the customer (<em>in notes and coins</em>).</p>
</blockquote>
<h3 id="understand-what-is-needed">Understand what is needed</h3>
<ul>
<li>Create a <code>function</code> called <code>getChange</code> that accepts <em><strong>two parameters</strong></em>: <code>totalPayable</code> and <code>cashPaid</code></li>
<li>For a given <code>totalPayable</code> (the total amount an item in the vending machine costs) and <code>cashPaid</code> (the amount of cash the customer paid into the vending machine), <code>getChange</code> should <em><strong>calculate</strong></em> the <em><strong>change</strong></em> the machine should <em>return</em> to the customer</li>
<li><code>getChange</code> should <em><strong>return</strong></em> change as an <code>array</code> of coins (largest to smallest) that the vending machine will need to <em>dispense</em> to the customer.</li>
</ul>
<h4 id="example"><em>Example</em></h4>
<p>If a customer buys an item costing £2.15 (<em>we represent this as <strong>215 pennies</strong></em> <code>totalPayable</code>) and pays £3 (3 x £1 or <em><strong>300 pennies</strong></em> <code>cashPaid</code>) into the vending machine, the <em><strong>change</strong></em> will be <strong>85p</strong>. <br /> To dispense the 85p of change we should <em>return</em> <strong>four coins</strong> to the person: 50p, 20p, 10p and 5p. <br /> An <strong>array</strong> of these coins would look like: <code>[50, 20, 10, 5]</code></p>
<h4 id="coins">Coins</h4>
<p>In the UK we have the following Coins:</p>
<figure>
<img src="images/gbp-coins.jpg" title="GBP Coins" alt="GBP Coins" /><figcaption>GBP Coins</figcaption>
</figure>
<p>If we use the penny as the unit (i.e. 100 pennies in a pound) the coins can be represented as:</p>
<ul>
<li>200 (£2)</li>
<li>100 (£1)</li>
<li>50 (50p)</li>
<li>20 (20p)</li>
<li>10 (10p)</li>
<li>5 (5p)</li>
<li>2 (2p)</li>
<li>1 (1p)</li>
</ul>
<p>this can be stored as an Array:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">var</span> coins <span class="op">=</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">;</span></a></code></pre></div>
<p><em><strong>Note</strong></em>: The same can be done for any other cash system ($ ¥ €) simply use the cent, sen or rin as the unit and scale up notes.</p>
<h4 id="the-first-test">The First Test</h4>
<p>If you are <em>totally</em> new to TDD I recommend reading this <a href="http://www.agiledata.org/essays/tdd.html">introductory article</a> by Scott Ambler (especially the diagrams) otherwise this (test-fail-code-pass) process may seem <em>strange</em> …</p>
<p>In <strong>T</strong>est <strong>F</strong>irst <strong>D</strong>evelopment (TFD) we write a test <em>first</em> and <em>then</em> write the code that makes the test pass.</p>
<h4 id="first-requirement">First Requirement</h4>
<p>So, back in our <strong>index.html</strong> file <strong><em>remove the dummy tests</em></strong> and add the following lines:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="at">test</span>(<span class="st">&#39;getChange(1,1) should equal [] - an empty array&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">//no change/coins just an empty array</span></a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="kw">var</span> expected <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="op">}</span>)<span class="op">;</span> <span class="co">// use deepEqual for arrays see: https://api.qunitjs.com/deepEqual/</span></a></code></pre></div>
<p>We use QUnit’s <code>deepEqual</code> (<em>assert</em>) method to check that all the <em>elements</em> in the two arrays are <em><strong>identical</strong></em>. see: https://api.qunitjs.com/deepEqual/</p>
<p>At this point, your <code>index.html</code> file should look like this:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb8-3" title="3">    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb8-4" title="4">    <span class="kw">&lt;title&gt;</span>Vending Machine Change Calculator TDD<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb8-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;https://code.jquery.com/qunit/qunit-1.18.0.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb8-6" title="6">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;http://yui.yahooapis.com/pure/0.6.0/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb8-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb8-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb8-9" title="9">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&#39;main&#39;</span><span class="ot"> style=</span><span class="st">&#39;padding: 2em;&#39;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb8-10" title="10">      <span class="kw">&lt;h1&gt;</span>Vending Machine Change Calculator<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb8-11" title="11">      <span class="kw">&lt;h2&gt;</span>Calculate the Change for a Given Price and Cash Received<span class="kw">&lt;/h2&gt;</span></a>
<a class="sourceLine" id="cb8-12" title="12">    <span class="kw">&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb8-13" title="13"></a>
<a class="sourceLine" id="cb8-14" title="14">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;qunit&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb8-15" title="15">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;qunit-fixture&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb8-16" title="16">    <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;https://code.jquery.com/qunit/qunit-1.18.0.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb8-17" title="17"></a>
<a class="sourceLine" id="cb8-18" title="18">    <span class="kw">&lt;script&gt;</span></a>
<a class="sourceLine" id="cb8-19" title="19">    <span class="co">// your solution will go here!</span></a>
<a class="sourceLine" id="cb8-20" title="20">    <span class="kw">&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb8-21" title="21"></a>
<a class="sourceLine" id="cb8-22" title="22">    <span class="kw">&lt;script&gt;</span></a>
<a class="sourceLine" id="cb8-23" title="23">    <span class="at">test</span>(<span class="st">&#39;getChange(1,1) should equal [] - an empty array&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-24" title="24">      <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">//no change/coins just an empty array</span></a>
<a class="sourceLine" id="cb8-25" title="25">      <span class="kw">var</span> expected <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb8-26" title="26">      <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-27" title="27">    <span class="op">}</span>)<span class="op">;</span> <span class="co">// use deepEqual for arrays see: https://api.qunitjs.com/deepEqual/</span></a>
<a class="sourceLine" id="cb8-28" title="28"></a>
<a class="sourceLine" id="cb8-29" title="29">    <span class="kw">&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb8-30" title="30">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb8-31" title="31"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<h4 id="watch-it-fail">Watch it <em>Fail</em></h4>
<p>Back in your browser window, <em>refresh</em> the browser and watch it <em>fail</em>:</p>
<figure>
<img src="images/first-failing-test.png" alt="first failing test" /><figcaption>first failing test</figcaption>
</figure>
<blockquote>
<p><strong>Q</strong>: Why <em>deliberately</em> write a test we <em>know</em> is going to <em>fail</em>…? <br /> <strong>A</strong>: To get used to the idea of <em>only</em> writing the code required to <em>pass</em> the <em>current</em> (<em>failing</em>) <em>test</em>. <br /> <em>Read</em>: "<strong><em>The Importance of Test Failure</em></strong>: http://www.sustainabletdd.com/2012/03/importance-of-test-failure.html<br /> <strong>Note</strong>: This also proves the test <strong>will</strong> fail if the code doesn’t behave as expected.</p>
</blockquote>
<h4 id="create-the-getchange-function">Create the getChange <code>function</code></h4>
<p>In your <code>index.html</code> file add the following code (<em>above the tests</em>)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="op">&lt;</span>script<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">function</span> <span class="at">getChange</span> (totalPayable<span class="op">,</span> cashPaid) <span class="op">{</span></a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="kw">var</span> change <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb9-4" title="4">    <span class="co">// your code goes here</span></a>
<a class="sourceLine" id="cb9-5" title="5"></a>
<a class="sourceLine" id="cb9-6" title="6">    <span class="cf">return</span> change<span class="op">;</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="op">};</span></a>
<a class="sourceLine" id="cb9-8" title="8">&lt;/script<span class="op">&gt;</span></a></code></pre></div>
<p>Your <code>index.html</code> should now look something like this:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb10-3" title="3">    <span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;Content-Type&quot;</span><span class="ot"> content=</span><span class="st">&quot;text/html; charset=UTF-8&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb10-4" title="4">    <span class="kw">&lt;title&gt;</span>Vending Machine Change Calculator TDD<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb10-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;https://code.jquery.com/qunit/qunit-1.18.0.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb10-6" title="6">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;http://yui.yahooapis.com/pure/0.6.0/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb10-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb10-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb10-9" title="9">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&#39;main&#39;</span><span class="ot"> style=</span><span class="st">&#39;padding: 2em;&#39;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb10-10" title="10">      <span class="kw">&lt;h1&gt;</span>Vending Machine Change Calculator<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb10-11" title="11">      <span class="kw">&lt;h2&gt;</span>Calculate the Change for a Given Price and Cash Received<span class="kw">&lt;/h2&gt;</span></a>
<a class="sourceLine" id="cb10-12" title="12">      <span class="co">&lt;!-- &lt;input type=&#39;text&#39; id=&#39;price&#39;&gt; &lt;/input&gt; --&gt;</span></a>
<a class="sourceLine" id="cb10-13" title="13">    <span class="kw">&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb10-14" title="14"></a>
<a class="sourceLine" id="cb10-15" title="15">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;qunit&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb10-16" title="16">    <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;qunit-fixture&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb10-17" title="17">    <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;https://code.jquery.com/qunit/qunit-1.18.0.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb10-18" title="18"></a>
<a class="sourceLine" id="cb10-19" title="19">    <span class="kw">&lt;script&gt;</span></a>
<a class="sourceLine" id="cb10-20" title="20">    <span class="kw">var</span> getChange <span class="op">=</span> <span class="kw">function</span> (totalPayable<span class="op">,</span> cashPaid) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-21" title="21">        <span class="st">&#39;use strict&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-22" title="22"></a>
<a class="sourceLine" id="cb10-23" title="23">        <span class="kw">var</span> change <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb10-24" title="24"></a>
<a class="sourceLine" id="cb10-25" title="25">        <span class="cf">return</span> change</a>
<a class="sourceLine" id="cb10-26" title="26">    <span class="op">};</span></a>
<a class="sourceLine" id="cb10-27" title="27">    <span class="kw">&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb10-28" title="28"></a>
<a class="sourceLine" id="cb10-29" title="29">    <span class="kw">&lt;script&gt;</span></a>
<a class="sourceLine" id="cb10-30" title="30">    <span class="at">test</span>(<span class="st">&#39;getChange(1,1) should equal [] - an empty array&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-31" title="31">      <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">//no change/coins just an empty array</span></a>
<a class="sourceLine" id="cb10-32" title="32">      <span class="kw">var</span> expected <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb10-33" title="33">      <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-34" title="34">    <span class="op">}</span>)<span class="op">;</span> <span class="co">// use deepEqual for arrays see: https://api.qunitjs.com/deepEqual/</span></a>
<a class="sourceLine" id="cb10-35" title="35"></a>
<a class="sourceLine" id="cb10-36" title="36">    <span class="kw">&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb10-37" title="37">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb10-38" title="38"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<h4 id="refresh-index.html-in-the-browser">Refresh <code>index.html</code> in the Browser</h4>
<figure>
<img src="images/first-test-passes.png" alt="first test passes" /><figcaption>first test passes</figcaption>
</figure>
<p>It Passed!!</p>
<h4 id="now-lets-write-a-real-test">Now Let’s Write A <em>Real</em> Test</h4>
<p>Going back to the requirements, we need our <code>getChange</code> method to accept two arguments/parameters (<code>totalPayable</code> and <code>cashPaid</code>), and to <code>return</code> an <code>array</code> containing the coins equal to the difference between them:</p>
<p>e.g:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1">totalPayable <span class="op">=</span> <span class="dv">215</span>          <span class="co">// £2.15</span></a>
<a class="sourceLine" id="cb11-2" title="2">cashPaid     <span class="op">=</span> <span class="dv">300</span>          <span class="co">// £3.00</span></a>
<a class="sourceLine" id="cb11-3" title="3">difference   <span class="op">=</span>  <span class="dv">85</span>          <span class="co">// 85p</span></a>
<a class="sourceLine" id="cb11-4" title="4">change       <span class="op">=</span> [<span class="dv">50</span><span class="op">,</span><span class="dv">20</span><span class="op">,</span><span class="dv">10</span><span class="op">,</span><span class="dv">5</span>] <span class="co">// 50p, 20p, 10p, 5p</span></a></code></pre></div>
<p>Add the following test to tests section of <code>index.html</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="at">test</span>(<span class="st">&#39;getChange(215, 300) should return [50, 20, 10, 5]&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">215</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span> <span class="co">// expect an array containing [50,20,10,5]</span></a>
<a class="sourceLine" id="cb12-3" title="3">  <span class="kw">var</span> expected <span class="op">=</span> [<span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb12-4" title="4">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="op">}</span>)</a></code></pre></div>
<h4 id="write-the-method-to-pass-the-test">Write the Method to Pass the Test</h4>
<p>What if I <em><strong>cheat</strong></em> and make <code>getChange</code> return the expected result?</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">function</span> <span class="at">getChange</span> (totalPayable<span class="op">,</span> cashPaid) <span class="op">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="st">&#39;use strict&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4">  <span class="kw">var</span> change <span class="op">=</span> [<span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">;</span> <span class="co">// just &quot;enough to pass the failing test&quot;</span></a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6">  <span class="cf">return</span> change<span class="op">;</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="op">};</span></a></code></pre></div>
<p>This will <em>pass</em> the new test, but it also introduces a regression. The original test <code>getChange(1,1) should equal [] - an empty array</code> is now failing.</p>
<p>Step 2 of the <strong>TDD</strong> process requires that <em>all</em> tests should pass, not just the newly added one.</p>
<p>The <code>getChange</code> function needs to cater for two scenarios; when change should be returned and when it shouldn’t. A new implementation of <code>getChange</code> that handles both scenarios could be:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">function</span> <span class="at">getChange</span> (totalPayable<span class="op">,</span> cashPaid) <span class="op">{</span></a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="st">&#39;use strict&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-3" title="3"></a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="kw">var</span> change <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb14-5" title="5"></a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="cf">if</span>((cashPaid <span class="op">-</span> totalPayable) <span class="op">!=</span> <span class="dv">0</span>) <span class="op">{</span> <span class="co">// Is any change required?</span></a>
<a class="sourceLine" id="cb14-7" title="7">    change <span class="op">=</span> [<span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">;</span> <span class="co">// just &quot;enough to pass the failing test&quot;</span></a>
<a class="sourceLine" id="cb14-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb14-9" title="9"></a>
<a class="sourceLine" id="cb14-10" title="10">  <span class="cf">return</span> change<span class="op">;</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="op">};</span></a></code></pre></div>
<p>The regression has been fixed and all tests <em>pass</em>, but you have <em>hard coded</em> the result (<em>not exactly useful for a calculator…</em>)</p>
<p>This only works <em>once</em>. When the Spec (Test) Writer writes the next test, the method will need to be re-written to satisfy it.</p>
<p>Let’s try it. Work out what you expect so you can write your test:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1">totalPayable <span class="op">=</span> <span class="dv">486</span>           <span class="co">// £4.86</span></a>
<a class="sourceLine" id="cb15-2" title="2">cashPaid     <span class="op">=</span> <span class="dv">600</span>           <span class="co">// £6.00</span></a>
<a class="sourceLine" id="cb15-3" title="3">difference   <span class="op">=</span> <span class="dv">114</span>           <span class="co">// £1.14</span></a>
<a class="sourceLine" id="cb15-4" title="4">change       <span class="op">=</span> [<span class="dv">100</span><span class="op">,</span><span class="dv">10</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span>]  <span class="co">// £1, 10p, 2p, 2p</span></a></code></pre></div>
<p>Add the following test to <code>index.html</code> and refresh your browser:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="at">test</span>(<span class="st">&#39;getChange(486, 600) should equal [100, 10, 2, 2]&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">486</span><span class="op">,</span> <span class="dv">600</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-3" title="3">  <span class="kw">var</span> expected <span class="op">=</span> [<span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb16-4" title="4">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="op">}</span>)</a></code></pre></div>
<h4 id="should-we-keep-cheating-or-solve-the-problem">Should We <em>Keep Cheating or Solve the Problem</em>?</h4>
<p>We could <em>keep cheating</em> by writing a series of if statements:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">function</span> <span class="at">getChange</span> (totalPayable<span class="op">,</span> cashPaid) <span class="op">{</span></a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="st">&#39;use strict&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4">  <span class="kw">var</span> change <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb17-5" title="5"></a>
<a class="sourceLine" id="cb17-6" title="6">  <span class="cf">if</span>((cashPaid <span class="op">-</span> totalPayable) <span class="op">!=</span> <span class="dv">0</span>) <span class="op">{</span> <span class="co">// Is any change required?</span></a>
<a class="sourceLine" id="cb17-7" title="7">    <span class="cf">if</span>(totalPayable <span class="op">==</span> <span class="dv">486</span> <span class="op">&amp;&amp;</span> cashPaid <span class="op">==</span> <span class="dv">600</span>)</a>
<a class="sourceLine" id="cb17-8" title="8">        change <span class="op">=</span> [<span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb17-9" title="9">    <span class="cf">else</span> <span class="cf">if</span>(totalPayable <span class="op">==</span> <span class="dv">215</span> <span class="op">&amp;&amp;</span> cashPaid <span class="op">==</span> <span class="dv">300</span>)</a>
<a class="sourceLine" id="cb17-10" title="10">        change <span class="op">=</span> [<span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb17-11" title="11">  <span class="op">}</span></a>
<a class="sourceLine" id="cb17-12" title="12"></a>
<a class="sourceLine" id="cb17-13" title="13">  <span class="cf">return</span> change<span class="op">;</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="op">};</span></a></code></pre></div>
<p>The <em><strong>Arthur Andersen Approach</strong></em> gets results in the <em>short run</em> …</p>
<p>But it’s arguably <em>more work</em> than simply <em>solving</em> the problem. So let’s do that instead.</p>
<h1 id="try-it-yourself-before-looking-at-the-solution">Try It Yourself (<em>before looking at the solution</em>!)</h1>
<blockquote>
<p>Try to create your own <code>getChange</code> method that passes the three tests <em>before</em> you look at the solution…</p>
</blockquote>
<p>To re-cap, these are our three tests:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="at">test</span>(<span class="st">&#39;getChange(1,1) should equal [] - an empty array&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">//no change/coins just an empty array</span></a>
<a class="sourceLine" id="cb18-3" title="3">  <span class="kw">var</span> expected <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb18-4" title="4">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-6" title="6"></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="at">test</span>(<span class="st">&#39;getChange(215, 300) should return [50, 20, 10, 5]&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb18-8" title="8">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">215</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span> <span class="co">// expect an array containing [50,20,10,5]</span></a>
<a class="sourceLine" id="cb18-9" title="9">  <span class="kw">var</span> expected <span class="op">=</span> [<span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb18-10" title="10">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-12" title="12"></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="at">test</span>(<span class="st">&#39;getChange(486, 600) should equal [100, 10, 2, 2]&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb18-14" title="14">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">486</span><span class="op">,</span> <span class="dv">600</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-15" title="15">  <span class="kw">var</span> expected <span class="op">=</span> [<span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb18-16" title="16">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h4 id="one-more-test-to-be-sure-it-works">One More Test to be <em>Sure</em> it Works?</h4>
<p>Let’s invent a test that will return one of each of the coins …</p>
<p>Recall that we have 8 types of coins:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">var</span> coins <span class="op">=</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">;</span></a></code></pre></div>
<p>The sum of the (<em><code>array</code> containing one of each</em>) coins is: <strong>388</strong>p</p>
<p>So, we need to create a test in which we <strong>pay £4</strong> for an item costing 12p. (A bit unrealistic, but if it works we know our <code>getChange</code> method is <em>ready</em>!)</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="at">test</span>(<span class="st">&#39;getChange(12, 400) should return [200, 100, 50, 20, 10, 5, 2, 1]&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">12</span><span class="op">,</span> <span class="dv">400</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-3" title="3">  <span class="kw">var</span> expected <span class="op">=</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb20-4" title="4">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>When these tests pass, your work is done.</p>
<p><br /> <br /></p>
<h2 id="solutions-contributions-welcome">Solution(s) <a href="https://github.com/dwyl/learn-tdd/issues"><img src="https://img.shields.io/badge/contributions-welcome-brightgreen.svg?style=flat" alt="contributions welcome" /></a></h2>
<p><em><strong>Note</strong></em>: Feel free to suggest a more <em>compact</em> algorithm.</p>
<h3 id="imperative-version-two-for-loops">“Imperative” Version (“Two For Loops”)</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">var</span> coins <span class="op">=</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">function</span> <span class="at">getChange</span> (payable<span class="op">,</span> paid) <span class="op">{</span></a>
<a class="sourceLine" id="cb21-3" title="3">  <span class="kw">var</span> change <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb21-4" title="4">  <span class="kw">var</span> length <span class="op">=</span> <span class="va">coins</span>.<span class="at">length</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-5" title="5">  <span class="kw">var</span> remaining <span class="op">=</span> paid <span class="op">-</span> payable<span class="op">;</span> <span class="co">// we reduce this below</span></a>
<a class="sourceLine" id="cb21-6" title="6"></a>
<a class="sourceLine" id="cb21-7" title="7">  <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> length<span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span> <span class="co">// loop through array of notes &amp; coins:</span></a>
<a class="sourceLine" id="cb21-8" title="8">    <span class="kw">var</span> coin <span class="op">=</span> coins[i]<span class="op">;</span></a>
<a class="sourceLine" id="cb21-9" title="9"></a>
<a class="sourceLine" id="cb21-10" title="10">    <span class="kw">var</span> times_coin_fits <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(remaining / coin)<span class="op">;</span> <span class="co">// no partial coins</span></a>
<a class="sourceLine" id="cb21-11" title="11">    <span class="cf">if</span>(times_coin_fits <span class="op">&gt;=</span> <span class="dv">1</span>) <span class="op">{</span> <span class="co">// check coin fits into the remaining amount</span></a>
<a class="sourceLine" id="cb21-12" title="12"></a>
<a class="sourceLine" id="cb21-13" title="13">      <span class="cf">for</span>(<span class="kw">var</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> times_coin_fits <span class="op">;</span> j<span class="op">++</span>) <span class="op">{</span> <span class="co">// add coin to change x times</span></a>
<a class="sourceLine" id="cb21-14" title="14">        <span class="va">change</span>.<span class="at">push</span>(coin)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-15" title="15">        remaining <span class="op">=</span> remaining <span class="op">-</span> coin<span class="op">;</span>  <span class="co">// subtract coin from remaining</span></a>
<a class="sourceLine" id="cb21-16" title="16">      <span class="op">}</span></a>
<a class="sourceLine" id="cb21-17" title="17">    <span class="op">}</span></a>
<a class="sourceLine" id="cb21-18" title="18">  <span class="op">}</span></a>
<a class="sourceLine" id="cb21-19" title="19">  <span class="cf">return</span> change<span class="op">;</span></a>
<a class="sourceLine" id="cb21-20" title="20"><span class="op">};</span></a></code></pre></div>
<h3 id="functional">“Functional”</h3>
<p>The “functional” solution is more <em>compact</em> than the “nested for loops”: <br /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">const</span> COINS <span class="op">=</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">;</span> <span class="co">// &quot;constant&quot; of all coins</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">function</span> <span class="at">getChange</span> (payable<span class="op">,</span> paid) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-3" title="3">  <span class="cf">return</span> <span class="va">COINS</span>.<span class="at">reduce</span>((change<span class="op">,</span> coin) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb22-4" title="4">    <span class="kw">const</span> change_sum <span class="op">=</span> <span class="va">change</span>.<span class="at">reduce</span>((sum<span class="op">,</span> coin) <span class="kw">=&gt;</span> sum <span class="op">+</span> coin<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb22-5" title="5">    <span class="kw">const</span> remaining <span class="op">=</span> paid <span class="op">-</span> payable <span class="op">-</span> change_sum<span class="op">;</span></a>
<a class="sourceLine" id="cb22-6" title="6">    <span class="kw">const</span> times_coin_fits <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(remaining / coin)<span class="op">;</span></a>
<a class="sourceLine" id="cb22-7" title="7">    <span class="cf">return</span> <span class="va">change</span>.<span class="at">concat</span>(<span class="at">Array</span>(times_coin_fits).<span class="at">fill</span>(coin))<span class="op">;</span></a>
<a class="sourceLine" id="cb22-8" title="8">  <span class="op">},</span> [])<span class="op">;</span> <span class="co">// change array starts out empty and gets filled iteratively.</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="op">}</span></a></code></pre></div>
<p>Don’t panic if you are <em>unfamiliar</em> with the JavaScript <code>Array.Map</code> &amp; <code>Array.Reduce</code> methods; they were new to everyone <em>once</em>.</p>
<p>We recommend reading:</p>
<ul>
<li>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Map</li>
<li>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce</li>
<li>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/fill</li>
<li>Example Functional JavaScript: https://www.sitepoint.com/map-reduce-functional-javascript</li>
<li><a href="https://github.com/MostlyAdequate/mostly-adequate-guide">Mostly Adequate Guide To Functional Programming</a></li>
</ul>
<h3 id="alternative-solution">Alternative Solution</h3>
<p>An alternative shared by <span class="citation" data-cites="blunket">@blunket</span>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">var</span> cointypes  <span class="op">=</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">function</span> <span class="at">getChange</span>(price<span class="op">,</span> paid) <span class="op">{</span></a>
<a class="sourceLine" id="cb23-3" title="3">  <span class="kw">var</span> difference <span class="op">=</span> paid <span class="op">-</span> price<span class="op">;</span></a>
<a class="sourceLine" id="cb23-4" title="4">  <span class="kw">var</span> change <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb23-5" title="5"></a>
<a class="sourceLine" id="cb23-6" title="6">  <span class="va">cointypes</span>.<span class="at">forEach</span>(<span class="kw">function</span>(coin) <span class="op">{</span></a>
<a class="sourceLine" id="cb23-7" title="7">    <span class="co">// keep adding the current coin until it&#39;s more than the difference</span></a>
<a class="sourceLine" id="cb23-8" title="8">    <span class="cf">while</span> (difference <span class="op">&gt;=</span> coin) <span class="op">{</span></a>
<a class="sourceLine" id="cb23-9" title="9">      <span class="va">change</span>.<span class="at">push</span>(coin)<span class="op">;</span></a>
<a class="sourceLine" id="cb23-10" title="10">      difference <span class="op">=</span> difference <span class="op">-</span> coin<span class="op">;</span></a>
<a class="sourceLine" id="cb23-11" title="11">    <span class="op">}</span></a>
<a class="sourceLine" id="cb23-12" title="12">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb23-13" title="13"></a>
<a class="sourceLine" id="cb23-14" title="14">  <span class="cf">return</span> change<span class="op">;</span></a>
<a class="sourceLine" id="cb23-15" title="15"><span class="op">}</span></a></code></pre></div>
<p>If you see this:</p>
<figure>
<img src="images/showing-all-passing-tests.png" alt="learn-tdd-showing-all-passing-tests" /><figcaption>learn-tdd-showing-all-passing-tests</figcaption>
</figure>
<p><em><strong>Congratulations! You can do Test Driven Development</strong></em> (TDD)!! <br /></p>
<p>Give yourself a pat on the back! <strong>Tweet your <em>success</em></strong>! <br /> <em>or <strong>Re-Tweet</strong></em>: https://twitter.com/livelifelively/status/768645514120212480 <a href="https://twitter.com/livelifelively/status/768645514120212480"><img src="https://cloud.githubusercontent.com/assets/194400/18021179/91827edc-6bdd-11e6-8ae5-082181c0d789.png" alt="learn-tdd" /></a></p>
<p><em>Take a break, grab some water and come back for the #<strong>BonusLevel</strong></em></p>
<table>
<thead>
<tr class="header">
<th>&lt;b</th>
<th>r</th>
<th>/&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;b</td>
<td>r</td>
<td>/&gt;</td>
</tr>
</tbody>
</table>
<h2 id="bonus-level-1-code-coverage-10-mins">Bonus Level 1: Code Coverage (10 mins)</h2>
<h3 id="what-is-code-coverage">What is Code Coverage?</h3>
<figure>
<img src="http://i.imgur.com/bmY2imf.jpg" alt="sign not in use" /><figcaption>sign not in use</figcaption>
</figure>
<p>In computer programming, code coverage is a measure used to describe the degree to which the source code of a program is tested by a particular test suite.</p>
<p>In other words: if there is code in the codebase which is not “<em>covered</em>” by a test, it could potentially be a source of bugs or undesirable behaviour.</p>
<blockquote>
<p>Read more: https://en.wikipedia.org/wiki/Code_coverage</p>
</blockquote>
<h3 id="example-from-our-vending-machine-coin-change-example">Example from our Vending Machine <em>Coin Change</em> Example</h3>
<p>Imagine the makers of the Vending Machine (<em>unknowingly</em>) hired a <em><strong>rogue</strong></em> programmer to build the change calculator.</p>
<p>The <em><strong>rogue</strong></em> programmer charged below the “<em>market rate</em>”, delivered the code quickly and even included tests!</p>
<p>The makers of the vending machine think that everything is working fine, all the <em>tests</em> pass and when they try the machine it dispenses the merchandise and the <em>correct change every time</em>.</p>
<p>But in the <code>getChange</code> method the <em><strong>rogue</strong></em> programmer put in the following lines:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb24-1" title="1"><span class="cf">if</span>(cashPaid <span class="op">==</span> <span class="dv">1337</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb24-2" title="2">  ATM <span class="op">=</span> [<span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb24-3" title="3">  <span class="cf">for</span>(<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span> <span class="dv">18</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span> <span class="va">ATM</span>.<span class="at">push</span>(<span class="dv">100</span>) <span class="op">};</span></a>
<a class="sourceLine" id="cb24-4" title="4">  <span class="cf">return</span> ATM<span class="op">;</span> <span class="op">}</span></a></code></pre></div>
<p>If all the QA person did was run the tests they would see them all “green” and think the job was well done.</p>
<p>But … once the vending machines had gone into service, e.g: one in every train station in the country. The Vending Machine company begins to notice that there is less money in them than they expect … They don’t understand why because they only hire <em>trustworthy</em> people to re-stock the machines.</p>
<p>One day the Vending Machine Company decide to hire <em>you</em> to review the code in the <code>getChange</code> calculator and you discover the <em><strong>rogue</strong></em> programmer trick!</p>
<p>Every time the <em><strong>rogue</strong></em> programmer inserts £13.37 into <em>any</em> vending machine it will payout £18.37 i.e: a <strong>£5 payout</strong> (and a “<em>free</em>” item from the vending machine!)</p>
<blockquote>
<p><em>How could this have been <strong>prevented</strong></em>?</p>
</blockquote>
<p>The answer is <strong><em>code coverage</em></strong>!</p>
<blockquote>
<p><em>Note: Checking code coverage is <strong>not a substitute for QA/Code Review</strong>…</em>!</p>
</blockquote>
<h3 id="blanket.js">Blanket.js</h3>
<p>To check the <em>coverage</em> of code being executed (<em>in the browser</em>) we use <strong>Blanket.js</strong></p>
<blockquote>
<p>See: http://blanketjs.org/ and https://github.com/alex-seville/blanket</p>
</blockquote>
<p>To <em>run</em> blanket.js we need to separate our tests and solution into distinct <strong>.js</strong> files:</p>
<p><strong>test.js</strong> contains our unit tests</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb25-1" title="1"><span class="at">test</span>(<span class="st">&#39;getChange(1,1) should equal [] - an empty array&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb25-2" title="2">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">//no change/coins just an empty array</span></a>
<a class="sourceLine" id="cb25-3" title="3">  <span class="kw">var</span> expected <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb25-4" title="4">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-6" title="6"></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="at">test</span>(<span class="st">&#39;getChange(215, 300) should return [50, 20, 10, 5]&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb25-8" title="8">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">215</span><span class="op">,</span> <span class="dv">300</span>)<span class="op">;</span> <span class="co">// expect an array containing [50,20,10,5]</span></a>
<a class="sourceLine" id="cb25-9" title="9">  <span class="kw">var</span> expected <span class="op">=</span> [<span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb25-10" title="10">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-12" title="12"></a>
<a class="sourceLine" id="cb25-13" title="13"><span class="at">test</span>(<span class="st">&#39;getChange(486, 600) should equal [100, 10, 2, 2]&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb25-14" title="14">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">486</span><span class="op">,</span> <span class="dv">600</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-15" title="15">  <span class="kw">var</span> expected <span class="op">=</span> [<span class="dv">100</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb25-16" title="16">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-17" title="17"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-18" title="18"></a>
<a class="sourceLine" id="cb25-19" title="19"><span class="at">test</span>(<span class="st">&#39;getChange(12, 400) should return [200, 100, 50, 20, 10, 5, 2, 1]&#39;</span><span class="op">,</span> <span class="kw">function</span>(assert) <span class="op">{</span></a>
<a class="sourceLine" id="cb25-20" title="20">  <span class="kw">var</span> result <span class="op">=</span> <span class="at">getChange</span>(<span class="dv">12</span><span class="op">,</span> <span class="dv">400</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-21" title="21">  <span class="kw">var</span> expected <span class="op">=</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb25-22" title="22">  <span class="va">assert</span>.<span class="at">deepEqual</span>(result<span class="op">,</span> expected)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-23" title="23"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p><strong>change.js</strong> has the <code>getChange</code> method.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">var</span> coins <span class="op">=</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">function</span> <span class="at">getChange</span>(payable<span class="op">,</span> paid) <span class="op">{</span></a>
<a class="sourceLine" id="cb26-3" title="3">    <span class="kw">var</span> change <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb26-4" title="4">    <span class="kw">var</span> length <span class="op">=</span> <span class="va">coins</span>.<span class="at">length</span><span class="op">;</span></a>
<a class="sourceLine" id="cb26-5" title="5">    <span class="kw">var</span> remaining <span class="op">=</span> paid <span class="op">-</span> payable<span class="op">;</span>          <span class="co">// we reduce this below</span></a>
<a class="sourceLine" id="cb26-6" title="6"></a>
<a class="sourceLine" id="cb26-7" title="7">    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> length<span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span> <span class="co">// loop through array of notes &amp; coins:</span></a>
<a class="sourceLine" id="cb26-8" title="8">        <span class="kw">var</span> coin <span class="op">=</span> coins[i]<span class="op">;</span></a>
<a class="sourceLine" id="cb26-9" title="9"></a>
<a class="sourceLine" id="cb26-10" title="10">        <span class="kw">var</span> times_coin_fits <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(remaining / coin)<span class="op">;</span> <span class="co">// no partial coins</span></a>
<a class="sourceLine" id="cb26-11" title="11">        <span class="cf">if</span>(times_coin_fits <span class="op">&gt;=</span> <span class="dv">1</span>) <span class="op">{</span> <span class="co">// check coin fits into the remaining amount</span></a>
<a class="sourceLine" id="cb26-12" title="12"></a>
<a class="sourceLine" id="cb26-13" title="13">            <span class="cf">for</span>(<span class="kw">var</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> times_coin_fits<span class="op">;</span> j<span class="op">++</span>) <span class="op">{</span> <span class="co">// add coin to change x times</span></a>
<a class="sourceLine" id="cb26-14" title="14">                <span class="va">change</span>.<span class="at">push</span>(coin)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-15" title="15">                remaining <span class="op">=</span> remaining <span class="op">-</span> coin<span class="op">;</span>  <span class="co">// subtract coin from remaining</span></a>
<a class="sourceLine" id="cb26-16" title="16">            <span class="op">}</span></a>
<a class="sourceLine" id="cb26-17" title="17">        <span class="op">}</span></a>
<a class="sourceLine" id="cb26-18" title="18">    <span class="op">}</span></a>
<a class="sourceLine" id="cb26-19" title="19">    <span class="cf">if</span>(paid <span class="op">==</span> <span class="dv">1337</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb26-20" title="20">      ATM <span class="op">=</span> [<span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb26-21" title="21">      <span class="cf">for</span>(<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span> <span class="dv">18</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span> <span class="va">ATM</span>.<span class="at">push</span>(<span class="dv">100</span>) <span class="op">};</span></a>
<a class="sourceLine" id="cb26-22" title="22">      <span class="cf">return</span> ATM<span class="op">;</span></a>
<a class="sourceLine" id="cb26-23" title="23">    <span class="op">}</span></a>
<a class="sourceLine" id="cb26-24" title="24">    <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb26-25" title="25">      <span class="cf">return</span> change<span class="op">;</span></a>
<a class="sourceLine" id="cb26-26" title="26">    <span class="op">}</span></a>
<a class="sourceLine" id="cb26-27" title="27"><span class="op">};</span></a></code></pre></div>
<p>Include these two files <em>and</em> the <strong>Blanket.js</strong> library in your index.html:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb27-1" title="1"><span class="co">&lt;!-- Load Blanket.js from CDN --&gt;</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;https://cdnjs.cloudflare.com/ajax/libs/blanket.js/1.1.4/blanket.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;/change.js&quot;</span><span class="ot"> data-cover</span><span class="kw">&gt;&lt;/script&gt;</span> <span class="co">&lt;!-- load our getChange method  --&gt;</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;/test.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span>              <span class="co">&lt;!-- load tests after getChange --&gt;</span></a></code></pre></div>
<h3 id="live-server"><em>Live</em> Server</h3>
<blockquote>
<p><em><strong>Note</strong>: This is a <em>light</em> taste of Node.js for absolute beginners.</em></p>
</blockquote>
<p>Because we are loading external <strong>.js</strong> files, our web browser will not <em>allow</em> us to simply open the <strong>index.html</strong> from the directory.</p>
<p>Open your terminal and run this command to <em><strong>install</strong> the <strong>node modules</strong> and <strong>start</strong> the <strong>live server</strong></em>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb28-1" title="1"><span class="ex">npm</span> init -f <span class="kw">&amp;&amp;</span> <span class="ex">npm</span> install live-server --save-dev <span class="kw">&amp;&amp;</span> <span class="ex">node_modules/.bin/live-server</span> --port=8000</a></code></pre></div>
<p>It will take a minute to install, but once that’s done your <code>live-server</code> will start up.</p>
<p>That starts a node.js HTTP server on port 8000.</p>
<blockquote>
<p>Visit: http://localhost:8000/?coverage in your web browser</p>
</blockquote>
<p>You should expect to see:</p>
<figure>
<img src="images/showing-coverage.png" alt="learn-tdd-showing-coverage" /><figcaption>learn-tdd-showing-coverage</figcaption>
</figure>
<p>(Make sure to tick “Enable Coverage”, as it is not checked by default!)</p>
<h3 id="click-line-1-in-the-blanket.js-section-to-expand-the-code-coverage-view">Click line #1 in the Blanket.js section to expand the code coverage view</h3>
<figure>
<img src="images/showing-rogue-code-not-covered.png" alt="learn-tdd-showing-rogue-code-not-covered" /><figcaption>learn-tdd-showing-rogue-code-not-covered</figcaption>
</figure>
<p>Here we can clearly see which lines are <strong>not</strong> being covered by the tests! We can quickly identify a potential for bugs or <em>rogue</em> code and remove it!</p>
<h4 id="hold-on-what-if-the-rogue-code-is-all-on-one-line">Hold on … What if the <em>rogue</em> code is all on <em>one line</em>?</h4>
<figure>
<img src="images/showing-rogue-code-on-one-line-goes-un-detected.png" alt="learn-tdd-showing-rogue-code-on-one-line-goes-un-detected" /><figcaption>learn-tdd-showing-rogue-code-on-one-line-goes-un-detected</figcaption>
</figure>
<blockquote>
<p>The (<em>sad?</em>) <em>fact</em> is: Blanket.js Code Coverage analysis will not detect <em>all</em> bugs or rogue code. you <strong>still need</strong> a <em><strong>human</strong></em> to do a <em><strong>code review</strong></em>!</p>
</blockquote>
<p><em>But</em> … if you use <em><strong>Istanbul</strong></em> to check coverage on the server, you’ll see that only part of the single line of <em>rogue</em> code was executed. Istanbul is <em>much</em> better at spotting un-tested code!</p>
<blockquote>
<p>We wrote a <strong>beginners guide</strong> to <strong>Code Coverage with Istanbul</strong>: <a href="https://github.com/dwyl/learn-istanbul">https://github.com/dwyl/<strong>learn-istanbul</strong></a> that goes into <em>detail</em>.</p>
</blockquote>
<h2 id="bonus-level-2-node.js-server-side-tests-10-mins">Bonus Level 2: Node.js (<em>server-side</em>) Tests (10 mins)</h2>
<blockquote>
<p><em><strong>Note</strong>: You will need to have Node.js installed on your machine for this section. If you don’t already have it, download it from: https://nodejs.org/en/download/</em></p>
</blockquote>
<p>The beauty of writing JavaScript is that you can <em><strong>run</strong></em> it <em><strong>anywhere</strong></em>!</p>
<p>In this bonus level we are going to run our tests <em><strong>“server-side”</strong></em> using <strong>Node.js</strong>.</p>
<p>Add these lines to the top of the <strong>test.js</strong> file you created in <strong>Bonus Level 1</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb29-1" title="1"><span class="co">/* The code block below ONLY Applies to Node.js - This Demonstrates</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="co">   re-useability of JS code in both Back-end and Front-end! #isomorphic */</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="co">/* istanbul ignore if */</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="cf">if</span> (<span class="kw">typeof</span> module <span class="op">!==</span> <span class="st">&#39;undefined&#39;</span> <span class="op">&amp;&amp;</span> <span class="va">module</span>.<span class="at">exports</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb29-5" title="5">  <span class="kw">var</span> QUnit <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;qunitjs&#39;</span>)<span class="op">;</span> <span class="co">// require QUnit node.js module</span></a>
<a class="sourceLine" id="cb29-6" title="6">  <span class="co">// alias the QUnit.test method so we don&#39;t have to change all our tests</span></a>
<a class="sourceLine" id="cb29-7" title="7">  <span class="kw">var</span> test <span class="op">=</span> <span class="va">QUnit</span>.<span class="at">test</span><span class="op">;</span> <span class="co">// stores a copy of QUnit.test</span></a>
<a class="sourceLine" id="cb29-8" title="8">  <span class="at">require</span>(<span class="st">&#39;qunit-tap&#39;</span>)(QUnit<span class="op">,</span> <span class="va">console</span>.<span class="at">log</span>)<span class="op">;</span> <span class="co">// use console.log for test output</span></a>
<a class="sourceLine" id="cb29-9" title="9">  <span class="kw">var</span> getChange <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;./change.js&#39;</span>)<span class="op">;</span> <span class="co">// load our getChange method</span></a>
<a class="sourceLine" id="cb29-10" title="10"><span class="op">}</span></a></code></pre></div>
<p>And add these lines to the bottom of the <strong>test.js</strong> file you created in <strong>Bonus Level 1</strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb30-1" title="1"><span class="co">/* istanbul ignore next */</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="cf">if</span> (<span class="kw">typeof</span> module <span class="op">!==</span> <span class="st">&#39;undefined&#39;</span> <span class="op">&amp;&amp;</span> <span class="va">module</span>.<span class="at">exports</span>) <span class="op">{</span> <span class="va">QUnit</span>.<span class="at">load</span>()<span class="op">;</span> <span class="op">}</span> <span class="co">// run the tests</span></a></code></pre></div>
<p>In addition, you need to add this to the <strong>change.js</strong> file you created in <strong>Bonus Level 1</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb31-1" title="1"><span class="co">/* The code block below ONLY Applies to Node.js - This Demonstrates</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co">   re-useability of JS code in both Back-end and Front-end! #isomorphic */</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="co">/* istanbul ignore next */</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="cf">if</span> (<span class="kw">typeof</span> module <span class="op">!==</span> <span class="st">&#39;undefined&#39;</span> <span class="op">&amp;&amp;</span> <span class="va">module</span>.<span class="at">exports</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb31-5" title="5">  <span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> getChange<span class="op">;</span>  <span class="co">// allows CommonJS/Node.js require()</span></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="op">}</span></a></code></pre></div>
<p>Next, install the following node.js modules by running <code>npm install qunitjs qunit-tap istanbul --save-dev</code>: + QUnit node.js module + qunit-tap (for command line output) + Istanbul for server-side code coverage</p>
<p>Run the tests in your <em>terminal</em>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb32-1" title="1"><span class="ex">node</span> test.js</a></code></pre></div>
<p>And run Istanbul to see the server-side code coverage:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb33-1" title="1"><span class="ex">./node_modules/.bin/istanbul</span> cover test.js</a></code></pre></div>
<p>At this point, you should see something like this in your terminal:</p>
<figure>
<img src="images/server-side-command-line-test-run-with-istanbul.png" alt="server-side-command-line-test-run-with-istanbul" /><figcaption>server-side-command-line-test-run-with-istanbul</figcaption>
</figure>
<p>Execute <code>open ./coverage/lcov-report/index.html</code> to view the detailed coverage report, and you should see something like this:</p>
<figure>
<img src="images/server-side-test-istanbul-coverage-highlights-rogue-code.png" alt="server-side-test-istanbul-coverage-highlights-rogue-code" /><figcaption>server-side-test-istanbul-coverage-highlights-rogue-code</figcaption>
</figure>
<p>This clearly highlights the “<em>rogue</em>” code from the previous <strong>Bonus Level</strong>.</p>
<p>Let’s <em>remove</em> the “<em>rogue</em>” code lines and re-run the tests:</p>
<figure>
<img src="images/server-side-command-line-test-run-with-istanbul-100-percent-coverage.png" alt="server-side-command-line-test-run-with-istanbul-100-percent-coverage" /><figcaption>server-side-command-line-test-run-with-istanbul-100-percent-coverage</figcaption>
</figure>
<p>Refresh the Code Coverage report in your browser:</p>
<figure>
<img src="images/server-side-test-istanbul-coverage-report.png" alt="server-side-test-istanbul-coverage-report" /><figcaption>server-side-test-istanbul-coverage-report</figcaption>
</figure>
<blockquote>
<p><em><strong>Boom</strong></em>! Now you know how to run your QUnit-based Unit Tests server-side!</p>
</blockquote>
<h3 id="top-tip-use-codecov.io-to-track-coverage-in-your-projects"><em>Top Tip</em>: Use <a href="https://codecov.io/#features">Codecov.io</a> to Track Coverage in your Projects!</h3>
<blockquote>
<p>Now that you understand how Code Coverage Works, you can use https://codecov.io/#features to <strong><em>track</em></strong> Coverage in your project over time! You can even add a <a href="https://github.com/dwyl/repo-badges"><strong><em>Badge</em></strong></a> to your readme file e.g: <a href="https://codecov.io/github/dwyl/learn-tdd?branch=master"><img src="https://codecov.io/github/dwyl/learn-tdd/coverage.svg?branch=master" alt="codecov.io" /></a> to show others that you <em>care</em> about testing.</p>
</blockquote>
<h2 id="bonus-level-3-continuous-integration-5-mins">Bonus Level 3: <em>Continuous Integration</em> (5 mins)</h2>
<p>If you are new to <strong>Continuous Integration</strong> (<strong>CI</strong> <em>in general</em>) or <strong>Travis CI</strong> check out our tutorial: https://github.com/docdis/learn-travis</p>
<p>To quickly add CI support to your project:</p>
<p><strong>1</strong>) <strong>Visit</strong>: https://travis-ci.org/profile and <strong>Login</strong> with your <strong>GitHub account</strong> <br /> <strong>2</strong>) Enable Travis for your project (<em><strong>Note</strong></em>: The project will need to be hosted on GitHub)</p>
<figure>
<img src="images/enable-travis-ci.png" alt="learn-tdd-enable-travis-ci" /><figcaption>learn-tdd-enable-travis-ci</figcaption>
</figure>
<p><strong>3</strong>) Add a <strong>.travis.yml</strong> file to your project’s root directory and include the following lines in it:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb34-1" title="1"><span class="ex">language</span>: node_js</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="ex">node_js</span>:</a>
<a class="sourceLine" id="cb34-3" title="3">  <span class="ex">-</span> <span class="st">&quot;node&quot;</span></a></code></pre></div>
<p><strong>4</strong>) Ensure that you have a <strong>package.json</strong> file with <strong>test</strong> script. <br /> (<em>if in doubt, just copy-paste the <strong>package.json</strong> from this project!</em>)</p>
<p><strong>5</strong>) <strong>Commit</strong> your changes and <strong>push</strong> them to GitHub <br /> <strong>6</strong>) Visit the page on Travis-CI for your project. e.g: https://travis-ci.org/dwyl/learn-tdd to see the build results.</p>
<figure>
<img src="images/build-passing-summary.png" alt="learn-tdd-build-passing-summary" /><figcaption>learn-tdd-build-passing-summary</figcaption>
</figure>
<figure>
<img src="images/build-passing.png" alt="learn-tdd-build-passing" /><figcaption>learn-tdd-build-passing</figcaption>
</figure>
<p>Done. <a href="https://travis-ci.org/dwyl/learn-tdd"><img src="https://travis-ci.org/dwyl/learn-tdd.svg" alt="Build Status" /></a></p>
<p><br /></p>
<h2 id="bonus-level-4-documentation-with-jsdoc-5-mins">Bonus Level 4: <em>Documentation</em> with <a href="https://github.com/jsdoc3/jsdoc">JSDoc</a> (5 mins)</h2>
<blockquote>
<p><strong>Note</strong>: Bonus Level 4 <strong><em>requires node.js</em></strong> to be <em>installed</em> on your machine. If you don’t already have it installed, don’t panic. You don’t need to know <em>anything</em> about Node.js to work through the examples. To download, visit: https://nodejs.org/en/download/ and install the version for your Operating System.</p>
</blockquote>
<p>If you took a peak at the solution in <strong>change.js</strong> you may have noticed that there is a <strong><em>comment block</em></strong> at the top of the file:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb35-1" title="1"><span class="co">/**</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co"> * getChange accepts two parameters (totalPayable and cashPaid) and calculates</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="co"> * the change in &quot;coins&quot; that needs to be returned.</span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="cv">{number}</span><span class="co"> totalPayable the integer amount (in pennies) to be paid</span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="cv">{number}</span><span class="co"> cashPaid the integer amount (in pennies) the person paid</span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="co"> * </span><span class="an">@returns</span><span class="co"> {array} list of coins we need to dispense to the person as change</span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="co"> * </span><span class="an">@example</span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="co"> * getChange(215, 300); // returns [50, 20, 10, 5]</span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co"> */</span></a></code></pre></div>
<p>This is a JSDoc comment block which documents the <code>getChange</code> function/method.</p>
<p>The beauty of writing documenting comments this way is that you can easily produce documentation for your project in 3 easy steps:</p>
<p><strong>1</strong>) Install jsdoc: in your terminal run the following command <code>npm install jsdoc --save-dev</code></p>
<p><strong>2</strong>) Run the <code>jsdoc</code> command in your terminal: <code>./node_modules/.bin/jsdoc change.js</code></p>
<p><strong>3</strong>) Open the resulting <strong>html</strong> file <code>open ./out/global.html#getChange</code> and you should see something like this in your web browser:</p>
<figure>
<img src="images/jsdoc-html.png" alt="learn-tdd-jsdoc-html" /><figcaption>learn-tdd-jsdoc-html</figcaption>
</figure>
<p>This <em>clearly</em> documents the functionality of the <code>getChange</code> method.</p>
<hr />
<h2 id="conclusion"><em>Conclusion</em></h2>
<p>In the last <strong>90 minutes</strong> you <em><strong>learned how</strong></em> to: + Write code following <strong>T</strong>est <strong>D</strong>riven <strong>D</strong>evelopment (<strong>TDD</strong>) discipline + Generate and view the <strong>code coverage</strong> for both front-end and back-end JavaScript Code + Set up <strong>Travis-CI Continuous Integration</strong> for your project (so that you can keep track of the test/build status for your project) + Use <strong>JSDoc</strong> to generate documentation for your code after writing simple comment blocks above your functions.</p>
<blockquote>
<p><em>Please <strong>Star</strong></em> this repository and share it with your coder friends/colleagues. <br /> <em>Help us</em> spread the TDD Love by <strong><em>re-tweeting</em></strong>: https://twitter.com/dwyl/status/621353373019865089 If you have <em><strong>any questions</strong></em> please ask: https://github.com/dwyl/learn-tdd/issues</p>
</blockquote>
<hr />
<p><sup>1</sup>Ok, its not <em>really</em> possible to learn “everything” in 30 mins… but you’ll certainly know <em>most</em> of what you need! And, if you have <em>any questions</em>, <em><strong>please ask</strong></em> at: https://github.com/dwyl/learn-tdd/issues</p>
<p><br /></p>
<h1 id="what-to-learn-next">What (<em>To Learn</em>) <em>Next</em>?</h1>
<p>Now that you know TDD basics, what should you learn/practice <em>next</em>…?</p>
<ul>
<li>Learn <strong><em>Elm Architecture</em></strong> to build web applications using the <em><strong>simple, reliable</strong> and <strong>fast</strong></em> architecture with our step-by-step guide: <a href="https://github.com/dwyl/learn-elm-architecture-in-javascript">github.com/dwyl/<strong>learn-elm-architecture</strong>-in-javascript</a> This is relevant to anyone who wants to build Web or Mobile Apps using React.js (<em>learning the principles of the <strong>Elm Architecture</strong> will help to keep your code well-organised and with a logical rendering flow</em>)</li>
<li>Learn <strong><em>Tape</em></strong> (<em>the simplest Node/Browser testing framework</em>): https://github.com/dwyl/learn-tape Apply your TDD knowledge to Node.js and browser testing using the Tape framework which is both fast and flexible!</li>
<li>Learn how to build a Todo List App (TodoMVC) in JavaScript from scratch: https://github.com/dwyl/todo-list-javascript-tutorial This is the <em>best</em> way to practice your TDD skills by building a <em>real</em> App following TDD best-practice from start to finish. This is also an extended example of using “Document Driven Development” where all code is documented <em>before</em> it is written using JSDoc comments.</li>
</ul>
<h1 id="interested-in-contributing">Interested in Contributing?</h1>
<p><em><strong>Please read</strong> our</em> <a href="https://github.com/dwyl/contributing"><strong>contribution guide</strong></a> (<em>thank you</em>!)</p>
