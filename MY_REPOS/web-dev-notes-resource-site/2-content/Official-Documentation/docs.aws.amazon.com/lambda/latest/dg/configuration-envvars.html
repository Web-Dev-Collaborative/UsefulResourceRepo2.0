<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="AWSDocsDocPageApp">
   
<!-- Mirrored from docs.aws.amazon.com/lambda/latest/dg/configuration-envvars.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 21 Feb 2021 15:00:03 GMT -->
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Using AWS Lambda environment variables - AWS Lambda</title>
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <meta name="assets_root" content="/assets" />
      <meta name="target_state" content="configuration-envvars" />
      <meta name="default_state" content="configuration-envvars" />
      <link rel="icon" type="image/ico" href="https://docs.aws.amazon.com/assets/images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="https://docs.aws.amazon.com/assets/images/favicon.ico" />
      <link rel="canonical" href="configuration-envvars.html" />
      <meta name="description" content="You can use environment variables to adjust your function's behavior without updating code. An environment variable is a pair of strings that are stored in a function's version-specific configuration. The Lambda runtime makes environment variables available to your code and sets additional environment variables that contain information about the function and invocation request." />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="AWS Lambda" />
      <meta name="guide" content="Developer Guide" />
      <meta name="locales" content="de_de:Deutsch/en_us:English/es_es:Español/fr_fr:Français/it_it:Italiano/ja_jp:日本語/ko_kr:한국어/pt_br:Português/zh_cn:中文 (简体)/zh_tw:中文 (繁體)" />
      <meta name="abstract" content="" />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <meta name="feedback-item" content="Lambda" />
      <meta name="this_doc_product" content="AWS Lambda" />
      <meta name="this_doc_guide" content="Developer Guide" />
      <link href="https://docs.aws.amazon.com/assets/css/vendor4.css?version=2020.09.30" rel="stylesheet" />
      <link href="https://docs.aws.amazon.com/assets/css/awsdocs-common.css?version=2020.09.30" rel="stylesheet" /><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/vendor3.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/vendor4.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/vendor1.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/awsdocs-common.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/awsdocs-doc-app.js?version=2020.09.30" defer=""></script></head>
   <body class="awsdocs awsui">
      <div class="awsdocs-container">
         <awsdocs-header></awsdocs-header>
         <awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)">
            <div id="guide-toc" dom-region="navigation">
               <awsdocs-toc></awsdocs-toc>
            </div>
            <div id="main-column" dom-region="content" tabindex="-1">
               <awsdocs-view class="awsdocs-view">
                  <div id="awsdocs-content">
                     <head>
                        <title>Using AWS Lambda environment variables - AWS Lambda</title>
                        <meta name="pdf" content="lambda-dg.pdf#configuration-envvars" />
                        <meta name="kindle" content="https://www.amazon.com/dp/B07GFJLN6D" />
                        <meta name="github" content="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/doc_source/configuration-envvars.md" />
                        <meta name="rss" content="lambda-updates.rss" />
                        <meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=186" />
                        <meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-envvars.html" />
                        <meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-envvars.html" />
                        <meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-envvars.html" />
                        <meta name="keywords" content="Lambda,AWS Lambda,serverless,serverless applications,cloud computing" />
                     </head>
                     <body>
                        <div id="main">
                           <div style="display: none"><a href="lambda-dg.pdf#configuration-envvars" target="_blank" title="Open PDF"></a><a target="_blank" href="https://www.amazon.com/dp/B07GFJLN6D" title="Open Kindle"></a><a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/doc_source/configuration-envvars.md" target="_blank" title="Edit this page on GitHub"></a></div>
                           <div id="breadcrumbs" class="breadcrumb"><a href="http://aws.amazon.com/">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/lambda/index.html">AWS Lambda</a><a href="welcome.html">Developer Guide</a></div>
                           <div id="page-toc-src"><a href="#configuration-envvars-runtime">Runtime environment variables</a><a href="#configuration-envvars-encryption">Securing environment variables</a><a href="#configuration-envvars-api">Configuring environment variables with the Lambda API</a><a href="#configuration-envvars-samples">Sample code and templates</a></div>
                           <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="configuration-envvars">Using AWS Lambda environment variables</h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p>You can use environment variables to adjust your function's behavior without updating
                                    code. An environment variable is a pair of strings that are stored in a function's
                                    version-specific configuration. The Lambda runtime makes environment variables available
                                    to your code and sets additional environment variables that contain information about
                                    the function and invocation request.
                                 </p>
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>To increase database security, we recommend that you use AWS Secrets Manager instead
                                          of environment variables to store database credentials. For more information, see
                                          <a href="configuration-database.html">Configuring database access for a Lambda function</a>.
                                       </p>
                                    </div>
                                 </div>
                                 <p>You set environment variables on the unpublished version of your function by specifying
                                    a key and value. When you publish a version, the environment variables are locked
                                    for that version along with other <a href="configuration-console.html">version-specific configuration</a>.
                                    
                                 </p>
                                 <div class="procedure">
                                    <p class="title"><b>To set environment variables in the Lambda console</b></p>
                                    <ol>
                                       <li>
                                          <p>Open the <a href="https://console.aws.amazon.com/lambda/home#/functions" rel="noopener noreferrer" target="_blank"><span>Functions page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on the Lambda console.
                                          </p>
                                       </li>
                                       <li>
                                          
                                          <p>Choose a function.</p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Under <b>Environment variables</b>, choose <b>Edit</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Add environment variable</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Enter a key and value.</p>
                                          
                                          <div class="itemizedlist">
                                             
                                             <p class="title"><b>Requirements</b></p>
                                              
                                              
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p>Keys start with a letter and are at least two characters.</p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Keys only contain letters, numbers, and the underscore character (<code class="code">_</code>).
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>Keys aren't <a href="#configuration-envvars-runtime">reserved by Lambda</a>.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p>The total size of all environment variables doesn't exceed 4 KB.</p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Save</b>.
                                          </p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                 <p>Use environment variables to pass environment-specific settings to your code. For
                                    example, you can have two
                                    functions with the same code but different configuration. One function connects to
                                    a test database, and the other
                                    connects to a production database. In this situation, you use environment variables
                                    to tell the function the
                                    hostname and other connection details for the database. 
                                 </p>
                                 <p>The following example shows how to define the database host and database name as environment
                                    variables.
                                 </p>
                                 <div class="mediaobject">
                                     
                                    <img src="images/console-env.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;      Environment variables in the Lambda console.&#xA;    " />
                                     
                                     
                                    
                                 </div>
                                 <p>If you want your test environment to generate more debug information than the production
                                    environment, you could
                                    set an environment variable to configure your test environment to use more verbose
                                    logging or more detailed
                                    tracing.
                                 </p>
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>Environment variables are not evaluated prior to the function invocation. Any value
                                          you define is considered a
                                          literal string and not expanded. Perform the variable evaluation in the function code.
                                       </p>
                                    </div>
                                 </div>
                                 <p>To retrieve environment variables in your function code, use the standard method for
                                    your programming
                                    language.
                                 </p>
                                 <awsdocs-tabs>
                                    <dl style="display: none">
                                       
                                       <dt>Node.js</dt>
                                       <dd tab-id="node.html">
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nodejs ">let region = process.env.AWS_REGION</code></pre>
                                          </dd>
                                       
                                       <dt>Python</dt>
                                       <dd tab-id="python">
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import os
region = os.environ['AWS_REGION']</code></pre>
                                          <div class="awsdocs-note">
                                             <div class="awsdocs-note-title">
                                                <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                             <div class="awsdocs-note-text">
                                                <p>In some cases, you may need to use the following format:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">region = os.environ.get('AWS_REGION')</code></pre></div>
                                          </div>
                                          
                                       </dd>
                                       
                                       <dt>Ruby</dt>
                                       <dd tab-id="ruby">
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="ruby ">region = ENV["AWS_REGION"]</code></pre>
                                          </dd>
                                       
                                       <dt>Java</dt>
                                       <dd tab-id="java">
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">String region = System.getenv("AWS_REGION");</code></pre>
                                          </dd>
                                       
                                       <dt>Go</dt>
                                       <dd tab-id="go">
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="go ">var region = os.Getenv("AWS_REGION")</code></pre>
                                          </dd>
                                       
                                       <dt>C#</dt>
                                       <dd tab-id="c#">
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="csharp ">string region = Environment.GetEnvironmentVariable("AWS_REGION");</code></pre>
                                          </dd>
                                       
                                       <dt>PowerShell</dt>
                                       <dd tab-id="powershell">
                                          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="powershell ">$region = $env:AWS_REGION</code></pre>
                                          </dd>
                                       
                                    </dl>
                                 </awsdocs-tabs>
                                 <p>Lambda stores environment variables securely by encrypting them at rest. You can <a href="#configuration-envvars-encryption">configure Lambda to use a different encryption key</a>, encrypt
                                    environment variable values on the client side, or set environment variables in an
                                    AWS CloudFormation template with
                                    AWS Secrets Manager.
                                 </p>
                                 <div class="highlights" id="inline-topiclist">
                                    <p><strong>Sections</strong></p>
                                    <ul>
                                       <li><a href="#configuration-envvars-runtime">Runtime environment variables</a></li>
                                       <li><a href="#configuration-envvars-encryption">Securing environment variables</a></li>
                                       <li><a href="#configuration-envvars-api">Configuring environment variables with the Lambda API</a></li>
                                       <li><a href="#configuration-envvars-samples">Sample code and templates</a></li>
                                    </ul>
                                 </div>
                                 
                                 <h2 id="configuration-envvars-runtime">Runtime environment variables</h2>
                                 
                                 
                                 <p>Lambda <a href="lambda-runtimes.html">runtimes</a> set several environment variables during initialization.
                                    Most of the environment variables provide information about the function or runtime.
                                    The keys for these
                                    environment variables are <em>reserved</em> and cannot be set in your function configuration.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    <p class="title"><b>Reserved environment variables</b></p>
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><code class="code">_HANDLER</code> – The handler location configured on the function.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">_X_AMZN_TRACE_ID</code> – The <a href="services-xray.html">X-Ray tracing
                                                header</a>.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_REGION</code> – The AWS Region where the Lambda function is executed.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_EXECUTION_ENV</code> – The <a href="lambda-runtimes.html">runtime identifier</a>,
                                             prefixed by <code class="code">AWS_Lambda_</code>—for example, <code class="code">AWS_Lambda_java8</code>.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_LAMBDA_FUNCTION_NAME</code> – The name of the function.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_LAMBDA_FUNCTION_MEMORY_SIZE</code> – The amount of memory available to the function in
                                             MB.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_LAMBDA_FUNCTION_VERSION</code> – The version of the function being executed.
                                          </p>
                                          
                                          <p><code class="code">AWS_LAMBDA_INITIALIZATION_TYPE</code> – The initialization type of the function, which is
                                             either <code class="code">on-demand</code> or  <code class="code">provisioned-concurrency</code>. For information, see <a href="configuration-concurrency.html#configuration-concurrency-provisioned">
                                                Configuring provisioned concurrency</a>. 
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_LAMBDA_LOG_GROUP_NAME</code>, <code class="code">AWS_LAMBDA_LOG_STREAM_NAME</code> – The name of the
                                             Amazon CloudWatch Logs group and stream for the function.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_ACCESS_KEY_ID</code>, <code class="code">AWS_SECRET_ACCESS_KEY</code>, <code class="code">AWS_SESSION_TOKEN</code>
                                             – The access keys obtained from the function's <a href="lambda-intro-execution-role.html">execution
                                                role</a>.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_LAMBDA_RUNTIME_API</code> – (<a href="runtimes-custom.html">Custom runtime</a>) The
                                             host and port of the <a href="runtimes-api.html">runtime API</a>.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">LAMBDA_TASK_ROOT</code> – The path to your Lambda function code.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">LAMBDA_RUNTIME_DIR</code> – The path to runtime libraries.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">TZ</code> – The environment's time zone (<code class="code">UTC</code>). The execution environment uses
                                             NTP to synchronize the system clock.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <p>The following additional environment variables aren't reserved and can be extended
                                    in your function
                                    configuration.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    <p class="title"><b>Unreserved environment variables</b></p>
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><code class="code">LANG</code> – The locale of the runtime (<code class="code">en_US.UTF-8</code>).
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">PATH</code> – The execution path
                                             (<code class="code">/usr/local/bin:/usr/bin/:/bin:/opt/bin</code>).
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">LD_LIBRARY_PATH</code> – The system library path
                                             (<code class="code">/lib64:/usr/lib64:$LAMBDA_RUNTIME_DIR:$LAMBDA_RUNTIME_DIR/lib:$LAMBDA_TASK_ROOT:$LAMBDA_TASK_ROOT/lib:/opt/lib</code>).
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">NODE_PATH</code> – (<a href="lambda-nodejs.html">Node.js</a>) The Node.js library path
                                             (<code class="code">/opt/nodejs/node12/node_modules/:/opt/nodejs/node_modules:$LAMBDA_RUNTIME_DIR/node_modules</code>).
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">PYTHONPATH</code> – (<a href="lambda-python.html">Python 2.7, 3.6, 3.8</a>) The Python
                                             library path (<code class="code">$LAMBDA_RUNTIME_DIR</code>).
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">GEM_PATH</code> – (<a href="lambda-ruby.html">Ruby</a>) The Ruby library path
                                             (<code class="code">$LAMBDA_TASK_ROOT/vendor/bundle/ruby/2.5.0:/opt/ruby/gems/2.5.0</code>).
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_XRAY_CONTEXT_MISSING</code> – For X-Ray tracing, Lambda sets this to
                                             <code class="code">LOG_ERROR</code> to avoid throwing runtime errors from the X-Ray SDK.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_XRAY_DAEMON_ADDRESS</code> – For X-Ray tracing, the IP address and port of the X-Ray
                                             daemon.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">AWS_LAMBDA_DOTNET_PREJIT</code> – For the .NET 3.1 runtime, set this variable to enable or
                                             disable .NET 3.1 specific runtime optimizations. Values include <code class="code">always</code>,  <code class="code">never</code>, and
                                             <code class="code">provisioned-concurrency</code>. For information, see <a href="configuration-concurrency.html#configuration-concurrency-provisioned">
                                                Configuring provisioned concurrency</a>.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <p>The sample values shown reflect the latest runtimes. The presence of specific variables
                                    or their values can
                                    vary on earlier runtimes.
                                 </p>
                                  
                                 
                                 <h2 id="configuration-envvars-encryption">Securing environment variables</h2>
                                 
                                 
                                 <p>Lambda encrypts environment variables with a key that it creates in your account (an
                                    AWS managed customer
                                    master key (CMK)). Use of this key is free. You can also choose to provide your own
                                    key for Lambda to use instead
                                    of the default key.
                                 </p>
                                 
                                 <p>When you provide the key, only users in your account with access to the key can view
                                    or manage environment
                                    variables on the function. Your organization might also have internal or external
                                    requirements to manage keys that
                                    are used for encryption and to control when they're rotated.
                                 </p>
                                 
                                 <div class="procedure">
                                    <p class="title"><b>To use a customer managed CMK</b></p>
                                    <ol>
                                       <li>
                                          <p>Open the <a href="https://console.aws.amazon.com/lambda/home#/functions" rel="noopener noreferrer" target="_blank"><span>Functions page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on the Lambda console.
                                          </p>
                                       </li>
                                       <li>
                                          
                                          <p>Choose a function.</p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Under <b>Environment variables</b>, choose <b>Edit</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Expand <b>Encryption configuration</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Use a customer master key</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose your customer managed CMK.</p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Save</b>.
                                          </p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                 
                                 <p>Customer managed CMKs incur standard <a href="https://aws.amazon.com/kms/pricing/" rel="noopener noreferrer" target="_blank"><span>AWS KMS charges</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.
                                 </p>
                                 
                                 
                                 <p>No AWS KMS permissions are required for your user or the function's execution role
                                    to use the default encryption
                                    key. To use a customer managed CMK, you need permission to use the key. Lambda uses
                                    your permissions to create a
                                    grant on the key. This allows Lambda to use it for encryption.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><code class="code">kms:ListAliases</code> – To view keys in the Lambda console.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">kms:CreateGrant</code>, <code class="code">kms:Encrypt</code> – To configure a customer managed CMK on a
                                             function.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><code class="code">kms:Decrypt</code> – To view and manage environment variables that are encrypted with a
                                             customer managed CMK.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <p>You can get these permissions from your user account or from a key's resource-based
                                    permissions policy.
                                    <code class="code">ListAliases</code> is provided by the <a href="access-control-identity-based.html">managed policies for
                                       Lambda</a>. Key policies grant the remaining permissions to users in the <b>Key users</b>
                                    group.
                                 </p>
                                 
                                 
                                 <p>Users without <code class="code">Decrypt</code> permissions can still manage functions, but they can't view environment
                                    variables or manage them in the Lambda console. To prevent a user from viewing environment
                                    variables, add a
                                    statement to the user's permissions that denies access to the default key, a customer
                                    managed key, or all
                                    keys.
                                 </p>
                                 
                                 <div class="example">
                                    <p class="title"><b>Example IAM policy – Deny access by key ARN</b></p>
                                    <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "VisualEditor0",
            "Effect": "Deny",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": "arn:aws:kms:us-east-2:123456789012:key/3be10e2d-xmpl-4be4-bc9d-0405a71945cc"
        }
    ]
}</code></pre></div>
                                 </div>
                                 
                                 <div class="mediaobject">
                                     
                                    <img src="images/env-accessdenied.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Error message for user without decrypt permissions in the Lambda console.&#xA;      " />
                                     
                                     
                                    
                                 </div>
                                 
                                 <p>For details on managing key permissions, see <a href="https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html">Using key policies in
                                       AWS KMS</a>.
                                 </p>
                                 
                                 
                                 <p>You can also encrypt environment variable values on the client side before sending
                                    them to Lambda, and decrypt
                                    them in your function code. This obscures secret values in the Lambda console and
                                    API output, even for users who
                                    have permission to use the key. In your code, you retrieve the encrypted value from
                                    the environment and decrypt it
                                    by using the AWS KMS API.
                                 </p>
                                 
                                 <div class="procedure">
                                    <p class="title"><b>To encrypt environment variables on the client side</b></p>
                                    <ol>
                                       <li>
                                          <p>Open the <a href="https://console.aws.amazon.com/lambda/home#/functions" rel="noopener noreferrer" target="_blank"><span>Functions page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on the Lambda console.
                                          </p>
                                       </li>
                                       <li>
                                          
                                          <p>Choose a function.</p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Under <b>Environment variables</b>, choose <b>Edit</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Expand <b>Encryption configuration</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Enable helpers for encryption in transit</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Encrypt</b> next to a variable to encrypt its value.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Save</b>.
                                          </p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                 
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>When you use the console encryption helpers, your function needs permission to call
                                          the
                                          <code class="code">kms:Decrypt</code> API operation in its <a href="lambda-intro-execution-role.html">execution
                                             role</a>.
                                       </p>
                                    </div>
                                 </div>
                                 
                                 <p>To view sample code for your function's language, choose <b>Code</b> next to an environment
                                    variable. The sample code shows how to retrieve an environment variable in a function
                                    and decrypt its
                                    value.
                                 </p>
                                 
                                 
                                 <p>Another option is to store passwords in AWS Secrets Manager secrets. You can reference
                                    the secret in your AWS CloudFormation
                                    templates to set passwords on databases. You can also set the value of an environment
                                    variable on the Lambda
                                    function. For an example, see the next section.
                                 </p>
                                  
                                 
                                 <h2 id="configuration-envvars-api">Configuring environment variables with the Lambda API</h2>
                                 
                                 
                                 <p>To manage environment variables with the AWS CLI or AWS SDK, use the following API
                                    operations.
                                 </p>
                                  
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          <p><a href="API_UpdateFunctionConfiguration.html">UpdateFunctionConfiguration</a></p>
                                       </li>
                                       <li class="listitem">
                                          <p><a href="API_GetFunctionConfiguration.html">GetFunctionConfiguration</a></p>
                                       </li>
                                       <li class="listitem">
                                          <p><a href="API_CreateFunction.html">CreateFunction</a></p>
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 
                                 <p>The following example sets two environment variables on a function named <code class="code">my-function</code>.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda update-function-configuration --function-name my-function \
    --environment "Variables=<span>{</span>BUCKET=my-bucket,KEY=file.txt}"</code></code></pre>
                                 <p>When you apply environment variables with the <code class="code">update-function-configuration</code> command, the entire
                                    contents of the <code class="code">Variables</code> structure is replaced. To retain existing environment variables when you
                                    add a new one, include all existing values in your request.
                                 </p>
                                 
                                 <p>To get the current configuration, use the <code class="code">get-function-configuration</code> command.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda get-function-configuration --function-name my-function</code></code></pre>
                                 <p>You should see the following output:</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "FunctionName": "my-function",
    "FunctionArn": "arn:aws:lambda:us-east-2:123456789012:function:my-function",
    "Runtime": "nodejs12.x",
    "Role": "arn:aws:iam::123456789012:role/lambda-role",
    "Environment": <span>{</span>
        "Variables": <span>{</span>
            "BUCKET": "my-bucket",
            "KEY": "file.txt"
        }
    },
    "RevisionId": "0894d3c1-2a3d-4d48-bf7f-abade99f3c15",
    ...
}</code></pre>
                                 <p>To ensure that the values don't change between when you read the configuration and
                                    when you update it, you can
                                    pass the revision ID from the output of <code class="code">get-function-configuration</code> as a parameter to
                                    <code class="code">update-function-configuration</code>.
                                 </p>
                                 
                                 
                                 <p>To configure a function's encryption key, set the <code class="code">KMSKeyARN</code> option.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda update-function-configuration --function-name my-function \
   --kms-key-arn arn:aws:kms:us-east-2:123456789012:key/055efbb4-xmpl-4336-ba9c-538c7d31f599</code></code></pre>
                                  
                                 <h2 id="configuration-envvars-samples">Sample code and templates</h2>
                                 
                                 
                                 <p>Sample applications in this guide's GitHub repository demonstrate the use of environment
                                    variables in function
                                    code and AWS CloudFormation templates.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    <p class="title"><b>Sample applications</b></p>
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><a href="samples-blank.html">Blank function</a> – Create a function and an Amazon SNS topic in the
                                             same template. Pass the name of the topic to the function in an environment variable.
                                             Read environment
                                             variables in code (multiple languages).
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/rds-mysql" rel="noopener noreferrer" target="_blank"><span>RDS MySQL</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> – Create a VPC and an Amazon RDS DB instance in
                                             one template, with a password stored in Secrets Manager. In the application template,
                                             import database details from the
                                             VPC stack, read the password from Secrets Manager, and pass all connection configuration
                                             to the function in environment
                                             variables.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                                 <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the AWS Documentation, Javascript must be
                                                enabled. Please refer to your browser's Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              <div id="main-col-footer" class="awsui-util-font-size-0">
                                 <div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div>
                                 <div class="prev-next">
                                    <div id="previous" class="prev-link" accesskey="p" href="configuration-images.html">Functions defined as container images</div>
                                    <div id="next" class="next-link" accesskey="n" href="configuration-concurrency.html">Concurrency</div>
                                 </div>
                              </div>
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div>
                           <div id="quick-feedback-yes" style="display: none;">
                              <div class="title">Did this page help you? - Yes</div>
                              <div class="content">
                                 <p>Thanks for letting us know we're doing a good
                                    job!
                                 </p>
                                 <p>If you've got a moment, please tell us what we did right
                                    so we can do more of it.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-envvars.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                           <div id="quick-feedback-no" style="display: none;">
                              <div class="title">Did this page help you? - No</div>
                              <div class="content">
                                 <p>Thanks for letting us know this page needs work. We're
                                    sorry we let you down.
                                 </p>
                                 <p>If you've got a moment, please tell us how we can make
                                    the documentation better.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-envvars.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                        </div>
                     </body>
                  </div>
               </awsdocs-view>
               <div class="page-loading-indicator" id="page-loading-indicator">
                  <awsui-spinner size="large"></awsui-spinner>
               </div>
            </div>
            <div id="tools-panel" dom-region="tools">
               <awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel>
            </div>
         </awsui-app-layout>
         <awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner>
         <!--
                SiteCatalyst code version: H.25.2.
                Copyright 1996-2012 Adobe, Inc. All Rights Reserved
                More info available at http://www.omniture.com
            --><script language="JavaScript" type="text/javascript">
var awsdocs = awsdocs || {};
awsdocs.prop66 = 'AWS Lambda';
awsdocs.prop65 =  'Developer Guide';
            </script><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js" language="JavaScript" type="text/javascript"></script>
         <!--/DO NOT REMOVE/-->
         <!--End SiteCatalyst code version: H.25.2.--></div>
   </body>

<!-- Mirrored from docs.aws.amazon.com/lambda/latest/dg/configuration-envvars.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 21 Feb 2021 15:00:11 GMT -->
</html>