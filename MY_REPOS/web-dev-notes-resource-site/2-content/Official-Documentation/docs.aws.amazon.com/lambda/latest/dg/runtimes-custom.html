<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="AWSDocsDocPageApp">
   
<!-- Mirrored from docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 21 Feb 2021 15:00:14 GMT -->
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Custom AWS Lambda runtimes - AWS Lambda</title>
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <meta name="assets_root" content="/assets" />
      <meta name="target_state" content="runtimes-custom" />
      <meta name="default_state" content="runtimes-custom" />
      <link rel="icon" type="image/ico" href="https://docs.aws.amazon.com/assets/images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="https://docs.aws.amazon.com/assets/images/favicon.ico" />
      <link rel="canonical" href="runtimes-custom.html" />
      <meta name="description" content="You can implement an AWS Lambda runtime in any programming language. A runtime is a program that runs a Lambda function's handler method when the function is invoked. You can include a runtime in your function's deployment package in the form of an executable file named" />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="AWS Lambda" />
      <meta name="guide" content="Developer Guide" />
      <meta name="locales" content="de_de:Deutsch/en_us:English/es_es:Español/fr_fr:Français/it_it:Italiano/ja_jp:日本語/ko_kr:한국어/pt_br:Português/zh_cn:中文 (简体)/zh_tw:中文 (繁體)" />
      <meta name="abstract" content="" />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <meta name="feedback-item" content="Lambda" />
      <meta name="this_doc_product" content="AWS Lambda" />
      <meta name="this_doc_guide" content="Developer Guide" />
      <link href="https://docs.aws.amazon.com/assets/css/vendor4.css?version=2020.09.30" rel="stylesheet" />
      <link href="https://docs.aws.amazon.com/assets/css/awsdocs-common.css?version=2020.09.30" rel="stylesheet" /><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/vendor3.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/vendor4.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/vendor1.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/awsdocs-common.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/awsdocs-doc-app.js?version=2020.09.30" defer=""></script></head>
   <body class="awsdocs awsui">
      <div class="awsdocs-container">
         <awsdocs-header></awsdocs-header>
         <awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)">
            <div id="guide-toc" dom-region="navigation">
               <awsdocs-toc></awsdocs-toc>
            </div>
            <div id="main-column" dom-region="content" tabindex="-1">
               <awsdocs-view class="awsdocs-view">
                  <div id="awsdocs-content">
                     <head>
                        <title>Custom AWS Lambda runtimes - AWS Lambda</title>
                        <meta name="pdf" content="lambda-dg.pdf#runtimes-custom" />
                        <meta name="kindle" content="https://www.amazon.com/dp/B07GFJLN6D" />
                        <meta name="github" content="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/doc_source/runtimes-custom.md" />
                        <meta name="rss" content="lambda-updates.rss" />
                        <meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=186" />
                        <meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-custom.html" />
                        <meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-custom.html" />
                        <meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-custom.html" />
                        <meta name="keywords" content="Lambda,AWS Lambda,serverless,serverless applications,cloud computing" />
                     </head>
                     <body>
                        <div id="main">
                           <div style="display: none"><a href="lambda-dg.pdf#runtimes-custom" target="_blank" title="Open PDF"></a><a target="_blank" href="https://www.amazon.com/dp/B07GFJLN6D" title="Open Kindle"></a><a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/doc_source/runtimes-custom.md" target="_blank" title="Edit this page on GitHub"></a></div>
                           <div id="breadcrumbs" class="breadcrumb"><a href="http://aws.amazon.com/">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/lambda/index.html">AWS Lambda</a><a href="welcome.html">Developer Guide</a></div>
                           <div id="page-toc-src"><a href="#runtimes-custom-use">Using a custom runtime</a><a href="#runtimes-custom-build">Building a custom runtime</a></div>
                           <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="runtimes-custom">Custom AWS Lambda runtimes</h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p>You can implement an AWS Lambda runtime in any programming language. A runtime is
                                    a program that runs a Lambda
                                    function's handler method when the function is invoked. You can include a runtime
                                    in your function's deployment
                                    package in the form of an executable file named <code>bootstrap</code>.
                                 </p>
                                 <p>A runtime is responsible for running the function's setup code, reading the handler
                                    name from an environment
                                    variable, and reading invocation events from the Lambda runtime API. The runtime passes
                                    the event data to the
                                    function handler, and posts the response from the handler back to Lambda.
                                 </p>
                                 <p>Your custom runtime runs in the standard Lambda <a href="lambda-runtimes.html">execution environment</a>. It
                                    can be a shell script, a script in a language that's included in Amazon Linux, or
                                    a binary executable file that's compiled
                                    in Amazon Linux.
                                 </p>
                                 <p>To get started with custom runtimes, see <a href="runtimes-walkthrough.html">Tutorial – Publishing a custom runtime</a>. You can also explore a custom runtime implemented in C++ at <a href="https://github.com/awslabs/aws-lambda-cpp" rel="noopener noreferrer" target="_blank"><span>awslabs/aws-lambda-cpp</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on GitHub.
                                 </p>
                                 <div class="highlights" id="inline-topiclist">
                                    <p><strong>Topics</strong></p>
                                    <ul>
                                       <li><a href="#runtimes-custom-use">Using a custom runtime</a></li>
                                       <li><a href="#runtimes-custom-build">Building a custom runtime</a></li>
                                    </ul>
                                 </div>
                                 
                                 <h2 id="runtimes-custom-use">Using a custom runtime</h2>
                                 
                                 
                                 <p>To use a custom runtime, set your function's runtime to <code class="code">provided</code>. The runtime can be included in
                                    your function's deployment package, or in a <a href="configuration-layers.html">layer</a>.
                                 </p>
                                 
                                 <div class="example">
                                    <p class="title"><b>Example function.zip</b></p>
                                    <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">.
├── bootstrap
├── function.sh</code></pre></div>
                                 </div>
                                 
                                 
                                 <p>If there's a file named <code>bootstrap</code> in your deployment package, Lambda runs that file.
                                    If not, Lambda looks for a runtime in the function's layers. If the bootstrap file
                                    isn't found or isn't executable,
                                    your function returns an error upon invocation.
                                 </p>
                                  
                                 
                                 <h2 id="runtimes-custom-build">Building a custom runtime</h2>
                                 
                                 
                                 <p>A custom runtime's entry point is an executable file named <code>bootstrap</code>. The bootstrap file
                                    can be the runtime, or it can invoke another file that creates the runtime. The following
                                    example uses a bundled
                                    version of Node.js to run a JavaScript runtime in a separate file named
                                    <code>runtime.js</code>.
                                 </p>
                                 
                                 <div class="example">
                                    <p class="title"><b>Example bootstrap</b></p>
                                    <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">#!/bin/sh
cd $LAMBDA_TASK_ROOT
./node-v11.1.0-linux-x64/bin/node runtime.js</code></pre></div>
                                 </div>
                                 
                                 
                                 <p>Your runtime code is responsible for completing some initialization tasks. Then it
                                    processes invocation events
                                    in a loop until it's terminated. The initialization tasks run once <a href="runtimes-context.html">per instance
                                       of the function</a> to prepare the environment to handle invocations.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    <p class="title"><b>Initialization tasks</b></p>
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><b>Retrieve settings</b> – Read environment variables to get details
                                             about the function and environment.
                                          </p>
                                          
                                          <div class="itemizedlist">
                                              
                                              
                                              
                                             
                                             <ul class="itemizedlist" type="disc">
                                                <li class="listitem">
                                                   
                                                   <p><code class="code">_HANDLER</code> – The location to the handler, from the function's configuration. The
                                                      standard format is <code class="code"><code class="replaceable">file</code>.<code class="replaceable">method</code></code>, where
                                                      <code class="code">file</code> is the name of the file without an extension, and <code class="code">method</code> is the name of a
                                                      method or function that's defined in the file.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p><code class="code">LAMBDA_TASK_ROOT</code> – The directory that contains the function code.
                                                   </p>
                                                   
                                                </li>
                                                <li class="listitem">
                                                   
                                                   <p><code class="code">AWS_LAMBDA_RUNTIME_API</code> – The host and port of the runtime API.
                                                   </p>
                                                   
                                                </li>
                                             </ul>
                                          </div>
                                          
                                          <p>See <a href="configuration-envvars.html#configuration-envvars-runtime">Runtime environment variables</a> for a
                                             full list of available variables.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Initialize the function</b> – Load the handler file and run any global
                                             or static code that it contains. Functions should create static resources like SDK
                                             clients and database
                                             connections once, and reuse them for multiple invocations.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Handle errors</b> – If an error occurs, call the <a href="runtimes-api.html#runtimes-api-initerror">initialization error</a> API and exit immediately.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 
                                 <p>Initialization counts towards billed execution time and timeout. When an execution
                                    triggers the initialization
                                    of a new instance of your function, you can see the initialization time in the logs
                                    and <a href="services-xray.html">AWS X-Ray trace</a>.
                                 </p>
                                 
                                 <div class="example">
                                    <p class="title"><b>Example log</b></p>
                                    <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">REPORT RequestId: f8ac1208... Init Duration: 48.26 ms   Duration: 237.17 ms   Billed Duration: 300 ms   Memory Size: 128 MB   Max Memory Used: 26 MB</code></pre></div>
                                 </div>
                                 
                                 <div class="mediaobject">
                                     
                                    <img src="images/runtimes-custom-init.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Initialization time in an X-Ray trace.&#xA;      " />
                                     
                                     
                                    
                                 </div>
                                 
                                 
                                 <p>While it runs, a runtime uses the <a href="runtimes-api.html">Lambda runtime interface</a> to manage
                                    incoming events and report errors. After completing initialization tasks, the runtime
                                    processes incoming events in
                                    a loop. In your runtime code, perform the following steps in order.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                    
                                    <p class="title"><b>Processing tasks</b></p>
                                     
                                     
                                     
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><b>Get an event</b> – Call the <a href="runtimes-api.html#runtimes-api-next">next
                                                invocation</a> API to get the next event. The response body contains the event data. Response headers
                                             contain the request ID and other information.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Propagate the tracing header</b> – Get the X-Ray tracing header from
                                             the <code class="code">Lambda-Runtime-Trace-Id</code> header in the API response. Set the <code class="code">_X_AMZN_TRACE_ID</code>
                                             environment variable locally with the same value. The X-Ray SDK uses this value to
                                             connect trace data between
                                             services.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Create a context object</b> – Create an object with context
                                             information from environment variables and headers in the API response.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Invoke the function handler</b> – Pass the event and context object to
                                             the handler.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Handle the response</b> – Call the <a href="runtimes-api.html#runtimes-api-response">invocation response</a> API to post the response from the handler.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Handle errors</b> – If an error occurs, call the <a href="runtimes-api.html#runtimes-api-invokeerror">invocation error</a> API.
                                          </p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Cleanup</b> – Release unused resources, send data to other services,
                                             or perform additional tasks before getting the next event.
                                          </p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 
                                 
                                 <p>You can include the runtime in your function's deployment package, or distribute the
                                    runtime separately in a
                                    function layer. For an example walkthrough, see <a href="runtimes-walkthrough.html">Tutorial – Publishing a custom runtime</a>.
                                 </p>
                                 
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                                 <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the AWS Documentation, Javascript must be
                                                enabled. Please refer to your browser's Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              <div id="main-col-footer" class="awsui-util-font-size-0">
                                 <div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div>
                                 <div class="prev-next">
                                    <div id="previous" class="prev-link" accesskey="p" href="runtimes-logs-api.html">Logs API</div>
                                    <div id="next" class="next-link" accesskey="n" href="runtimes-walkthrough.html">Tutorial – Custom runtime</div>
                                 </div>
                              </div>
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div>
                           <div id="quick-feedback-yes" style="display: none;">
                              <div class="title">Did this page help you? - Yes</div>
                              <div class="content">
                                 <p>Thanks for letting us know we're doing a good
                                    job!
                                 </p>
                                 <p>If you've got a moment, please tell us what we did right
                                    so we can do more of it.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-custom.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                           <div id="quick-feedback-no" style="display: none;">
                              <div class="title">Did this page help you? - No</div>
                              <div class="content">
                                 <p>Thanks for letting us know this page needs work. We're
                                    sorry we let you down.
                                 </p>
                                 <p>If you've got a moment, please tell us how we can make
                                    the documentation better.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-custom.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                        </div>
                     </body>
                  </div>
               </awsdocs-view>
               <div class="page-loading-indicator" id="page-loading-indicator">
                  <awsui-spinner size="large"></awsui-spinner>
               </div>
            </div>
            <div id="tools-panel" dom-region="tools">
               <awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel>
            </div>
         </awsui-app-layout>
         <awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner>
         <!--
                SiteCatalyst code version: H.25.2.
                Copyright 1996-2012 Adobe, Inc. All Rights Reserved
                More info available at http://www.omniture.com
            --><script language="JavaScript" type="text/javascript">
var awsdocs = awsdocs || {};
awsdocs.prop66 = 'AWS Lambda';
awsdocs.prop65 =  'Developer Guide';
            </script><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js" language="JavaScript" type="text/javascript"></script>
         <!--/DO NOT REMOVE/-->
         <!--End SiteCatalyst code version: H.25.2.--></div>
   </body>

<!-- Mirrored from docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 21 Feb 2021 15:00:15 GMT -->
</html>