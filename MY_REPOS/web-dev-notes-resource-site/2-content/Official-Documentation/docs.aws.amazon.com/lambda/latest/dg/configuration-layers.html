<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="AWSDocsDocPageApp">
   
<!-- Mirrored from docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 21 Feb 2021 15:00:16 GMT -->
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Lambda layers - AWS Lambda</title>
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <meta name="assets_root" content="/assets" />
      <meta name="target_state" content="configuration-layers" />
      <meta name="default_state" content="configuration-layers" />
      <link rel="icon" type="image/ico" href="https://docs.aws.amazon.com/assets/images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="https://docs.aws.amazon.com/assets/images/favicon.ico" />
      <link rel="canonical" href="configuration-layers.html" />
      <meta name="description" content="You can configure your Lambda function to pull in additional code and content in the form of layers. A layer is a .zip file archive that contains libraries, a custom runtime , or other dependencies. With layers, you can use libraries in your function without needing to include them in your deployment package." />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="AWS Lambda" />
      <meta name="guide" content="Developer Guide" />
      <meta name="locales" content="de_de:Deutsch/en_us:English/es_es:Español/fr_fr:Français/it_it:Italiano/ja_jp:日本語/ko_kr:한국어/pt_br:Português/zh_cn:中文 (简体)/zh_tw:中文 (繁體)" />
      <meta name="abstract" content="" />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <meta name="feedback-item" content="Lambda" />
      <meta name="this_doc_product" content="AWS Lambda" />
      <meta name="this_doc_guide" content="Developer Guide" />
      <link href="https://docs.aws.amazon.com/assets/css/vendor4.css?version=2020.09.30" rel="stylesheet" />
      <link href="https://docs.aws.amazon.com/assets/css/awsdocs-common.css?version=2020.09.30" rel="stylesheet" /><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/vendor3.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/vendor4.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/vendor1.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/awsdocs-common.js?version=2020.09.30" defer=""></script><script type="text/javascript" src="https://docs.aws.amazon.com/assets/js/awsdocs-doc-app.js?version=2020.09.30" defer=""></script></head>
   <body class="awsdocs awsui">
      <div class="awsdocs-container">
         <awsdocs-header></awsdocs-header>
         <awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)">
            <div id="guide-toc" dom-region="navigation">
               <awsdocs-toc></awsdocs-toc>
            </div>
            <div id="main-column" dom-region="content" tabindex="-1">
               <awsdocs-view class="awsdocs-view">
                  <div id="awsdocs-content">
                     <head>
                        <title>Lambda layers - AWS Lambda</title>
                        <meta name="pdf" content="lambda-dg.pdf#configuration-layers" />
                        <meta name="kindle" content="https://www.amazon.com/dp/B07GFJLN6D" />
                        <meta name="github" content="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/doc_source/configuration-layers.md" />
                        <meta name="rss" content="lambda-updates.rss" />
                        <meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=186" />
                        <meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-layers.html" />
                        <meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-layers.html" />
                        <meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-layers.html" />
                        <meta name="keywords" content="Lambda,AWS Lambda,serverless,serverless applications,cloud computing" />
                     </head>
                     <body>
                        <div id="main">
                           <div style="display: none"><a href="lambda-dg.pdf#configuration-layers" target="_blank" title="Open PDF"></a><a target="_blank" href="https://www.amazon.com/dp/B07GFJLN6D" title="Open Kindle"></a><a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/doc_source/configuration-layers.md" target="_blank" title="Edit this page on GitHub"></a></div>
                           <div id="breadcrumbs" class="breadcrumb"><a href="http://aws.amazon.com/">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/lambda/index.html">AWS Lambda</a><a href="welcome.html">Developer Guide</a></div>
                           <div id="page-toc-src"><a href="#configuration-layers-using">Configure a function to use layers</a><a href="#configuration-layers-create">Create layers</a><a href="#configuration-layers-manage">Manage layers</a><a href="#configuration-layers-path">Include library dependencies in a layer</a><a href="#configuration-layers-permissions">Layer permissions</a><a href="#configuration-layers-cloudformation">AWS CloudFormation and AWS SAM</a><a href="#configuration-layers-samples">Sample applications</a></div>
                           <div id="main-content" class="awsui-util-container">
                              <div id="main-col-body">
                                 <awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner>
                                 <h1 class="topictitle" id="configuration-layers">Lambda layers</h1>
                                 <div class="awsdocs-page-header-container">
                                    <awsdocs-page-header></awsdocs-page-header>
                                    <awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector>
                                 </div>
                                 <p>You can configure your Lambda function to pull in additional code and content in the
                                    form of layers. A
                                    <em>layer</em> is a .zip file archive that contains libraries, a <a href="runtimes-custom.html">custom runtime</a>, or other dependencies. With layers, you can use libraries in your function without
                                    needing
                                    to include them in your deployment package.
                                 </p>
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>Functions defined as container images do not support layers. When you build a container
                                          image, you can package
                                          your preferred runtimes and dependencies as a part of the image.
                                       </p>
                                    </div>
                                 </div>
                                 <p>Layers let you keep your deployment package small, which makes development easier.
                                    You can avoid errors that can
                                    occur when you install and package dependencies with your function code. For Node.js,
                                    Python, and Ruby functions,
                                    you can <a href="code-editor.html">develop your function code in the Lambda console</a> as long as you keep your
                                    deployment package under 3 MB.
                                 </p>
                                 <div class="awsdocs-note">
                                    <div class="awsdocs-note-title">
                                       <awsui-icon name="status-info" variant="link"></awsui-icon><span>Note</span></div>
                                    <div class="awsdocs-note-text">
                                       <p>A function can use up to five layers at a time. The total unzipped size of the function
                                          and all layers
                                          can't exceed the unzipped deployment package size limit of 250 MB. For more information,
                                          see
                                          <a href="gettingstarted-limits.html">Lambda quotas</a>.
                                       </p>
                                    </div>
                                 </div>
                                 <p>You can create layers, or use layers that AWS or an AWS customer has published. Layers
                                    support <a href="#configuration-layers-permissions">resource-based policies</a> for granting layer usage permissions to
                                    specific AWS accounts, <a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_introduction.html">AWS Organizations</a>, or all accounts.
                                 </p>
                                 <p>Layers are extracted to the <code class="code">/opt</code> directory in the function execution environment. Each runtime
                                    looks for libraries in a different location under <code class="code">/opt</code>, depending on the language. <a href="#configuration-layers-path">Structure your layer</a> so that function code can access libraries without
                                    additional configuration.
                                 </p>
                                 <p>You can also use the AWS Serverless Application Model (AWS SAM) to manage layers and
                                    your function's layer configuration. For
                                    instructions, see <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-layers.html">Working with
                                       layers</a> in the <em>AWS Serverless Application Model Developer Guide</em>.
                                 </p>
                                 <div class="highlights" id="inline-topiclist">
                                    <p><strong>Sections</strong></p>
                                    <ul>
                                       <li><a href="#configuration-layers-using">Configure a function to use layers</a></li>
                                       <li><a href="#configuration-layers-create">Create layers</a></li>
                                       <li><a href="#configuration-layers-manage">Manage layers</a></li>
                                       <li><a href="#configuration-layers-path">Include library dependencies in a layer</a></li>
                                       <li><a href="#configuration-layers-permissions">Layer permissions</a></li>
                                       <li><a href="#configuration-layers-cloudformation">AWS CloudFormation and AWS SAM</a></li>
                                       <li><a href="#configuration-layers-samples">Sample applications</a></li>
                                    </ul>
                                 </div>
                                 
                                 <h2 id="configuration-layers-using">Configure a function to use layers</h2>
                                 
                                 
                                 <p>You can specify up to five layers in your Lambda function's configuration, during
                                    or after function
                                    creation. You choose a specific version of a layer to use. If you want to use a different
                                    version later, update
                                    your function's configuration.
                                 </p>
                                 
                                 
                                 <p>To add layers to your function, use the <code class="code">update-function-configuration</code> command. The following
                                    example adds two layers: one from the same account as the function, and one from a
                                    different account.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda update-function-configuration --function-name my-function \
--layers <code class="replaceable">arn:aws:lambda:us-east-2:123456789012:layer:my-layer:3</code> \
<code class="replaceable">arn:aws:lambda:us-east-2:210987654321:layer:their-layer:2</code></code></code></pre>
                                 <p>You should see the following output:</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "FunctionName": "test-layers",
    "FunctionArn": "arn:aws:lambda:us-east-2:123456789012:function:my-function",
    "Runtime": "nodejs12.x",
    "Role": "arn:aws:iam::123456789012:role/service-role/lambda-role",
    "Layers": [
        <span>{</span>
            "Arn": "arn:aws:lambda:us-east-2:123456789012:layer:my-layer:3",
            "CodeSize": 169
        },
        <span>{</span>
            "Arn": "arn:aws:lambda:us-east-2:210987654321:layer:their-layer:2",
            "CodeSize": 169
        }
    ],
    "RevisionId": "81cc64f5-5772-449a-b63e-12330476bcc4",
    ...
}</code></pre>
                                 
                                 <p>You must specify the version of each layer to use by providing the full Amazon Resource
                                    Name (ARN) of the
                                    layer version. When you add layers to a function that already has layers, the new
                                    list overwrites the previous
                                    list. Include all layers every time that you update the layer configuration. To remove
                                    all layers, specify an
                                    empty list.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda update-function-configuration --function-name my-function --layers []</code></code></pre>
                                 
                                 <p>While your function is running, it can access the content of the layer in the <code class="code">/opt</code> directory.
                                    Layers are applied in the order that's specified, merging any folders with the same
                                    name. If the same file appears
                                    in multiple layers, the version in the last applied layer is used.
                                 </p>
                                 
                                 
                                 <p>The creator of a layer can delete the version of the layer that you're using. When
                                    this happens, your function
                                    continues to run as though the layer version still exists. However, when you update
                                    the layer configuration, you
                                    must remove the reference to the deleted version.
                                 </p>
                                  
                                 
                                 <h2 id="configuration-layers-create">Create layers</h2>
                                 
                                 <p>You can create new layers in the Lambda console or using the Lambda API.</p>
                                 
                                 
                                 <div class="procedure">
                                    <p class="title"><b>To create a layer in the console</b></p>
                                    <ol>
                                       <li>
                                          
                                          <p>Open the <a href="https://console.aws.amazon.com/lambda/home#/layers" rel="noopener noreferrer" target="_blank"><span>Layers page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> of the Lambda console.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Create layer</b>.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>For <b>Name</b>, enter a name for your layer.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>(Optional) For <b>Description</b>, enter a description for your layer.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>To upload your layer code, do one of the following:</p>
                                          
                                          <ul>
                                             
                                             <li>
                                                
                                                <p>To upload a .zip file from your computer, choose <b>Upload a .zip file</b>, choose your
                                                   .zip file, and then choose <b>Open</b>.
                                                </p>
                                                
                                             </li>
                                             
                                             <li>
                                                
                                                <p>To upload a file from Amazon Simple Storage Service (Amazon S3), choose <b>Upload a file from Amazon S3</b>. Then, for
                                                   <b>Amazon S3 link URL</b>, enter a link to the file.
                                                </p>
                                                
                                             </li>
                                             
                                          </ul>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>(Optional) For <b>Compatible runtimes</b>, choose up to 15 runtimes.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>(Optional) For <b>License</b>, enter any necessary license information.
                                          </p>
                                          
                                       </li>
                                       <li>
                                          
                                          <p>Choose <b>Create</b>.
                                          </p>
                                          
                                       </li>
                                    </ol>
                                 </div>
                                 
                                 
                                 <p><b>To create a layer using the API</b></p>
                                 
                                 <p>To create a layer, use the <code class="code">publish-layer-version</code> command with a name, description, .zip file
                                    archive, and a list of <a href="lambda-runtimes.html">runtimes</a> that are compatible with the layer. The
                                    list of runtimes is optional, but it makes the layer easier to discover.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda publish-layer-version --layer-name my-layer --description "My layer" --license-info "MIT" \
--content S3Bucket=lambda-layers-us-east-2-123456789012,S3Key=layer.zip --compatible-runtimes python3.6 python3.7</code></code></pre>
                                 <p>You should see the following output:</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Content": <span>{</span>
        "Location": "https://awslambda-us-east-2-layers.s3.us-east-2.amazonaws.com/snapshots/123456789012/my-layer-4aaa2fbb-ff77-4b0a-ad92-5b78a716a96a?versionId=27iWyA73cCAYqyH...",
        "CodeSha256": "tv9jJO+rPbXUUXuRKi7CwHzKtLDkDRJLB3cC3Z/ouXo=",
        "CodeSize": 169
    },
    "LayerArn": "arn:aws:lambda:us-east-2:123456789012:layer:my-layer",
    "LayerVersionArn": "arn:aws:lambda:us-east-2:123456789012:layer:my-layer:1",
    "Description": "My layer",
    "CreatedDate": "2018-11-14T23:03:52.894+0000",
    "Version": 1,
    "LicenseInfo": "MIT",
    "CompatibleRuntimes": [
        "python3.6",
        "python3.7",
        "python3.8"
    ]
}</code></pre>
                                 
                                 <p>Each time that you call <code class="code">publish-layer-version</code>, you create a new version. Functions that use the
                                    layer refer directly to a layer version. You can <a href="#configuration-layers-permissions">configure
                                       permissions</a> on an existing layer version, but to make any other changes, you must create a new
                                    version.
                                 </p>
                                 
                                  
                                 
                                 <h2 id="configuration-layers-manage">Manage layers</h2>
                                 
                                 
                                 <p> To find layers that are compatible with your Lambda function's runtime, use the <code class="code">list-layers</code>
                                    command.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda list-layers --compatible-runtime python3.8</code></code></pre>
                                 <p>You should see the following output:</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Layers": [
        <span>{</span>
            "LayerName": "my-layer",
            "LayerArn": "arn:aws:lambda:us-east-2:123456789012:layer:my-layer",
            "LatestMatchingVersion": <span>{</span>
                "LayerVersionArn": "arn:aws:lambda:us-east-2:123456789012:layer:my-layer:2",
                "Version": 2,
                "Description": "My layer",
                "CreatedDate": "2018-11-15T00:37:46.592+0000",
                "CompatibleRuntimes": [
                    "python3.6",
                    "python3.7",
                    "python3.8",
                ]
            }
        }
    ]
}</code></pre>
                                 <p>To list all layers, you can omit the runtime option. The details in the response reflect
                                    the latest version of
                                    the layer. See all the versions of a layer with <code class="code">list-layer-versions</code>. To see more information about a
                                    version, use <code class="code">get-layer-version</code>.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda get-layer-version --layer-name my-layer --version-number 2</code></code></pre>
                                 <p>You should see the following output:</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Content": <span>{</span>
        "Location": "https://awslambda-us-east-2-layers.s3.us-east-2.amazonaws.com/snapshots/123456789012/my-layer-91e9ea6e-492d-4100-97d5-a4388d442f3f?versionId=GmvPV.309OEpkfN...",
        "CodeSha256": "tv9jJO+rPbXUUXuRKi7CwHzKtLDkDRJLB3cC3Z/ouXo=",
        "CodeSize": 169
    },
    "LayerArn": "arn:aws:lambda:us-east-2:123456789012:layer:my-layer",
    "LayerVersionArn": "arn:aws:lambda:us-east-2:123456789012:layer:my-layer:2",
    "Description": "My layer",
    "CreatedDate": "2018-11-15T00:37:46.592+0000",
    "Version": 2,
    "CompatibleRuntimes": [
        "python3.6",
        "python3.7",
        "python3.8"
    ]
}</code></pre>
                                 <p>The link in the response lets you download the layer archive. The link is valid for
                                    10 minutes.
                                 </p>
                                 
                                 
                                 <p>To delete a layer version, use the <code class="code">delete-layer-version</code> command.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda delete-layer-version --layer-name my-layer --version-number 1</code></code></pre>
                                 <p>When you delete a layer version, you can no longer configure functions to use it.
                                    However, any function that
                                    already uses the version continues to have access to it. Version numbers are never
                                    reused for a layer name.
                                 </p>
                                  
                                 
                                 <h2 id="configuration-layers-path">Include library dependencies in a layer</h2>
                                 
                                 <p>You can move runtime dependencies out of your Lambda function code by placing them
                                    in a layer. Lambda runtimes
                                    include paths in the <code class="code">/opt</code> directory to ensure that your function code has access to libraries that
                                    are included in layers.
                                 </p>
                                 
                                 <p>To include libraries in a layer, place them in one of the folders that your runtime
                                    supports, or modify that
                                    path variable for your language.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><b>Node.js</b> – <code class="code">nodejs/node_modules</code>,
                                             <code class="code">nodejs/node8/node_modules</code> (<code class="code">NODE_PATH</code>)
                                          </p>
                                          
                                          <div class="example">
                                             <p class="title"><b>Example AWS X-Ray SDK for Node.js</b></p>
                                             <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">xray-sdk.zip
└ nodejs/node_modules/aws-xray-sdk</code></pre></div>
                                          </div>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Python</b> – <code class="code">python</code>,
                                             <code class="code">python/lib/python<code class="replaceable">3.8</code>/site-packages</code> (site directories)
                                          </p>
                                          
                                          <div class="example">
                                             <p class="title"><b>Example Pillow</b></p>
                                             <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">pillow.zip
│ python/PIL
└ python/Pillow-5.3.0.dist-info</code></pre></div>
                                          </div>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Ruby</b> – <code class="code">ruby/gems/<code class="replaceable">2.5.0</code></code>
                                             (<code class="code">GEM_PATH</code>), <code class="code">ruby/lib</code> (<code class="code">RUBYLIB</code>)
                                          </p>
                                          
                                          <div class="example">
                                             <p class="title"><b>Example JSON</b></p>
                                             <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">json.zip
└ ruby/gems/2.5.0/
               | build_info
               | cache
               | doc
               | extensions
               | gems
               | └ json-2.1.0
               └ specifications
                 └ json-2.1.0.gemspec</code></pre></div>
                                          </div>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Java</b> – <code class="code">java/lib</code> (classpath)
                                          </p>
                                          
                                          <div class="example">
                                             <p class="title"><b>Example Jackson</b></p>
                                             <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">jackson.zip
└ java/lib/jackson-core-2.2.3.jar</code></pre></div>
                                          </div>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>All</b> – <code class="code">bin</code> (<code class="code">PATH</code>), <code class="code">lib</code>
                                             (<code class="code">LD_LIBRARY_PATH</code>)
                                          </p>
                                          
                                          <div class="example">
                                             <p class="title"><b>Example JQ</b></p>
                                             <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">jq.zip
└ bin/jq</code></pre></div>
                                          </div>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <p>For more information about path settings in the Lambda execution environment, see
                                    <a href="configuration-envvars.html#configuration-envvars-runtime">Runtime environment variables</a>.
                                 </p>
                                  
                                 
                                 <h2 id="configuration-layers-permissions">Layer permissions</h2>
                                 
                                 
                                 <p>Layer usage permissions are managed on the resource. To configure a Lambda function
                                    with a layer, you need
                                    permission to call <code class="code">GetLayerVersion</code> on the layer version. For functions in your account, you can get
                                    this permission from your <a href="access-control-identity-based.html">user policy</a> or from the function's
                                    <a href="access-control-resource-based.html">resource-based policy</a>. To use a layer in another account,
                                    you need permission on your user policy, and the owner of the other account must grant
                                    your account permission
                                    with a resource-based policy.
                                 </p>
                                 
                                 
                                 <p>To grant layer-usage permission to another account, add a statement to the layer version's
                                    permissions policy
                                    with the <code class="code">add-layer-version-permission</code> command. In each statement, you can grant permission to a
                                    single account, all accounts, or an organization.
                                 </p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda add-layer-version-permission --layer-name xray-sdk-nodejs --statement-id xaccount \
--action lambda:GetLayerVersion  --principal 210987654321 --version-number 1 --output text</code></code></pre>
                                 <p>You should see the following output:</p>
                                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">e210ffdc-e901-43b0-824b-5fcd0dd26d16    <span>{</span>"Sid":"xaccount","Effect":"Allow","Principal":<span>{</span>"AWS":"arn:aws:iam::210987654321:root"},"Action":"lambda:GetLayerVersion","Resource":"arn:aws:lambda:us-east-2:123456789012:layer:xray-sdk-nodejs:1"}</code></pre>
                                 
                                 <p>Permissions apply only to a single version of a layer. Repeat the process each time
                                    that you create a new layer
                                    version.
                                 </p>
                                 
                                 
                                 
                                 <p>For more examples, see <a href="access-control-resource-based.html#permissions-resource-xaccountlayer">Granting layer access to other accounts</a>.
                                 </p>
                                  
                                 
                                 <h2 id="configuration-layers-cloudformation">AWS CloudFormation and AWS SAM</h2>
                                 
                                 
                                 <p>To automate the creation and mapping of layers in your application, use AWS SAM in
                                    your AWS CloudFormation templates. The
                                    <code class="code">AWS::Serverless::LayerVersion</code> resource type creates a layer version that you can reference from
                                    your Lambda function configuration.
                                 </p>
                                 
                                 
                                 <div class="example">
                                    <p class="title"><b>Example <a href="https://github.com/awsdocs/aws-lambda-developer-guide/blob/master/sample-apps/blank-nodejs/template.yml" rel="noopener noreferrer" target="_blank"><span>blank-nodejs/template.yml</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> – Serverless
                                          resources</b></p>
                                    <div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">AWSTemplateFormatVersion: '2010-09-09'
Transform: 'AWS::Serverless-2016-10-31'
Description: An AWS Lambda application that calls the Lambda API.
Resources:
  function:
    Type: <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html">AWS::Serverless::Function</a>
    Properties:
      Handler: index.handler
      Runtime: nodejs12.x
      CodeUri: function/.
      Description: Call the AWS Lambda API
      Timeout: 10
      # Function's execution role
      Policies:
        - AWSLambdaBasicExecutionRole
        - AWSLambdaReadOnlyAccess
        - AWSXrayWriteOnlyAccess
      Tracing: Active
      Layers:
        - !Ref libs
  libs:
    Type: <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-layerversion.html">AWS::Serverless::LayerVersion</a>
    Properties:
      LayerName: blank-nodejs-lib
      Description: Dependencies for the blank sample app.
      ContentUri: lib/.
      CompatibleRuntimes:
        - nodejs12.x</code></pre></div>
                                 </div>
                                 
                                 <p>When you update your dependencies and deploy, AWS SAM creates a new version of the
                                    layer and updates the
                                    mapping. If you deploy changes to your code without modifying your dependencies, AWS
                                    SAM skips the layer update,
                                    saving upload time.
                                 </p>
                                  
                                 
                                 <h2 id="configuration-layers-samples">Sample applications</h2>
                                 
                                 
                                 <p>The GitHub repository for this guide provides <a href="lambda-samples.html">sample applications</a> that
                                    demonstrate the use of layers for dependency management.
                                 </p>
                                 
                                 <div class="itemizedlist">
                                     
                                     
                                     
                                     
                                    
                                    <ul class="itemizedlist" type="disc">
                                       <li class="listitem">
                                          
                                          <p><b>Node.js</b> – <a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/blank-nodejs" rel="noopener noreferrer" target="_blank"><span>blank-nodejs</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Python</b> – <a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/blank-python" rel="noopener noreferrer" target="_blank"><span>blank-python</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Ruby</b> – <a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/blank-ruby" rel="noopener noreferrer" target="_blank"><span>blank-ruby</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
                                          
                                       </li>
                                       <li class="listitem">
                                          
                                          <p><b>Java</b> – <a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/blank-java" rel="noopener noreferrer" target="_blank"><span>blank-java</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
                                          
                                       </li>
                                    </ul>
                                 </div>
                                 
                                 <p>For more information about the blank sample app, see <a href="samples-blank.html">Blank function sample application for AWS Lambda</a>.
                                 </p>
                                 
                                 <awsdocs-copyright class="copyright-print"></awsdocs-copyright>
                                 <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback>
                              </div>
                              <noscript>
                                 <div>
                                    <div>
                                       <div>
                                          <div id="js_error_message">
                                             <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your
                                                   browser.</strong></p>
                                             <p>To use the AWS Documentation, Javascript must be
                                                enabled. Please refer to your browser's Help pages for instructions.
                                             </p>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </noscript>
                              <div id="main-col-footer" class="awsui-util-font-size-0">
                                 <div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div>
                                 <div class="prev-next">
                                    <div id="previous" class="prev-link" accesskey="p" href="configuration-aliases.html">Aliases</div>
                                    <div id="next" class="next-link" accesskey="n" href="configuration-memory.html">Memory</div>
                                 </div>
                              </div>
                              <awsdocs-page-utilities></awsdocs-page-utilities>
                           </div>
                           <div id="quick-feedback-yes" style="display: none;">
                              <div class="title">Did this page help you? - Yes</div>
                              <div class="content">
                                 <p>Thanks for letting us know we're doing a good
                                    job!
                                 </p>
                                 <p>If you've got a moment, please tell us what we did right
                                    so we can do more of it.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-layers.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                           <div id="quick-feedback-no" style="display: none;">
                              <div class="title">Did this page help you? - No</div>
                              <div class="content">
                                 <p>Thanks for letting us know this page needs work. We're
                                    sorry we let you down.
                                 </p>
                                 <p>If you've got a moment, please tell us how we can make
                                    the documentation better.
                                 </p>
                                 <p>
                                    <awsui-button id="fblink" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/configuration-layers.html"></awsui-button>
                                 </p>
                              </div>
                           </div>
                        </div>
                     </body>
                  </div>
               </awsdocs-view>
               <div class="page-loading-indicator" id="page-loading-indicator">
                  <awsui-spinner size="large"></awsui-spinner>
               </div>
            </div>
            <div id="tools-panel" dom-region="tools">
               <awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel>
            </div>
         </awsui-app-layout>
         <awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner>
         <!--
                SiteCatalyst code version: H.25.2.
                Copyright 1996-2012 Adobe, Inc. All Rights Reserved
                More info available at http://www.omniture.com
            --><script language="JavaScript" type="text/javascript">
var awsdocs = awsdocs || {};
awsdocs.prop66 = 'AWS Lambda';
awsdocs.prop65 =  'Developer Guide';
            </script><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js" language="JavaScript" type="text/javascript"></script>
         <!--/DO NOT REMOVE/-->
         <!--End SiteCatalyst code version: H.25.2.--></div>
   </body>

<!-- Mirrored from docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 21 Feb 2021 15:00:16 GMT -->
</html>