<!DOCTYPE html><html><head>
      <title>w15_front-end-state-management</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\almyk\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header undefined" id="week-15brfront-end-state-management">WEEK 15<br><em>Front-End State Management</em></h1>

<hr>
<p><a href="#redux-learning-objectives-part-1"><strong>Redux Learning Objectives: Part 1</strong></a></p>
<ul>
<li><a href="#redux-explained"><strong>Redux Explained</strong></a>
<ul>
<li><a href="#where-did-redux-come-from">Where did Redux come from?</a></li>
<li><a href="#when-is-it-appropriate-to-use-redux">When is it appropriate to use Redux?</a></li>
<li><a href="#vocabulary">Vocabulary</a></li>
</ul>
</li>
<li><a href="#flux-and-redux"><strong>Flux and Redux</strong></a>
<ul>
<li><a href="#what-is-flux">What is Flux?</a></li>
<li><a href="#redux">Redux</a></li>
</ul>
</li>
<li><a href="#store-2"><strong>Store</strong></a>
<ul>
<li><a href="#creating-the-store">Creating the store</a></li>
<li><a href="#store-api">Store API</a></li>
<li><a href="#updating-the-store">Updating the store</a></li>
<li><a href="#subscribing-to-the-store">Subscribing to the store</a></li>
<li><a href="#reviewing-a-simple-example">Reviewing a simple example</a></li>
</ul>
</li>
<li><a href="#reducers"><strong>Reducers</strong></a>
<ul>
<li><a href="#updating-the-reducer-to-handle-additional-action-types">Updating the reducer to handle additional action types</a></li>
<li><a href="#avoiding-state-mutations">Avoiding state mutations</a></li>
</ul>
</li>
<li><a href="#actions-2"><strong>Actions</strong></a>
<ul>
<li><a href="#using-action-creators">Using action creators</a></li>
<li><a href="#preventing-typos-in-action-type-string-literals">Preventing typos in action type string literals</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example">Reviewing a completed Fruit Stand example</a></li>
</ul>
</li>
<li><a href="#debugging-arrow-functions"><strong>Debugging Arrow Functions</strong></a>
<ul>
<li><a href="#understanding-the-limitations-of-implicit-return-values">Understanding the limitations of implicit return values</a></li>
<li><a href="#rewriting-an-arrow-function-to-use-an-explicit-return-statement">Rewriting an arrow function to use an explicit return statement</a></li>
</ul>
</li>
<li><a href="#redux-to-do-list-project"><em>Redux To-do List Project</em></a></li>
</ul>
<p><a href="#redux-learning-objectives-part-2"><strong>Redux Learning Objectives: Part 2</strong></a></p>
<ul>
<li><a href="#using-redux-with-react"><strong>Using Redux with React</strong></a>
<ul>
<li><a href="#integrating-redux-into-a-react-application">Integrating Redux into a React application</a></li>
<li><a href="#organizing-your-redux-code">Organizing your Redux code</a></li>
<li><a href="#writing-redux-aware-react-components">Writing Redux aware React components</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example-1">Reviewing a completed Fruit Stand example</a></li>
</ul>
</li>
<li><a href="#splitting-and-combining-reducers"><strong>Splitting and Combining Reducers</strong></a>
<ul>
<li><a href="#splitting-reducers">Splitting reducers</a></li>
<li><a href="#combining-reducers">Combining reducers</a></li>
<li><a href="#delegating-to-reducers">Delegating to reducers</a></li>
<li><a href="#destructuring-state-in-your-component">Destructuring State in your component</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example-2">Reviewing a completed Fruit Stand example</a></li>
</ul>
</li>
<li><a href="#container-components"><strong>Container Components</strong></a>
<ul>
<li><a href="#comparing-presentational-and-container-components">Comparing presentational and container components</a></li>
<li><a href="#determining-where-to-create-containers">Determining where to create containers</a></li>
<li><a href="#writing-a-container-component">Writing a container component</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example-3">Reviewing a completed Fruit Stand example</a></li>
</ul>
</li>
<li><a href="#freezing-objects"><strong>Freezing Objects</strong></a>
<ul>
<li><a href="#using-objectfreeze-to-prevent-state-mutations">Using <code>Object.freeze</code> to prevent state mutations</a></li>
</ul>
</li>
<li><a href="#preloaded-state"><strong>Preloaded State</strong></a>
<ul>
<li><a href="#creating-a-store-with-preloaded-state">Creating a store with preloaded state</a></li>
<li><a href="#creating-local-storage-helper-functions">Creating local storage helper functions</a></li>
<li><a href="#saving-state-to-local-storage">Saving state to local storage</a></li>
<li><a href="#loading-state-from-local-storage">Loading state from local storage</a></li>
</ul>
</li>
<li><a href="#react-and-redux-to-do-list-project"><em>React and Redux To-Do List Project</em></a></li>
</ul>
<p><a href="#redux-learning-objectives-part-3"><strong>Redux Learning Objectives: Part 3</strong></a></p>
<ul>
<li><a href="#higher-order-components"><strong>Higher-Order Components</strong></a>
<ul>
<li><a href="#reviewing-higher-order-functions">Reviewing higher-order functions</a></li>
<li><a href="#leveraging-higher-order-components-hocs">Leveraging higher-order components (HOCs)</a></li>
<li><a href="#using-hocs-to-keep-code-dry">Using HOCs to keep code DRY</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example-4">Reviewing a completed Fruit Stand example</a></li>
</ul>
</li>
<li><a href="#react-redux-provider"><strong>React-Redux: <code>&lt;Provider/&gt;</code></strong></a>
<ul>
<li><a href="#understanding-the-advantages-of-the-provider-component">Understanding the advantages of the <code>&lt;Provider /&gt;</code> component</a></li>
<li><a href="#adding-provider">Adding <code>&lt;Provider /&gt;</code></a></li>
<li><a href="#understanding-how-provider-relates-to-the-react-context-api">Understanding how <code>&lt;Provider /&gt;</code> relates to the React Context API</a></li>
</ul>
</li>
<li><a href="#react-redux-connect-1"><strong>React-Redux: <code>connect()</code></strong></a>
<ul>
<li><a href="#calling-connect">Calling <code>connect</code></a></li>
<li><a href="#defining-mapstatetopropsstate-ownprops">Defining <code>mapStateToProps(state, [ownProps])</code></a></li>
<li><a href="#defining-mapdispatchtoprops">Defining <code>mapDispatchToProps</code></a></li>
<li><a href="#putting-it-all-together">Putting it all together</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example-5">Reviewing a completed Fruit Stand example</a></li>
</ul>
</li>
<li><a href="#selectors"><strong>Selectors</strong></a>
<ul>
<li><a href="#writing-a-selector">Writing a selector</a></li>
<li><a href="#selector-examples">Selector examples</a></li>
</ul>
</li>
<li><a href="#middleware-1"><strong>Middleware</strong></a>
<ul>
<li><a href="#applying-middleware-to-a-redux-store">Applying middleware to a Redux store</a></li>
<li><a href="#reviewing-the-signature-of-middleware-functions">Reviewing the signature of middleware functions</a></li>
<li><a href="#creating-your-own-logger-middleware">Creating your own <code>logger</code> middleware</a></li>
<li><a href="#installing-and-applying-the-redux-logger-middleware">Installing and applying the <code>redux-logger</code> middleware</a></li>
</ul>
</li>
<li><a href="#thunks-1"><strong>Thunks</strong></a>
<ul>
<li><a href="#looking-at-how-thunks-work">Looking at how thunks work</a></li>
<li><a href="#reviewing-a-concrete-example">Reviewing a concrete example</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example-6">Reviewing a completed Fruit Stand example</a></li>
</ul>
</li>
<li><a href="#advanced-containers"><strong>Advanced Containers</strong></a>
<ul>
<li><a href="#knowing-when-to-break-the-rules">Knowing when to break the rules</a></li>
</ul>
</li>
<li><a href="#redux-developer-tools"><strong>Redux Developer Tools</strong></a>
<ul>
<li><a href="#instructions">Instructions</a></li>
<li><a href="#use">Use</a></li>
<li><a href="#resources">Resources</a></li>
</ul>
</li>
<li><a href="#redux-based-pokedex-project"><em>Redux-Based Pokedex Project</em></a></li>
<li><a href="#giphy-search-project"><em>Giphy Search Project</em></a></li>
</ul>
<p><a href="#hooks-objectives"><strong>Hooks Objectives</strong></a></p>
<ul>
<li><a href="#intro-to-react-hooks"><strong>Intro to React Hooks</strong></a>
<ul>
<li><a href="#usestate">useState</a></li>
<li><a href="#useeffect">useEffect</a></li>
<li><a href="#usecontext">useContext</a></li>
</ul>
</li>
<li><a href="#introduction-to-hooks-in-redux"><strong>Introduction to Hooks in Redux</strong></a>
<ul>
<li><a href="#using-hooks-with-redux">Using hooks with Redux</a></li>
<li><a href="#getting-started-1">Getting Started</a></li>
<li><a href="#useselector"><code>useSelector</code></a></li>
<li><a href="#usedispatch"><code>useDispatch</code></a></li>
<li><a href="#refactoring-an-existing-component">Refactoring an existing component</a></li>
<li><a href="#additional-resources">Additional resources</a></li>
<li><a href="#starting-point-for-ip-address-project">Starting point for IP address project</a></li>
</ul>
</li>
<li><a href="#react-router-hooks"><strong>React Router Hooks</strong></a>
<ul>
<li><a href="#useparams"><code>useParams</code></a></li>
<li><a href="#usehistory"><code>useHistory</code></a></li>
<li><a href="#uselocation"><code>useLocation</code></a></li>
<li><a href="#useroutematch"><code>useRouteMatch</code></a></li>
<li><a href="#bring-it-together">Bring it together</a></li>
</ul>
</li>
<li><a href="#react-hooks-documentation"><strong>React Hooks Documentation</strong></a>
<ul>
<li><a href="#why-hooks">Why hooks?</a></li>
<li><a href="#hook-basics">Hook basics</a></li>
<li><a href="#more-about-hooks">More about hooks</a></li>
</ul>
</li>
<li><a href="#pokedex-hooks-project-phase-1"><em>Pokedex Hooks Project: Phase 1</em></a></li>
<li><a href="#pokedex-hooks-project-phase-2"><em>Pokedex Hooks Project: Phase 2</em></a></li>
<li><a href="#pokedex-hooks-project-phase-3"><em>Pokedex Hooks Project: Phase 3</em></a></li>
</ul>
<p><a href="#websockets-learning-objectives"><strong>WebSockets Learning Objectives</strong></a></p>
<ul>
<li><a href="#websockets-overview"><strong>WebSockets Overview</strong></a>
<ul>
<li><a href="#key-points-about-web-sockets">Key points about Web sockets</a></li>
<li><a href="#client-side-code">Client-side code</a></li>
<li><a href="#server-side-code">Server-side code</a></li>
</ul>
</li>
<li><a href="#websocket-server-applications"><strong>WebSocket Server Applications</strong></a></li>
<li><a href="#websocket-client-applications"><strong>WebSocket Client Applications</strong></a></li>
<li><a href="#tic-tac-toe-online-project"><em>Tic-Tac-Toe Online Project</em></a></li>
</ul>
<p><a href="#react-solo-project-expectations"><strong>React Solo Project Expectations</strong></a></p>
<ul>
<li><a href="#react-project"><em>React Project</em></a>
<ul>
<li><a href="#homework">Homework</a></li>
<li><a href="#planning-day">Planning Day</a></li>
<li><a href="#project-ideas">Project ideas</a></li>
</ul>
</li>
</ul>
<hr>
<hr>
<h1 class="mume-header undefined" id="week-15-day-1brredux">WEEK-15 DAY-1<br><em>Redux</em></h1>

<hr>
<h1 class="mume-header" id="redux-learning-objectives-part-1">Redux Learning Objectives: Part 1</h1>

<p>You&apos;ve been using React&apos;s Context API to manage global state to share the same<br>
information across multiple components. Redux, like Context, gives you a way to<br>
store and manage global state in your React applications. Even though Context<br>
has become a popular option since its introduction, Redux remains a popular<br>
option for projects with sophisticated global state requirements.</p>
<p>After reading and practicing how to use Redux, you should be able to:</p>
<ul>
<li>Describe the Redux data cycle</li>
<li>Describe the role of the store in the Redux architecture</li>
<li>Explain what a <em>reducer</em> is</li>
<li>Use the <code>createStore</code> method to create an instance of a Redux store</li>
<li>Use the <code>store.dispatch</code> method to dispatch an action to trigger a state<br>
update</li>
<li>Use the <code>store.subscribe</code> method to listen for state updates</li>
<li>Use the <code>store.getState</code> method to get the current state</li>
<li>Use a <code>switch</code> statement within a reducer function to handle multiple action<br>
types</li>
<li>Describe why it&apos;s important for a reducer to avoid mutating the current state<br>
when creating the next state</li>
<li>Write an action creator function to facilitate in the creation of action<br>
objects</li>
<li>Use constants to define action types to prevent simple typos in action type<br>
string literals</li>
</ul>
<hr>
<h1 class="mume-header" id="redux-explained">Redux Explained</h1>

<p>Redux is a JavaScript framework for managing the frontend state of a web<br>
application. It allows us to store information in an organized manner in a web<br>
app and to quickly retrieve that information from anywhere in the app. Redux is<br>
modeled on a few previous web technologies including <a href="http://elm-lang.org/docs">Elm</a> and<br>
<a href="https://facebook.github.io/flux/docs/overview.html#content">Flux</a>.</p>
<p>Advantages of Redux include:</p>
<ul>
<li>It simplifies some of the more cumbersome aspects of Flux</li>
<li>It is very lightweight; the library only takes up 2 kbs</li>
<li>It is very fast (the time to insert or retrieve data is low)</li>
<li>It is predictable (interacting with the data store in the same way repeatedly<br>
will produce the same effect)</li>
</ul>
<h2 class="mume-header" id="where-did-redux-come-from">Where did Redux come from?</h2>

<p>Redux was created by Dan Abramov in 2015. It was initially intended as an<br>
experiment to create a simplified version of Flux. Abramov wanted to remove some<br>
of what he saw as the unnecessary boilerplate code that was required to create a<br>
Flux app.</p>
<p>Abramov also wanted to eliminate some of the aspects of development he found<br>
frustrating. When trying to debug a web app, one must often go through the<br>
series of steps that cause the bug to occur each time the code is changed. This<br>
quickly becomes repetitive and frustrating. Abramov envisioned dev tools that<br>
would allow one to undo or replay a series of actions at the click of a button.<br>
This idea became the Redux DevTools.</p>
<p>The reason this works is that Redux updates the state using pure functions<br>
called reducers (see below for definitions), so one can simply replay a series<br>
of actions and be guaranteed to arrive at the same final state. As Redux was<br>
developed it also became more convenient to use a single object to store the<br>
state, as opposed to traditional Flux which uses multiple stores.</p>
<p>These design choices allowed for the creation of an ecosystem of powerful Redux<br>
tools and extensions. Over time three principles were recognized as central to<br>
the philosophy of Redux. They are:</p>
<ul>
<li>
<p><strong>A Single Source of Truth</strong> The state for an entire Redux app is stored in a<br>
single, plain JavaScript object.</p>
</li>
<li>
<p><strong>State is Read Only</strong> The state object cannot be directly modified. Instead<br>
it is modified by dispatching actions.</p>
</li>
<li>
<p><strong>Changes Are Made with Pure Functions</strong> The reducers that receive the actions<br>
and return updated state are pure functions of the old state and the action.</p>
</li>
</ul>
<p>Beyond this, a guiding meta-philosophy of Redux is the idea that in a software<br>
library restrictions can be just as important as features. Redux deliberately<br>
places significant restrictions on the way state can be stored and updated, but<br>
in return it allows easy implementation of a number of powerful features that<br>
would be extremely difficult to write using a less restrictive framework.</p>
<h2 class="mume-header" id="when-is-it-appropriate-to-use-redux">When is it appropriate to use Redux?</h2>

<p>Initially, Redux grew in popularity, quickly moving beyond its initial plan as<br>
an experiment. As of early 2016 it had over 3,000,000 downloads. The Redux<br>
repository on GitHub has over 50,000 stars, and Redux is now used by a number of<br>
companies including Exana, Patreon, and ClassPass.</p>
<p>Since the introduction of Redux, Context has been added to React. Context, like<br>
Redux, gives you a way to store and manage global state in your React<br>
applications. For projects with simpler global state requirements, Context has<br>
become a popular alternative to using Redux.</p>
<p>Context is built into React so there&apos;s no need to install an additional library<br>
as a dependency. Context is also simpler overall and generally requires less<br>
work to get up and running. All that being said, for projects with more<br>
sophisticated global state requirements, Redux remains a popular option. Redux<br>
offers greater flexibility with support for middleware and richer developer<br>
tools in the form of the Redux DevTools.</p>
<h2 class="mume-header" id="vocabulary">Vocabulary</h2>

<p>Learning how to use Redux requires you to understand a fair amount of<br>
terminology. For now, don&apos;t worry about memorizing all of the following terms;<br>
it&apos;s good enough to just have a general awareness. You&apos;ll revisit each of these<br>
terms as you work your way through this lesson.</p>
<h3 class="mume-header" id="state">State</h3>

<p>Ex: &quot;<em>Redux is a state manager.</em>&quot;</p>
<p>The <em>state</em> of a program means all the information stored by that program at a<br>
particular point in time. It is generally used to refer to the data stored by<br>
the program at a particular instance in time, as opposed to the logic of the<br>
program, which doesn&apos;t change over time. The job of Redux is to store the state<br>
of your app and make it available to entire app.</p>
<h3 class="mume-header" id="store">Store</h3>

<p>Ex: &quot;<em>Redux stores state in a single store.</em>&quot;</p>
<p>The Redux store is a single JavaScript object with a few methods, including<br>
<code>getState</code>, <code>dispatch(action)</code>, and <code>subscribe(listener)</code>. Any state you want<br>
Redux to handle is held in the store.</p>
<h3 class="mume-header" id="actions">Actions</h3>

<p>Ex: &quot;<em>The Redux store is updated by dispatching actions.</em>&quot;</p>
<p>An action is a POJO (plain old JavaScript object) with a <code>type</code> property.<br>
Actions contain information that can be used to update the store. They can be<br>
<em>dispatched</em>, i.e. sent to the store, in response to user actions or AJAX<br>
requests. Typically Redux apps use functions called <em>action creators</em> that<br>
return actions. Action creators can take arguments which allow them to customize<br>
the data contained in the actions they generate.</p>
<h3 class="mume-header" id="pure-functions">Pure functions</h3>

<p>Ex: &quot;<em>Redux reducers are pure functions.</em>&quot;</p>
<p>A function is pure if its behavior depends only its arguments and it has no side<br>
effects. This means the function can&apos;t depend on the value of any variables that<br>
aren&apos;t passed to it as arguments, and it can&apos;t alter the state of the program or<br>
any variable existing outside itself. It simply takes in arguments and returns a<br>
value.</p>
<h3 class="mume-header" id="reducer">Reducer</h3>

<p>Ex: &quot;<em>Redux handles actions using reducers.</em>&quot;</p>
<p>A reducer is a function that is called each time an action is dispatched. The<br>
reducer receives an action and the current state as arguments and returns an<br>
updated state.</p>
<p>Redux reducers are required to be pure functions of the dispatched action and<br>
the current state. This makes their behavior very predictable and allows their<br>
effects to potentially be reversed.</p>
<h3 class="mume-header" id="middleware">Middleware</h3>

<p>Ex: &quot;<em>You can customize your response to dispatched actions using middleware.</em>&quot;</p>
<p>Middleware is an optional component of Redux that allows custom responses to<br>
dispatched actions. When an action is dispatched, it passes through each<br>
middleware that has been added to the state. The middleware can take some action<br>
in response and chose whether or not to pass the action on down the chain.<br>
Behind the scenes, the middleware actually replaces the dispatch method of the<br>
store with a customized version. There is a large ecosystem of existing<br>
middleware ready to be plugged into any Redux projects. One example is a logger<br>
that records each action before passing it on to the reducer. Perhaps the most<br>
common use for middleware is to dispatch asynchronous requests to a server.</p>
<h3 class="mume-header" id="time-traveling-dev-tools">Time traveling dev tools</h3>

<p>Ex: &quot;<em>Redux has time traveling dev tools.</em>&quot;</p>
<p>Redux reducers are pure functions of the dispatched action and the current<br>
state. This means that if one were to store a list of the previous states over<br>
time and the actions that had been dispatched, one could retroactively cancel an<br>
action and recalculate the state as if that action had never been dispatched.<br>
This is precisely the functionality that the Redux DevTools provide. The dev<br>
tools can be added as middleware to any Redux project. They allow you to look<br>
back through the history of the state and toggle past actions on and off to see<br>
a live recalculation of the state. This ability to revert to a previous state is<br>
what is meant by time travel.</p>
<h3 class="mume-header" id="thunks">Thunks</h3>

<p>Ex: &quot;<em>Thunks are a convenient format for taking asynchronous actions in Redux.</em>&quot;</p>
<p>The traditional approach to middleware closely parallels the format of reducers.<br>
The actions being dispatched are POJOs with types and various middleware files<br>
are waiting to receive them. These files check the type of the action using a<br>
case statement just like reducers.</p>
<p>Thunks are an alternative approach. A thunk is a general concept in computer<br>
science referring to a function whose primary purpose is simply to call another<br>
function. In Redux a thunk action creator returns a function rather than an<br>
object. When they are dispatched, thunk actions are intercepted by a piece of<br>
middleware that simply checks if each action is a function. If it is, that<br>
function is called with the state and dispatch as arguments, otherwise it is<br>
passed on down the chain. Thunks are most commonly used to make asynchronous API<br>
requests.</p>
<h2 class="mume-header" id="what-you-learned">What you learned</h2>

<p>In this article, you learned what Redux is and where it came from. You also<br>
learned when it&apos;s appropriate to use Redux and some of the vocabulary terms used<br>
by Redux.</p>
<h2 class="mume-header" id="see-also">See also...</h2>

<p>The <a href="http://redux.js.org/">official Redux documentation</a> is a great resource for learning<br>
more about Redux. To see who&apos;s using Redux, see this page on<br>
<a href="https://stackshare.io/reduxjs">StackShare</a>.</p>
<hr>
<h1 class="mume-header" id="flux-and-redux">Flux and Redux</h1>

<p>Redux is an evolution of the concepts introduced by Flux. Having a general<br>
understanding of Flux will assist you in learning Redux.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Describe the relationship between Redux and Flux</li>
<li>Describe the three principles that Redux abides by</li>
<li>Describe the Redux data cycle</li>
</ul>
<h2 class="mume-header" id="what-is-flux">What is Flux?</h2>

<p>Flux is a front-end application architecture Facebook developed to use with<br>
React. Flux is not a library or framework. Flux is simply a pattern in which to<br>
structure one&#x2019;s application. It doesn&#x2019;t even need to be used with React! Flux<br>
provides unidirectional data flow, which affords more predictability than one<br>
might encounter when using other application design patterns.</p>
<p><img src="https://facebook.github.io/flux/docs/overview.html#content" alt="flux"></p>
<h3 class="mume-header" id="actions-1">Actions</h3>

<p>An action begins the flow of data in Flux. An action is a simple object that at<br>
a minimum contains a <code>type</code>. An action&#x2019;s <code>type</code> indicates the type of change to<br>
be performed on the application&#x2019;s state. An action may contain additional data<br>
(the &quot;payload&quot;) that&#x2019;s necessary for changing the application&#x2019;s former state to<br>
its next one.</p>
<h3 class="mume-header" id="dispatcher">Dispatcher</h3>

<p>The dispatcher is a mechanism for distributing (or &quot;dispatching&quot;) actions to a<br>
Flux application&#x2019;s store. The dispatcher is little more than a registry of<br>
callback functions into the store. Redux (the implementation of Flux we&#x2019;ll use<br>
at App Academy) consolidates the dispatcher into a single <code>dispatch()</code> function.</p>
<h3 class="mume-header" id="store-1">Store</h3>

<p>The store represents the entire state of the application. It&#x2019;s also responsible<br>
for updating the state of the application appropriately whenever it receives an<br>
action. It does so by registering with the dispatcher a callback function that<br>
receives an action. This callback function uses the action&#x2019;s type to invoke the<br>
proper function to change the application&#x2019;s state. After the store has changed<br>
state, it &#x201C;emits a change,&#x201D; i.e. the store passes the new state to any views<br>
(explanation incoming) that have registered listeners (callbacks) to it.</p>
<h3 class="mume-header" id="view">View</h3>

<p>A view is a unit of code that&#x2019;s responsible for rendering the user interface. To<br>
complete the Flux pattern, a view listens to change events emitted by the store.<br>
When a change to the application&#x2019;s data layer occurs, a view can respond<br>
appropriately, such as by updating its internal state and triggering a<br>
re-render.</p>
<p>A view can create actions itself, e.g. in user-triggered events. If a user marks<br>
a todo as complete, a view might call a function that would dispatch an action<br>
to toggle the todo&#x2019;s state. Creating an action from the view turns our Flux<br>
pattern into a unidirectional loop.</p>
<p><img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/fullstack/react/assets/flux-loop.png" alt="flux-loop"></p>
<p>Here the original action might (for example) result from an asynchronous request<br>
to fetch todos from the database with a success callback to dispatch our action<br>
to receive those todos and update the application&#x2019;s state accordingly. It&apos;s a<br>
common pattern in Flux to dispatch an action that populates the initial state of<br>
the application, with further modifications coming from the client.</p>
<h2 class="mume-header" id="redux">Redux</h2>

<p>Redux is a library (distributed as an npm package) that facilitates a particular<br>
implementation of Flux. A Redux loop behaves slightly differently than a vanilla<br>
Flux loop, but the general concepts remain the same. Redux abides by three<br>
principles:</p>
<ol>
<li><strong>Single Source of Truth</strong>: The entire state of the application is stored in<br>
a single JavaScript object in a single store. This object is commonly<br>
referred to as a &#x201C;state tree&#x201D; because its values often contain or are objects<br>
themselves.</li>
<li><strong>State is Read-Only</strong>: The only way to change the state is to dispatch an<br>
action. This principle ensures that our Redux loop is never short-circuited<br>
and change of state remains single-threaded.</li>
<li><strong>Only Pure Functions Change State</strong>: Pure functions known as &#x201C;reducers&#x201D;<br>
receive the previous state and an action and return the next state. They<br>
return new state objects instead of mutating previous state. Read<br>
<a href="https://medium.com/javascript-scene/master-the-javascript-interview-what-is-a-pure-function-d1c076bec976#.lfv7bgqco">more</a> about what makes a function pure.</li>
</ol>
<p><img src="https://assets.aaonline.io/fullstack/react/assets/redux.gif" alt="redux-loop"></p>
<p>As you&apos;ve probably already surmised, <code>React</code> will be our view layer.</p>
<blockquote>
<p><strong>Note:</strong> Middleware is an ecosystem of utilities that augments the<br>
functionality of <code>dispatch()</code>. Among other things, it allows for asynchronous<br>
requests in a Redux application.</p>
</blockquote>
<p>You&apos;ll learn more about each part in the Redux loop in this lesson.</p>
<h2 class="mume-header" id="what-you-learned-1">What you learned</h2>

<p>In this article, you learned about the relationship between Redux and Flux. You<br>
also learned about the three principles that Redux abides by and the Redux data<br>
cycle.</p>
<hr>
<h1 class="mume-header" id="store-2">Store</h1>

<p>The <strong>store</strong> is the central element of Redux&apos;s architecture. It holds the<br>
global <strong>state</strong> of an application. The store is responsible for updating the<br>
global state via its <strong>reducer</strong>, broadcasting state updates via<br>
<strong>subscription</strong>, and listening for <strong>actions</strong> that tell it when to update the<br>
state.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Describe the role of the store in the Redux architecture</li>
<li>Use the <code>createStore</code> method to create an instance of the Redux store</li>
<li>Use the <code>store.dispatch</code> method to dispatch an action to trigger a state<br>
update</li>
<li>Use the <code>store.subscribe</code> method to listen for state updates</li>
<li>Use the <code>store.getState</code> method to get the current state</li>
</ul>
<h2 class="mume-header" id="creating-the-store">Creating the store</h2>

<p>The <code>redux</code> library provides us with a <code>createStore()</code> method, which takes up to<br>
three arguments and returns a Redux store.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token punctuation">[</span>preloadedState<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>enhancer<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><ul>
<li><code>reducer</code> (required) - A reducing function that receives the store&apos;s current<br>
state and incoming action, determines how to update the store&apos;s state, and<br>
returns the next state (more on this in a moment).</li>
<li><code>preloadedState</code> (optional) - An <code>object</code> representing any application state<br>
that existed before the store was created.</li>
<li><code>enhancer</code> (optional) - A <code>function</code> that adds extra functionality to the<br>
store.</li>
</ul>
<blockquote>
<p>You&apos;ll learn more about how to use the <code>preloadedState</code> and <code>enhancer</code><br>
parameters later in this lesson. For now you&apos;ll focus on creating a store with<br>
just the single required <code>reducer</code> parameter.</p>
</blockquote>
<p>Here is an example of how to create a store for a Fruit Stand application:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO implement reducer</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>fruitReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>A Redux application will typically only have a single store. You&apos;ll implement<br>
the <code>reducer</code> function in just a bit.</p>
<h2 class="mume-header" id="store-api">Store API</h2>

<p>A Redux store is just an object that holds the application state, wrapped in a<br>
minimalist API. The store has three methods: <code>getState()</code>, <code>dispatch(action)</code>,<br>
and <code>subscribe(callback)</code>.</p>
<h3 class="mume-header" id="store-methods">Store methods</h3>

<ul>
<li><code>getState()</code> - Returns the store&apos;s current state.</li>
<li><code>dispatch(action)</code> - Passes an <code>action</code> into the store&apos;s <code>reducer</code> telling it<br>
what information to update.</li>
<li><code>subscribe(callback)</code> - Registers a callback to be triggered whenever the<br>
store updates. Returns a function, which when invoked, unsubscribes the<br>
callback function from the store.</li>
</ul>
<h2 class="mume-header" id="updating-the-store">Updating the store</h2>

<p>Store updates can only be triggered by dispatching <strong>actions</strong>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>An <code>action</code> in Redux is just a plain object with:</p>
<ul>
<li>a <code>type</code> key indicating the action being performed, and</li>
<li>optional payload keys containing any new information.</li>
</ul>
<p>For example, the store for your Fruit Stand application would handle the<br>
inventory. You would use the following <code>addOrange</code> action to add an orange to<br>
the store&apos;s state. Notice how it has a <code>type</code> of &apos;ADD_FRUIT&apos; and a <code>fruit</code><br>
payload of &apos;orange&apos;:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> addOrange <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">:</span> <span class="token string">&apos;orange&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>When <code>store.dispatch()</code> is called, the store passes its current <code>state</code>, along<br>
with the <code>action</code> being dispatched, to the <code>reducer</code>. The <code>reducer</code> function<br>
takes the two arguments (<code>state</code> and <code>action</code>) and returns the next <code>state</code>.<br>
You&apos;ll read more about the <code>reducer</code> in just a bit, but for now, think of it as<br>
a Redux app&apos;s traffic cop, routing new information to its rightful place in the<br>
state.</p>
<p>A <code>reducer</code> for the Fruit Stand application looks like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> action<span class="token punctuation">.</span>fruit<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>The reducer&apos;s <code>state</code> parameter provides a default value; this is the <strong>initial<br>
state</strong> of our store prior to any actions. In this case, it&apos;s an empty array. In<br>
Redux, <a href="https://github.com/reactjs/redux/issues/758"><strong>the state is immutable</strong></a>, so the reducer must return a<br>
<strong>new array or object</strong> whenever the state changes.</p>
<p>Now that you&apos;ve defined your app&apos;s reducing function, you can now <code>dispatch</code> the<br>
<code>addOrange</code> action to the store:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// []</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>addOrange<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ &apos;orange&apos; ]</span>
</pre><h2 class="mume-header" id="subscribing-to-the-store">Subscribing to the store</h2>

<p>Once the store has processed a <code>dispatch()</code>, it triggers all its subscribers.<br>
Subscribers are callbacks that can be added to the store via <code>subscribe()</code>.</p>
<p>You can define a callback <code>display</code> and subscribe it to the store:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">display</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> unsubscribeDisplay <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>display<span class="token punctuation">)</span><span class="token punctuation">;</span>

store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>addOrange<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ &apos;orange&apos;, &apos;orange&apos; ]</span>

<span class="token comment">// display will no longer be invoked after store.dispatch()</span>
<span class="token function">unsubscribeDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>addOrange<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no output</span>
</pre><p>In the example above, the store processed the dispatched action and then called<br>
all of its subscribers in response. The only subscriber is your <code>display</code><br>
callback which logs the current state when called.</p>
<blockquote>
<p>Later in this lesson, you&apos;ll learn how to use the <code>store.subscribe()</code> method<br>
to connect a React component to the store so that it can listen for global<br>
state updates.</p>
</blockquote>
<h2 class="mume-header" id="reviewing-a-simple-example">Reviewing a simple example</h2>

<p>Later in this lesson, you&apos;ll see how to use Redux with React and how to organize<br>
your Redux code into separate modules, but for now to keep things as simple as<br>
possible, you&apos;ll put everything into a single file and use Node.js to run your<br>
application.</p>
<p>Here&apos;s an <code>app.js</code> file that brings together all of the above code snippets into<br>
a single example:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// app.js</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;redux&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Define the store&apos;s reducer.</span>
<span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> action<span class="token punctuation">.</span>fruit<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Create the store.</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>fruitReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Define an &apos;ADD_FRUIT&apos; action for adding an orange to the store.</span>
<span class="token keyword">const</span> addOrange <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">:</span> <span class="token string">&apos;orange&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Log to the console the store&apos;s state before and after</span>
<span class="token comment">// dispatching the &apos;ADD_FRUIT&apos; action.</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// []</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>addOrange<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ &apos;orange&apos; ]</span>

<span class="token comment">// Define and register a callback to listen for store updates</span>
<span class="token comment">// and console log the store&apos;s state.</span>
<span class="token keyword">const</span> <span class="token function-variable function">display</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> unsubscribeDisplay <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>display<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Dispatch the &apos;ADD_FRUIT&apos; action. This time the `display` callback</span>
<span class="token comment">// will be called by the store when its state is updated.</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>addOrange<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ &apos;orange&apos;, &apos;orange&apos; ]</span>

<span class="token comment">// Unsubscribe the `display` callback to stop listening for store updates.</span>
<span class="token function">unsubscribeDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Dispatch the &apos;ADD_FRUIT&apos; action one more time</span>
<span class="token comment">// to confirm that the `display` method won&apos;t be called</span>
<span class="token comment">// when the store state is updated.</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>addOrange<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no output</span>
</pre><p>To run the above example, use npm to initialize the project (<code>npm init -y</code>) and<br>
to install Redux (<code>npm install redux</code>). Then use the command <code>node app.js</code> to<br>
run the example. You should see the following output:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span> <span class="token string">&apos;orange&apos;</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span> <span class="token string">&apos;orange&apos;</span>, <span class="token string">&apos;orange&apos;</span> <span class="token punctuation">]</span>
</pre><h2 class="mume-header" id="what-you-learned-2">What you learned</h2>

<p>In this article, you learned about the role of the store in the Redux<br>
architecture. You saw how to use the <code>createStore</code> method to create a store<br>
instance, the <code>store.dispatch</code> method to dispatch an action to trigger a state<br>
update, the <code>store.subscribe</code> method to listen for state updates, and<br>
<code>store.getState</code> method to get the current state.</p>
<h2 class="mume-header" id="see-also-1">See also...</h2>

<p>To learn more about the store, see the official <a href="http://redux.js.org/docs/basics/Store.html">Redux<br>
documentation</a>.</p>
<hr>
<h1 class="mume-header" id="reducers">Reducers</h1>

<p>As you saw in an earlier article, the Redux store has a <strong>reducer</strong> function for<br>
updating its state. The reducer function receives the current <code>state</code> and an<br>
<code>action</code>, updates the state appropriately based on the <code>action.type</code>, and<br>
returns the next state.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Explain what a <em>reducer</em> is</li>
<li>Use a <code>switch</code> statement within a reducer function to handle multiple action<br>
types</li>
<li>Describe why it&apos;s important for a reducer to avoid mutating the current state<br>
when creating the next state</li>
</ul>
<h2 class="mume-header" id="updating-the-reducer-to-handle-additional-action-types">Updating the reducer to handle additional action types</h2>

<p>Recall the reducer from the Fruit Stand application:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> action<span class="token punctuation">.</span>fruit<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>When the store initializes, it calls its reducer with an <code>undefined</code> <code>state</code>,<br>
allowing the reducer to dictate the store&apos;s initial state via the <code>state</code><br>
parameter&apos;s default value.</p>
<p>The bulk of the reducer function then implements updates to the state. First,<br>
the reducer decides what logic to implement based on the <code>action.type</code> <code>switch</code>.<br>
Then, it creates and returns a new object representing the next state (after<br>
processing the action) if any of the information needs to be changed. The<br>
<code>state</code> is returned unchanged if no cases match the <code>action.type</code>, meaning that<br>
the reducer doesn&apos;t <em>care</em> about that action (e.g. <code>{type: &apos;NEW_TRANSFORMERS_SEQUEL&apos;}</code>).</p>
<p>In the above example, the reducer&apos;s initial state is set to an empty array (i.e.<br>
<code>[]</code>). The reducer returns a new array with <code>action.fruit</code> appended to the<br>
previous <code>state</code> if <code>action.type</code> is <code>&apos;ADD_FRUIT&apos;</code>. Otherwise, it returns the<br>
<code>state</code> unchanged.</p>
<p>Additional <code>case</code> clauses can be added to update the reducer to handle the<br>
following action types:</p>
<ul>
<li><code>&apos;ADD_FRUITS&apos;</code> - Add an array of fruits to the inventory of fruits</li>
<li><code>&apos;SELL_FRUIT&apos;</code> - Remove the first instance of a fruit if available</li>
<li><code>&apos;SELL_OUT&apos;</code> - Someone bought the whole inventory of fruit! Return an empty<br>
array</li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> action<span class="token punctuation">.</span>fruit<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&apos;ADD_FRUITS&apos;</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>action<span class="token punctuation">.</span>fruits<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&apos;SELL_FRUIT&apos;</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> index <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// remove first instance of action.fruit</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span> <span class="token comment">// if action.fruit is not in state, return previous state</span>
    <span class="token keyword">case</span> <span class="token string">&apos;SELL_OUT&apos;</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="reviewing-how-arrayslice-works">Reviewing how <code>Array#slice</code> works</h3>

<p>If you don&apos;t regularly use the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice"><code>Array#slice</code></a> method, the following expression<br>
might look odd at first glance:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</pre><p>The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice"><code>Array#slice</code></a> method returns a new array containing a shallow copy of the<br>
array elements indicated by the <code>start</code> and <code>end</code> arguments. The <code>start</code><br>
argument is the index of the first element to include and the <code>end</code> argument is<br>
the index of the element to include up to (but not including). If the <code>end</code><br>
argument isn&apos;t provided, all of the array elements up to the end of the array<br>
will be included. The original array will not be modified.</p>
<p>By combining two calls to the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice"><code>Array#slice</code></a> method into a new array, a copy of<br>
an array can be created that omits an element at a specific index (<code>index</code>):</p>
<ul>
<li><code>state.slice(0, index)</code> - Returns a new array containing the elements starting<br>
from index <code>0</code> up to <code>index</code></li>
<li><code>state.slice(index + 1)</code> - Returns a new array containing the elements<br>
starting from <code>index + 1</code> (one past the index to omit the element at <code>index</code>)<br>
up through the last element in the array</li>
</ul>
<p>Then the spread syntax is used to spread the elements in the slices into a new<br>
array.</p>
<p>Here&apos;s a complete example:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> fruits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;apple&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;apple&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;orange&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;banana&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;watermelon&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// The index of the &apos;orange&apos; element is 2.</span>
<span class="token keyword">const</span> index <span class="token operator">=</span> fruits<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&apos;orange&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// `...fruits.slice(0, index)` returns the array [&apos;apple&apos;, &apos;apple&apos;]</span>
<span class="token comment">// `...fruits.slice(index + 1)` returns the array [&apos;banana&apos;, &apos;watermelon&apos;]</span>
<span class="token comment">// The spread syntax combines the two array slices into the array</span>
<span class="token comment">// [&apos;apple&apos;, &apos;apple&apos;, &apos;banana&apos;, &apos;watermelon&apos;]</span>
<span class="token keyword">const</span> newFruits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>fruits<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span>fruits<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</pre><p>This approach to removing an element from an array is just one way to complete<br>
the operation without modifying or mutating the original array.</p>
<h2 class="mume-header" id="avoiding-state-mutations">Avoiding state mutations</h2>

<p>Inside a Redux reducer, you must never mutate its arguments (i.e. <code>state</code> and<br>
<code>action</code>). <strong>Your reducer must return a new object if the state changes</strong>.<br>
<a href="https://github.com/reactjs/redux/issues/758">Here&apos;s why</a>.</p>
<p>Here&apos;s an example of a <em>bad</em> reducer which mutates the previous state.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">badReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span> count<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&apos;INCREMENT_COUNTER&apos;</span><span class="token punctuation">:</span>
      state<span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>And here&apos;s an example of a good reducer which uses <code>Object.assign</code> to create a<br>
shallow duplicate of the previous <code>state</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">goodReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span> count<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&apos;INCREMENT_COUNTER&apos;</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> nextState <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
      nextState<span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="what-you-learned-3">What you learned</h2>

<p>In this article, you learned about reducers and how to use a <code>switch</code> statement<br>
within a reducer function to handle multiple action types. You also learned why<br>
it&apos;s important for a reducer to avoid mutating the current state when creating<br>
the next state.</p>
<h2 class="mume-header" id="see-also-2">See also...</h2>

<p>To learn more about reducers, see the official <a href="https://redux.js.org/basics/reducers">Redux<br>
documentation</a>.</p>
<hr>
<h1 class="mume-header" id="actions-2">Actions</h1>

<p>As you&apos;ve already learned from an earlier article, <strong>actions</strong> are the only way<br>
to trigger changes to the store&apos;s state. Remember, actions are simple POJOs with<br>
a mandatory <code>type</code> key and optional payload keys containing new information.<br>
They get sent using <code>store.dispatch()</code> and are the primary drivers of the Redux<br>
loop.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Write an action creator function to facilitate in the creation of action<br>
objects</li>
<li>Use constants to define action types to prevent simple typos in action type<br>
string literals</li>
</ul>
<h2 class="mume-header" id="using-action-creators">Using action creators</h2>

<p>When an action is dispatched, any new state data must be passed along as the<br>
<strong>payload</strong>. The example below passes a payload key of <code>fruit</code> with the new<br>
state data, &apos;orange&apos;:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> addOrange <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">:</span> <span class="token string">&apos;orange&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>addOrange<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ &apos;orange&apos; ]</span>
</pre><p>However, when these action payloads are generated dynamically, it becomes<br>
necessary to extrapolate the creation of the action object into a function.<br>
These functions are called <strong>action creators</strong>. The JavaScript objects they<br>
return are the <strong>actions</strong>. To initiate a dispatch, you pass the result of<br>
calling an action creator to <code>store.dispatch()</code>.</p>
<p>For example, an action creator function to create &apos;ADD_FRUIT&apos; actions looks like<br>
this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
    fruit<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>You can also rewrite the above arrow function to use an implicit return value:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><blockquote>
<p>While either approach for defining action creators using arrow functions<br>
works, the latter approach of using an implicit return value makes it more<br>
difficult to debug the Redux cycle (you&apos;ll see why later in this lesson).</p>
</blockquote>
<p>Now we can add any <code>fruit</code> to the store using our action creator<br>
<code>addFruit(fruit)</code>, instead of having to define an action object for each fruit:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruit</span><span class="token punctuation">(</span><span class="token string">&apos;apple&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruit</span><span class="token punctuation">(</span><span class="token string">&apos;strawberry&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruit</span><span class="token punctuation">(</span><span class="token string">&apos;lychee&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ &apos;orange&apos;, &apos;apple&apos;, &apos;strawberry&apos;, &apos;lychee&apos; ]</span>
</pre><h2 class="mume-header" id="preventing-typos-in-action-type-string-literals">Preventing typos in action type string literals</h2>

<p>Update your actions to include <code>&apos;ADD_FRUIT&apos;</code>, <code>&apos;ADD_FRUITS&apos;</code>, <code>&apos;SELL_FRUIT&apos;</code>,<br>
and <code>&apos;SELL_OUT&apos;</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token constant">ADD_FRUIT</span> <span class="token operator">=</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">ADD_FRUITS</span> <span class="token operator">=</span> <span class="token string">&apos;ADD_FRUITS&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">SELL_FRUIT</span> <span class="token operator">=</span> <span class="token string">&apos;SELL_FRUIT&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">SELL_OUT</span> <span class="token operator">=</span> <span class="token string">&apos;SELL_OUT&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">addFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">ADD_FRUIT</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">addFruits</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruits</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">ADD_FRUITS</span><span class="token punctuation">,</span>
  fruits<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">sellFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">SELL_FRUIT</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">sellOut</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">SELL_OUT</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Notice that constants were used for all of the fruit action types. This prevents<br>
simple typos in the reducer&apos;s case clauses (i.e. <code>&apos;ADD_FRIUT&apos;</code>) from<br>
unexpectedly not matching the appropriate action type (i.e. <code>&apos;ADD_FRUIT&apos;</code>).<br>
Creating constants for the action type string literals ensures that an error is<br>
thrown if the constant name is mistyped.</p>
<h2 class="mume-header" id="reviewing-a-completed-fruit-stand-example">Reviewing a completed Fruit Stand example</h2>

<p>To review and run a completed Fruit Stand example application, clone the<br>
<a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the <code>fruit-stand-redux</code><br>
folder. Run the command <code>npm install</code> to install the project&apos;s dependencies.<br>
Then use the command <code>node app.js</code> to run the Fruit Stand application. You<br>
should see the following output:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Default Redux Store <span class="token punctuation">(</span>empty fruit list<span class="token punctuation">)</span>:
<span class="token punctuation">[</span><span class="token punctuation">]</span>
Redux Store:
<span class="token punctuation">[</span> <span class="token string">&apos;orange&apos;</span>, <span class="token string">&apos;apple&apos;</span> <span class="token punctuation">]</span>
Redux Store:
<span class="token punctuation">[</span> <span class="token string">&apos;orange&apos;</span>, <span class="token string">&apos;apple&apos;</span>, <span class="token string">&apos;orange&apos;</span>, <span class="token string">&apos;lychee&apos;</span>, <span class="token string">&apos;grapefruit&apos;</span> <span class="token punctuation">]</span>
Updated Redux Store:
<span class="token punctuation">[</span> <span class="token string">&apos;orange&apos;</span>, <span class="token string">&apos;orange&apos;</span>, <span class="token string">&apos;lychee&apos;</span>, <span class="token string">&apos;grapefruit&apos;</span> <span class="token punctuation">]</span>
Reset Redux Store <span class="token punctuation">(</span>empty fruit list<span class="token punctuation">)</span>:
<span class="token punctuation">[</span><span class="token punctuation">]</span>
</pre><p>The <code>reduxSAR.js</code> file contains the action types, reducer, store, and action<br>
creator functions. The <code>app.js</code> file contains the code that interacts with the<br>
Redux store. The <code>appWithSubscription.js</code> file also contains code that interacts<br>
with the store but subscribes a callback function (using the <code>store.subscribe</code><br>
method) to listen for and log state updates to the console.</p>
<h2 class="mume-header" id="what-you-learned-4">What you learned</h2>

<p>In this article, you learned how to write an action creator function to<br>
facilitate in the creation of action objects. You also learned how to use<br>
constants to define action types to prevent simple typos in action type string<br>
literals.</p>
<h2 class="mume-header" id="see-also-3">See also...</h2>

<p>To learn more about actions, see the official <a href="http://redux.js.org/docs/basics/Actions.html">Redux<br>
documentation</a>.</p>
<hr>
<h1 class="mume-header" id="debugging-arrow-functions">Debugging Arrow Functions</h1>

<p>Arrow functions are ubiquitous in React and Redux. Understanding how to use<br>
<code>debugger</code> statements with arrow functions is necessary to be able to<br>
effectively debug the Redux cycle.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Describe why <code>debugger</code> statements can&apos;t be used with arrow functions that<br>
have an implicit return value</li>
<li>Rewrite an arrow function with an implicit return value to use an explicit<br>
return statement so that a <code>debugger</code> statement can be added</li>
</ul>
<h2 class="mume-header" id="understanding-the-limitations-of-implicit-return-values">Understanding the limitations of implicit return values</h2>

<p>Here&apos;s an example of a Redux action creator that&apos;s defined using an arrow<br>
function with an implicit return value:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>While using an arrow function with an implicit return value allows you to<br>
concisely define <code>addFruit</code>, it&apos;s difficult to debug. Suppose you want to use a<br>
<code>debugger</code> statement to stop execution within <code>addFruit</code> to inspect the value of<br>
the <code>fruit</code> parameter. You <strong>can&apos;t</strong> do this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token keyword">debugger</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p><code>{ type: &apos;ADD_FRUIT&apos;, fruit }</code> is an object, and you can&apos;t put a <code>debugger</code><br>
statement inside of an object. But you also <strong>can&apos;t</strong> do this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token keyword">debugger</span>
  <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
    fruit<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The parentheses after the fat arrow (<code>=&gt;</code>) are used to indicate that the object<br>
<code>{ type: &apos;ADD_FRUIT&apos;, fruit }</code> should be implicitly returned. As a result, the<br>
above won&apos;t work, because we can&apos;t put a debugger inside of a return statement.</p>
<h2 class="mume-header" id="rewriting-an-arrow-function-to-use-an-explicit-return-statement">Rewriting an arrow function to use an explicit return statement</h2>

<p>To put a <code>debugger</code> statement inside of the <code>addFruit</code> action creator function,<br>
you first need to convert it into an arrow function with an explicit return<br>
statement:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
    fruit<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now, finally, you can put the <code>debugger</code> statement before the <code>return</code><br>
statement:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">debugger</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">,</span>
    fruit<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>If you want to avoid having to do this over and over again as you&apos;re debugging<br>
your arrow functions, you can make it a habit to write all of your arrow<br>
functions with explicit return statements. Do be aware, however, that writing<br>
arrow functions with implicit return values is a common convention in Redux and<br>
you will see it often out in the wild.</p>
<h2 class="mume-header" id="what-you-learned-5">What you learned</h2>

<p>In this article, you learned why <code>debugger</code> statements can&apos;t be used with arrow<br>
functions that have an implicit return value. You also learned how to rewrite an<br>
arrow function with an implicit return value to use an explicit return statement<br>
so that a <code>debugger</code> statement can be added.</p>
<hr>
<h1 class="mume-header" id="redux-to-do-list-project">Redux To-do List Project</h1>

<p>At this point, you understand how to perform CRUD operations with a backend API.<br>
You also know how to perform CRUD operations by creating a user interface with<br>
React, managing state with React Context, and storing persistent data in local<br>
storage. It&apos;s time to create a simple Node to-do list application that utilizes<br>
the Redux library and runs in your terminal! This project is intended as a way<br>
to practice the basics of Redux before learning how to use Redux within a React<br>
application.</p>
<p>In today&apos;s project, you will:</p>
<ul>
<li>Generate a Redux <strong>store</strong> by using the <code>createStore</code> method from the Redux<br>
library</li>
<li>Set up a <strong>reducer</strong> to direct different action types to interact with the<br>
Redux store in different ways</li>
<li>Set up <strong>actions</strong> to create a task, delete a task, and reset the task list</li>
<li>Use the <code>store.getState</code> method to access the data stored in the Redux store</li>
<li>Use the <code>store.dispatch</code> method to <strong>dispatch</strong> actions to the Redux store</li>
<li>Use the <code>store.subscribe</code> method to subscribe to Redux store changes</li>
<li>Use the VS Code debugger to follow the Redux cycle</li>
</ul>
<h2 class="mume-header" id="phase-1-create-redux-store-actions-and-reducer">Phase 1: Create Redux store, actions, and reducer</h2>

<p>Run the following commands in your terminal to create a new project directory,<br>
generate a <code>package.json</code> file, and install <code>redux</code> as a dependency:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">mkdir</span> redux-todos <span class="token operator">&amp;&amp;</span> <span class="token function">cd</span> redux-todos
<span class="token function">npm</span> init -y <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> <span class="token function">install</span> redux
</pre><p>Now it&apos;s time to create your first Redux project! Create a<br>
<code>reduxStoreActionReducer.js</code> file and import the <code>createStore</code> method from<br>
Redux. You&apos;ll need to use CommonJS module syntax (<code>module.exports</code> and<br>
<code>require</code>) to be able to run the project within the Node environment:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;redux&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="store-3">Store</h3>

<p>You&apos;ll use the <code>createStore</code> method to generate your Redux store by invoking it<br>
with a reducer. As a reminder, each application should only have one Redux store<br>
where all of an application&apos;s state is managed. This is unlike using React<br>
Context, where a single React application can utilize multiple contexts.</p>
<p>Conceptually speaking, you can think of the reducer as a function that helps<br>
manage the Redux store by routing actions based on their <code>type</code> attribute. Based<br>
on the official Redux documentation on the <a href="https://redux.js.org/api/createstore/">createStore</a> method and its<br>
parameters, a reducer is a &quot;reducing function that returns the next state tree,<br>
given the current state tree and an action to handle.&quot;</p>
<p>Now that we&apos;ve gone over a conceptual overview of reducers, let&apos;s create a<br>
<code>tasksReducer</code> to manage the to-do list tasks in your Redux store!</p>
<p>Define the <code>tasksReducer</code> function and have it take in the Redux store&apos;s <code>state</code><br>
and an <code>action</code> as parameters. You&apos;ll want the <code>state</code> to default to an empty<br>
(<code>[]</code>) if the <code>tasksReducer</code> is invoked without a state. Since you invoke the<br>
<code>createStore</code> method with the <code>tasksReducer</code>, you&apos;ll need to define the<br>
<code>tasksReducer</code> before invoking the <code>createStore</code> method to generate the Redux<br>
store.</p>
<blockquote>
<p><strong>Note:</strong> this project uses an array to store the tasks instead of an object<br>
to make it easier to delete a positional task, since there is no user<br>
interface that will expose the task ID needed to dispatch task deletion. In<br>
the case of this project, a <code>taskId</code> will refer to the index of a task in the<br>
array.</p>
</blockquote>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">tasksReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: Set up switch statement to manage actions based on type</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>tasksReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The underlying code in the store returned by the <code>createStore</code> method will<br>
automatically invoke the <code>tasksReducer</code> function whenever an action is<br>
dispatched. Speaking of actions, let&apos;s set up the <code>createTask</code>, <code>deleteTask</code>,<br>
and <code>resetTaskList</code> actions before finishing the <code>tasksReducer</code> function that<br>
conceptually <em>routes</em> action objects (think of how it makes more sense to create<br>
a component before setting up a <code>&lt;Route&gt;</code> for it).</p>
<p>You&apos;ll finish defining the <code>tasksReducer</code> function after creating the<br>
<code>createTask</code>, <code>deleteTask</code>, and <code>resetTaskList</code> actions that the reducer<br>
manages. You&apos;ll set up your actions below the line of code that sets up the<br>
Redux <code>store</code>.</p>
<h3 class="mume-header" id="actions-3">Actions</h3>

<p>Let&apos;s set up the <code>createTask</code> action creator! You&apos;ll want your <code>createTask</code><br>
action creator to return an action with the following shape:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;CREATE_TASK&apos;</span><span class="token punctuation">,</span>
  taskMessage<span class="token punctuation">:</span> <span class="token string">&apos;walk dog&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</pre><p>As a reminder, an <strong>action creator</strong> is simply a function that returns an<br>
<strong>action</strong> which is a POJO (plain old JavaScript object) that defines a <code>type</code><br>
key and optional payload keys. Have your <code>createTask</code> function take in a<br>
<code>taskMessage</code> as a parameter:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">createTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">taskMessage</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: Return POJO with `type` property and function&apos;s argument (`taskMessage`)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now you&apos;ll want to set up the function&apos;s return statement to return the action<br>
POJO. The POJO should have a <code>type</code> property. The <code>type</code> property will be how<br>
the <code>tasksReducer</code> will decipher different types of actions to update the Redux<br>
store&apos;s state in different ways. The action will also have a payload key set to<br>
the function&apos;s argument (<code>taskMessage</code>).</p>
<p>In this case, the <code>createTask</code> function has a <code>taskMessage</code> parameter, so the<br>
action POJO will have a <code>type</code> property set to the string <code>CREATE_TASK</code>, as<br>
well as a <code>taskMessage</code> property set to the <code>taskMessage</code> parameter value.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">createTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">taskMessage</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&apos;CREATE_TASK&apos;</span><span class="token punctuation">,</span>
    taskMessage<span class="token punctuation">:</span> taskMessage<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>It is best practice to use constants for action types, instead of string<br>
literals. Since the reducer depends on the action&apos;s <code>type</code> to decipher different<br>
types of actions, a typo in the reducer or action specifying the type will go<br>
unseen. For example, imagine if the reducer needs an action with the type<br>
<code>CREATE_TASK</code> to perform the create operation, but there is a typo making the<br>
reducer listen for the type <code>&apos;CREATE_TSAK&apos;</code> instead. When an action of type<br>
<code>CREATE_TASK</code> is dispatched, it will never be evaluated by the reducer<br>
listening for an action of type <code>&apos;CREATE_TSAK&apos;</code>. Creating constants for string<br>
literals ensures that an error will be thrown for action type typos.</p>
<p>Define a constant for the <code>CREATE_TASK</code> string. Make sure to define the<br>
constant before defining your <code>tasksReducer</code>, otherwise you&apos;ll receive<br>
<code>ReferenceError: CREATE_TASK is not defined</code> when you dispatch an action. At<br>
this point, your file should look something like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;redux&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">CREATE_TASK</span> <span class="token operator">=</span> <span class="token string">&apos;CREATE_TASK&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">tasksReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO: Set up switch statement to manage actions based on type</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>tasksReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">createTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">taskMessage</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">,</span>
    taskMessage<span class="token punctuation">:</span> taskMessage<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>You can also have the function implicitly return by removing the function&apos;s<br>
curly braces and wrapping the action object&apos;s curly braces with parentheses. The<br>
<code>createTask</code> code below has the exact same functionality as the code above:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">createTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">taskMessage</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">,</span>
  taskMessage<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Although the code looks shorter and cleaner, note that you are unable to use the<br>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/debugger">debugger statement</a> to debug a function when it is implicitly returning. You<br>
can use the VS Code debugger to set a breakpoint, but you won&apos;t be able to set a<br>
breakpoint with the <code>debugger</code> statement.</p>
<p>When working on your React-Redux projects in the future, it&apos;ll be helpful to<br>
keep the <code>return</code> statement so you can easily place a breakpoint with the<br>
<code>debugger</code> statement to debug the action creator function and make sure a<br>
specific action is actually being dispatched.</p>
<p>Now that you have set up a <code>createTask</code> action creator, follow the same pattern<br>
to set up a <code>deleteTask</code> action creator that takes in a <code>taskId</code>. The<br>
<code>resetTaskList</code> action creator will be a little different. You&apos;ll still follow<br>
the pattern of setting a <code>type</code> for the action, but the <code>resetTaskList</code> function<br>
will not take any parameters. The action will simply have a <code>type</code> property and<br>
a <code>emptyTaskList</code> property set to an empty array:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">resetTaskList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token constant">RESET_TASK_LIST</span><span class="token punctuation">,</span>
    emptyTaskList<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="reducer-1">Reducer</h3>

<p>It&apos;s time to circle back and finish implementing the <code>tasksReducer</code>! Begin by<br>
setting up a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/switch">switch</a> statement that evaluates a case statement based on the<br>
<code>action.type</code>.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">tasksReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO: Set up switch case for `createTask` action</span>
    <span class="token comment">// TODO: Set up switch case for `deleteTask` action</span>
    <span class="token comment">// TODO: Set up switch case for `resetTaskList` action</span>
    <span class="token comment">// TODO: Set up default switch case</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Let&apos;s begin by setting up the default switch case. By default, you always want<br>
to return the default <code>state</code> argument passed into the reducer:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">tasksReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO: Set up switch case for `createTask` action</span>
    <span class="token comment">// TODO: Set up switch case for `deleteTask` action</span>
    <span class="token comment">// TODO: Set up switch case for `resetTaskList` action</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now let&apos;s set up the <code>case</code> statements for each action type. You have three task<br>
actions, so you&apos;ll set up three case statements. As a reminder, you set up the<br>
action types with constants to make sure typos in the reducer&apos;s <code>case</code><br>
statements throw an error. Use the constants in the switch statement:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">tasksReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">:</span>
      <span class="token comment">// TODO: Define what happens when a `createTask` action is dispatched</span>
    <span class="token keyword">case</span> <span class="token constant">DELETE_TASK</span><span class="token punctuation">:</span>
      <span class="token comment">// TODO: Define what happens when a `deleteTask` action is dispatched</span>
    <span class="token keyword">case</span> <span class="token constant">RESET_TASK_LIST</span><span class="token punctuation">:</span>
      <span class="token comment">// TODO: Define what happens when a `resetTaskList` action is dispatched</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>As a reminder, the reducer function is called every time an action is<br>
dispatched. This means that the <code>tasksReducer</code> function will be invoked whenever<br>
an action is dispatched. It&apos;s now time to write code to handle each specific<br>
action type and define what happens when actions of different types are<br>
dispatched!</p>
<h4 class="mume-header" id="create_task-case-statement"><code>CREATE_TASK</code> case statement</h4>

<p>Under the case statement for <code>CREATE_TASK</code>, you&apos;ll want to return an updated<br>
version of the reducer&apos;s state tree, with the new task. As a reminder, the Redux<br>
store&apos;s state should be immutable - this means you should never mutate the<br>
<code>state</code> array directly.</p>
<p>Begin by generating a <code>newTask</code> object based on the action&apos;s <code>taskMessage</code><br>
property:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
  message<span class="token punctuation">:</span> action<span class="token punctuation">.</span>taskMessage<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Since you don&apos;t want to directly mutate the <code>state</code> array, you don&apos;t want to<br>
<code>push</code> the <code>newTask</code> directly into the <code>state</code> array. Instead, you can use<br>
spread syntax to return an updated state with <code>newTask</code> set as the last array<br>
element in a new array:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">case</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">:</span>
  <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
    message<span class="token punctuation">:</span> action<span class="token punctuation">.</span>taskMessage<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> newTask<span class="token punctuation">]</span><span class="token punctuation">;</span>
</pre><h4 class="mume-header" id="delete_task-case-statement"><code>DELETE_TASK</code> case statement</h4>

<p>Now let&apos;s define what happens when a <code>DELETE_TASK</code> action is dispatched. As a<br>
reminder, the <code>deleteTask</code> action creator function takes in a <code>taskId</code> that<br>
actually references a task element&apos;s index in the <code>state</code> array. In the<br>
<code>DELETE_TASK</code> case statement, you&apos;ll use the index (the action&apos;s <code>taskId</code><br>
property) and the native <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice">Array.slice</a> method to return a copy of the state that<br>
excludes the task to delete:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">case</span> <span class="token constant">DELETE_TASK</span><span class="token punctuation">:</span>
  <span class="token keyword">const</span> idx <span class="token operator">=</span> action<span class="token punctuation">.</span>taskId<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</pre><p>Using spread syntax and non-mutative methods are one of the many immutable<br>
update patterns you can use to update state without directly mutating it. Feel<br>
free to visit the official Redux documentation to view more <a href="https://redux.js.org/recipes/structuring-reducers/immutable-update-patterns#inserting-and-removing-items-in-arrays">immutable update<br>
patterns</a>.</p>
<h4 class="mume-header" id="reset_task_list-case-statement"><code>RESET_TASK_LIST</code> case statement</h4>

<p>Now let&apos;s define what happens when a <code>RESET_TASK_LIST</code> action is dispatched. As<br>
a reminder, the action has an <code>emptyTaskList</code> property that is an empty array,<br>
similar to the default state set by the reducer. You can simply return the<br>
<code>emptyTaskList</code> array to update the Redux store&apos;s state. The <code>emptyTaskList</code><br>
will replace the <code>state</code> array entirely.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">case</span> <span class="token constant">RESET_TASK_LIST</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> action<span class="token punctuation">.</span>emptyTaskList<span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="phase-2-testing">Phase 2: Testing</h2>

<p>Start by creating an <code>app.js</code> file and importing <code>store</code>, <code>createTask</code>,<br>
<code>deleteTask</code>, and <code>resetTaskList</code> from the <code>reduxStoreActionReducer.js</code> file.<br>
Since this project is running within the native Node environment, you&apos;ll need to<br>
use CommonJS module syntax (<code>require</code> and <code>module.exports</code>) to manage imports<br>
and exports within the project:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">,</span>
  createTask<span class="token punctuation">,</span>
  deleteTask<span class="token punctuation">,</span>
  resetTaskList<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;./reduxStoreActionReducer&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Before you begin dispatching actions to test the actions and reducer you have<br>
created, you&apos;ll need to set up a way to log the Redux store and view its current<br>
state. You can use the <code>store.getState</code> method to access the Redux store&apos;s<br>
current state and simply console log the Redux store&apos;s state that was retrieved.<br>
To make your logging more clear, you can even add a message labeling the status<br>
of the store logged. After the imports at the top of your <code>app.js</code> file, log the<br>
initial state of the Redux store (an empty task list) with the following<br>
<code>console.log</code> statements:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Default Redux Store (empty task list):&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>At this point, take a moment to run your Node application by running the follow<br>
terminal statement from the root of the project directory:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">node app.js
</pre><p>You should see the following output in your terminal:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Default Redux Store <span class="token punctuation">(</span>empty task list<span class="token punctuation">)</span>:
<span class="token punctuation">[</span><span class="token punctuation">]</span>
</pre><blockquote>
<p>Notice how you are currently using <code>console.log</code> statements to test and debug<br>
your code. Later in the project, you&apos;ll get a chance to investigate your code<br>
with the VS Code debugger to gain more context and insight about your code and<br>
its variable values.</p>
</blockquote>
<h3 class="mume-header" id="dispatch-the-create_task-action">Dispatch the <code>CREATE_TASK</code> action</h3>

<p>Now you can test whether you can actually create a task by using the<br>
<code>store.dispatch</code> method to dispatch the <code>CREATE_TASK</code> action. Invoke the<br>
<code>createTask</code> action creator function with a task message, and then dispatch the<br>
invoked action. As a reminder, dispatching the action will &quot;send&quot; it through the<br>
reducer (in this case, the <code>tasksReducer</code>) and determine what operation to<br>
perform based on the action&apos;s <code>type</code> property.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;walk dog&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;feed cat&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;talk to bird&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;watch goldfish&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Redux Store:&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now run your application with <code>node app.js</code> and you should see the following<br>
output in your terminal:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Default Redux Store <span class="token punctuation">(</span>empty task list<span class="token punctuation">)</span>:
<span class="token punctuation">[</span><span class="token punctuation">]</span>
Redux Store:
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;walk dog&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;talk to bird&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;watch goldfish&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
</pre><p>That may have seemed like magic for now, but at the end of the project, you&apos;ll<br>
walk-through your project&apos;s code step-by-step to view what is really happening<br>
with the Redux cycle. For now, focus on understanding the idea of <em>dispatching<br>
an action</em>.</p>
<h3 class="mume-header" id="dispatch-the-delete_task-action">Dispatch the <code>DELETE_TASK</code> action</h3>

<p>Now you can add the following code after your <code>CREATE_TASK</code> dispatch calls to<br>
dispatch a <code>DELETE_TASK</code> action and log the Redux store&apos;s updated state:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">deleteTask</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">deleteTask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Updated Redux Store:&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Run your application with <code>node app.js</code> and you should see the following output<br>
in your terminal:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Default Redux Store <span class="token punctuation">(</span>empty task list<span class="token punctuation">)</span>:
<span class="token punctuation">[</span><span class="token punctuation">]</span>
Redux Store:
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;walk dog&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;talk to bird&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;watch goldfish&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
Updated Redux Store:
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> message: <span class="token string">&apos;watch goldfish&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
</pre><h3 class="mume-header" id="dispatch-the-reset_task_list-action">Dispatch the <code>RESET_TASK_LIST</code> action</h3>

<p>Lastly, take a moment to test the dispatching of the <code>RESET_TASK_LIST</code> action<br>
and log the updated state by adding the following code after the <code>DELETE_TASK</code><br>
dispatch calls:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">resetTaskList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Reset Redux Store (empty task list):&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>If you run your application with <code>node app.js</code> and you should see the following<br>
output in your terminal:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Default Redux Store <span class="token punctuation">(</span>empty task list<span class="token punctuation">)</span>:
<span class="token punctuation">[</span><span class="token punctuation">]</span>
Redux Store:
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;walk dog&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;talk to bird&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;watch goldfish&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
Updated Redux Store:
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> message: <span class="token string">&apos;watch goldfish&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
Reset Redux Store <span class="token punctuation">(</span>empty task list<span class="token punctuation">)</span>:
<span class="token punctuation">[</span><span class="token punctuation">]</span>
</pre><h3 class="mume-header" id="subscribe-to-redux-store-updates">Subscribe to Redux store updates</h3>

<p>Instead of having multiple console log statements to log <code>store.getState()</code>, you<br>
can have your store subscribe to changes in the state with the <code>store.subscribe</code><br>
method. Create a new <code>appWithSubscription.js</code> file with the following code to<br>
view how you can invoke <code>store.subscribe</code> so that the state is logged anytime<br>
the store is updated (i.e. anytime an action is dispatched).</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./appWithSubscription.js</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">,</span>
  createTask<span class="token punctuation">,</span>
  deleteTask<span class="token punctuation">,</span>
  resetTaskList<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;./reduxStoreActionReducer&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Default Redux Store (empty task list):&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Task creation actions&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;walk dog&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;feed cat&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;talk to bird&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;watch goldfish&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Task deletion actions&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">deleteTask</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">deleteTask</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Task reset action&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">resetTaskList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Run your application with <code>node appWithSubscription.js</code> and you should see the<br>
following output. Notice how the state was logged four times under &quot;Task<br>
creation actions&quot; because of how four actions were dispatched, and the state was<br>
logged twice after &quot;Task deletion actions&quot; because of how two actions were<br>
dispatched.</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Default Redux Store <span class="token punctuation">(</span>empty task list<span class="token punctuation">)</span>:
<span class="token punctuation">[</span><span class="token punctuation">]</span>
Task creation actions:
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;walk dog&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;walk dog&apos;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;walk dog&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;talk to bird&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;walk dog&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;talk to bird&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;watch goldfish&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
Task deletion actions:
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;talk to bird&apos;</span> <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span> message: <span class="token string">&apos;watch goldfish&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span> <span class="token punctuation">{</span> message: <span class="token string">&apos;feed cat&apos;</span> <span class="token punctuation">}</span>, <span class="token punctuation">{</span> message: <span class="token string">&apos;watch goldfish&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span>
Task reset action:
<span class="token punctuation">[</span><span class="token punctuation">]</span>
</pre><h3 class="mume-header" id="debug-to-follow-the-redux-cycle">Debug to follow the Redux cycle</h3>

<p>Now that you&apos;ve used <code>console.log</code> statements to thoroughly investigate your<br>
project, you can set up the VS Code debugger and add some breakpoints to follow<br>
the Redux cycle. You&apos;ll use the breakpoints to investigate how invoking<br>
<code>store.dispatch</code> with the result from an action creator function directs the<br>
action to a specific switch case in the <code>tasksReducer</code> function. Start by<br>
creating a <code>.vscode</code> directory and a <code>launch.json</code> file to configure the VS Code<br>
debugger:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">mkdir</span> .vscode <span class="token operator">&amp;&amp;</span> <span class="token function">cd</span> .vscode
<span class="token function">touch</span> launch.json
</pre><p>Paste the following configuration into your <code>launch.json</code> file:</p>
<pre data-role="codeBlock" data-info="json" class="language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.2.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;configurations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;request&quot;</span><span class="token operator">:</span> <span class="token string">&quot;launch&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Launch Program&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;skipFiles&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;&lt;node_internals&gt;/**&quot;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;program&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${workspaceFolder}/app.js&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</pre><blockquote>
<p>As a reminder, VS Code can also auto-generate the <code>.vscode</code> directory and the<br>
<code>launch.json</code> for you. Feel free to visit the VS Code documentation for more<br>
on <a href="https://code.visualstudio.com/Docs/editor/debugging">debugging with VS Code</a>.</p>
</blockquote>
<p>You can follow your code when an action object is dispatched by setting<br>
breakpoints. You can also examine the action&apos;s attributes by setting a<br>
breakpoint in the reducer. In the reducer, make sure to set the breakpoint<br>
within a <code>case</code> statement. For example, if you set a breakpoint in the <code>switch</code><br>
statement, but <em>outside</em> of a <code>case</code> statement, you won&apos;t ever hit the<br>
breakpoint set.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// Example of bad `debugger` placement that will not work!</span>

<span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">debugger</span><span class="token punctuation">;</span>
  <span class="token keyword">case</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">:</span>
    <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
      message<span class="token punctuation">:</span> action<span class="token punctuation">.</span>taskMessage<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> newTask<span class="token punctuation">]</span><span class="token punctuation">;</span>
</pre><p>Take a moment to use the <code>debugger</code> keyword to set breakpoints in the<br>
<code>createTask</code> action creator and <code>CREATE_TASK</code> case statement in your<br>
<code>reduxStoreActionReducer.js</code> file:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">tasksReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">:</span>
      <span class="token keyword">debugger</span>
      <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
        message<span class="token punctuation">:</span> action<span class="token punctuation">.</span>taskMessage<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> newTask<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">DELETE_TASK</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> idx <span class="token operator">=</span> action<span class="token punctuation">.</span>taskId<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">RESET_TASK_LIST</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> action<span class="token punctuation">.</span>emptyTaskList<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">createTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">taskMessage</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">debugger</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">,</span>
    taskMessage<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now you&apos;ll be able to pause the running of your code to examine variables in the<br>
environment and view step-by-step updates to the Redux store&apos;s <code>state</code> as your<br>
code is evaluated.</p>
<p>Open <code>app.js</code> as the active file in your VS Code workspace. Press <code>F5</code> and<br>
select <code>Node.js</code> as your environment - VS Code will try to run your currently<br>
active file in debug mode. This will allow you to follow each dispatched action<br>
and watch how each dispatched action updates the Redux store&apos;s state.</p>
<p>As you step through each dispatched action, you&apos;ll notice that there really is a<br>
<em>cycle</em>: an action is generated, then the action is dispatched to go through a<br>
reducer, and then the store is updated.</p>
<p>Here is a quick breakdown of what happens with the <code>CREATE_TASK</code> action is<br>
dispatched, to guide the navigation of using VS Code debugger to investigate the<br>
Redux cycle:</p>
<ol>
<li>The <code>createTask</code> action creator function is invoked with the string <code>&apos;walk dog&apos;</code>.</li>
<li>The <code>createTask</code> function returns a POJO (known as an &quot;action&quot;) with a <code>type</code><br>
attribute and <code>taskMessage</code> properties. The POJO is structured like this:</li>
</ol>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;CREATE_TASK&apos;</span><span class="token punctuation">,</span>
  taskMessage<span class="token punctuation">:</span> <span class="token string">&apos;walk dog&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</pre><ol start="3">
<li>The <code>store.dispatch</code> method is invoked to dispatch the action POJO and invoke<br>
the <code>tasksReducer</code> function. Since the POJO has a type of <code>CREATE_TASK</code>,<br>
the case statement for <code>CREATE_TASK</code> will be evaluated:</li>
</ol>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">case</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">:</span>
  <span class="token keyword">const</span> newTask <span class="token operator">=</span> <span class="token punctuation">{</span>
    message<span class="token punctuation">:</span> <span class="token string">&apos;walk dog&apos;</span><span class="token punctuation">,</span> <span class="token comment">// This is `action.taskMessage`</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> newTask<span class="token punctuation">]</span><span class="token punctuation">;</span>
</pre><ol start="4">
<li>The store&apos;s state is updated to be the new state returned by the reducer<br>
(<code>[...state, newTask]</code>).</li>
</ol>
<p>Congratulations! You have just created your first Redux store, reducer, and<br>
actions. You also learned more about what a reducer is doing by investigating<br>
with console log statements and debugging the project with the VS Code debugger.</p>
<hr>
<h1 class="mume-header undefined" id="week-15-day-2brreact-redux">WEEK-15 DAY-2<br><em>React + Redux</em></h1>

<hr>
<h1 class="mume-header" id="redux-learning-objectives-part-2">Redux Learning Objectives: Part 2</h1>

<p>To keep things as simple as possible when initially learning Redux, you started<br>
with using Redux independent of React. Now it&apos;s time to learn how to use Redux<br>
within a React application!</p>
<p>After reading and practicing how to use Redux with React, you should be able to:</p>
<ul>
<li>Add Redux actions, reducer(s), and a store to a React project</li>
<li>Update a React class component to subscribe to a Redux store to listen for<br>
state changes</li>
<li>Update a React component to dispatch actions to a Redux store</li>
<li>Define multiple reducers to manage individual slices of state</li>
<li>Use the Redux <code>combineReducers</code> method to combine multiple reducers into a<br>
single root reducer</li>
<li>Update a reducer to delegate a state update to a subordinate reducer</li>
<li>Describe how container components differ from presentational components</li>
<li>Write a container component to handle all of the Redux store interaction for<br>
one or more presentational components</li>
<li>Use <code>Object.freeze</code> to prevent the current state within a reducer from being<br>
mutated</li>
<li>Create a Redux store with preloaded state</li>
</ul>
<hr>
<h1 class="mume-header" id="using-redux-with-react">Using Redux with React</h1>

<p>To keep things as simple as possible when initially learning Redux, you started<br>
with using Redux independent of React. Now it&apos;s time to learn how to use Redux<br>
within a React application!</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Add Redux actions, reducer(s), and a store to a React project</li>
<li>Update a React class component to subscribe to a Redux store to listen for<br>
state changes</li>
<li>Update a React component to dispatch actions to a Redux store</li>
</ul>
<h2 class="mume-header" id="integrating-redux-into-a-react-application">Integrating Redux into a React application</h2>

<p>The techniques shown in this article for integrating Redux into a React<br>
application, is just one step in your journey to learn Redux. As you work your<br>
way through this lesson, you&apos;ll learn how to improve upon these techniques to<br>
improve the organization or your code, the design of your components, and the<br>
overall performance of your application.</p>
<p>In general, the steps to integrate Redux into an existing React application are:</p>
<ul>
<li>Set up Redux
<ul>
<li>Install the <code>redux</code> npm package</li>
<li>Define your actions</li>
<li>Define your reducer(s)</li>
<li>Create your store</li>
</ul>
</li>
<li>Update components
<ul>
<li>Use <code>store.subscribe</code> to listen for state updates</li>
<li>Call <code>store.getState</code> to retrieve state for rendering</li>
<li>Call <code>store.dispatch</code> to dispatch actions to the store</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>Note:</strong> You&apos;ll start with writing all of the code to interact with the store<br>
within each component that needs to render state from the store or to dispatch<br>
actions. Later on, you&apos;ll learn how to improve the overall design of your<br>
application by using container components. Eventually, you&apos;ll learn how to use<br>
the <a href="https://react-redux.js.org/">React-Redux</a> library&apos;s <code>connect</code> method to avoid writing<br>
container components by hand.</p>
</blockquote>
<h2 class="mume-header" id="organizing-your-redux-code">Organizing your Redux code</h2>

<p>Instead of placing all of your Redux related code into a single file, you&apos;ll<br>
separate your store, reducer, and actions into their own files.</p>
<p>There are a variety of acceptable ways to organize your Redux code within a<br>
React project. When starting out with using Redux, organizing your code by type<br>
(i.e. separate files or folders for the store, reducers, and actions) often<br>
feels natural and makes it easy to find the file that you need to make a change<br>
to. As your projects increase in size and complexity, you might find that<br>
organizing your files by feature (i.e. locating all the files related to a<br>
feature inside of a single folder) will keep you from searching and jumping<br>
around a project that contains hundreds of files.</p>
<blockquote>
<p><strong>Note:</strong> How a project is organized is highly dependent upon who is working<br>
on the project. It&apos;s also not unusual for the organization of a project to<br>
evolve and change throughout its lifetime. Don&apos;t struggle too much with<br>
deciding on an approach when getting starting a new project. Pick an approach<br>
and move on to getting work done!</p>
</blockquote>
<h3 class="mume-header" id="following-along">Following along</h3>

<p>If you&apos;d like to follow along, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-with-react-starter">react-fruit-stand-with-react-starter</a><br>
repo.</p>
<p>After cloning the repo, open a terminal and browse to the <code>starter</code> folder<br>
within the repo. Run the command <code>npm install</code> to install the project&apos;s<br>
dependencies (the <code>redux</code> package is already listed as a dependency). Then use<br>
the command <code>npm start</code> to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the<br>
Create React App tooling. When running the application using <code>npm start</code>, the<br>
application should automatically open in your default browser. If it doesn&apos;t,<br>
you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h3 class="mume-header" id="adding-the-actions">Adding the actions</h3>

<p>Within the React project&apos;s <code>src</code> folder, add a folder named <code>actions</code>. Within<br>
that folder, add a file named <code>fruitActions.js</code> containing the following code:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/actions/fruitActions.js</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ADD_FRUIT</span> <span class="token operator">=</span> <span class="token string">&apos;ADD_FRUIT&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ADD_FRUITS</span> <span class="token operator">=</span> <span class="token string">&apos;ADD_FRUITS&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SELL_FRUIT</span> <span class="token operator">=</span> <span class="token string">&apos;SELL_FRUIT&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SELL_OUT</span> <span class="token operator">=</span> <span class="token string">&apos;SELL_OUT&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">addFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">ADD_FRUIT</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">addFruits</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruits</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">ADD_FRUITS</span><span class="token punctuation">,</span>
  fruits<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">sellFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">SELL_FRUIT</span><span class="token punctuation">,</span>
  fruit<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">sellOut</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">SELL_OUT</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="adding-the-reducer">Adding the reducer</h3>

<p>Within the React project&apos;s <code>src</code> folder, add a folder named <code>reducers</code>. Within<br>
that folder, add a file named <code>fruitReducer.js</code> containing the following code:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/fruitReducer.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token constant">ADD_FRUIT</span><span class="token punctuation">,</span>
  <span class="token constant">ADD_FRUITS</span><span class="token punctuation">,</span>
  <span class="token constant">SELL_FRUIT</span><span class="token punctuation">,</span>
  <span class="token constant">SELL_OUT</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_FRUIT</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> action<span class="token punctuation">.</span>fruit<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_FRUITS</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>action<span class="token punctuation">.</span>fruits<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">SELL_FRUIT</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> index <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// remove first instance of action.fruit</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span> <span class="token comment">// if action.fruit is not in state, return previous state</span>
    <span class="token keyword">case</span> <span class="token constant">SELL_OUT</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> fruitReducer<span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="adding-the-store">Adding the store</h3>

<p>Within the React project&apos;s <code>src</code> folder, add a file named <code>store.js</code> containing<br>
the following code:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/store.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> fruitReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/fruitReducer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>fruitReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="writing-redux-aware-react-components">Writing Redux aware React components</h2>

<p><strong>Remember that the integration techniques shown in this article are just a<br>
starting point with using Redux with React components.</strong> As you work your way<br>
through this lesson, you&apos;ll learn how to improve upon these techniques.</p>
<h3 class="mume-header" id="listening-for-state-changes">Listening for state changes</h3>

<p>Components that need to render state from the store can use the<br>
<code>store.subscribe</code> method to subscribe to listen for state updates. When a state<br>
update occurs, the <a href="https://facebook.github.io/react/docs/component-api.html#forceupdate"><code>forceUpdate</code></a> method is called to render<br>
the component. Within the component&apos;s <code>render</code> method, the <code>store.getState</code><br>
method is called to retrieve the current state. This approach ensures that<br>
whenever state is updated in the store (after the reducer has processed a<br>
dispatched action), the component will retrieve and render the updated state.</p>
<blockquote>
<p><strong>Note:</strong> Calling <code>forceUpdate</code> causes <code>render</code> to be called without first<br>
calling <code>shouldComponentUpdate</code>. Child components will go through their normal<br>
lifecycle, including calling <code>shouldComponentUpdate</code> to determine if the child<br>
component should render. While this pattern works, it&apos;s a rather blunt<br>
instrument for complex components, since re-rendering a parent causes<br>
re-rendering of all its children. Later in this lesson, you&apos;ll learn how the<br>
<a href="https://react-redux.js.org/">React-Redux</a> library solves this problem.</p>
</blockquote>
<p>The <code>componentDidMount</code> and <code>componentWillUnmount</code> class component lifecycle<br>
methods can be used to ensure that the component <em>subscribes</em> to the store when<br>
it&apos;s mounted and <em>unsubscribes</em> from the store when the component is about to be<br>
unmounted:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitList.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FruitList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fruit <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>fruit<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span>
          <span class="token operator">?</span> <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span><span class="token punctuation">{</span>fruit<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">fruitName<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>fruitName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
          <span class="token punctuation">:</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>No fruit currently <span class="token keyword">in</span> stock<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitList<span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="dispatching-actions">Dispatching actions</h3>

<p>Updating a component to dispatch an action to the store is a bit simpler overall<br>
than listening for and rendering state updates. You just need to import the<br>
appropriate action creator function and use the <code>store.dispatch</code> method within a<br>
event handler to dispatch the action:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitQuickAdd.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> addFruit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FruitQuickAdd</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">addFruitClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fruit <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerText<span class="token punctuation">;</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>Quick Add<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addFruitClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token constant">APPLE</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addFruitClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token constant">ORANGE</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>  
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitQuickAdd<span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="listening-for-state-changes-and-dispatching-actions">Listening for state changes and dispatching actions</h3>

<p>Sometimes components need to listen for and render state updates <em>and</em> dispatch<br>
actions to the store. The <code>FruitSeller</code> component listens for state updates so<br>
that it can render a collection of buttons--one for each distinct fruit<br>
available in the fruit stand. The component also handles button clicks to<br>
dispatch an action to sell a fruit or to sell out all of the fruits.</p>
<p>Here&apos;s what the component looks like:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitSeller.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> sellFruit<span class="token punctuation">,</span> sellOut <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FruitSeller</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">sellFruitClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fruit <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerText<span class="token punctuation">;</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">sellFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">sellOutClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">sellOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fruit <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> distinctFruit <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>distinctFruit<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>Sell<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>distinctFruit<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">fruitName<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
          <span class="token operator">&lt;</span>button key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>sellFruitClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>fruitName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>sellOutClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token constant">SELL</span> <span class="token constant">OUT</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitSeller<span class="token punctuation">;</span>
</pre><p>The <code>FruitSeller</code> component is sort of a mash up of the <code>FruitList</code> and<br>
<code>FruitQuickAdd</code> components!</p>
<h3 class="mume-header" id="practicing-on-your-own">Practicing on your own</h3>

<p>There&apos;s just one component left to implement: <code>BulkAdd</code>. This is the perfect<br>
chance to get a bit of practice on your own to help you cement what you&apos;re<br>
learned in this article.</p>
<h2 class="mume-header" id="reviewing-a-completed-fruit-stand-example-1">Reviewing a completed Fruit Stand example</h2>

<p>To review and run a completed Fruit Stand example application that uses React<br>
with Redux, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the<br>
<code>fruit-stand-redux-with-react</code> folder. Run the command <code>npm install</code> to install<br>
the project&apos;s dependencies. Then use the command <code>npm start</code> to run the Fruit<br>
Stand application.</p>
<p>This Fruit Stand example application is a React application created by the<br>
Create React App tooling. When running the application using <code>npm start</code>, the<br>
application should automatically open in your default browser. If it doesn&apos;t,<br>
you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 class="mume-header" id="what-you-learned-6">What you learned</h2>

<p>In this article, you learned how to add Redux actions, reducer(s), and a store<br>
to a React project. You also learned how to update a React class component to<br>
subscribe to a Redux store to listen for state changes and to dispatch actions<br>
to a Redux store.</p>
<hr>
<h1 class="mume-header" id="splitting-and-combining-reducers">Splitting and Combining Reducers</h1>

<p>So far, you&apos;ve been using a single reducer to manage state in your Redux store.<br>
As your applications increase in size and complexity, it&apos;ll become necessary to<br>
use multiple reducers, each managing a slice of state.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Define multiple reducers to manage individual slices of state</li>
<li>Use the Redux <code>combineReducers</code> method to combine multiple reducers into a<br>
single root reducer</li>
<li>Update a reducer to delegate a state update to a subordinate reducer</li>
</ul>
<h2 class="mume-header" id="splitting-reducers">Splitting reducers</h2>

<p>Imagine that your fruit stand is extremely successful and it grows so much that<br>
you need multiple farmers helping you to keep your stand stocked with fruit.<br>
Your application&apos;s state will need to grow to store not only an array of <code>fruit</code><br>
but also a <code>farmers</code> object that keeps track of your farmers.</p>
<p>Here&apos;s a sample state tree of your updated application:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  fruit<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&apos;APPLE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;APPLE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;ORANGE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;GRAPEFRUIT&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;WATERMELON&apos;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  farmers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">&apos;John Smith&apos;</span><span class="token punctuation">,</span>
      paid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">&apos;Sally Jones&apos;</span><span class="token punctuation">,</span>
      paid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>The store now needs to handle new action types like <code>&apos;HIRE_FARMER&apos;</code> and<br>
<code>&apos;PAY_FARMER&apos;</code> by updating the <code>farmers</code> slice of state. You could add more<br>
cases to your existing reducer, but eventually the existing reducer would become<br>
too large and difficult to manage. The solution is to split the reducer into<br>
separate <code>fruit</code> and <code>farmers</code> reducers.</p>
<p>Splitting up the reducer into multiple reducers handling separate, independent<br>
<em>slices</em> of state is called <strong>reducer composition</strong>, and it&apos;s the fundamental<br>
pattern of building Redux apps. Because each reducer only handles a single<br>
<em>slice</em> of state, its <code>state</code> parameter corresponds only to the part of the<br>
state that it manages and it only responds to actions that concern that slice of<br>
state.</p>
<p>Split up your popular Fruit Stand application&apos;s reducer into two reducers:</p>
<ul>
<li><code>fruitReducer</code> - A reducing function that handles actions updating the<br>
<code>fruits</code> slice of state</li>
<li><code>farmersReducer</code> - A reducing function that handles actions updating the new<br>
<code>farmers</code> slice of state</li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/reducers/fruitReducer.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token constant">ADD_FRUIT</span><span class="token punctuation">,</span>
  <span class="token constant">ADD_FRUITS</span><span class="token punctuation">,</span>
  <span class="token constant">SELL_FRUIT</span><span class="token punctuation">,</span>
  <span class="token constant">SELL_OUT</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_FRUIT</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> action<span class="token punctuation">.</span>fruit<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_FRUITS</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>action<span class="token punctuation">.</span>fruits<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">SELL_FRUIT</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> index <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// remove first instance of action.fruit</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span> <span class="token comment">// if action.fruit is not in state, return previous state</span>
    <span class="token keyword">case</span> <span class="token constant">SELL_OUT</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> fruitReducer<span class="token punctuation">;</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/reducers/farmersReducer.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">HIRE_FARMER</span><span class="token punctuation">,</span> <span class="token constant">PAY_FARMER</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/farmersActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">farmersReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> nextState <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">HIRE_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> farmerToHire <span class="token operator">=</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> action<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> action<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
        paid<span class="token punctuation">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> farmerToHire<span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">PAY_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> farmerToPay <span class="token operator">=</span> nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
      farmerToPay<span class="token punctuation">.</span>paid <span class="token operator">=</span> <span class="token operator">!</span>farmerToPay<span class="token punctuation">.</span>paid<span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> farmersReducer<span class="token punctuation">;</span>
</pre><p>You&apos;ll also need to define a module containing the <code>&apos;HIRE_FARMER&apos;</code> and<br>
<code>&apos;PAY_FARMER&apos;</code> actions:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/actions/farmersActions.js</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">HIRE_FARMER</span> <span class="token operator">=</span> <span class="token string">&apos;HIRE_FARMER&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">PAY_FARMER</span> <span class="token operator">=</span> <span class="token string">&apos;PAY_FARMER&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">hireFarmer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">HIRE_FARMER</span><span class="token punctuation">,</span>
  id<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  name<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">payFarmer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">PAY_FARMER</span><span class="token punctuation">,</span>
  id<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="combining-reducers">Combining reducers</h2>

<p>Your reducer setup is now much more modular. However, <code>createStore</code> only takes<br>
one <code>reducer</code> argument, so you must combine your reducers back into a single<br>
reducer to pass to the store. To do this you&apos;ll use the <code>combineReducers</code> method<br>
from the <code>redux</code> package and pass it an object that maps state keys to the<br>
reducers that handle those slices of state. Below, the <code>combineReducers</code> maps<br>
the <code>fruitReducer</code> for the <code>fruit</code> slice of state and the <code>farmersReducer</code> for<br>
the <code>farmers</code> slice of state. Invoking the <code>combineReducers</code> function returns a<br>
single <code>rootReducer</code> that you can use to create your Redux store.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/reducers/rootReducer.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> combineReducers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> fruitReducer <span class="token keyword">from</span> <span class="token string">&apos;./fruitReducer&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> farmersReducer <span class="token keyword">from</span> <span class="token string">&apos;./farmersReducer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> rootReducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  fruit<span class="token punctuation">:</span> fruitReducer<span class="token punctuation">,</span>
  farmers<span class="token punctuation">:</span> farmersReducer
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> rootReducer<span class="token punctuation">;</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="delegating-to-reducers">Delegating to reducers</h2>

<p>Another aspect of reducer composition involves delegating state updates to<br>
subordinate reducers. Consider the farmers reducer. You can modify it so that<br>
the <code>farmers</code> (plural) reducer delegates to a <code>farmer</code> (singular) reducer<br>
whenever a single farmer&apos;s attributes need to be modified (in this case whenever<br>
a farmer has been hired or paid):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/reducers/farmersReducer.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">HIRE_FARMER</span><span class="token punctuation">,</span> <span class="token constant">PAY_FARMER</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/farmersActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">farmerReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// State is a farmer object.</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">HIRE_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> action<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> action<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
        paid<span class="token punctuation">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">PAY_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> state<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        paid<span class="token punctuation">:</span> <span class="token operator">!</span>state<span class="token punctuation">.</span>paid
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">farmersReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> nextState <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">HIRE_FARMER</span><span class="token punctuation">:</span>
      nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">farmerReducer</span><span class="token punctuation">(</span>undefined<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">PAY_FARMER</span><span class="token punctuation">:</span>
      nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">farmerReducer</span><span class="token punctuation">(</span>nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> farmersReducer<span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="catching-and-preventing-state-mutation-bugs">Catching and preventing state mutation bugs</h3>

<p>Updating the <code>farmersReducer</code> to delegate farmer state updates to the<br>
<code>farmerReducer</code> resolved a subtle state mutation bug. Take another look at the<br>
original implementation of the <code>farmersReducer</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">farmersReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> nextState <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">HIRE_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> farmerToHire <span class="token operator">=</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> action<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> action<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
        paid<span class="token punctuation">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> farmerToHire<span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">PAY_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> farmerToPay <span class="token operator">=</span> nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
      farmerToPay<span class="token punctuation">.</span>paid <span class="token operator">=</span> <span class="token operator">!</span>farmerToPay<span class="token punctuation">.</span>paid<span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Notice that the <code>state</code> parameter is duplicated to the <code>nextState</code> variable<br>
using the <code>Object.assign</code> method:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">let</span> nextState <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>While this code correctly creates a duplicate of the <code>state</code> object, <code>nextState</code><br>
is only a shallow duplicate as only the top-level object is duplicated. Each<br>
&quot;farmer&quot; object that the <code>state</code> object refers to are still the <em>same</em> objects.</p>
<p>In the <code>PAY_FARMER</code> case clause, the farmer object is mutated by setting the<br>
<code>paid</code> property to a new value:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">case</span> <span class="token constant">PAY_FARMER</span><span class="token punctuation">:</span>
  <span class="token keyword">const</span> farmerToPay <span class="token operator">=</span> nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
  farmerToPay<span class="token punctuation">.</span>paid <span class="token operator">=</span> <span class="token operator">!</span>farmerToPay<span class="token punctuation">.</span>paid<span class="token punctuation">;</span>
  <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
</pre><p>Now look again at the <code>PAY_FARMER</code> case clause in the version of the<br>
<code>farmersReducer</code> that delegates farmer state updates to the <code>farmerReducer</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">case</span> <span class="token constant">PAY_FARMER</span><span class="token punctuation">:</span>
  nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">farmerReducer</span><span class="token punctuation">(</span>nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
</pre><p>This code calls the <code>farmerReducer</code> by passing in the farmer object for the<br>
<code>action.id</code> property value (i.e. <code>nextState[action.id]</code>) and the <code>action</code><br>
parameter. The <code>farmerReducer</code> has a <code>PAY_FARMER</code> case clause that correctly<br>
uses the <code>Object.assign</code> method to duplicate the farmer object with the new<br>
<code>paid</code> property value (i.e. <code>Object.assign({}, state, { paid: !state.paid })</code>):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">farmerReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// State is a farmer object.</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">HIRE_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> action<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> action<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
        paid<span class="token punctuation">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">PAY_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> state<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        paid<span class="token punctuation">:</span> <span class="token operator">!</span>state<span class="token punctuation">.</span>paid
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p><strong>Catching state mutation bugs is difficult to do.</strong> Leveraging patterns like<br>
reducer composition can help you from introducing these kinds of bugs in the<br>
first place.</p>
<h2 class="mume-header" id="destructuring-state-in-your-component">Destructuring State in your component</h2>

<p>If you try to start your Fruit Stand app now, you will probably get an error that looks something like:</p>
<pre data-role="codeBlock" data-info class="language-"><code>TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
</code></pre><p>That is because there is one last thing that you need to do in order prepare your fruitstand to use these split reducers: make sure that your component is accessing the right slice of state. Back in your <code>FruitList.js</code> <code>render</code> method, you are currently assigning the return value of your <code>getState()</code> call to &apos;fruit&apos;.</p>
<pre data-role="codeBlock" data-info class="language-"><code>const fruit = store.getState();
</code></pre><p>If you <code>console.log</code> or insert a debugger just after this line to see what fruit has been assigned, you will see:</p>
<pre data-role="codeBlock" data-info class="language-"><code>fruit = {
  fruit: [],
  farmers: {}
}
</code></pre><p>Your state shape changed when you created these reducers! You component is trying to iterate over your new state shape, instead of the fruit slice of that state. To give the component access to the array of fruit, destructure this assignment:</p>
<pre data-role="codeBlock" data-info class="language-"><code>const { fruit } = store.getState();
</code></pre><h2 class="mume-header" id="reviewing-a-completed-fruit-stand-example-2">Reviewing a completed Fruit Stand example</h2>

<p>To review and run a completed Fruit Stand example application that contains<br>
multiple reducers, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the<br>
<code>fruit-stand-redux-with-react-multiple-reducers</code> folder. Run the command <code>npm install</code> to install the project&apos;s dependencies. Then use the command <code>npm start</code><br>
to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the<br>
Create React App tooling. When running the application using <code>npm start</code>, the<br>
application should automatically open in your default browser. If it doesn&apos;t,<br>
you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 class="mume-header" id="what-you-learned-7">What you learned</h2>

<p>In this article, you learned how to define multiple reducers to manage<br>
individual slices of state. You also learned how to use the Redux<br>
<code>combineReducers</code> method to combine multiple reducers into a single root reducer<br>
and how to update a reducer to delegate a state update to a subordinate reducer.</p>
<hr>
<h1 class="mume-header" id="container-components">Container Components</h1>

<p>As you saw in an earlier article, there can be quite a bit of code involved in<br>
connecting a component to the store. Putting all this code into the component<br>
with heavy rendering logic tends to cause bloated components and violates the<br>
principle of <a href="https://en.wikipedia.org/wiki/Separation_of_concerns">separation of concerns</a>.<br>
Therefore, it&apos;s a common pattern in Redux code to separate <strong>presentational<br>
components</strong> from their connected counterparts, called <strong>containers</strong>.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Describe how container components differ from presentational components</li>
<li>Write a container component to handle all of the Redux store interaction for<br>
one or more presentational components</li>
</ul>
<h2 class="mume-header" id="comparing-presentational-and-container-components">Comparing presentational and container components</h2>

<p>The distinction between presentational components and containers is not<br>
technical but rather functional. Presentational components are concerned with<br>
how things look and container components are concerned with how things work.</p>
<p>Here&apos;s a table outlining the differences:</p>
<table>
<thead>
<tr>
<th></th>
<th>Presentational</th>
<th>Container</th>
</tr>
</thead>
<tbody>
<tr>
<td>Purpose</td>
<td>How things look (markup, styles)</td>
<td>How things work (data fetching, state updates)</td>
</tr>
<tr>
<td>Aware of Redux</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>To Read Data</td>
<td>Read data from <code>props</code></td>
<td>Subscribe to Redux state</td>
</tr>
<tr>
<td>To Change Data</td>
<td>Invoke callbacks from <code>props</code></td>
<td>Dispatch Redux actions</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> You&apos;ll start with writing all of the code for your container<br>
components by hand. Later in this lesson, you&apos;ll learn how to create container<br>
components using the <a href="https://react-redux.js.org/">React-Redux</a> library&apos;s <code>connect</code> method.</p>
</blockquote>
<h2 class="mume-header" id="determining-where-to-create-containers">Determining where to create containers</h2>

<p>Not every component needs to be connected to the store. Generally, you&apos;ll only<br>
want to create containers for the &apos;big&apos; components in your app that represent<br>
sections of a page and contain smaller purely functional presentational<br>
components. These larger container components are responsible for interacting<br>
with the store and passing state and dispatch props down to all their<br>
presentational children.</p>
<p>For the Fruit Stand application, a good starting point would be to create two<br>
container components, <code>FruitManagerContainer</code> and <code>FarmerManagerContainer</code>, to<br>
respectively render the presentational components for the &quot;Fruit&quot; and &quot;Farmers&quot;<br>
sections of the page. Here&apos;s a visual representation of that component<br>
hierarchy:</p>
<pre data-role="codeBlock" data-info class="language-"><code>App
&#x251C;&#x2500;&#x2500; FruitManagerContainer
&#x2502;&#xA0;&#xA0; &#x2514;&#x2500;&#x2500; FruitManager
&#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; FruitList
&#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; FruitSeller
&#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; FruitQuickAdd
&#x2502;&#xA0;&#xA0;     &#x2514;&#x2500;&#x2500; FruitBulkAdd
&#x2514;&#x2500;&#x2500; FarmerManagerContainer
 &#xA0;&#xA0; &#x2514;&#x2500;&#x2500; FarmerManager
 &#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; FarmerList
 &#xA0;&#xA0;     &#x2502;   &#x2514;&#x2500;&#x2500; Farmer
 &#xA0;&#xA0;     &#x2514;&#x2500;&#x2500; FarmerHire
</code></pre><p>Notice that the container component names are a combination of the name of the<br>
presentational component that they wrap and the suffix &quot;Container&quot;.</p>
<p>In general, aim to have fewer containers rather than more. Most of the<br>
components you&apos;ll write will be presentational, but you&apos;ll need to generate a<br>
few containers to connect presentational components to the Redux store.</p>
<h2 class="mume-header" id="writing-a-container-component">Writing a container component</h2>

<p>While you can write a container component from scratch, you can also refactor an<br>
existing React component that interacts with a Redux store into separate<br>
container and presentational components.</p>
<h3 class="mume-header" id="using-a-container-component-to-retrieve-state">Using a container component to retrieve state</h3>

<p>Here&apos;s the current version of the <code>FruitList</code> component that subscribes to the<br>
store (using <code>store.subscribe</code>) to know when state has been updated and calls<br>
<code>store.getState</code> to retrieve and render the <code>fruit</code> state slice:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitList.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FruitList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> fruit <span class="token punctuation">}</span> <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>fruit<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span>
          <span class="token operator">?</span> <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span><span class="token punctuation">{</span>fruit<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">fruitName<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>fruitName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
          <span class="token punctuation">:</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>No fruit currently <span class="token keyword">in</span> stock<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitList<span class="token punctuation">;</span>
</pre><p>The <code>FruitManager</code> component is responsible for rendering each of the<br>
fruit-related components (i.e. <code>FruitList</code>, <code>FruitSeller</code>, <code>FruitQuickAdd</code>, and<br>
<code>FruitBulkAdd</code>), so create a container component named <code>FruitManagerContainer</code><br>
to handle all of the store interaction for the &quot;Fruit&quot; section of the page.</p>
<p>To review, here&apos;s what the component hierarchy will look like:</p>
<pre data-role="codeBlock" data-info class="language-"><code>FruitManagerContainer
&#x2514;&#x2500;&#x2500; FruitManager
    &#x251C;&#x2500;&#x2500; FruitList
    &#x251C;&#x2500;&#x2500; FruitSeller
    &#x251C;&#x2500;&#x2500; FruitQuickAdd
    &#x2514;&#x2500;&#x2500; FruitBulkAdd
</code></pre><p>As a starting point, here&apos;s the code for the <code>FruitManagerContainer</code> component:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitManagerContainer.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitManager <span class="token keyword">from</span> <span class="token string">&apos;./FruitManager&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FruitManagerContainer</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> fruit <span class="token punctuation">}</span> <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>FruitManager fruit<span class="token operator">=</span><span class="token punctuation">{</span>fruit<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitManagerContainer<span class="token punctuation">;</span>
</pre><p>Notice that the container component, just like the original version of the<br>
<code>FruitList</code> component, subscribes to the store (using <code>store.subscribe</code>) to know<br>
when state has been updated and calls <code>store.getState</code> to retrieve the <code>fruit</code><br>
state slice. But instead of directly rendering the <code>fruit</code> state, it sets a prop<br>
on the <code>FruitManager</code> component to pass the state down the component hierarchy.</p>
<p>The <code>FruitManager</code> component receives the <code>fruit</code> prop and in turn uses a prop<br>
to pass it down to the <code>FruitList</code> component:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitManager.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitList <span class="token keyword">from</span> <span class="token string">&apos;./FruitList&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitSeller <span class="token keyword">from</span> <span class="token string">&apos;./FruitSeller&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitQuickAdd <span class="token keyword">from</span> <span class="token string">&apos;./FruitQuickAdd&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitBulkAdd <span class="token keyword">from</span> <span class="token string">&apos;./FruitBulkAdd&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">FruitManager</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> fruit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Available Fruit<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitList fruit<span class="token operator">=</span><span class="token punctuation">{</span>fruit<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Fruit Inventory Manager<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitSeller <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitQuickAdd <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitBulkAdd <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitManager<span class="token punctuation">;</span>
</pre><p>And finally, the <code>FruitList</code> component receives the <code>fruit</code> prop and renders it<br>
into an unordered list:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitList.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">FruitList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> fruit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>fruit<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span>
        <span class="token operator">?</span> <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span><span class="token punctuation">{</span>fruit<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">fruitName<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>fruitName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
        <span class="token punctuation">:</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>No fruit currently <span class="token keyword">in</span> stock<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
      <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitList<span class="token punctuation">;</span>
</pre><blockquote>
<p><strong>Reminder:</strong> Using component props to pass a value down the component<br>
hierarchy is known as <em>prop threading</em>.</p>
</blockquote>
<p>Notice that the <code>FruitList</code> <em>presentational</em> component, which no longer needs to<br>
use the <code>componentDidMount</code> and <code>componentWillUnmount</code> lifecycle methods to<br>
subscribe and unsubscribe to the store, can be refactored into a function<br>
component. Additionally, the <code>store</code> is no longer imported in the <code>FruitList</code><br>
module, as the <code>FruitList</code> component simply receives and renders the <code>fruit</code><br>
state via a prop without any knowledge of or direct interaction with the store.</p>
<h3 class="mume-header" id="using-a-container-component-to-dispatch-actions">Using a container component to dispatch actions</h3>

<p>Here&apos;s the current version of the <code>FruitQuickAdd</code> component that dispatches the<br>
<code>ADD_FRUIT</code> action to add a fruit to the fruit stand:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitQuickAdd.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> addFruit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FruitQuickAdd</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">addFruitClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fruit <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerText<span class="token punctuation">;</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>Quick Add<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addFruitClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token constant">APPLE</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addFruitClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token constant">ORANGE</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>  
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitQuickAdd<span class="token punctuation">;</span>
</pre><p>To prepare to refactor the <code>FruitQuickAdd</code> component into a <em>presentational</em><br>
component, update the <code>FruitManagerContainer</code> component to the following code:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitManagerContainer.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> addFruit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitManager <span class="token keyword">from</span> <span class="token string">&apos;./FruitManager&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FruitManagerContainer</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> fruit <span class="token punctuation">}</span> <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>FruitManager
        fruit<span class="token operator">=</span><span class="token punctuation">{</span>fruit<span class="token punctuation">}</span>
        add<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitManagerContainer<span class="token punctuation">;</span>
</pre><p>Notice that the <code>addFruit</code> action creator is imported (at the top of the file)<br>
and a new component method named <code>add</code> receives a <code>fruit</code> parameter value and<br>
calls <code>store.dispatch</code> to dispatch a <code>ADD_FRUIT</code> action. The <code>render</code> method<br>
sets a prop on the <code>FruitManager</code> component to pass the <code>add</code> method down the<br>
component hierarchy.</p>
<p>The <code>FruitManager</code> component receives the <code>add</code> prop and in turn uses a prop to<br>
pass it down to the <code>FruitQuickAdd</code> component:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitManager.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitList <span class="token keyword">from</span> <span class="token string">&apos;./FruitList&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitSeller <span class="token keyword">from</span> <span class="token string">&apos;./FruitSeller&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitQuickAdd <span class="token keyword">from</span> <span class="token string">&apos;./FruitQuickAdd&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitBulkAdd <span class="token keyword">from</span> <span class="token string">&apos;./FruitBulkAdd&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">FruitManager</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> fruit<span class="token punctuation">,</span> add <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Available Fruit<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitList fruit<span class="token operator">=</span><span class="token punctuation">{</span>fruit<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Fruit Inventory Manager<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitSeller <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitQuickAdd add<span class="token operator">=</span><span class="token punctuation">{</span>add<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitBulkAdd <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitManager<span class="token punctuation">;</span>
</pre><p>And finally, the <code>FruitQuickAdd</code> component receives the <code>add</code> callback function<br>
via a prop and calls it within a <code>handleClick</code> event handler, passing in the<br>
target button&apos;s inner text:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitQuickAdd.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">FruitQuickAdd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> add <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">add</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerText<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>Quick Add<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token constant">APPLE</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token constant">ORANGE</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>  
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitQuickAdd<span class="token punctuation">;</span>
</pre><p>The change between the original and refactored <code>FruitQuickAdd</code> component isn&apos;t<br>
as dramatic as the <code>FruitList</code> component example, but it&apos;s still a significant<br>
improvement to the overall separation of concerns. The <code>FruitQuickAdd</code> component<br>
is now strictly concerned with rendering the UI and handling user generated<br>
events (i.e. button clicks) and the <code>FruitManagerContainer</code> component is now<br>
strictly concerned with interacting with the Redux store.</p>
<h3 class="mume-header" id="reviewing-the-completed-container-component">Reviewing the completed container component</h3>

<p>The <code>FruitManagerContainer</code> <em>container</em> component can continue to be expanded<br>
until each of its child <em>presentational</em> components no longer interact directly<br>
with the store. Here&apos;s a look at the completed <code>FruitManagerContainer</code><br>
component:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitManagerContainer.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> addFruit<span class="token punctuation">,</span> addFruits<span class="token punctuation">,</span> sellFruit<span class="token punctuation">,</span> sellOut <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitManager <span class="token keyword">from</span> <span class="token string">&apos;./FruitManager&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FruitManagerContainer</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">addBulk</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruits</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">sell</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">sellFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">sellAll</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">sellOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> fruit <span class="token punctuation">}</span> <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> distinctFruit <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>FruitManager
        fruit<span class="token operator">=</span><span class="token punctuation">{</span>fruit<span class="token punctuation">}</span>
        distinctFruit<span class="token operator">=</span><span class="token punctuation">{</span>distinctFruit<span class="token punctuation">}</span>
        add<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">}</span>
        addBulk<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addBulk<span class="token punctuation">}</span>
        sell<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>sell<span class="token punctuation">}</span>
        sellAll<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>sellAll<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitManagerContainer<span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="reviewing-a-completed-fruit-stand-example-3">Reviewing a completed Fruit Stand example</h2>

<p>To review and run a completed Fruit Stand example application that utilizes<br>
containers, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the<br>
<code>fruit-stand-redux-with-react-containers</code> folder. Run the command <code>npm install</code><br>
to install the project&apos;s dependencies. Then use the command <code>npm start</code> to run<br>
the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the<br>
Create React App tooling. When running the application using <code>npm start</code>, the<br>
application should automatically open in your default browser. If it doesn&apos;t,<br>
you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 class="mume-header" id="what-you-learned-8">What you learned</h2>

<p>In this article, you learned how container components differ from presentational<br>
components. You also learned how to write a container component to handle all of<br>
the Redux store interaction for one or more presentational components.</p>
<hr>
<h1 class="mume-header" id="freezing-objects">Freezing Objects</h1>

<p>As you learned earlier in this lesson, a reducer must never mutate its<br>
arguments. If the state changes, the reducer must return a new object.</p>
<p>JavaScript provides us with an easy way to enforce this.<br>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze"><code>Object.freeze</code></a> prevents new properties from being added to an<br>
object, and also prevents properties currently on an object from being altered<br>
or deleted. Essentially, it renders an object immutable, which is exactly what<br>
you want.</p>
<p>When you finish this article, you should be able to use <code>Object.freeze</code> to<br>
prevent the current state within a reducer from being mutated.</p>
<h2 class="mume-header" id="using-objectfreeze-to-prevent-state-mutations">Using <code>Object.freeze</code> to prevent state mutations</h2>

<p>By calling <code>Object.freeze(state)</code> at the top of every reducer, you can ensure<br>
that the state is never accidentally mutated. For example, this is what your<br>
farmer reducer from the Fruit Stand application would look like:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">farmersReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> nextState <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">HIRE_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> farmerToHire <span class="token operator">=</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> action<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> action<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
        paid<span class="token punctuation">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> farmerToHire<span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">PAY_FARMER</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> farmerToPay <span class="token operator">=</span> nextState<span class="token punctuation">[</span>action<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
      farmerToPay<span class="token punctuation">.</span>paid <span class="token operator">=</span> <span class="token operator">!</span>farmerToPay<span class="token punctuation">.</span>paid<span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now you can be certain that you won&apos;t accidentally mutate the state within the<br>
reducer.</p>
<h3 class="mume-header" id="understanding-the-difference-between-deep-and-shallow-freezes">Understanding the difference between deep and shallow freezes</h3>

<p>Here&apos;s another example:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token punctuation">{</span> farmers<span class="token punctuation">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&apos;Old MacDonald&apos;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span>people<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>When you try to mutate an object that you <em>froze</em> by modifying a property, it<br>
will be prevented:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">people<span class="token punctuation">.</span>farmers <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&apos;Young MacDonald&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
people<span class="token punctuation">;</span> <span class="token comment">// { farmers: { name: &apos;Old MacDonald&apos; } }</span>
</pre><p><strong>Note: This is not a <em>deep freeze</em>.</strong> <code>Object.freeze</code> performs a <em>shallow<br>
freeze</em> as it only applies to the immediate properties of the object itself.<br>
Nested objects can still be mutated, so be careful. Here&apos;s an example of this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">people<span class="token punctuation">.</span>farmers<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&apos;Young MacDonald&apos;</span><span class="token punctuation">;</span>
people<span class="token punctuation">;</span> <span class="token comment">// { farmers: { name: &apos;Young MacDonald&apos; } }</span>
</pre><h3 class="mume-header" id="objectfreeze-and-arrays"><code>Object.freeze</code> and arrays</h3>

<p>You can also use <code>Object.freeze</code> to freeze an array, so if a reducer&apos;s <code>state</code><br>
parameter is an array, you can still prevent accidental state mutations:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_FRUIT</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> action<span class="token punctuation">.</span>fruit<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_FRUITS</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token operator">...</span>action<span class="token punctuation">.</span>fruits<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token constant">SELL_FRUIT</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> index <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// remove first instance of action.fruit</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span>state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span> <span class="token comment">// if action.fruit is not in state, return previous state</span>
    <span class="token keyword">case</span> <span class="token constant">SELL_OUT</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>When an array is frozen with <code>Object.freeze</code>, its elements cannot be altered and<br>
no elements can be added to or removed from the array. Just like with objects,<br>
freezing arrays has limitations. If the array&apos;s elements containing objects,<br>
properties on those objects can still be mutated.</p>
<h2 class="mume-header" id="what-you-learned-9">What you learned</h2>

<p>In this article, you learned how to use <code>Object.freeze</code> to prevent the current<br>
state within a reducer from being mutated.</p>
<hr>
<h1 class="mume-header" id="preloaded-state">Preloaded State</h1>

<p>Currently, when the page in the browser is reloaded, any state data stored in<br>
the Redux store is lost. Later in this lesson, you&apos;ll learn how to use Redux to<br>
interact with an API to persist state data. Until then (or if your React<br>
application doesn&apos;t use an API), you can use the combination of Redux&apos;s ability<br>
to create a store with <em>preloaded state</em> with the browser&apos;s local storage to<br>
persist store state across page reloads.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Create a Redux store with preloaded state</li>
<li>Use the browser&apos;s local storage to persist a Redux store&apos;s state across page<br>
reloads</li>
</ul>
<h2 class="mume-header" id="creating-a-store-with-preloaded-state">Creating a store with preloaded state</h2>

<p>So far, your Redux stores have initialized with no initial state. Sometimes,<br>
though, you may want to take pre-existing data and pass it into the store upon<br>
initialization. Such data can be passed to the <code>createStore</code> method using the<br>
<code>preloadedState</code> argument:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> preloadedState <span class="token operator">=</span> <span class="token punctuation">{</span>
  fruit<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&apos;APPLE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;ORANGE&apos;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  farmers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">&apos;John Smith&apos;</span><span class="token punctuation">,</span>
      paid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">&apos;Sally Jones&apos;</span><span class="token punctuation">,</span>
      paid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">,</span> preloadedState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>A couple of things to note about preloading state:</p>
<ul>
<li>The <code>preloadedState</code> must match the state shape (as produced by the reducers).</li>
<li><code>preloadedState</code> is not the same as default state. Default state should always<br>
be set in your reducers themselves.</li>
</ul>
<h2 class="mume-header" id="creating-local-storage-helper-functions">Creating local storage helper functions</h2>

<p>To assist with using the browser&apos;s local storage to persist a Redux store&apos;s<br>
state across page reloads, start with creating a set of helper functions:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// localStorage.js</span>

<span class="token keyword">const</span> <span class="token constant">STATE_KEY</span> <span class="token operator">=</span> <span class="token string">&apos;fruitstand&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">loadState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> stateJSON <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token constant">STATE_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>stateJSON <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> undefined<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>stateJSON<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> undefined<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">saveState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> stateJSON <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token constant">STATE_KEY</span><span class="token punctuation">,</span> stateJSON<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>The <code>saveState</code> function is responsible for converting the <code>state</code> parameter<br>
value into JSON (using the <code>JSON.stringify</code> method) and saving the state JSON<br>
string to the browser&apos;s local storage (using the <code>localStorage.setItem</code> method).<br>
A <code>try...catch</code> statement is used to catch and log any errors.</p>
<p>The <code>loadState</code> function is responsible for loading the state JSON from the<br>
browser&apos;s local storage (using the <code>localStorage.getItem</code> method). If the state<br>
JSON isn&apos;t stored in local storage, <code>undefined</code> is returned so the store&apos;s<br>
reducer function can initialize the state to its default value. If the state<br>
JSON is successfully retrieved from local storage, it&apos;s parsed into JavaScript<br>
objects (using the <code>JSON.parse</code> method) and returned to the caller. A<br>
<code>try...catch</code> statement is used to catch and log any errors.</p>
<h2 class="mume-header" id="saving-state-to-local-storage">Saving state to local storage</h2>

<p>To ensure that the persisted state in local storage doesn&apos;t get out of sync with<br>
the store, you want to persist the state whenever it&apos;s updated. Knowing that the<br>
store&apos;s reducer is called whenever there&apos;s an action dispatched to update the<br>
state, you might be tempted to update your reducer like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token constant">ADD_FRUIT</span><span class="token punctuation">,</span>
  <span class="token constant">ADD_FRUITS</span><span class="token punctuation">,</span>
  <span class="token constant">SELL_FRUIT</span><span class="token punctuation">,</span>
  <span class="token constant">SELL_OUT</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> saveState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../localStorage&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_FRUIT</span><span class="token punctuation">:</span>
      <span class="token keyword">const</span> nextState <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">,</span> action<span class="token punctuation">.</span>fruit<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token function">saveState</span><span class="token punctuation">(</span>nextState<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Persist state data to local storage</span>
      <span class="token keyword">return</span> nextState<span class="token punctuation">;</span>

    <span class="token comment">// Case clauses removed for brevity.</span>

    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> fruitReducer<span class="token punctuation">;</span>
</pre><p><strong>But don&apos;t do this!</strong> Per the <a href="https://redux.js.org/basics/reducers#handling-actions">official Redux docs on<br>
reducers</a>, reducers should stay <em>pure</em> and<br>
not cause <em>side effects</em> (like calling APIs or persisting data to local<br>
storage).</p>
<p>To keep your reducers pure, handle persisting state to local storage in the<br>
module where you create your store (<code>store.js</code>) by subscribing to listen for<br>
state changes:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> saveState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./localStorage&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>

store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">saveState</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</pre><p>Now whenever the store&apos;s state is updated, the <code>store.getState</code> method is called<br>
to get and pass the current state to the <code>saveState</code> method.</p>
<h2 class="mume-header" id="loading-state-from-local-storage">Loading state from local storage</h2>

<p>Now that you&apos;re persisting state to local storage, you can load state from local<br>
storage and pass it to the <code>createStore</code> method as preloaded state:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> loadState<span class="token punctuation">,</span> saveState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./localStorage&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> preloadedState <span class="token operator">=</span> <span class="token function">loadState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">,</span> preloadedState<span class="token punctuation">)</span><span class="token punctuation">;</span>

store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">saveState</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</pre><p>With these updates in place, your Redux store&apos;s state will persist across page<br>
reloads.</p>
<h2 class="mume-header" id="what-you-learned-10">What you learned</h2>

<p>In this article, you learned how to create a Redux store with preloaded state.<br>
You also learned how to use the browser&apos;s local storage to persist a Redux<br>
store&apos;s state across page reloads.</p>
<hr>
<h1 class="mume-header" id="react-and-redux-to-do-list-project">React and Redux To-Do List Project</h1>

<p>Today you&apos;ll be building a to-do list application with React and local storage.<br>
Instead of using Context to manage and update your application&apos;s state, you&apos;ll<br>
set up a Redux store and interact with it using the store&apos;s <code>getState</code>,<br>
<code>dispatch</code>, and <code>subscribe</code> methods.</p>
<p>This project will also give you a better understanding of how to share and<br>
update &quot;global&quot; data across a React application by using Redux. You&apos;ll use Redux<br>
to dispatch action POJOs through a reducer function, and have your component<br>
access an updated version of the Redux store&apos;s state.</p>
<p>In this project, you will:</p>
<ul>
<li>Generate a Redux store to manage your application&apos;s global information</li>
<li>Define functions to save and load the Redux store&apos;s state with local storage</li>
<li>Generate a Redux <strong>store</strong> with a preloaded state from local storage by using<br>
the <code>createStore</code> method from the Redux library</li>
<li>Set up a <strong>reducer</strong> to direct different action types to interact with the<br>
Redux store in different ways</li>
<li>Set up <strong>actions</strong> to create a task and delete a task</li>
<li>Use a <code>debugger</code> to investigate the state from within a component</li>
</ul>
<h2 class="mume-header" id="phase-1-set-up-project-and-redux-store">Phase 1: Set up project and Redux store</h2>

<p>Begin by cloning the starter project from<br>
<a href="https://github.com/appacademy-starters/react-redux-todo-list-starter">https://github.com/appacademy-starters/react-redux-todo-list-starter</a>.</p>
<p>Take a moment to examine the project&apos;s file tree below. In the next few phases,<br>
you&apos;ll follow the <code>TODO</code> notes in each file to implement Redux into your React<br>
project.</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">&#x251C;&#x2500;&#x2500; package-lock.json
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x2514;&#x2500;&#x2500; src
    &#x251C;&#x2500;&#x2500; App.js
    &#x251C;&#x2500;&#x2500; actions
    &#x2502;   &#x2514;&#x2500;&#x2500; taskActions.js
    &#x251C;&#x2500;&#x2500; components
    &#x2502;   &#x251C;&#x2500;&#x2500; Task.js
    &#x2502;   &#x251C;&#x2500;&#x2500; TodoForm.js
    &#x2502;   &#x2514;&#x2500;&#x2500; TodoList.js
    &#x251C;&#x2500;&#x2500; index.js
    &#x251C;&#x2500;&#x2500; localStorage.js
    &#x251C;&#x2500;&#x2500; reducers
    &#x2502;   &#x2514;&#x2500;&#x2500; tasksReducer.js
    &#x2514;&#x2500;&#x2500; store.js
</pre><h3 class="mume-header" id="local-storage">Local storage</h3>

<p>Let&apos;s start by setting up some functions in the <code>localStorage.js</code> file to save<br>
and load the Redux store&apos;s state with local storage!</p>
<p>In the <code>loadState</code> function, you&apos;ll want to access the stored tasks state from<br>
local storage by using the <code>localStorage.getItem</code> method. If there is no state<br>
found, return <code>undefined</code>. However, if the state was found, parse the state from<br>
JSON into JavaScript and return the parsed state. If any errors were caught, log<br>
the errors with a <code>console.warn</code> statement and have the function return<br>
<code>undefined</code>.</p>
<p>In the <code>saveState</code> function, you&apos;ll want to parse the <code>state</code> input from<br>
JavaScript into a JSON string. When you call the <code>saveState</code> function, you&apos;ll<br>
invoke the function with the Redux store&apos;s state accessed with the<br>
<code>store.getState</code> method. After parsing the state from JavaScript into a JSON<br>
string, set the string into local storage. Lastly, you&apos;ll want to catch any<br>
errors with a <code>console.warn</code> statement.</p>
<h3 class="mume-header" id="generate-applications-redux-store">Generate application&apos;s Redux store</h3>

<p>Now that you&apos;ve set up some functions to handle accessing and storing the data<br>
with local storage, you&apos;ll want to use those functions in the <code>store.js</code> file.<br>
In this file, you&apos;ll use Redux&apos;s <code>createStore</code> function to set up your<br>
application&apos;s Redux <code>store</code>. As a reminder, the <code>createStore</code> function takes in<br>
a reducer as its first argument, and an optional preloaded state, also referred<br>
to as <em>initial</em> state, as its second argument.</p>
<p>Use the <code>loadState</code> function you just defined to access the <code>preloadedState</code>.<br>
Now you&apos;ll invoke the <code>createStore</code> function with the <code>tasksReducer</code> and the<br>
<code>preloadedState</code> to generate the application&apos;s Redux store.</p>
<p>You&apos;ll want your application to update local storage and log the state whenever<br>
there an update to the store - this means you&apos;ll want your application to listen<br>
for changes to the store with the <code>store.subscribe</code> method and then update local<br>
storage with the <code>saveState</code> function and <code>console.log</code> the state upon any<br>
change.</p>
<h2 class="mume-header" id="phase-2-actions-and-reducers">Phase 2: Actions and reducers</h2>

<p>Now that you have your application&apos;s Redux store set up, it&apos;s time to define<br>
some action creator functions and reducers! You&apos;ll define action creator<br>
functions in the <code>taskActions.js</code> file and set up corresponding case statements<br>
for each action type in the <code>tasksReducer.js</code> file.</p>
<h3 class="mume-header" id="define-action-creator-functions">Define action creator functions</h3>

<p>As a reminder, it is best practice to use constants for action types, instead of<br>
string literals, to ensure that errors will be thrown for typos. Start by<br>
defining constants for your action types: <code>CREATE_TASK</code> and <code>DELETE_TASK</code>.</p>
<p>Once you have the constants set up, it&apos;s time to define an action creator<br>
function for each action type! Start by thinking of what payload information you<br>
want your action POJOs to pass into the reducer function.</p>
<p>Define a <code>createTask</code> action creator function that returns actions of type<br>
<code>CREATE_TASK</code>. You&apos;ll want <code>type</code>, <code>taskId</code>, and <code>taskMessage</code> payload keys for<br>
each <code>CREATE_TASK</code> action POJO. Have the action creator function take in a<br>
<code>taskMessage</code> and auto-generate the <code>taskId</code>. You can set the <code>taskId</code> to a<br>
time-string that is set when the action creator function is invoked. Generate a<br>
new <code>Date</code> object and get its time-string with <code>new Date().getTime()</code>. Set the<br>
time-string to the <code>taskId</code> payload key and the <code>taskMessage</code> input to the<br>
<code>taskMessage</code> payload key.</p>
<p>Now you&apos;ll want to define the <code>deleteTask</code> action creator function to return<br>
actions of type <code>DELETE_TASK</code>. You&apos;ll want the action creator function to take<br>
in a <code>taskId</code>. Each <code>DELETE_TASK</code> action POJO should have a <code>type</code> property and<br>
a <code>taskId</code> payload key.</p>
<h3 class="mume-header" id="define-tasks-reducer-function">Define tasks reducer function</h3>

<p>The next step is to finish implementing the <code>tasksReducer</code>! Begin by freezing<br>
the <code>state</code> with <code>Object.freeze(state);</code> so that you won&apos;t accidentally mutate<br>
the state. As a reminder, Redux follows the immutable state pattern, meaning<br>
that a reducer function should never directly mutate state. After freezing the<br>
state, import <code>CREATE_TASK</code> and <code>DELETE_TASK</code> string literal constants and set<br>
up a switch statement to evaluate a case statement based on each <code>action.type</code>.</p>
<p>In the <code>CREATE_TASK</code> case, you&apos;ll want to make a copy of the state, structure a<br>
<code>newTask</code> POJO, and add the <code>newTask</code> into the copy of the state before<br>
returning the copy. Define a <code>nextState</code> variable and use spread syntax (<code>...</code>)<br>
to make a copy of the state (<code>{ ...state }</code>). Next, you&apos;ll want to structure the<br>
<code>newTask</code> POJO to have an <code>id</code> property set to the action&apos;s <code>taskId</code> payload and<br>
a <code>message</code> property set to the action&apos;s <code>taskMessage</code> payload.</p>
<p>Once you have finished structuring the <code>newTask</code> POJO, key into the <code>nextState</code><br>
with the new task ID and set the value of <code>nextState[newTask.id]</code> to the<br>
<code>newTask</code>. Alternatively, you could use the <code>taskId</code> payload and set the value<br>
of <code>nextState[action.taskId]</code> to the <code>newTask</code> (this will also accomplish what<br>
we want, which is to set up a <code>nextState</code> with keys that are task IDs and values<br>
that are task POJOs). At the end of the <code>CREATE_TASK</code> case statement, return the<br>
updated <code>nextState</code>.</p>
<p>In the <code>DELETE_TASK</code> case, you&apos;ll also want to make a copy of the state<br>
(<code>{...state }</code>). Set the copy of the state to a <code>stateWithDeletion</code> variable.<br>
Since your <code>DELETE_TASK</code> actions have a <code>taskId</code> payload, you can use<br>
JavaScript&apos;s <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/delete">delete</a> operator to delete a specific key-value pair from the<br>
<code>stateWithDeletion</code> object, based on the <code>taskId</code> payload:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">delete</span> stateWithDeletion<span class="token punctuation">[</span>action<span class="token punctuation">.</span>taskId<span class="token punctuation">]</span><span class="token punctuation">;</span>
</pre><p>The last thing left in your <code>DELETE_TASK</code> statement is to return the updated<br>
<code>stateWithDeletion</code>! If you compare your initial definition of the <code>nextState</code><br>
and <code>stateWithDeletion</code> variables, you&apos;ll see that they are both copies of the<br>
<code>state</code> made with spread syntax. Move the <code>nextState</code> variable outside of the<br>
<code>switch</code> statement so that both <code>case</code> statements can reference and update the<br>
<code>nextState</code>, instead of the <code>DELETE_TASK</code> case statement creating a new copy of<br>
the state and updating it.</p>
<h2 class="mume-header" id="phase-3-dispatch-actions-from-the-devtools-console">Phase 3: Dispatch actions from the DevTools console</h2>

<p>Now you can test whether you can actually create a task by using the<br>
<code>store.dispatch</code> method to dispatch the <code>CREATE_TASK</code> action. As a reminder,<br>
dispatching the action will &quot;send&quot; it through the reducer to determine what<br>
operation to perform based on the action&apos;s <code>type</code> property. Take a moment to go<br>
into your <code>index.js</code> file and import your application&apos;s Redux <code>store</code> and action<br>
creator functions:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createTask<span class="token punctuation">,</span> deleteTask <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./actions/taskActions&apos;</span><span class="token punctuation">;</span>
</pre><p>Now that you&apos;ve had the store and actions imported into the file, you can set<br>
them as properties to the <code>window</code> object, so that you can access the <code>store</code><br>
and actions from the developer tools console.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">window<span class="token punctuation">.</span>store <span class="token operator">=</span> store<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>createTask <span class="token operator">=</span> createTask<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>deleteTask <span class="token operator">=</span> deleteTask<span class="token punctuation">;</span>
</pre><p>At this point, your <code>index.js</code> file should look something like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&apos;./App&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createTask<span class="token punctuation">,</span> deleteTask <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./actions/taskActions&apos;</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span>store <span class="token operator">=</span> store<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>createTask <span class="token operator">=</span> createTask<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>deleteTask <span class="token operator">=</span> deleteTask<span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;root&apos;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Open up your browser&apos;s DevTools console and type <code>window.store</code>. Now you should<br>
see the <code>store</code> object and its methods: <code>{dispatch: &#x192;, subscribe: &#x192;, getState: &#x192;, replaceReducer: &#x192;, Symbol(observable): &#x192;}</code>,</p>
<p>Now type <code>window.store.getState()</code>. You should see an empty object - this is the<br>
default state (<code>state = {}</code>) that you set up in the <code>tasksReducer</code>.</p>
<p>Since you can access your application&apos;s state from the DevTools console, that<br>
means you can also dispatch actions by invoking the <code>window.store.dispatch</code><br>
method with an action:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">window<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;learn redux&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>You just dispatched a <code>CREATE_TASK</code> action! You&apos;ll see that your updated state<br>
was logged - this is because of the <code>console.log</code> statement in the<br>
<code>store.subscribe</code> invocation in your <code>index.js</code> file (as you might remember, the<br>
<code>store.subscribe</code> method listens for any updates to the store, i.e. dispatch<br>
calls). Dispatch another <code>CREATE_TASK</code> action:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">window<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;learn react hooks&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now if you type <code>window.store.getState()</code> again, you&apos;ll see that the state<br>
return from the <code>store.getState</code> method is the same plain old JavaScript object<br>
as the state that was logged within the <code>store.subscribe</code> invocation.</p>
<p>Now let&apos;s place some <code>debugger</code> statements in the <code>tasksReducer</code> and<br>
<code>createTask</code> action creator function! Remember to make sure the <code>debugger</code><br>
statement in your <code>tasksReducer</code> is <strong>inside</strong> a case statement. If the<br>
<code>debugger</code> is between the switch statement and a case statement, you will never<br>
hit that breakpoint!</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">tasksReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">:</span>
      <span class="token keyword">debugger</span><span class="token punctuation">;</span>
    <span class="token comment">// CODE SHORTENED FOR BREVITY</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">taskMessage</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">debugger</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token constant">CREATE_TASK</span><span class="token punctuation">,</span>
    taskId<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    taskMessage<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now dispatch another <code>CREATE_TASK</code> action to hit the two <code>debugger</code> statements<br>
you just set:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">window<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">createTask</span><span class="token punctuation">(</span><span class="token string">&apos;work on self-care&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Notice how you are now in the <code>Sources</code> tab of your DevTools looking at the<br>
<code>taskActions.js</code> file in your project. You can view the value of the<br>
<code>taskMessage</code> argument by hovering over the variable or looking at the local<br>
scope variables in the DevTools&apos; right window.</p>
<p><img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/redux/assets/react-redux-to-do-list-devtools-1.png" alt="devtools-taskActions"></p>
<p>If you click the blue play button to continue to the next <code>debugger</code> statement,<br>
you&apos;ll land in your <code>tasksReducer.js</code> file and be able to hover over the <code>state</code><br>
to view the value of the Redux store&apos;s previous state <strong>before</strong> the dispatching<br>
of the <code>CREATE_TASK</code> action.</p>
<p><img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/redux/assets/react-redux-to-do-list-devtools-2.png" alt="devtools-tasksReducer"></p>
<p>Now if you click the blue play button to continue, you&apos;ll exit out of debug mode<br>
and your updated state will be logged in the console.</p>
<p>Congratulations! You just used a <code>debugger</code> to follow the Redux flow of<br>
dispatching a <code>CREATE_TASK</code> action! Comment out your <code>debugger</code> statements for<br>
now. In the next phase, you&apos;ll work on dispatching actions through a user<br>
interface.</p>
<h2 class="mume-header" id="phase-4-dispatch-actions-from-components">Phase 4: Dispatch actions from components</h2>

<p>Now it&apos;s time to set up a user interface that allows for intuitive dispatching<br>
of actions. In the <code>TodoForm</code> component, you&apos;ll set up a button that invokes the<br>
<code>createTask</code> action creator function with the <code>inputValue</code> state to dispatch a<br>
<code>CREATE_TASK</code> action based on the form input! For each <code>Task</code> component, you&apos;ll<br>
set up a button to dispatch a <code>DELETE_TASK</code> action for that task.</p>
<h3 class="mume-header" id="todoform">TodoForm</h3>

<p>In the <code>TodoForm.js</code> file, import your application&apos;s Redux <code>store</code> instance and<br>
the <code>createTask</code> action creator function. Now you&apos;ll want to finish the<br>
<code>handleSubmit</code> method so that it dispatches a <code>CREATE_TASK</code> action. Invoke the<br>
<code>createTask</code> action creator function with the <code>inputValue</code> state and the<br>
<code>store.dispatch</code> method with the invoked action creator function.</p>
<p>Take a moment to test out the dispatch call generated by your form submission.<br>
Type a task in the input field - when you submit, you should see an updated<br>
state logged in the DevTools console with your new task!</p>
<h3 class="mume-header" id="todolist">TodoList</h3>

<p>In the <code>TodoList.js</code> file, import the application&apos;s Redux <code>store</code> instance and<br>
the <code>deleteTask</code> action creator function. Now you&apos;ll set up the component&apos;s<br>
<code>componentDidMount</code> and <code>componentDidUnmount</code> life-cycle methods.</p>
<p>In the <code>componentDidMount</code> method, use the store&apos;s <code>subscribe</code> method to force a<br>
component to update whenever the state changes:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>You want to name the subscription as <code>this.unsubscribe</code>, so that you can<br>
unsubscribe upon the unmounting of a component. When the <code>componentDidMount</code><br>
life-cycle method is invoked upon the mounting of a component, it will invoke<br>
the <code>store.subscribe</code> method to force the component to update whenever the<br>
store&apos;s state changes. It will also set a <code>this.unsubscribe</code> variable to the<br>
<code>TodoList</code> class, so that <code>this.unsubscribe</code> is accessible from other parts of<br>
the component&apos;s code.</p>
<p>In the <code>componentDidUnmount</code> method, you&apos;ll want to check if the component has<br>
mounted by checking if <code>this.unsubscribe</code> has been defined. Whenever a component<br>
mounts, the <code>this.unsubscribe</code> variable set in the <code>componentDidMount</code> method<br>
will become initialize. If <code>this.unsubscribe</code> is undefined, that means that the<br>
component has not invoked the <code>componentDidMount</code> method and has therefore not<br>
been mounted yet. If <code>this.unsubscribe</code> is defined, you&apos;ll want to invoke<br>
<code>this.unsubscribe</code> to have the component unsubscribe from changes once component<br>
unmounts:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>In the <code>deleteTask</code> method, you&apos;ll want to wrap the invocation of the<br>
<code>deleteTask</code> action creator function with the <code>store.dispatch</code> method. The<br>
<code>deleteTask</code> action creator function will be invoked based on the<br>
<code>this.deleteTask</code> method&apos;s <code>id</code> input. Later in this phase, you&apos;ll pass the<br>
<code>TodoList</code> component&apos;s <code>this.deleteTask</code> method as a <code>deleteTask</code> prop into each<br>
<code>Task</code> component. Then, whenever the <code>deleteTask</code> prop is invoked from within a<br>
<code>Task</code> component, it can simply be invoked with a task ID to dispatch a<br>
<code>DELETE_TASK</code> action without needing to import the <code>store</code> into each <code>Task</code><br>
component to invoke <code>store.dispatch</code></p>
<p>In the component&apos;s <code>render</code> method, access the tasks stored in the Redux store&apos;s<br>
state by invoking the <code>store.getState</code> method and saving its return value to a<br>
<code>tasksState</code> variable. Now that you can use a <code>debugger</code> statement to view the<br>
state and check out what data you are working with!</p>
<p>If there are no tasks stored in state, you&apos;ll want to have the <code>TodoList</code><br>
component return <code>null</code>. Otherwise if there are tasks stored in state, render a<br>
<code>Task</code> component for each of the tasks. For each <code>Task</code> component, you&apos;ll want<br>
to use the task&apos;s ID as the <code>key</code> and pass two props: the <code>task</code> object and the<br>
<code>this.deleteTask</code> method as a <code>deleteTask</code> prop.</p>
<h3 class="mume-header" id="task">Task</h3>

<p>Have the <code>Task</code> function component destructure and take in the <code>deleteTask</code><br>
method and <code>task</code> object props. Invoke the <code>deleteTask</code> function passed as a<br>
prop in the <code>Task</code> component&apos;s <code>handleClick</code> method and replace the <code>Hi, I&apos;m a task in your to-do list!</code> placeholder text with the <code>task.message</code>.</p>
<p>As a reminder, the <code>deleteTask</code> action creator function was already wrapped with<br>
a <code>store.dispatch</code> call in the <code>TodoList</code> component - this is why the<br>
<code>handleClick</code> function in the <code>Task</code> component does not include a<br>
<code>store.dispatch</code> invocation. The <code>TodoList</code> component passed the wrapped<br>
function as a prop named <code>deleteTask</code> to each <code>Task</code> component. The <code>deleteTask</code><br>
function invoked in the <code>Task</code> component&apos;s <code>handleClick</code> function is the<br>
<code>TodoList</code> component&apos;s <code>deleteTask</code> <strong>method</strong>, not the <code>deleteTask</code> <strong>action<br>
creator function</strong>.</p>
<h2 class="mume-header" id="phase-5-implement-a-full-redux-cycle">Phase 5: Implement a full Redux cycle</h2>

<p>In this phase, you&apos;ll implement a full Redux cycle without the guidance of<br>
<code>TODO</code> notes or specific, written instructions. Remember, the <code>debugger</code><br>
statement is your friend! If you get stuck, think of where you can place<br>
<code>debugger</code> statements to gain more context about your code. As a general<br>
guideline, feel free to follow the steps below:</p>
<ul>
<li>Set up an action creator function for a <code>RESET_TASK_LIST</code> action</li>
<li>Set up a reducer case statement for the <code>RESET_TASK_LIST</code> action type</li>
<li>Create a user interface (button) to dispatch the <code>RESET_TASK_LIST</code> action</li>
</ul>
<p>Congratulations! You have just created an application that uses Redux to manage<br>
the application&apos;s information. Give yourself a pat on the back! As a reminder,<br>
the Redux library is a highly conceptual library to pick up, and when learning<br>
anything new practice always makes perfect! If the implementation of Redux feels<br>
confusing, always feel free to step back and use a <code>debugger</code> statement to<br>
follow the Redux flow: an action is generated, then the action is dispatched to<br>
go through a reducer, and then the store is updated.</p>
<hr>
<h1 class="mume-header undefined" id="week-15-day-3brreact-redux">WEEK-15 DAY-3<br><em>React + Redux</em></h1>

<hr>
<h1 class="mume-header" id="redux-learning-objectives-part-3">Redux Learning Objectives: Part 3</h1>

<p>Just like Luke Skywalker returning to Dagobah to complete his Jedi training with<br>
Yoda, it&apos;s time for you to return to learning Redux one more time. In this final<br>
section on Redux, you&apos;ll learn how to use the React-Redux library to connect<br>
components to a Redux store and how to use middleware and thunks to interact<br>
with an API.</p>
<p>After completing this final section on Redux, you should be able to:</p>
<ul>
<li>Describe what a higher-order component (HOC) is</li>
<li>Write a higher-order component (HOC) that accepts a component as an argument<br>
and returns a new component</li>
<li>Use the React-Redux library&apos;s <code>&lt;Provider /&gt;</code> component to make your Redux<br>
store available to any nested components that have been wrapped in the<br>
<code>connect</code> function</li>
<li>Use the React-Redux library&apos;s <code>connect</code> function to give a component access to<br>
a Redux store</li>
<li>Write a selector to extract and format information from state stored in a<br>
Redux store</li>
<li>Use the React-Redux library&apos;s <code>applyMiddleware</code> function to configure one or<br>
more middleware when creating a store</li>
<li>Write a thunk action creator to make an asynchronous request to an API and<br>
dispatch an action when the response is received</li>
<li>Describe a situation where defining multiple containers for a single component<br>
is advantageous</li>
<li>Configure a React application to use the Redux development tools</li>
</ul>
<hr>
<h1 class="mume-header" id="higher-order-components">Higher-Order Components</h1>

<p>In React, <a href="https://reactjs.org/docs/higher-order-components.html">higher-order components (HOCs)</a><br>
are a pattern for reusing component logic. Ultimately, higher order components<br>
allow you to dynamically generate wrapper components.</p>
<p>Before React existed, developers leveraged JavaScript&apos;s support for functions as<br>
first-class objects, meaning that functions can be treated just like any other<br>
data type (i.e. stored in a variable, object, or array, passed as an argument to<br>
a function, or returned from a function). Understanding what higher-order<br>
functions are and how they work will help you to understand and use higher-order<br>
components in React.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Describe what a higher-order component (HOC) is</li>
<li>Write a higher-order component (HOC) that accepts a component as an argument<br>
and returns a new component</li>
</ul>
<h2 class="mume-header" id="reviewing-higher-order-functions">Reviewing higher-order functions</h2>

<p>Functions that operate on other functions, either by receiving them as arguments<br>
or returning them, are called <strong>higher-order functions</strong>. Said differently,<br>
higher-order functions are functions that:</p>
<ul>
<li>Define and return functions;</li>
<li>Accept callbacks as arguments;</li>
<li>Or do both.</li>
</ul>
<h3 class="mume-header" id="using-closures-with-higher-order-functions">Using closures with higher-order functions</h3>

<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures"><strong>closure</strong></a>, also known as <em>lexical scoping</em>, is a function<br>
that uses <strong>free variables</strong>, variables defined outside of its scope. Closures<br>
come in handy when writing higher-order functions. Consider the following code:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">calculator</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">operationCb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// high-order function</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">op1<span class="token punctuation">,</span> op2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// closure</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`calling with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>op1<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>op2<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">operationCb</span><span class="token punctuation">(</span>op1<span class="token punctuation">,</span> op2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`equals </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">addition</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n1<span class="token punctuation">,</span> n2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// callback</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>n1<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>n2<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> n1 <span class="token operator">+</span> n2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> adder <span class="token operator">=</span> <span class="token function">calculator</span><span class="token punctuation">(</span>addition<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">adder</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// calling with 1 2</span>
<span class="token comment">// 1 + 2</span>
<span class="token comment">// equals 3</span>
</pre><p>The <code>calculator</code> function receives a callback as an argument (<code>operationCb</code>)<br>
which is called in the anonymous function <code>calculator</code> returns. This return<br>
value would not work if the inner function could not close over <code>operationCb</code>, a<br>
variable defined outside of its scope.</p>
<h3 class="mume-header" id="defining-higher-order-functions-with-arrow-functions">Defining higher-order functions with arrow functions</h3>

<p>Arrow functions make it easy to write higher-order functions. The two examples<br>
below illustrate the same function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// Without arrow functions (ES5):</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">arg1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arg1<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> came before </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arg2<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> and </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arg3<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> came last`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// With arrow functions (ES6):</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token parameter">arg1</span> <span class="token operator">=&gt;</span> <span class="token parameter">arg2</span> <span class="token operator">=&gt;</span> <span class="token parameter">arg3</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arg1<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> came before </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arg2<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> and </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arg3<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> came last`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Here&apos;s the earlier <code>calculator</code> function rewritten using arrow functions:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">calculator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">operationCb</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">op1<span class="token punctuation">,</span> op2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`calling with </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>op1<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>op2<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">operationCb</span><span class="token punctuation">(</span>op1<span class="token punctuation">,</span> op2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`equals </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><blockquote>
<p><strong>Note:</strong> Remember, ES6 arrow functions, unlike normal JavaScript functions,<br>
are automatically bound to the context (<code>this</code>) that existed when they were<br>
defined. In other words, <code>this</code> means the same thing inside an arrow function<br>
that it does outside of it.</p>
</blockquote>
<h2 class="mume-header" id="leveraging-higher-order-components-hocs">Leveraging higher-order components (HOCs)</h2>

<p>In the same way that higher-order functions can receive a function as an<br>
argument and return a new function, <a href="https://reactjs.org/docs/higher-order-components.html"><strong>higher-order components</strong> or<br>
<strong>HOC</strong>s</a> receive a React component as an<br>
argument and return a new component.</p>
<h3 class="mume-header" id="protectedroute-and-authroute"><code>ProtectedRoute</code> and <code>AuthRoute</code></h3>

<p>In the <strong>React Twitter Lite</strong> project, you created two HOCs to control what<br>
pages users could see based upon their authentication status. The<br>
<code>ProtectedRoute</code> HOC ensured that only logged users could view the Profile and<br>
Home pages while the <code>AuthRoute</code> HOC prevented logged in users from viewing the<br>
<code>Login</code> or <code>Registration</code> pages:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">ProtectedRoute</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> component<span class="token punctuation">:</span> Component<span class="token punctuation">,</span> path<span class="token punctuation">,</span> currentUserId<span class="token punctuation">,</span> exact <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Route
      path<span class="token operator">=</span><span class="token punctuation">{</span>path<span class="token punctuation">}</span>
      exact<span class="token operator">=</span><span class="token punctuation">{</span>exact<span class="token punctuation">}</span>
      render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        currentUserId <span class="token operator">?</span> <span class="token operator">&lt;</span>Component <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">:</span> <span class="token operator">&lt;</span>Redirect to<span class="token operator">=</span><span class="token string">&quot;/login&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">AuthRoute</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> component<span class="token punctuation">:</span> Component<span class="token punctuation">,</span> path<span class="token punctuation">,</span> currentUserId<span class="token punctuation">,</span> exact <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Route
      path<span class="token operator">=</span><span class="token punctuation">{</span>path<span class="token punctuation">}</span>
      exact<span class="token operator">=</span><span class="token punctuation">{</span>exact<span class="token punctuation">}</span>
      render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        currentUserId <span class="token operator">?</span> <span class="token operator">&lt;</span>Redirect to<span class="token operator">=</span><span class="token string">&quot;/&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">:</span> <span class="token operator">&lt;</span>Component <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Notice how both components accept a component via the <code>component</code> parameter and<br>
return a <code>Route</code> component (that renders the passed component via a <code>render</code><br>
prop).</p>
<h2 class="mume-header" id="using-hocs-to-keep-code-dry">Using HOCs to keep code DRY</h2>

<p>HOCs give React developers a powerful way to reuse component logic so that they<br>
can keep their code DRY.</p>
<p>When learning about Redux container components, you might have noticed that the<br>
<code>FruitManagerContainer</code> and <code>FarmerManagerContainer</code> components in the Fruit<br>
Stand application contain the same <code>componentDidMount</code> and<br>
<code>componentWillUnmount</code> lifecycle method implementations:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitManagerContainer.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  addFruit<span class="token punctuation">,</span>
  addFruits<span class="token punctuation">,</span>
  sellFruit<span class="token punctuation">,</span>
  sellOut<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitManager <span class="token keyword">from</span> <span class="token string">&apos;./FruitManager&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FruitManagerContainer</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">addBulk</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruits</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">sell</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">sellFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">sellAll</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">sellOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> fruit <span class="token punctuation">}</span> <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> distinctFruit <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>FruitManager
        fruit<span class="token operator">=</span><span class="token punctuation">{</span>fruit<span class="token punctuation">}</span>
        distinctFruit<span class="token operator">=</span><span class="token punctuation">{</span>distinctFruit<span class="token punctuation">}</span>
        add<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">}</span>
        addBulk<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addBulk<span class="token punctuation">}</span>
        sell<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>sell<span class="token punctuation">}</span>
        sellAll<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>sellAll<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitManagerContainer<span class="token punctuation">;</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FarmerManagerContainer.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;../store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> hireFarmer<span class="token punctuation">,</span> payFarmer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/farmersActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FarmerManager <span class="token keyword">from</span> <span class="token string">&apos;./FarmerManager&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FarmerManagerContainer</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">pay</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">payFarmer</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">hire</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">hireFarmer</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> farmers<span class="token punctuation">:</span> farmersState <span class="token punctuation">}</span> <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> farmers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>farmersState<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>FarmerManager
        farmers<span class="token operator">=</span><span class="token punctuation">{</span>farmers<span class="token punctuation">}</span>
        pay<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pay<span class="token punctuation">}</span>
        hire<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>hire<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FarmerManagerContainer<span class="token punctuation">;</span>
</pre><p>While the amount of duplicated code is currently relatively small, keep in mind<br>
that <strong>the approach of using the <code>forceUpdate</code> method to render the component<br>
whenever state is updated in the store isn&apos;t optimal</strong>. Calling <code>forceUpdate</code><br>
causes <code>render</code> to be called without first calling <code>shouldComponentUpdate</code>.</p>
<p>Ideally, each container component should contain logic to determine if the state<br>
that it retrieves from the store has <em>actually changed</em> before continuing with<br>
rendering. Adding the code for this logic would increase the amount of code<br>
duplicated in each container component.</p>
<h3 class="mume-header" id="react-redux-connect">React-Redux <code>connect</code></h3>

<p><a href="https://react-redux.js.org/">React-Redux</a>, a library from the creators of <a href="https://redux.js.org/">Redux</a>,<br>
includes a higher-order component named <code>connect</code> that you can use to create<br>
container components. Using <code>connect</code> frees you from having to manually create<br>
the <code>FruitManagerContainer</code> and <code>FarmerManagerContainer</code> container components.<br>
Using <code>connect</code> also eliminates boilerplate code so you can focus on what makes each<br>
container unique: selecting specific slices of state from the store and writing<br>
functions to dispatch specific actions. Even better, <code>connect</code> includes the<br>
logic that&apos;s needed to optimize the rendering performance, only rendering when<br>
the state retrieved from the store has <em>actually changed</em>.</p>
<blockquote>
<p>Over the next couple of articles, you&apos;ll learn how to use <code>connect</code> and the<br>
<a href="https://react-redux.js.org/">React-Redux</a> library.</p>
</blockquote>
<h3 class="mume-header" id="writing-a-hoc-for-creating-container-components">Writing a HOC for creating container components</h3>

<p>Higher-order components like <a href="https://react-redux.js.org/">React-Redux</a> <code>connect</code>, while<br>
extremely useful, can be confusing to understand. To help give you some insight<br>
into the underlying implementation of the <code>connect</code> function, you can build a<br>
your own <em>custom version</em> of <code>connect</code> (albeit without the logic that&apos;s needed<br>
to optimize rendering performance).</p>
<blockquote>
<p>Don&apos;t worry if you struggle to fully understand the following custom version<br>
of <code>connect</code>. It takes time and practice to get comfortable with the<br>
techniques that are used to create higher-order components. And remember,<br>
<strong>you don&apos;t have to build your <code>connect</code> function!</strong> Going forward, you&apos;ll use<br>
the well-maintained, highly optimized <code>connect</code> function provided by the<br>
<a href="https://react-redux.js.org/">React-Redux</a> library.</p>
</blockquote>
<p>Consider the following <em>custom</em> <code>connect</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/connect.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;./store&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">connect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> stateProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stateProps <span class="token operator">=</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">let</span> dispatchProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>mapDispatchToProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dispatchProps <span class="token operator">=</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> propsToSpread <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">,</span> stateProps<span class="token punctuation">,</span> dispatchProps<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span><span class="token operator">...</span>propsToSpread<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unsubscribe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> connect<span class="token punctuation">;</span>
</pre><p>The <code>connect</code> function is a higher-order component that returns a function. That<br>
function returns an anonymous class component that wraps the component passed in<br>
via the <code>WrappedComponent</code> parameter.</p>
<p>The anonymous class component is a &quot;generic&quot; container component that <em>connects</em><br>
<code>WrappedComponent</code> to the Redux store by:</p>
<ul>
<li>Defining the <code>componentDidMount</code> and <code>componentWillUnmount</code> lifecycle method<br>
implementations necessary for managing the subscription to the store to render<br>
<code>WrappedComponent</code> when state is updated; and</li>
<li>Passing slices of state and functions to dispatch actions down to<br>
<code>WrappedComponent</code> using props.</li>
</ul>
<h3 class="mume-header" id="comparing-nested-arrow-functions-to-regular-functions">Comparing nested arrow functions to regular functions</h3>

<p>As you saw earlier in this article, higher-order functions can be written using<br>
arrow functions or regular functions. The <code>connect</code> higher-order function<br>
can be written using arrow functions and implicit return statements:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">connect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
    <span class="token comment">// Code removed for brevity.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Or can be rewritten using regular functions and explicit return statements:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">function</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token parameter">mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
      <span class="token comment">// Code removed for brevity.</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>The arrow function syntax, while concise, can be confusing to read.</p>
<h3 class="mume-header" id="dynamically-setting-component-attributes">Dynamically setting component attributes</h3>

<p>The <code>connect</code> function&apos;s <code>mapStateToProps</code> and <code>mapDispatchToProps</code> parameters<br>
are both functions that are called within the anonymous class&apos; <code>render</code> method:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">connect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> stateProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stateProps <span class="token operator">=</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">let</span> dispatchProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>mapDispatchToProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dispatchProps <span class="token operator">=</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// Code removed for brevity.</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Code removed for brevity.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The Redux store&apos;s current state, retrieved using <code>store.getState</code>, is passed to<br>
the <code>mapStateToProps</code> function and the store&apos;s <code>dispatch</code> method is passed to<br>
the <code>mapDispatchToProps</code> function. The <code>mapStateToProps</code> and<br>
<code>mapDispatchToProps</code> functions also receive the anonymous class component&apos;s<br>
props (via <code>this.props</code>).</p>
<p>But what are the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions exactly?<br>
To answer that question, take a look at an example of using the <code>connect</code><br>
function to define the <code>FruitManagerContainer</code> component:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitManagerContainer.js</span>

<span class="token keyword">import</span> connect <span class="token keyword">from</span> <span class="token string">&apos;../connect&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  addFruit<span class="token punctuation">,</span>
  addFruits<span class="token punctuation">,</span>
  sellFruit<span class="token punctuation">,</span>
  sellOut<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitManager <span class="token keyword">from</span> <span class="token string">&apos;./FruitManager&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  fruit<span class="token punctuation">:</span> state<span class="token punctuation">.</span>fruit<span class="token punctuation">,</span>
  distinctFruit<span class="token punctuation">:</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">add</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">addBulk</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addFruits</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sell</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">fruit</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">sellFruit</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sellAll</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">sellOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  mapStateToProps<span class="token punctuation">,</span>
  mapDispatchToProps
<span class="token punctuation">)</span><span class="token punctuation">(</span>FruitManager<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p><code>mapStateToProps</code> is a function that accepts store&apos;s current state and returns<br>
an object that maps state data to one or more properties. <code>mapDispatchToProps</code><br>
is also a function, but it accepts the store&apos;s <code>dispatch</code> method and returns an<br>
object whose properties are set to functions that can be called dispatch actions<br>
to the store.</p>
<p>In the <code>connect</code> function, <code>Object.assign</code> is then used to combine the<br>
<code>stateProps</code> and <code>dispatchProps</code> objects with <code>this.props</code> (the anonymous class<br>
component&apos;s props):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> propsToSpread <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">,</span> stateProps<span class="token punctuation">,</span> dispatchProps<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Then the properties defined on the <code>propsToSpread</code> object become props on<br>
<code>WrappedComponent</code> using JSX spread attribute syntax (<code>...</code>):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">return</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span><span class="token operator">...</span>propsToSpread<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Within the <code>FruitManager</code> component (the component that the <code>connect</code> function&apos;s<br>
<code>WrappedComponent</code> is wrapping), parameter destructuring is used to reference<br>
the props provided by the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions.<br>
These props are then passed as props to the appropriate child presentational<br>
component:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FruitManager.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitList <span class="token keyword">from</span> <span class="token string">&apos;./FruitList&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitSeller <span class="token keyword">from</span> <span class="token string">&apos;./FruitSeller&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitQuickAdd <span class="token keyword">from</span> <span class="token string">&apos;./FruitQuickAdd&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FruitBulkAdd <span class="token keyword">from</span> <span class="token string">&apos;./FruitBulkAdd&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">FruitManager</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> fruit<span class="token punctuation">,</span> distinctFruit<span class="token punctuation">,</span> add<span class="token punctuation">,</span> addBulk<span class="token punctuation">,</span> sell<span class="token punctuation">,</span> sellAll <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Available Fruit<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitList fruit<span class="token operator">=</span><span class="token punctuation">{</span>fruit<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Fruit Inventory Manager<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitSeller distinctFruit<span class="token operator">=</span><span class="token punctuation">{</span>distinctFruit<span class="token punctuation">}</span> sell<span class="token operator">=</span><span class="token punctuation">{</span>sell<span class="token punctuation">}</span> sellAll<span class="token operator">=</span><span class="token punctuation">{</span>sellAll<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitQuickAdd add<span class="token operator">=</span><span class="token punctuation">{</span>add<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FruitBulkAdd addBulk<span class="token operator">=</span><span class="token punctuation">{</span>addBulk<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> FruitManager<span class="token punctuation">;</span>
</pre><p>Visualizing the flow of data all the from the <code>mapStateToProps</code> and<br>
<code>mapDispatchToProps</code> function definitions within the <code>FruitManagerContainer.js</code><br>
file through the <code>connect</code> higher-order component down to the <code>FruitManager</code><br>
wrapped component is <strong>difficult to do</strong>. Understanding how to use React&apos;s<br>
ability to dynamically set component attributes using JSX spread attribute<br>
syntax is <strong>one of the more challenging aspects of writing higher-order<br>
components</strong>.</p>
<p><strong>Just remember that you don&apos;t need to fully understand the above example to use<br>
the <code>connect</code> function provided by the <a href="https://react-redux.js.org/">React-Redux</a> library.</strong></p>
<h2 class="mume-header" id="reviewing-a-completed-fruit-stand-example-4">Reviewing a completed Fruit Stand example</h2>

<p>To review and run a completed Fruit Stand example application that utilizes the<br>
above <em>custom</em> <code>connect</code> higher-order component to create container components,<br>
clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the<br>
<code>fruit-stand-redux-with-react-generic-container</code> folder. Run the command <code>npm install</code> to install the project&apos;s dependencies. Then use the command <code>npm start</code><br>
to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the<br>
Create React App tooling. When running the application using <code>npm start</code>, the<br>
application should automatically open in your default browser. If it doesn&apos;t,<br>
you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 class="mume-header" id="what-you-learned-11">What you learned</h2>

<p>In this article, you learned about higher-order components (HOCs) including how<br>
to write a higher-order component that accepts a component as an argument and<br>
returns a new component.</p>
<hr>
<h1 class="mume-header" id="react-redux-provider">React-Redux: <code>&lt;Provider/&gt;</code></h1>

<p>As you learned in earlier articles, the integration techniques that you were<br>
initially shown were just a starting point with using Redux with React. Now that<br>
you&apos;ve learned the basics of how React components interact with a Redux store,<br>
it&apos;s time to learn how you can use <a href="https://react-redux.js.org/">React-Redux</a>, a library from<br>
the creators of <a href="https://redux.js.org/">Redux</a>, to improve upon those techniques.</p>
<p>To prepare to use the <code>connect</code> function from the <a href="https://react-redux.js.org/">React-Redux<br>
library</a>, you need to first add a <code>&lt;Provider /&gt;</code> component to your<br>
React application. When you finish this article, you should be able to use the<br>
<code>&lt;Provider /&gt;</code> component to make your Redux store available to any nested<br>
components that have been wrapped in the <code>connect</code> function.</p>
<h2 class="mume-header" id="understanding-the-advantages-of-the-provider-component">Understanding the advantages of the <code>&lt;Provider /&gt;</code> component</h2>

<p>Oftentimes, a deeply nested component will need access to the store, while its<br>
parents do not. Using vanilla React, these parents would have to receive the<br>
<code>store</code> prop in order to pass it down to its child.</p>
<p>Consider the example below:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// App.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">UserInfo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>username<span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Header</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>UserInfo store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Header store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// index.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">&apos;./reducer&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&apos;./App&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span><span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>App store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;root&apos;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The <code>store</code> is created in the <code>index.js</code> file, but the <code>UserInfo</code> component that<br>
needs to access it is deeply nested. Thus, the store must be passed as a prop<br>
down the entire component tree, even though components such as the <code>Header</code> do<br>
not need to access the store.</p>
<p>This pattern, called <strong>prop threading</strong>, is tedious and error-prone. You can<br>
avoid it by using the <code>&lt;Provider /&gt;</code>/<code>connect</code> API provided by React-Redux.</p>
<h3 class="mume-header" id="preparing-your-react-application-for-server-side-rendering">Preparing your React application for server-side rendering</h3>

<p>Using <code>&lt;Provider /&gt;</code> also helps to prepare your React/Redux application to<br>
utilize server-side rendering. Server-side rendering allows you to render<br>
components to static markup, which can help to reduce the initial loading time<br>
of your application.</p>
<blockquote>
<p>React server-side rendering is an advanced topic that won&apos;t be covered in this<br>
course. For more information, see the official <a href="https://reactjs.org/docs/react-dom-server.html">React</a><br>
and <a href="https://redux.js.org/recipes/server-rendering">Redux</a> docs.</p>
</blockquote>
<h2 class="mume-header" id="adding-provider">Adding <code>&lt;Provider /&gt;</code></h2>

<p>Before adding <code>&lt;Provider /&gt;</code> to your React application, use npm to install the<br>
<code>react-redux</code> package:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> react-redux
</pre><p>Then, in the entry point for your application (typically the <code>index.js</code> file),<br>
import the <code>Provider</code> component and your Redux <code>store</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;./store&apos;</span><span class="token punctuation">;</span>
</pre><p>Then use the <code>Provider</code> component to wrap your <code>App</code> component and set its<br>
<code>store</code> prop to your Redux <code>store</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
</pre><p>Here&apos;s what your completed <code>index.js</code> file will look like:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/index.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&apos;./index.css&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&apos;./App&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&apos;./store&apos;</span><span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;root&apos;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p><code>&lt;Provider /&gt;</code> is simply a React component in which you wrap the rest of the<br>
application. The <code>Provider</code> component receives the <code>store</code> as a <code>prop</code> and sets<br>
a store <code>context</code>. Because you wrapped the entire <code>App</code> in the <code>Provider</code><br>
component, all your components can access the store <code>context</code>.</p>
<p>Components that need to access the store <code>context</code> have to be wrapped in a<br>
container component created by the <code>connect</code> function, which converts the store<br>
<code>context</code> into a <code>store</code> prop. You&apos;ll learn how to use the <code>connect</code> function in<br>
the next article.</p>
<h2 class="mume-header" id="understanding-how-provider-relates-to-the-react-context-api">Understanding how <code>&lt;Provider /&gt;</code> relates to the React Context API</h2>

<p>The store <code>context</code> set by <code>&lt;Provider /&gt;</code> is the <em>same</em> React Context that you<br>
used in an earlier lesson to manage global state within a React application. You<br>
can see this in action by reviewing the <code>react-redux</code> source code on GitHub:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// https://github.com/reduxjs/react-redux/blob/master/src/components/Context.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> ReactReduxContext <span class="token operator">=</span> <span class="token comment">/*#__PURE__*/</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&apos;production&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ReactReduxContext<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">&apos;ReactRedux&apos;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ReactReduxContext
</pre><p>And while it&apos;s rarely used, it&apos;s possible to import the context from React-Redux<br>
and use the <code>&lt;Consumer /&gt;</code> to access the <code>store</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> ReactReduxContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// in your connected component</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>ReactReduxContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// do something with the store here</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ReactReduxContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>You can also connect the Redux <code>&lt;Provider /&gt;</code> component to the<br>
<code>&lt;Context.Provider /&gt;</code> component that passes the <code>value</code> of a context object to<br>
all child components. Redux&apos;s <code>&lt;Provider /&gt;</code> component simply passes the Redux<br>
<code>store</code>, instead of a context <code>value</code>.</p>
<h2 class="mume-header" id="what-you-learned-12">What you learned</h2>

<p>In this article, you learned how to use the <code>&lt;Provider /&gt;</code> component to make<br>
your Redux store available to any nested components that have been wrapped in<br>
the <code>connect</code> function.</p>
<hr>
<h1 class="mume-header" id="react-redux-connect-1">React-Redux: <code>connect()</code></h1>

<p>The React-Redux library allows you to access the store <code>context</code> set by the<br>
<code>&lt;Provider /&gt;</code> in a powerful and convenient way via the <code>connect</code> function.<br>
Using <code>connect</code>, you can pass specific slices of the store&apos;s state and specific<br>
action-dispatches to a React component as <code>props</code>. A component&apos;s <code>props</code> then<br>
serve as its API to the store, making the component more modular and less<br>
burdened by Redux boilerplate.</p>
<p>When you finish this article, you should be able to use the <code>connect</code> function<br>
to give a component access to a Redux store.</p>
<h2 class="mume-header" id="calling-connect">Calling <code>connect</code></h2>

<p>The React-Redux <code>connect</code> function is a <em>higher-order function</em>. It takes two<br>
arguments (plus a couple optional arguments you can read more about in the<br>
<a href="https://react-redux.js.org/using-react-redux/connect-mapstate#ownprops-optional">docs</a>) and returns a function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> createConnectedComponent <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  mapStateToProps<span class="token punctuation">,</span>
  mapDispatchToProps
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The returned function (<code>createConnectedComponent</code>) then takes the React<br>
component that needs access to the Redux store and returns a new React<br>
component:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> ConnectedComponent <span class="token operator">=</span> <span class="token function">createConnectedComponent</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ConnectedComponent<span class="token punctuation">;</span>
</pre><p><code>ConnectedComponent</code> will render <code>MyComponent</code>, passing along <code>props</code> as<br>
determined by the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> arguments.</p>
<p>You can combine these function calls into a single statement by immediately<br>
calling the function returned by the <code>connect</code> method (similarly to how you<br>
immediately call a function expression when defining an <a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE">IIFE</a>):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> ConnectedComponent <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ConnectedComponent<span class="token punctuation">;</span>
</pre><p>Typically, to keep things as concise as possible, the <code>ConnectedComponent</code><br>
variable is omitted:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="defining-mapstatetopropsstate-ownprops">Defining <code>mapStateToProps(state, [ownProps])</code></h2>

<p>This first argument to <code>connect</code> is a function, <code>mapStateToProps</code>. It tells<br>
<code>connect</code> how to map the <code>state</code> into your component&apos;s <code>props</code>.</p>
<p>It must take as an argument the store&apos;s <code>state</code> (supplied by the <code>Provider</code>&apos;s<br>
store <code>context</code>) and return an object containing the relevant <code>props</code> for your<br>
component.</p>
<pre data-role="codeBlock" data-info="jsx" class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> state<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ConnectedComponent <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>In the example above, <code>ConnectedComponent</code> will render <code>MyComponent</code>, passing<br>
<code>name</code> as a prop.</p>
<h3 class="mume-header" id="ownprops-optional"><code>ownProps</code> (optional)</h3>

<p>A component with explicit <code>props</code> passed down from its parent (e.g.<br>
<code>&lt;ConnectedComponent lastName={&apos;Wozniak&apos;}/&gt;</code>) can merge those <code>props</code> with<br>
slices of <code>state</code> via <code>ownProps</code>, a optional second argument to<br>
<code>mapStateToProps</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> ownProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token punctuation">:</span> state<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
  initials<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">. </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ownProps<span class="token punctuation">.</span>lastName<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ConnectedComponent <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>You can also access React Router props, such <code>match</code> and <code>history</code> through<br>
<code>ownProps</code>. Imagine you have a <code>users</code> slice of state, and you want to pass a<br>
specific user&apos;s <code>name</code> based on a <code>:userId</code> parameter. You can access the<br>
parameter from within the <code>mapStateToProps</code> function with<br>
<code>ownProps.match.params.userId</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> ownProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> state<span class="token punctuation">.</span>users<span class="token punctuation">[</span>ownProps<span class="token punctuation">.</span>match<span class="token punctuation">.</span>params<span class="token punctuation">.</span>userId<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ConnectedComponent <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="defining-mapdispatchtoprops">Defining <code>mapDispatchToProps</code></h2>

<p><code>mapDispatchToProps</code> is the second argument to <code>connect</code>. It&apos;s a function that<br>
accepts the store&apos;s <code>dispatch</code> method and returns an object containing functions<br>
that can be called to dispatch actions to the store. These action dispatchers<br>
are then passed as <code>props</code> to the component.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">deleteTodo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">&apos;DELETE_TODO&apos;</span><span class="token punctuation">,</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// action creators</span>
<span class="token keyword">const</span> <span class="token function-variable function">addTodo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">&apos;ADD_TODO&apos;</span><span class="token punctuation">,</span> msg <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">handleDelete</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">deleteTodo</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">handleAdd</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addTodo</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ConnectedComponent <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Notice that in the example above, the <code>connect</code> function is invoked with <code>null</code><br>
as a placeholder for the <code>mapStateToProps</code> function. The <code>connect</code> function<br>
expects <code>mapStateToProps</code> as its first argument and <code>mapDispatchToProps</code> as its<br>
second argument.</p>
<h2 class="mume-header" id="putting-it-all-together">Putting it all together</h2>

<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> firstName<span class="token punctuation">,</span> initials<span class="token punctuation">,</span> handleAdd<span class="token punctuation">,</span> handleDelete <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> ownProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token punctuation">:</span> state<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
  initials<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>state<span class="token punctuation">.</span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">. </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ownProps<span class="token punctuation">.</span>lastName<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">handleDelete</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">deleteTodo</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">handleAdd</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addTodo</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  mapStateToProps<span class="token punctuation">,</span>
  mapDispatchToProps
<span class="token punctuation">)</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p><code>MyComponent</code> will receive <code>firstName</code>, <code>initials</code>, <code>handleDelete</code>, and<br>
<code>handleAdd</code> as <code>props</code>.</p>
<p>And remember, unlike the earlier attempt at writing a custom <code>connect</code><br>
higher-order component, the React-Redux library&apos;s <code>connect</code> function <strong>contains<br>
logic to optimize the rendering of your connected components</strong>.</p>
<h2 class="mume-header" id="reviewing-a-completed-fruit-stand-example-5">Reviewing a completed Fruit Stand example</h2>

<p>To review and run a completed Fruit Stand example application that utilizes the<br>
React-Redux library, clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the<br>
<code>fruit-stand-redux-with-react-official-bindings</code> folder. Run the command <code>npm install</code> to install the project&apos;s dependencies. Then use the command <code>npm start</code><br>
to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the<br>
Create React App tooling. When running the application using <code>npm start</code>, the<br>
application should automatically open in your default browser. If it doesn&apos;t,<br>
you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 class="mume-header" id="what-you-learned-13">What you learned</h2>

<p>In this article, you learned how to use the React-Redux library&apos;s <code>connect</code><br>
function to give a component access to a Redux store.</p>
<hr>
<h1 class="mume-header" id="selectors">Selectors</h1>

<p>Selectors are functions used to extract and format information from the<br>
application state in different forms. When you finish this article, you should<br>
be able to write a selector to extract and format information from state stored<br>
in a Redux store.</p>
<h2 class="mume-header" id="writing-a-selector">Writing a selector</h2>

<p>Here&apos;s a sample state tree from the Fruit Stand React/Redux application:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  fruit<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&apos;APPLE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;APPLE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;ORANGE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;GRAPEFRUIT&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;WATERMELON&apos;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  farmers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">&apos;John Smith&apos;</span><span class="token punctuation">,</span>
      paid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">&apos;Sally Jones&apos;</span><span class="token punctuation">,</span>
      paid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>The state&apos;s <code>farmers</code> are stored as an object. Keys correspond to <code>farmer.id</code>s<br>
and values correspond to <code>farmer</code> objects. This yields O(1) for the lookup of a<br>
single farmer. However, storing all the farmers as values of an object makes it<br>
slightly inconvenient to obtain and render them all at once. To solve this<br>
inconvenience, we use selectors.</p>
<p>Selectors are typically defined in a file that sits next to the reducer for its<br>
slice of state. For example, if the <code>farmers</code> state slice is managed by the<br>
reducer defined in <code>./src/reducers/farmersReducer.js</code>, then the farmers<br>
selectors would be stored in a file at <code>./src/reducers/farmersSelectors.js</code>.</p>
<p>Selectors are passed the application&apos;s <code>state</code> and return information from the<br>
state in a specified form (e.g. an array). You can use selectors to format<br>
different slice(s) of the state by calling them in a container&apos;s<br>
<code>mapStateToProps</code>.</p>
<p>For example, <code>getAllFarmers</code> returns all the farmers stored in the state as an<br>
array of <code>farmer</code> objects, making it easier to iterate over and render each one.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/reducers/farmersSelectors.js</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getAllFarmers</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> farmers <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>farmers<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>A selector can be used in multiple components&apos; <code>mapStateToProps</code>. For example:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FarmerManagerContainer.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> getAllFarmers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../reducers/farmersSelectors&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  farmers<span class="token punctuation">:</span> <span class="token function">getAllFarmers</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Selectors are passed the entire application <code>state</code> so they can utilize multiple<br>
slices of the application state to assemble data. For example, if the Fruit<br>
Stand application&apos;s state tree included a <code>filter</code> state slice:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  fruit<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&apos;APPLE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;APPLE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;ORANGE&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;GRAPEFRUIT&apos;</span><span class="token punctuation">,</span>
    <span class="token string">&apos;WATERMELON&apos;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  farmers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">&apos;John Smith&apos;</span><span class="token punctuation">,</span>
      paid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">&apos;Sally Jones&apos;</span><span class="token punctuation">,</span>
      paid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  filter<span class="token punctuation">:</span> <span class="token string">&apos;&apos;</span>
<span class="token punctuation">}</span>
</pre><p>Then you could write a selector to extract a filtered list of <code>farmer</code> objects:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/reducers/farmersSelectors.js</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getAllFarmers</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> farmers <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>farmers<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getFilteredFarmers</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> farmers<span class="token punctuation">,</span> filter <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> lowerCaseFilter <span class="token operator">=</span> filter<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>farmers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter">farmer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> farmer<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>lowerCaseFilter<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/FarmerManagerContainer.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> getAllFarmers<span class="token punctuation">,</span> getFilteredFarmers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../reducers/farmersSelectors&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  farmers<span class="token punctuation">:</span> <span class="token function">getAllFarmers</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">,</span>
  filteredFarmers<span class="token punctuation">:</span> <span class="token function">getFilteredFarmers</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="selector-examples">Selector examples</h2>

<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/reducers/farmersSelectors.js</span>

<span class="token comment">// Returns the state&apos;s farmers as an array of farmer objects.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getAllFarmers</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> farmers <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>farmers<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Returns the state&apos;s farmers as an array of farmer objects,</span>
<span class="token comment">// filtered by their name.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getFilteredFarmers</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> farmers<span class="token punctuation">,</span> filter <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> lowerCaseFilter <span class="token operator">=</span> filter<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>farmers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter">farmer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> farmer<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>lowerCaseFilter<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Returns the selected farmer object or an empty farmer object</span>
<span class="token comment">// if no farmer exists with given id.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">selectFarmer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> farmers <span class="token punctuation">}</span><span class="token punctuation">,</span> id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> nullFarmer <span class="token operator">=</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span>
    paid<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> farmers<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">||</span> nullFarmer<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="what-you-learned-14">What you learned</h2>

<p>In this article, you learned how to write a selector to extract and format<br>
information from state stored in a Redux store.</p>
<hr>
<h1 class="mume-header" id="middleware-1">Middleware</h1>

<p>In Redux, middleware specifically refers to an <code>enhancer</code> passed to the store<br>
via <code>createStore</code>. When a <code>dispatch</code> is made, the middleware intercepts the<br>
<code>action</code> before it reaches the <code>reducer</code>. The middleware can then:</p>
<ul>
<li><strong>resolve the action itself</strong> (for example, by making an AJAX request),</li>
<li><strong>pass along the action</strong> (if the middleware isn&apos;t concerned with it),</li>
<li><strong>generate a side effect</strong> (such as logging debugging information),</li>
<li><strong>send another dispatch</strong> (if the action triggers other actions),</li>
<li>or some combination thereof.</li>
</ul>
<p>You&apos;ll use Redux middleware for logging information about the store and making<br>
asynchronous API requests, but you can also use it for crash reporting, routing,<br>
and many other applications.</p>
<p>When you finish this article, you should be able to use the React-Redux<br>
library&apos;s <code>applyMiddleware</code> function to configure one or more middleware when<br>
creating a store.</p>
<h2 class="mume-header" id="applying-middleware-to-a-redux-store">Applying middleware to a Redux store</h2>

<p>Recall the <code>redux</code> library&apos;s <code>createStore</code> function used to instantiate a store.<br>
<code>createStore</code> accepts three arguments (<code>reducer, preloadedState, enhancer</code>);<br>
middleware is given to the store via the optional <code>enhancer</code> argument.</p>
<p>Consider the following example, where you import a third-party <code>logger</code><br>
middleware:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/store.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> logger <span class="token keyword">from</span> <span class="token string">&apos;redux-logger&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">configureStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">preloadedState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
    rootReducer<span class="token punctuation">,</span>
    preloadedState<span class="token punctuation">,</span>
    <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> configureStore<span class="token punctuation">;</span>
</pre><p>Any actions dispatched to the <code>store</code> pass through the <code>logger</code> middleware,<br>
which prints the store&apos;s state before and after the <code>action</code> is processed.</p>
<blockquote>
<p><strong>Note:</strong> <code>applyMiddleware()</code> accepts multiple arguments, so you can also<br>
apply more middleware if necessary.</p>
</blockquote>
<h2 class="mume-header" id="reviewing-the-signature-of-middleware-functions">Reviewing the signature of middleware functions</h2>

<p>In addition to importing third-party middlewares such as the above <code>logger</code>,<br>
you&apos;ll sometimes need to roll your own. All middleware functions need to conform<br>
to the same signature in order to be compatible with the store and other<br>
middlewares.</p>
<p>A <a href="https://developer.mozilla.org/en-US/docs/Glossary/Signature/Function"><strong>function signature</strong></a> is the set of inputs and output of a<br>
function. A Redux middleware must always have the following signature:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">middleware</span> <span class="token operator">=</span> <span class="token parameter">store</span> <span class="token operator">=&gt;</span> <span class="token parameter">next</span> <span class="token operator">=&gt;</span> <span class="token parameter">action</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token comment">// side effects, if any</span>
 <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Every middleware receives the <code>store</code> as an argument and returns a function that<br>
takes the <code>next</code> link in the middleware chain as an argument. That function<br>
returns <em>another</em> function that receives the <code>action</code> and then triggers any side<br>
effects before returning the result of <code>next(action)</code>. Side effects can include<br>
triggering AJAX requests, logging to the console, and more. Side effects can<br>
also happen after <code>next(action)</code> is called, like so:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">middleware</span> <span class="token operator">=</span> <span class="token parameter">store</span> <span class="token operator">=&gt;</span> <span class="token parameter">next</span> <span class="token operator">=&gt;</span> <span class="token parameter">action</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// side effect using `result`</span>
 <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="creating-your-own-logger-middleware">Creating your own <code>logger</code> middleware</h2>

<p>You can hand-roll the <code>logger</code> middleware you imported above. It should print<br>
out the state before and after each dispatch, allowing you to check if your<br>
reducers are working as expected. This middleware should:</p>
<ul>
<li>receive the store as its only argument,</li>
<li>return a function that receives the <code>next</code> middleware,</li>
<li>which should itself return a function receiving the <code>action</code>.</li>
</ul>
<p>The body of the innermost function is where you want to do your logging. That<br>
function should:</p>
<ul>
<li><code>console.log</code> the <code>action</code></li>
<li><code>console.log</code> the result of <code>store.getState()</code> (pre-dispatch)</li>
<li>call <code>next(action)</code> to pass the action on to the rest of the middlewares, and<br>
eventually, the reducer</li>
<li>save the <code>result</code> of the <code>next(action)</code> variable, to be returned later</li>
<li><code>console.log</code> the new <code>store.getState()</code></li>
<li>return the saved <code>result</code></li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">logger</span> <span class="token operator">=</span> <span class="token parameter">store</span> <span class="token operator">=&gt;</span> <span class="token parameter">next</span> <span class="token operator">=&gt;</span> <span class="token parameter">action</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Action received:&apos;</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;State pre-dispatch:&apos;</span><span class="token punctuation">,</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;State post-dispatch:&apos;</span><span class="token punctuation">,</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now, whenever you dispatch an action, you&apos;ll see its effect on the store.</p>
<h2 class="mume-header" id="installing-and-applying-the-redux-logger-middleware">Installing and applying the <code>redux-logger</code> middleware</h2>

<p>As you move forward with Redux, you&apos;ll want to have access to your store&apos;s state<br>
for debugging purposes. Including the <code>redux-logger</code> npm package and adding it<br>
as a middleware gives you access (through the console) to the previous state,<br>
action, and next state with each dispatch. This is incredibly convenient for<br>
debugging purposes and avoids such unpleasantness as attaching the <code>store</code> to<br>
the <code>window</code>.</p>
<p><img src="images/react-redux-logger.png" alt="react-redux-logger"></p>
<p>Follow the example below to include it in your projects:</p>
<ul>
<li>Include the <code>redux-logger</code> package:</li>
</ul>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> redux-logger
</pre><ul>
<li>Pass an instance of <code>redux-logger</code> to <code>applyMiddleware</code> when creating your<br>
store:</li>
</ul>
<p><strong>Note: <code>logger</code> must be the last middleware passed into <code>applyMiddleware</code></strong>,<br>
otherwise it will log the thunk and any involved promises. You&apos;ll learn about<br>
thunks and <code>react-thunk</code> in the next article.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/store.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&apos;redux-thunk&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> logger <span class="token keyword">from</span> <span class="token string">&apos;redux-logger&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">configureStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">preloadedState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
    rootReducer<span class="token punctuation">,</span>
    preloadedState<span class="token punctuation">,</span>
    <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">,</span> logger<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> configureStore<span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="what-you-learned-15">What you learned</h2>

<p>In this article, you learned how to use the React-Redux library&apos;s<br>
<code>applyMiddleware</code> function to configure one or more middleware when creating a<br>
store.</p>
<hr>
<h1 class="mume-header" id="thunks-1">Thunks</h1>

<p>One of the most common problems you need middleware to solve is asynchronicity.<br>
When building web applications that interact with a server, you&apos;ll need to<br>
request resources and then dispatch the response to your store when it<br>
eventually gets back.</p>
<p>While it&apos;s possible to make these API calls from your components and dispatch<br>
synchronously on success, for consistency and reusability it&apos;s preferable to<br>
have the source of every change to our application state be an action creator.<br>
Thunks are a new kind of action creator that will allow you to do that.</p>
<p>When you finish this article, you should be able to write a thunk action creator<br>
to make an asynchronous request to an API and dispatch an action when the<br>
response is received.</p>
<h2 class="mume-header" id="looking-at-how-thunks-work">Looking at how thunks work</h2>

<p>Rather than returning a plain object, a thunk action creator returns a function.<br>
This function, when called with an argument of <code>dispatch</code>, can then dispatch one<br>
or more actions, immediately, or later. Here&apos;s an example:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">thunkActionCreator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&apos;RECEIVE_MESSAGE&apos;</span><span class="token punctuation">,</span>
    message<span class="token punctuation">:</span> <span class="token string">&apos;This will be dispatched immediately.&apos;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&apos;RECEIVE_MESSAGE&apos;</span><span class="token punctuation">,</span>
    message<span class="token punctuation">:</span> <span class="token string">&apos;This will be dispatched 1 second later.&apos;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>This is great, but without custom middleware it will break as soon as the<br>
function action hits your reducer. You need middleware to intercept all actions<br>
of type <code>function</code> and then trigger the dispatch:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/middleware/thunkMiddleware.js</span>

<span class="token keyword">const</span> <span class="token function-variable function">thunk</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> getState <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token parameter">next</span> <span class="token operator">=&gt;</span> <span class="token parameter">action</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> action <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">action</span><span class="token punctuation">(</span>dispatch<span class="token punctuation">,</span> getState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> thunk<span class="token punctuation">;</span>
</pre><p>Notice how the <code>getState</code> function is passed into the <code>action</code> in case your<br>
asynchronous action creators need access to your application state.</p>
<p>Then you&apos;d apply your custom middleware to your store:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/store.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> logger <span class="token keyword">from</span> <span class="token string">&apos;redux-logger&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&apos;./middleware/thunkMiddleware&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">configureStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">preloadedState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
    rootReducer<span class="token punctuation">,</span>
    preloadedState<span class="token punctuation">,</span>
    <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">,</span> logger<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> configureStore<span class="token punctuation">;</span>
</pre><p>That&apos;s it! Now that you have all the pieces, you&apos;re ready to review a more<br>
concrete example.</p>
<h2 class="mume-header" id="reviewing-a-concrete-example">Reviewing a concrete example</h2>

<p>Much like the logger from the previous article, thunk middleware is available as<br>
the <code>redux-thunk</code> library.</p>
<blockquote>
<p>The middleware you just wrote is almost the entire original library! (<a href="https://github.com/gaearon/redux-thunk/blob/master/src/index.js">Check<br>
out the source code</a>). For more on thunks and handling<br>
asynchronicity in Redux, you can take a look at <a href="http://stackoverflow.com/questions/35411423/how-to-dispatch-a-redux-action-with-a-timeout/35415559#35415559">this interesting SO post from<br>
the creator</a>.</p>
</blockquote>
<p>Start by using npm to install the <code>redux-thunk</code> package:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> redux-thunk
</pre><p>Then apply the middleware to your store:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/store.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&apos;redux-thunk&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> logger <span class="token keyword">from</span> <span class="token string">&apos;redux-logger&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">configureStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">preloadedState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
    rootReducer<span class="token punctuation">,</span>
    preloadedState<span class="token punctuation">,</span>
    <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">,</span> logger<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> configureStore<span class="token punctuation">;</span>
</pre><p>Imagine that you&apos;re updating the Fruit Stand application to use a Node/Express<br>
API for data persistence. You would use a <code>fetchFruits</code> thunk action creator to<br>
retrieve the list of fruits from the API:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/actions/fruitActions.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">FRUIT_STAND_API_BASE_URL</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../config&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">RECEIVE_FRUITS</span> <span class="token operator">=</span> <span class="token string">&apos;RECEIVE_FRUITS&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">fetchFruits</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">FRUIT_STAND_API_BASE_URL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/fruits`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">receiveFruits</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>fruits<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">receiveFruits</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fruits</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token constant">RECEIVE_FRUITS</span><span class="token punctuation">,</span>
    fruits<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Notice that the Fetch API is used to make an HTTP request to the <code>/fruits</code> API<br>
endpoint. When the promise returned from the <code>fetch</code> method call resolves, the<br>
<code>res.json</code> method is called to parse the JSON into JavaScript objects, which in<br>
turn is dispatched to the store using the <code>receiveFruits</code> action creator. The<br>
<code>receiveFruits</code> action creator returns an action of type <code>RECEIVE_FRUITS</code> that<br>
includes the <code>fruit</code> payload.</p>
<p>In the <code>fruitReducer</code>, the <code>RECEIVE_FRUITS</code> case clause simply returns the<br>
<code>action.fruits</code> payload as the new state:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/reducers/fruitReducer.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">RECEIVE_FRUITS</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/fruitActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">fruitReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">RECEIVE_FRUITS</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> action<span class="token punctuation">.</span>fruits<span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> fruitReducer<span class="token punctuation">;</span>
</pre><p>To load the fruits from the API when the React application starts up, you can<br>
update the <code>index.js</code> file to dispatch the <code>fetchFruits</code> thunk action creator<br>
after creating the store:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/index.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string">&apos;./index.css&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&apos;./App&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> configureStore <span class="token keyword">from</span> <span class="token string">&apos;./store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchFruits <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./actions/fruitActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">fetchFruits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;root&apos;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="adding-configuration-for-the-api-base-url">Adding configuration for the API base URL</h3>

<p>The <code>FRUIT_STAND_API_BASE_URL</code> variable (imported at the top of the<br>
<code>fruitActions.js</code> file) is defined in the <code>config.js</code> file:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">FRUIT_STAND_API_BASE_URL</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">REACT_APP_FRUIT_STAND_API_BASE_URL</span><span class="token punctuation">;</span>
</pre><p>And the <code>REACT_APP_FRUIT_STAND_API_BASE_URL</code> environment variable is defined in<br>
an <code>.env</code> file (located in the root of the React project):</p>
<pre data-role="codeBlock" data-info class="language-"><code>REACT_APP_FRUIT_STAND_API_BASE_URL=http://localhost:8080
</code></pre><p>Adding configuration for the API base URL keeps you from having to hard-code a<br>
value that&apos;ll change between environments.</p>
<h2 class="mume-header" id="reviewing-a-completed-fruit-stand-example-6">Reviewing a completed Fruit Stand example</h2>

<p>To review and run a completed Fruit Stand example application that utilizes<br>
middleware and thunks to support asynchronous interaction with a backend API,<br>
clone the <a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the<br>
<code>fruit-stand-redux-with-react-middleware-thunks</code> folder.</p>
<h3 class="mume-header" id="running-the-api">Running the API</h3>

<p>To run the Node/Express API application, complete the following steps:</p>
<ol>
<li>
<p>Within the <code>backend</code> folder, add an <code>.env</code> file based upon the <code>.env.example</code><br>
file.</p>
</li>
<li>
<p>Use the following SQL statements to create a PostgreSQL database and user:</p>
</li>
</ol>
<pre data-role="codeBlock" data-info="sql" class="language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> fruit_stand<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> fruit_stand_app <span class="token keyword">with</span> encrypted password <span class="token string">&apos;&#xAB;a strong password for the fruit_stand_app user&#xBB;&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> <span class="token keyword">database</span> fruit_stand <span class="token keyword">to</span> fruit_stand_app<span class="token punctuation">;</span>
</pre><ol start="3">
<li>From a terminal, browse to the <code>backend</code> folder and run the following<br>
commands to apply the Sequelize migrations and seed data:</li>
</ol>
<pre data-role="codeBlock" data-info="sh" class="language-bash">npx dotenv sequelize db:migrate
npx dotenv sequelize db:seed:all
</pre><ol start="4">
<li>Start the application using <code>npm start</code>.</li>
</ol>
<h3 class="mume-header" id="running-the-react-application">Running the React application</h3>

<p>From the <code>frontend</code> folder, run the command <code>npm install</code> to install the<br>
project&apos;s dependencies. Then use the command <code>npm start</code> to run the Fruit Stand<br>
application.</p>
<p>This Fruit Stand example application is a React application created by the<br>
Create React App tooling. When running the application using <code>npm start</code>, the<br>
application should automatically open in your default browser. If it doesn&apos;t,<br>
you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<h2 class="mume-header" id="what-you-learned-16">What you learned</h2>

<p>In this article, you learned how to write a thunk action creator to make an<br>
asynchronous request to an API and dispatch an action when the response is<br>
received.</p>
<hr>
<h1 class="mume-header" id="advanced-containers">Advanced Containers</h1>

<p>While you learned in an earlier article that you should aim to have very few<br>
containers, there are exceptions. When you finish this article, you should be<br>
able to describe a situation where defining multiple containers for a single<br>
component is advantageous.</p>
<h2 class="mume-header" id="knowing-when-to-break-the-rules">Knowing when to break the rules</h2>

<p>Separating your concerns with presentational and container components allows you<br>
to reuse presentational components where it makes sense, rather than duplicating<br>
code. If a presentational component needs different data in each situation,<br>
though, you may need more containers. By creating more container components, you<br>
can render the same presentational component with each of those containers to<br>
suit different needs.</p>
<p>Consider a form component that may either <em>create</em> or <em>edit</em> a post. The form<br>
itself looks and works the same in both cases; it has a few inputs and a submit<br>
button. The use cases differ, though, in that the edit form needs to map state<br>
from the store to its props, while the create form does not. Furthermore, the<br>
edit form will need to dispatch a different action when the form submits than<br>
the create form will, as well as request the object from our backend.</p>
<p><strong>As you go through the code snippets below, read the comments carefully.</strong></p>
<p>Here&apos;s the presentational component, <code>PostForm</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// PostForm.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PostForm</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// set up initial state</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>post<span class="token punctuation">;</span> <span class="token comment">// a Post object has a title and a body</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// if we get a different post in props, we&apos;ll need to set state</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>post<span class="token punctuation">.</span>id <span class="token operator">!==</span> state<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> props<span class="token punctuation">.</span>post<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">field</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// `submit` will be a thunk action that presumably creates or edits a post</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>form onSubmit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>label<span class="token operator">&gt;</span>
          Title
          <span class="token operator">&lt;</span>input
            type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
            onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>title<span class="token punctuation">}</span>
          <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>label<span class="token operator">&gt;</span>
          Body
          <span class="token operator">&lt;</span>input
            type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
            onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&quot;body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>body<span class="token punctuation">}</span>
          <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>Submit Post<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PostForm<span class="token punctuation">;</span>
</pre><p>You can see that <code>PostForm</code> is expecting two things in props: a <code>post</code> object<br>
and a <code>submit</code> function. The container will have to define these, since right<br>
now, this form can&apos;t actually do anything. Give it the ability to create a post:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// CreatePostFormContainer.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PostForm <span class="token keyword">from</span> <span class="token string">&apos;./PostForm&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createPost <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/postActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    post<span class="token punctuation">:</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token string">&apos;&apos;</span> <span class="token punctuation">}</span> <span class="token comment">// a default blank object</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">submit</span><span class="token punctuation">:</span> <span class="token parameter">post</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createPost</span><span class="token punctuation">(</span>post<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  mapStateToProps<span class="token punctuation">,</span>
  mapDispatchToProps
<span class="token punctuation">)</span><span class="token punctuation">(</span>PostForm<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>So far, this is nothing new. Now, wherever you need a form to create a post, you<br>
can render <code>CreatePostFormContainer</code> by importing from the above file.</p>
<p>But what about editing? This is a little trickier, because you need more<br>
information from the store - so you&apos;ll need a <a href="https://spin.atomicobject.com/2017/03/02/higher-order-components-in-react/">higher-order component</a> to help<br>
you out. Higher-order components are a useful React pattern that essentially<br>
uses a component to render another component, usually to handle some sort of<br>
work and pass in data. This pattern allows us to keep your components small and<br>
modular. Here, you&apos;ll use a higher-order component to fetch the post you want to<br>
edit and pass it into the <code>PostForm</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// EditPostFormContainer.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PostForm <span class="token keyword">from</span> <span class="token string">&apos;./PostForm&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchPost<span class="token punctuation">,</span> updatePost <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/postActions&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> selectPost <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../reducers/postSelectors&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> ownProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> defaultPost <span class="token operator">=</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token string">&apos;&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token function">selectPost</span><span class="token punctuation">(</span>ownProps<span class="token punctuation">.</span>match<span class="token punctuation">.</span>params<span class="token punctuation">.</span>postId<span class="token punctuation">)</span> <span class="token operator">||</span> defaultPost<span class="token punctuation">;</span>
  <span class="token comment">// get the post this route is asking for</span>
  <span class="token comment">// (assuming here that this component is being rendered by a route)</span>
  <span class="token comment">// if you don&apos;t have the post in state yet, return a blank post so PostForm doesn&apos;t break</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> post <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// an edit form will need to fetch the relevant post, but the PostForm shouldn&apos;t handle that</span>
  <span class="token comment">// you&apos;ll handle this problem with a higher-order component, EditPostFormContainer</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">fetchPost</span><span class="token punctuation">:</span> <span class="token parameter">id</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">fetchPost</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">submit</span><span class="token punctuation">:</span> <span class="token parameter">post</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">updatePost</span><span class="token punctuation">(</span>post<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">EditPostForm</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">// this is the higher-order component made to handle the fetch</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do the fetching here so that PostForm doesn&apos;t have to</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">fetchPost</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>match<span class="token punctuation">.</span>params<span class="token punctuation">.</span>postId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// destructure the props so you can easily pass them down to PostForm</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> post<span class="token punctuation">,</span> submit <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>PostForm post<span class="token operator">=</span><span class="token punctuation">{</span>post<span class="token punctuation">}</span> submit<span class="token operator">=</span><span class="token punctuation">{</span>submit<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// now `connect` it to the Redux store</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  mapStateToProps<span class="token punctuation">,</span>
  mapDispatchToProps
<span class="token punctuation">)</span><span class="token punctuation">(</span>EditPostForm<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The result here is that we can render a <code>CreatePostFormContainer</code> wherever you<br>
want a form to create a post, and an <code>EditPostFormContainer</code> wherever you want<br>
to edit a post. Both components will render a <code>PostForm</code>, but each will have<br>
different functions. The <code>PostForm</code> also gets to be very simple and make almost<br>
no decisions. This helps keep your code DRY and modular.</p>
<p>You can use this pattern with any presentational component that needs to be<br>
connected to the store, but may need entirely different data to perform<br>
different functions.</p>
<h2 class="mume-header" id="what-you-learned-17">What you learned</h2>

<p>In this article, you learned about a situation where defining multiple<br>
containers for a single component is advantageous.</p>
<hr>
<h1 class="mume-header" id="redux-developer-tools">Redux Developer Tools</h1>

<p>Redux has its own special set of developer tools. They allow you to do things<br>
like inspect your application state in real time as you use your app, or cancel<br>
an action to see a live recalculation of the state as if that action had never<br>
been dispatched. They require only a few minutes of setup, and can be well worth<br>
the effort.</p>
<h2 class="mume-header" id="instructions">Instructions</h2>

<ol>
<li>
<p>Install the <a href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd">chrome extension</a>.</p>
</li>
<li>
<p>Install the npm package into your project:</p>
</li>
</ol>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> redux-devtools-extension
</pre><ol start="3">
<li>Make the following changes to your <code>./src/store.js</code> file.</li>
</ol>
<p><strong>If you&apos;re <em>not</em> using middleware:</strong></p>
<pre data-role="codeBlock" data-info="diff" class="language-diff">  // ./src/store.js

  import { createStore } from &apos;redux&apos;;
<span class="token inserted">+ import { devToolsEnhancer } from &apos;redux-devtools-extension&apos;;</span>

  import rootReducer from &apos;./reducers/rootReducer&apos;;

  const configureStore = () =&gt; {
    return createStore(
      rootReducer,
<span class="token inserted">+     devToolsEnhancer()</span>
    );
  };

  export default configureStore;
</pre><p><strong>Or if you&apos;re using middleware:</strong></p>
<pre data-role="codeBlock" data-info="diff" class="language-diff">  // ./src/store.js

  import { createStore, applyMiddleware } from &apos;redux&apos;;
  import thunk from &apos;redux-thunk&apos;;
  import logger from &apos;redux-logger&apos;;
<span class="token inserted">+ import { composeWithDevTools } from &apos;redux-devtools-extension&apos;;</span>

  import rootReducer from &apos;./reducers/rootReducer&apos;;

  const configureStore = () =&gt; {
    return createStore(
      rootReducer,
<span class="token inserted">+     composeWithDevTools(applyMiddleware(thunk, logger))</span>
<span class="token deleted">-     applyMiddleware(thunk, logger)</span>
    );
  };

  export default configureStore;
</pre><h2 class="mume-header" id="use">Use</h2>

<p>Now that you&apos;ve set up the Redux dev tools, you can try them out. You&apos;ll use one<br>
of the Fruit Stand application examples. If you haven&apos;t already, clone the<br>
<a href="https://github.com/appacademy-starters/redux-fruit-stand-examples">redux-fruit-stand-examples</a> repo.</p>
<p>After cloning the repo, open a terminal and browse to the<br>
<code>fruit-stand-redux-with-react-official-bindings</code> folder. Run the command <code>npm install</code> to install the project&apos;s dependencies. Then use the command <code>npm start</code><br>
to run the Fruit Stand application.</p>
<p>This Fruit Stand example application is a React application created by the<br>
Create React App tooling. When running the application using <code>npm start</code>, the<br>
application should automatically open in your default browser. If it doesn&apos;t,<br>
you can manually browse to <code>http://localhost:3000/</code> to view the application.</p>
<p><strong>Open the project into your code editor and complete the above set up steps.</strong></p>
<p>You should see an atom (a nucleus with electrons) icon on your Chrome toolbar,<br>
and if you&apos;ve set up the Redux dev tools correctly it should now be green. Click<br>
on it. When the Redux dev tools open, click one of the buttons on the very<br>
bottom left to open them in a new window.</p>
<p>Now try adding some fruit. This will cause actions to be dispatched. You should<br>
see those actions popping up in the Redux dev tools. You can click on them to<br>
cancel them and you should see the state recalculated in real time.</p>
<p>The Redux dev tools have some other handy features, so click around and explore!</p>
<h2 class="mume-header" id="resources">Resources</h2>

<ul>
<li><a href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd">Redux Dev Tools - Chrome Extension</a></li>
<li><a href="https://github.com/gaearon/redux-devtools">Redux Dev Tools - Github Page</a></li>
<li><a href="http://extension.remotedev.io/#demo">Redux Dev Tools - Demo</a></li>
</ul>
<hr>
<h1 class="mume-header" id="redux-based-pokedex-project">Redux-Based Pokedex Project</h1>

<p>Instead of building a new application, you will spend time refactoring an<br>
existing application, one that is not yours. Navigating around someone else&apos;s<br>
code is an interesting way to learn what to do and what <em>not</em> to do. The<br>
starter application is in a little bit of a mess and needs your help to get<br>
unmessed.</p>
<p>By the end of this walk-through, you will be able to:</p>
<ul>
<li>Describe the Redux data cycle</li>
<li>Explain a <em>reducer</em></li>
<li>Configure a React application to use Redux</li>
<li>Use connected components to access Redux state</li>
<li>Use composed reducers to simplify state management</li>
<li>Configure a React application to use the Redux development tools</li>
</ul>
<h2 class="mume-header" id="getting-started">Getting started</h2>

<p>You&apos;ll need the backend of the application.</p>
<p>If you have <em>not</em> cloned it, please clone the repository from<br>
<a href="https://github.com/appacademy-starters/pokedex-backend">https://github.com/appacademy-starters/pokedex-backend</a>.</p>
<p>If you have cloned it, please get the latest (things sometimes change) by going<br>
to the repository in your Terminal and typing <code>git pull origin master</code>. This<br>
will get the latest code for you.</p>
<p>You&apos;ll need the starter application. Please clone the repository from<br>
<a href="https://github.com/appacademy-starters/redux-pokedex-starter">https://github.com/appacademy-starters/redux-pokedex-starter</a>.</p>
<h2 class="mume-header" id="tour-the-application">Tour the application</h2>

<p>This application is a Heroku-deployable React application. Here are the files<br>
that are in it. Hopefully, you find nothing surprising about the file layout or<br>
the intent of each file. Take a moment to look in each file to get the lay of<br>
the land. (Really, take a look in each file. You may feel like jumping right<br>
into it, but looking at other people&apos;s code is helpful. This is one of the<br>
benefits to the pair-programming learning style at App Academy.)</p>
<pre data-role="codeBlock" data-info class="language-"><code>.
&#x251C;&#x2500;&#x2500; package-lock.json        - The NPM lock file
&#x251C;&#x2500;&#x2500; package.json             - The NPM file
&#x251C;&#x2500;&#x2500; public
&#x2502;&#xA0;&#xA0; &#x2514;&#x2500;&#x2500; index.html           - The page that gets served to the browser
&#x251C;&#x2500;&#x2500; server.js                - A very light-weight server for Heroku
&#x2514;&#x2500;&#x2500; src
    &#x251C;&#x2500;&#x2500; App.js               - The main application component
    &#x251C;&#x2500;&#x2500; Fab.js               - A floating action button component
    &#x251C;&#x2500;&#x2500; LoginPanel.js        - The form that shows the login
    &#x251C;&#x2500;&#x2500; LogoutButton.js      - A component for logging out
    &#x251C;&#x2500;&#x2500; PokemonBrowser.js    - The component that shows the list and detail
    &#x251C;&#x2500;&#x2500; PokemonDetail.js     - The component that shows the detail of a Pokemon
    &#x251C;&#x2500;&#x2500; PokemonForm.js       - The form to create a new Pokemon
    &#x251C;&#x2500;&#x2500; config.js            - Configuration variables
    &#x251C;&#x2500;&#x2500; index.css            - Styling for the application
    &#x2514;&#x2500;&#x2500; index.js             - The main entry point for Webpack
</code></pre><p>Start the backend with <code>npm run dev</code>. Start the React application with <code>npm run dev</code>. Make sure it runs. It looks for a local backend at<br>
<code>http://localhost:8000</code>, so make sure that&apos;s where the backend is running.</p>
<h2 class="mume-header" id="install-redux-and-devtools">Install Redux and DevTools</h2>

<p>If you haven&apos;t already, install <a href="https://github.com/zalmoxisus/redux-devtools-extension#installation">Redux DevTools</a>. During development, you can<br>
watch the Redux store handle actions and change state in the timeline.</p>
<p>To use Redux in this application, you need to install it and the connector<br>
between Redux and React. You will also want to use asynchronous actions with the<br>
Redux store, so you&apos;ll want a middleware, one like <a href="https://github.com/reduxjs/redux-thunk">Redux Thunk</a>.</p>
<pre data-role="codeBlock" data-info class="language-"><code>npm install react-redux redux redux-thunk
</code></pre><p>There are more than one asynchronous action-handling middleware out there in<br>
the world. Redux Thunk happens to be one of the oldest and widely used.</p>
<p>Whenever you consider installing a library or framework, you should make sure<br>
that your existing application meets the expectations. For example, as of the<br>
time of this writing, to <a href="https://react-redux.js.org/introduction/quick-start">install &quot;react-redux&quot;</a>, your application needs to<br>
support <strong>React 16.8.3</strong> or later. Take a look in the <strong>package.json</strong> file to<br>
make sure that an acceptable version of React is listed in there. If not, you<br>
will need to upgrade the version of React used by this project by running<br>
something like <code>npm upgrade</code>.</p>
<h2 class="mume-header" id="setting-up-the-store">Setting up the store</h2>

<p>The <em>store</em> is the object (and supporting objects and functions) that will<br>
contain the state of the application. This centralizes the state so that,<br>
presumably, you can better reason about it.</p>
<p>There are a couple of ways to organize your state management code, each with<br>
their own benefits. Redux has a list of different articles about <a href="https://redux.js.org/faq/code-structure/">this very<br>
topic</a>. You should choose to organize your code in a way that makes sense to<br>
your team (or follow any conventions that already exist). This walk-through will<br>
follow the <a href="https://github.com/erikras/ducks-modular-redux">Ducks</a> approach of layout.</p>
<p>In the <strong>src</strong> directory, create a new directory named <strong>store</strong>. In that new<br>
directory, create a new file named <strong>configureStore.js</strong>. In that file, put<br>
this code. This is boilerplate code and will appear in nearly every application<br>
that you have that uses Redux. A description of the contents follows the code<br>
block.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware<span class="token punctuation">,</span> combineReducers<span class="token punctuation">,</span> compose <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&apos;redux-thunk&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> composeEnhancers <span class="token operator">=</span> window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ <span class="token operator">||</span> compose<span class="token punctuation">;</span>

<span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">configureStore</span> <span class="token operator">=</span> <span class="token parameter">initialState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
    reducer<span class="token punctuation">,</span>
    initialState<span class="token punctuation">,</span>
    <span class="token function">composeEnhancers</span><span class="token punctuation">(</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> configureStore<span class="token punctuation">;</span>
</pre><p>(If you&apos;re looking in your console after putting this code in there, you&apos;ll<br>
see an error about not having any valid reducers. That&apos;s true, there are no<br>
valid reducers. You&apos;ll fix that in just a moment.)</p>
<p>On those first two lines, the code imports the stuff it will need to create and<br>
configure a store.</p>
<ul>
<li><code>createStore</code> is the function from Redux that creates the state-management<br>
object</li>
<li><code>applyMiddleware</code> allows you to plug in extra functionality into the<br>
state-management workflow (in this case, Redux Thunk)</li>
<li><code>combineReducers</code> takes many reducers and combines them into a single one</li>
<li><code>compose</code> is a function that <em>composes</em> functions from right-to-left, that is,<br>
it puts them together, the return value of the right-most getting passed to<br>
the second right-most, return values getting passed from that to the third<br>
right-most, and so on, until the first function in the list returns its final<br>
value to the store (<a href="https://redux.js.org/api/compose">documentation</a> for compose)</li>
<li><code>thunk</code> is the middleware that will allow you to make asynchronous calls<br>
because you can&apos;t do that in Redux actions</li>
</ul>
<p>The fourth line creates a new <code>composeEnhancers</code> variable that will be either<br>
the Redux DevTools special compose function, or the one from Redux, if DevTools<br>
is not installed. This allows browsers that have the DevTools installed to take<br>
advantage of watching the changes in the store.</p>
<p>The sixth and seventh lines is just the thing that combines the reducers for<br>
the store into a single reducer. More about that later.</p>
<p>The ninth line declares a function that gets exported at the end of the file<br>
that creates and configures the store with the <code>reducer</code>, the <code>initialState</code><br>
passed into the function, and composes the React Thunk middleware and the Redux<br>
DevTools, if they exist.</p>
<p>To use this functionality, open <strong>src/index.js</strong> and add two imports to the top<br>
of the file.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> configureStore <span class="token keyword">from</span> <span class="token string">&apos;./store/configureStore&apos;</span><span class="token punctuation">;</span>
</pre><p>Those two lines import a Context Provider from React Redux and the function you<br>
just created above. Now, under those lines and before the <code>ReactDOM.render</code><br>
statement, create a store.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Finally, wrap the <code>App</code> component in a <code>Provider</code> component that has a &quot;store&quot;<br>
property assigned the value of <code>store</code> that you created in the previous code<br>
snippet, just as you saw in the <em>Passing the Store</em> section of the <em>Usage with<br>
React</em> article you read in the homework preparing you for these topics.</p>
<p>If everything works, you should be able to view the Redux DevTools in your<br>
browser&apos;s DevTools environment as a new tab. You should see the &quot;@@INIT&quot; action<br>
that was run and an empty state.</p>
<p><img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/aggregates/pokedex/redux-based/assets/redux-initial-state-devtools.png" alt="Redux DevTools initialization"></p>
<h2 class="mume-header" id="your-first-action-workflow">Your first action workflow</h2>

<p>Now, you will refactor the <code>LoginPanel</code> component to put the token it receives<br>
from the AJAX call into the Redux store. The rest of the application will remain<br>
the same, for now.</p>
<p>Open <code>LoginPanel</code> and review it. There are two &quot;interesting&quot; portions of this<br>
code, the <code>render</code> function which will redirect to the path &quot;/&quot; when a token<br>
exists (and show the login form if it does not), and the <code>handleSubmit</code> method<br>
that makes the actual AJAX call to get the token. These are the things that you<br>
will modify to make this work. It&apos;s going to seem like a lot of code replacing<br>
just a few lines, but this will make your application easier to understand<br>
because all of the state changes will be encapsulated in their own area under<br>
the <strong>store</strong> directory. You won&apos;t have to search through a bunch of components<br>
to figure out why the application as a whole is not working.</p>
<p>The first step is to make <code>LoginPanel</code> a <em>connected component</em>, that is, connect<br>
it to the Redux store&apos;s pipeline. To do this, follow these steps:</p>
<ol>
<li>
<p>Import <code>connect</code> from <code>react-redux</code> in the import section of the<br>
<code>LoginPanel</code>.</p>
</li>
<li>
<p>Remove the <code>export</code> line at the bottom and replace it with this.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Yes, this looks funny, but you will often</span>
<span class="token comment">// see this kind of indentation in others&apos;</span>
<span class="token comment">// code when using React and Redux.</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  mapStateToProps<span class="token punctuation">,</span>
  mapDispatchToProps
<span class="token punctuation">)</span><span class="token punctuation">(</span>
  LoginPanel
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></li>
</ol>
<p>The last line of the code <em>connects</em> the <code>LoginPanel</code> to the Redux store. The<br>
two functions that you created above it, <code>mapStateToProps</code> and<br>
<code>mapDispatchToProps</code> are functions that you will write to help in translating<br>
state and actions for use in your component. The <code>mapStateToProps</code> function maps<br>
the state of the Redux store to the values that you want to show up in the<br>
<code>props</code> of the connected component. The <code>mapDispatchToProps</code> function maps<br>
complicated action calls to simple ones that your component can use.</p>
<p>The first thing you&apos;ll need is one of those actions. This is going to be<br>
something to let your authentication run to get that token. In the <strong>src/store</strong><br>
directory, create a new file named <strong>authentication.js</strong> which will contain<br>
all of the Redux-related stuff to handle authentication:</p>
<ul>
<li>the actions,</li>
<li>the action types,</li>
<li>the thunks (which are just actions that are allowed to perform calls<br>
that have use resources <em>outside</em> the function, like AJAX calls or putting<br>
something into local storage), and,</li>
<li>the reducers.</li>
</ul>
<p>The steps that you want the application to go through are:</p>
<ul>
<li>Make an AJAX call to sign in (that&apos;s a <em>thunk</em>)</li>
<li>When the token returns, create an <em>action</em> that will send the token to the<br>
store</li>
<li>Create a reducer to put the token in the store</li>
</ul>
<p>Most of these steps will need something more, so if you see something not<br>
defined in one of these steps, you will get to it in a later step.</p>
<h3 class="mume-header" id="the-thunk">The thunk</h3>

<p>In case you lost track, this goes in <strong>src/store/authentication.js</strong>.</p>
<p>First up, <em>thunks</em> are functions that return another function that takes a<br>
single function as its argument. The argument is the <code>dispatch</code> method used to<br>
dispatch actions to Redux. So, for example, the <code>login</code> thunk could have this<br>
form.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">email<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">async</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Dispatch an action, here</span>
<span class="token punctuation">}</span>
</pre><p>That&apos;s pretty weird, if you&apos;ve never seen that syntax before, those double <code>=&gt;</code><br>
signs in there. It&apos;s a shortcut to write a function that returns a function. You<br>
could also write it like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">email<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Dispatch an action, here</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>Once you get used to the double (or triple) <code>=&gt;</code> signs, it becomes second nature<br>
to write functions that return functions, that way.</p>
<p>Inside the login method, make a <code>fetch</code> call to the API using the same <code>fetch</code><br>
call found in <code>LoginPanel</code>&apos;s <code>handleSubmit</code> method. You&apos;ll need to import<br>
<code>baseUrl</code> from the <strong>src/config.js</strong> module. You don&apos;t have access to the state<br>
of the object, just the <code>email</code> and <code>password</code> that they&apos;re passing in through<br>
your method call, so change the &quot;body&quot; parameter of the <code>fetch</code> from<br>
<code>JSON.stringify(this.state),</code> to <code>JSON.stringify({ email, password }),</code>.</p>
<p>For now, if the response from the fetch is ok, just get the token out of the<br>
response object and log it to the console.</p>
<p>Now, to hook up this thunk to your component, open <strong>src/LoginPanel.js</strong> and<br>
import the <code>login</code> thunk that you just created. At the bottom in the<br>
<code>mapDispatchToProps</code> function, add a &quot;login&quot; key that is a function that<br>
takes an email and password, and then dispatches the <code>login</code> thunk with those<br>
values.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">return</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">login</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">email<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">login</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now, there&apos;s a &quot;login&quot; property on the <code>props</code> handed to the <code>LoginPanel</code><br>
component. The value of the &quot;login&quot; property is a function that takes an<br>
<em>email</em> and a <em>password</em>. Those then get handed to the <code>login</code> thunk which<br>
returns a function to the <code>dispatch</code> function of Redux. It&apos;s functions all the<br>
way down.</p>
<p>Now, delete everything from the <code>handleSubmit</code> method <em>except</em> the line that<br>
prevents the default action. Replace it with a call to the function in the<br>
&quot;login&quot; property of the <code>props</code> like this.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>email<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>After the application refreshes, you should be able to click the <em>Login</em> button<br>
on the screen and see token appear after the AJAX call completes.</p>
<p>Now that you have the token, you need to dispatch another action, one that isn&apos;t<br>
created yet, to set the token in the state so it can be used elsewhere. Remove<br>
the <code>console.log</code> statement in your <code>login</code> thunk and replace it with an<br>
invocation of the <code>dispatch</code> method that your thunk gets, dispatching an action<br>
creator named <code>setToken</code> with the token as its argument.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><p>Now, it&apos;s time to create that action.</p>
<h3 class="mume-header" id="the-action">The action</h3>

<p>Actions are just plain objects that have, at a minimum, a &quot;type&quot; property.<br>
Action creators are just plain functions that return actions.</p>
<p>Below your import section and above the <code>login</code> thunk of your code in<br>
<strong>src/store/authentication.js</strong>, create a constant named <code>SET_TOKEN</code> and set it<br>
equal to the string <code>&apos;pokedex/authentication/SET_TOKEN&apos;</code>. You could make this<br>
string <em>anything</em>, it just needs to be unique within your application. This is<br>
merely the <a href="https://github.com/erikras/ducks-modular-redux">Ducks</a> convention.</p>
<p>Now, create a function <code>setToken</code> that takes a token as its one parameter, and<br>
returns an object that has a &quot;type&quot; property set to the <code>SET_TOKEN</code> constant and<br>
a &quot;token&quot; property set to the value passed into the parameter. Export the<br>
<code>setToken</code> function.</p>
<p>If you&apos;ve done everything correctly to this point, when you click the <em>Login</em><br>
button, you should now see an action appear in the Redux DevTools with the<br>
string that you set the <code>SET_TOKEN</code> constant to.</p>
<p><img src="images/redux-set-token-action-devtools.png" alt="Redux DevTools with SET_TOKEN action"></p>
<p>Now, you need to tell Redux how to handle that action with a reducer.</p>
<h2 class="mume-header" id="the-reducer">The reducer</h2>

<p>Somewhere in the <strong>src/store/authentication.js</strong> file, export a <code>reducer</code><br>
function as the default value of the module. The <code>state</code> parameter gets a<br>
default value of an empty object because Redux does not like <code>undefined</code> values<br>
returned from reducers. Redux <em>will</em> call your reducer when it creates the store<br>
with <code>undefined</code> just to mess with you.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Your code in here.</span>
<span class="token punctuation">}</span>
</pre><p>In that reducer, you want to check if the &quot;type&quot; property of <code>action</code> is equal<br>
to the <code>SET_TOKEN</code> constant. Every reducer is called with every action, so you<br>
have to do this check. If it is, then you should return an object with the<br>
token in it. If it doesn&apos;t, then just return the state unaltered. Idiomatic<br>
Redux usually uses a <code>switch</code> statement to do this with each <code>case</code> statement<br>
handling a different action type.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">SET_TOKEN</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span>
        token<span class="token punctuation">:</span> action<span class="token punctuation">.</span>token<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</pre><h3 class="mume-header" id="adding-the-reducer-to-the-store">Adding the reducer to the store</h3>

<p>Now that you have the reducer handling the action, you must add it to the<br>
reducer in <strong>src/store/configureStore.js</strong>. Open up that file and import the<br>
default value as <code>authentication</code> from the <strong>src/store/authentication.js</strong><br>
module.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> authentication <span class="token keyword">from</span> <span class="token string">&apos;./authentication&apos;</span><span class="token punctuation">;</span>
</pre><p>Then, in the <code>combineReducers</code> invocation, add <code>authentication</code> as a key and<br>
value.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  authentication
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>After the page reloads, when you click the <em>Login</em> button, you should now see<br>
the authentication and token appear in the right pane of the Redux DevTools.<br>
(You may need to select the action in the left pane.)</p>
<h2 class="mume-header" id="using-the-token">Using the token</h2>

<p>Now, you&apos;ve come full circle. You&apos;re going to use the token in the store to<br>
inform the <code>LoginPanel</code> that it needs to close. In the <code>render</code> function, the<br>
code uses <code>this.state.token</code> to determine whether or not to redirect. You want<br>
that to use <code>this.props.token</code>, now, so change it to that.</p>
<p>To get the token value from the state of the Redux store into the <code>props</code>, you<br>
use <code>mapStateToProps</code> function that you created below. Change it to read like<br>
this, now, which takes the value of the token stored in the state and puts it<br>
into the &quot;token&quot; property of what will be passed to <code>LoginPanel</code> in its <code>props</code>.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    token<span class="token punctuation">:</span> state<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span>token<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now, when you click the <em>Login</em> button, it redirects the application back to<br>
&quot;/&quot;. However, because <code>App</code> relies on its own state to get updated from a call<br>
to its <code>updateToken</code> method, it goes into an recursive loop of redirecting back<br>
and forth between the <code>App</code> component and the <code>LoginPanel</code>. You&apos;ll fix that in<br>
the next section.</p>
<hr>
<h1 class="mume-header" id="more-state-moving">More State Moving</h1>

<p>The application is cleaner, but now has that bug of infinite redirecting. You<br>
will first fix that.</p>
<h2 class="mume-header" id="fixing-the-loop">Fixing the loop</h2>

<p>In the <code>App</code> component, it would change state in response to the <code>LoginPanel</code><br>
calling the <code>updateToken</code> method. The <code>LoginPanel</code> no longer does that because<br>
it dispatches its information to a thunk that makes the AJAX call and, in turns,<br>
dispatches an action that updates the Redux store. Then, <code>LoginPanel</code> uses the<br>
value from the store to no that something good has happened. You need to have<br>
<code>App</code> do the same.</p>
<p>Since <code>updateToken</code> is no longer used, remove the method and all of its uses<br>
from the <code>App</code> component.</p>
<p>When you have that done, you may notice that the route that shows the<br>
<code>LoginPanel</code> looks like this.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/login&quot;</span>
  render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>LoginPanel <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</pre><p>That is rendering <code>LoginPanel</code> and passing its props to it. That&apos;s just like<br>
using the &quot;component&quot; property of the <code>Route</code> component, so change it to use<br>
that instead of the more expensive &quot;render&quot; property.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/login&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>LoginPanel<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</pre><p>You&apos;re still in a render loop, so that hasn&apos;t fixed it. Time to connect <code>App</code> to<br>
the Redux store.</p>
<ol>
<li>Like you did in <code>LoginPanel</code>, import the <code>connect</code> function from the<br>
&quot;react-redux&quot; module.</li>
<li>Then, just like you did in <code>LoginPanel</code>, declare <code>mapStateToProps</code> and<br>
<code>mapDispatchToProps</code> functions after the component.</li>
</ol>
<ul>
<li>In the <code>mapStateToProps</code> function, map the token to a property named &quot;token&quot;<br>
identically to the way it is done in <code>LoginPanel</code>.</li>
<li>You have no actions, right now, so leave <code>mapDispatchToProps</code> just returning<br>
an empty object.</li>
</ul>
<ol start="3">
<li>Finally, connect <code>App</code> to the Redux store using those functions.</li>
</ol>
<p>That puts the value of the token into the props. In the actual <code>App</code> component,<br>
now find everywhere that uses <code>this.state.token</code> and replace it with<br>
<code>this.props.token</code>.</p>
<p>Try logging in, again. Still doesn&apos;t work. That&apos;s because <code>App</code> relies on<br>
another setting in its state named &quot;needLogin&quot; which is just a Boolean value<br>
that is basically the opposite of whether the token has a value. If there is a<br>
token, there is no need to login. If there is no token, there is a need to<br>
login. You can figure that out in the <code>mapStateToProps</code> function! Create another<br>
property, one named &quot;needLogin&quot;, in the object returned from the function. If<br>
there <em>is</em> a value in <code>state.authentication.token</code>, then set it to <code>false</code>. If<br>
there is <em>no</em> value (or an empty string) in <code>state.authentication.token</code>, then<br>
set &quot;needLogin&quot; to <code>true</code>. Once you have that, find every use of<br>
<code>this.state.needLogin</code> and replace it with <code>this.props.needLogin</code>.</p>
<p>You have now fixed the problem with the infinite redirects! And, once you log<br>
into the application, you can check that the <code>App</code> component <em>is</em> rendering the<br>
<code>PokemonBrowser</code> component. However, it is not showing anything. That&apos;s because<br>
the <code>App</code> component calls its <code>loadPokemon</code> method in the <code>componentDidMount</code><br>
method. There&apos;s no token at that time in its state because the token now comes<br>
from Redux.</p>
<p>What would be great is if, after logging in, the <code>login</code> action loaded the<br>
Pokemon for you, put them in the store, and <code>PokemonBrowser</code> could just use<br>
them directly.</p>
<p>Oh, that&apos;s what you&apos;ll do next.</p>
<h2 class="mume-header" id="getting-the-list-of-pokemon">Getting the list of Pokemon</h2>

<p>Now, you need some actions, thunks, and reducers for Pokemon, not<br>
authentication. Create a new file <strong>src/store/pokemon.js</strong>. In there, create the<br>
following items.</p>
<ul>
<li>An action type named <code>LOAD</code> with a value of &apos;pokedex/pokemon/LOAD&apos;</li>
<li>An action creator named <code>load</code> that takes in a list of Pokemon and creates<br>
an action with the type of <code>LOAD</code> and the list of Pokemon in it</li>
<li>A reducer that checks for the &quot;LOAD&quot; action and adds the list of Pokemon to<br>
the state (and returns just the state if the action is not &quot;LOAD&quot;)</li>
<li>Make sure the reducer has a default value for its <code>state</code> parameter</li>
</ul>
<p>Now, you need to make a thunk that will make the AJAX call. Call your think<br>
&quot;getPokemon&quot;. The thunk needs the token from the state to make its API call. The<br>
function that gets the &quot;dispatch&quot; parameter can also get a second parameter, a<br>
function conventionally called &quot;getState&quot;. Your thunk could look like this.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getPokemon</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">dispatch<span class="token punctuation">,</span> getState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> authentication<span class="token punctuation">:</span> <span class="token punctuation">{</span> token <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// AJAX call</span>
  <span class="token comment">// Handle response</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Then, in <strong>configureStore.js</strong>, import the default reducer and add it to the<br>
<code>combineReducers</code> argument as the &quot;pokemon&quot; property next to &quot;authentication&quot;.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  authentication<span class="token punctuation">,</span>
  pokemon<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now, you just need to kick off that AJAX call. It seems only reasonable that<br>
the component that actually needs it kicks it off, the <code>PokemonBrowser</code><br>
component. In <code>PokemonBrowser</code>, do the following:</p>
<ul>
<li>Import the <code>connect</code> function from &quot;react-redux&quot;</li>
<li>Import the <code>getPokemon</code> thunk you just created</li>
<li>Create a <code>mapStateToProps</code> function that maps the list of Pokemon from<br>
<code>state.pokemon.list</code> (or whatever you called your property in the reducer)<br>
to a property named &quot;pokemon&quot;</li>
<li>Create a <code>mapDispatchToProps</code> function that returns an object with a property<br>
named &quot;getPokemon&quot; that dispatches the <code>getPokemon</code> thunk you imported</li>
<li>Connect your component to the Redux store using <code>connect</code>, <code>mapStateToProps</code>,<br>
and <code>mapDispatchToProps</code></li>
<li>Add a <code>componentDidMount</code> method to the <code>PokemonBrowser</code> component and call<br>
<code>this.props.getPokemon()</code> from it</li>
</ul>
<p>Now, when you log into the application, you should see two actions in your<br>
Redux store!</p>
<p><img src="https://github.com/zalmoxisus/redux-devtools-extension#installation" alt="Pokemon LOAD action in Redux DevTools"></p>
<p>More importantly, you should see the list of Pokemon in the <code>PokemonBrowser</code><br>
actually appear in the browser.</p>
<h2 class="mume-header" id="clean-up-the-app-component">Clean up the App component</h2>

<p>Previously, all of the fetching logic for the list of Pokemon was handled by the<br>
<code>App</code> component. You can now get rid of the <code>loadPokemon</code> method and clean up<br>
any calls to it. Also, anywhere that refers to <code>this.state.pokemon</code> or using<br>
<code>setState</code> to update the &quot;pokemon&quot; property, you should get rid of all of that.<br>
This makes the <code>handleCreated</code> method empty, so get rid of that and all<br>
references to it, too, in the <code>App</code> component.</p>
<p>Because the <code>App</code> component doesn&apos;t make any AJAX calls, anymore, it doesn&apos;t<br>
need the token from the state. Remove the &quot;token&quot; property in <code>mapStateToProps</code><br>
and everywhere <code>token</code> is used in the <code>App</code> component. Include the call to<br>
local storage, too, in the deleting of things. You can remove the import of<br>
<code>baseUrl</code>, too, because there are no AJAX calls in the file.</p>
<p>Now, because <code>cProps</code> in the <code>render</code> method is empty, delete it and its uses<br>
in the <code>PrivateRoute</code> components below it. Now that the code is not using<br>
<code>cProps</code>, you can delete the parameter and its use from the <code>PrivateRoute</code><br>
component on line 8 (or so) of the <strong>src/App.js</strong> file.</p>
<h2 class="mume-header" id="storing-the-token-in-local-storage">Storing the token in local storage</h2>

<p>Actions that use outside resources like AJAX calls and local storage <em>must</em> be<br>
created in thunks. Back in the <strong>src/store/authentication.js</strong> module, do two<br>
things:</p>
<ul>
<li>Create a constant named <code>TOKEN_KEY</code> and set it equal to some non-empty string</li>
<li>In the <code>login</code> thunk, between getting the token from the response and<br>
dispatching the <code>setToken</code> action, write the token to local storage using the<br>
constant <code>TOKEN_KEY</code></li>
</ul>
<h2 class="mume-header" id="reading-the-token-out-of-local-storage">Reading the token out of local storage</h2>

<p>You need a new thunk to do this. Create a thunk named <code>loadToken</code> that takes no<br>
parameters, and returns a function that accepts a &quot;dispatch&quot; parameter. Then,<br>
implement it to read the value from local storage using the <code>TOKEN_KEY</code><br>
constant. If a value comes back, have it dispatch the <code>setToken</code> action.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">loadToken</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">async</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Read the token from local</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>In the <code>App</code> component, import the <code>loadToken</code> thunk. Use it in the<br>
<code>mapDispatchToProps</code> by mapping the dispatch of the <code>loadToken</code> thunk to a<br>
property of the same name.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">loadToken</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">loadToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Invoke that <code>loadToken</code> method in the <code>componentDidMount</code> method of the<br>
<code>App</code> component.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">async</span> <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loaded<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">loadToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>The moment you do that, the page should refresh and you should see the Pokemon<br>
browser rather than the login form.</p>
<p>You&apos;re halfway home!</p>
<hr>
<h1 class="mume-header" id="making-decisions-about-state">Making Decisions About State</h1>

<p>Now, it&apos;s time to log out of the application. Do that with the following<br>
steps.</p>
<p>The steps that the application will take are these:</p>
<ol>
<li>Someone clicks the logout button</li>
<li>The <code>LogoutButton</code> component dispatches a thunk</li>
<li>The thunk makes the AJAX call to logout</li>
<li>If that AJAX call succeeds, remove the token from local storage and dispatch<br>
an action to remove the token from the store</li>
<li>Redux will invoke a reducer that removes the token from the store</li>
<li>The <code>LogoutButton</code> will redirect the application back to &quot;/login&quot;</li>
</ol>
<p>In <strong>src/store/authentication.js</strong>:</p>
<ul>
<li>
<p>Create a new action type named <code>REMOVE_TOKEN</code></p>
</li>
<li>
<p>Create a new action creator that returns an action with just the &quot;type&quot;<br>
property set to the value of <code>REMOVE_TOKEN</code></p>
</li>
<li>
<p>Create a thunk named <code>logout</code> that</p>
<ul>
<li>makes an AJAX call to the API to <code>DELETE /api/session</code> (using the token in<br>
the state)</li>
<li>if the response is ok, then
<ul>
<li>removes the item from local storage with the key <code>TOKEN_KEY</code></li>
<li>dispatches the <code>removeToken</code> action</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Handles the <code>REMOVE_TOKEN</code> action type in the reducer by creating a new<br>
object that does <em>not</em> have the &quot;token&quot; key in it and returning that.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">case</span> <span class="token constant">REMOVE_TOKEN</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newState <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">delete</span> newState<span class="token punctuation">.</span>token<span class="token punctuation">;</span>
  <span class="token keyword">return</span> newState<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>Remember that handlers in reducers <em>must</em> return new objects if they want to<br>
modify the state.</p>
</li>
</ul>
<p>In <strong>src/LogoutButton.js</strong>:</p>
<p>(If you make a mistake with this and get into an inconsistent state, just delete<br>
all of the contents of your local storage and refresh your browser.)</p>
<ul>
<li>Import <code>connect</code> from &quot;react-redux&quot;</li>
<li>Import the <code>logout</code> thunk you just created</li>
<li>Create the <code>mapStateToProps</code> and set a property named <code>loggedOut</code> to <code>true</code> if<br>
the token in the state is empty, and <code>false</code> if there is a value for the token<br>
in the state</li>
<li>Create the <code>mapDispatchToProps</code> and set the &quot;logout&quot; property equal to a<br>
function that dispatches the result of the <code>logout</code> thunk you imported</li>
<li>In the <code>LogoutButton</code>&apos;s method named &quot;logout&quot;, instead of making an AJAX call,<br>
have it call <code>this.props.logout()</code>, instead</li>
<li>Get rid of the</li>
<li>Get rid of initializing the state in the constructor</li>
<li>Change the use of <code>this.state.loggedOut</code> to <code>this.props.loggedOut</code></li>
<li>Remove any unused imports</li>
</ul>
<p>If you check the console, now, you&apos;ll see that Babel is reporting a &quot;useless&quot;<br>
constructor. Sure enough, it is. <code>LogoutButton</code> no longer has any state, so<br>
there&apos;s no reason to leave it as a class-based component. Convert it to a<br>
function-based component. If you&apos;ve followed these instructions, your<br>
<code>LogoutButton</code> should end up looking something like this.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">LogoutButton</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span>
  props<span class="token punctuation">.</span>loggedOut <span class="token operator">?</span>
    <span class="token operator">&lt;</span>Redirect to<span class="token operator">=</span><span class="token string">&quot;/login&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;logout-button-holder&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>logout<span class="token punctuation">}</span><span class="token operator">&gt;</span>Logout<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">;</span>
</pre><hr>
<h1 class="mume-header" id="the-rest-of-it">The Rest Of It</h1>

<p>You have now been given instructions on how to refactor components from managing<br>
global application state to putting it in Redux. There are two more pieces left,<br>
the &quot;select the current Pokemon&quot; functionality and the &quot;create a new Pokemon&quot;<br>
functionality. Refactor the application so those are Redux-supported, as well.</p>
<h2 class="mume-header" id="select-the-current-pokemon">Select the current Pokemon</h2>

<p>The place to start, here, is to determine how the click of the navigation item<br>
on the left gets handled. It&apos;s a <code>NavLink</code>, so the <code>BrowserRouter</code> in the <code>App</code><br>
component handles that by routing to the <code>PokemonBrowser</code> with the route<br>
parameters. The <code>PokemonBrowser</code> then routes to the <code>PokemonDetail</code> with a<br>
<code>Route</code> component. In the <code>PokemonDetail</code> component, if the value of the<br>
<code>this.props.match.params.id</code> changes, then the <code>loadPokemon</code> method is called<br>
which, in turn, makes an AJAX call. And, there it is! The AJAX call.</p>
<p>This is like everything else, create a thunk, an action type, yada yada yada.</p>
<ul>
<li>Create a thunk (similar to what you did for logging in) to load the current<br>
Pokemon that
<ul>
<li>accepts an id</li>
<li>loads the Pokemon from an AJAX call</li>
<li>dispatches a &quot;set current Pokemon&quot; action</li>
</ul>
</li>
<li>Create a reducer that handles the &quot;set current Pokemon&quot; action by adding it<br>
to the state</li>
<li>Connect the <code>PokemonDetail</code> to the Redux store by
<ul>
<li>mapping the current Pokemon information in the state to its props, and</li>
<li>mapping the &quot;load the current Pokemon&quot; thunk to its props with a <code>dispatch</code><br>
call (don&apos;t forget the id parameter)</li>
</ul>
</li>
</ul>
<h2 class="mume-header" id="creating-a-new-pokemon">Creating a new Pokemon</h2>

<p>This is very similar to the login stuff you did with <code>LoginPanel</code>. In the<br>
<code>PokemonForm</code>, have</p>
<ul>
<li>the <code>componentDidMount</code> method call a thunk to load the Pokemon types</li>
<li>the <code>handleSubmit</code> method call a thunk to post the form information to the<br>
API</li>
</ul>
<p>In moving the Pokemon type fetching from the state to the props, you may end up<br>
getting an error that there is no method &quot;map&quot; of undefined. If that&apos;s the case,<br>
in the reducer in your <strong>src/store/pokemon.js</strong> file, have the default state<br>
include an array for the &quot;types&quot; property.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// CODE SNIPPET</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span> types<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</pre><p>That&apos;s the power of default parameters and initial state!</p>
<p>The action types, action creators, and thunk created to do this should go into<br>
the <strong>src/store/pokemon.js</strong> module. When the AJAX call succeeds to create the<br>
new Pokemon, have it <em>then</em> dispatch the <code>getPokemon</code> thunk to get a new list of<br>
Pokemon. Redux and React will add a new Pokemon to the end of the list. That&apos;s<br>
why you have to provide the &quot;key&quot; property in lists of things, so that React<br>
will efficiently determine if something in the list needs to get changed, added,<br>
or deleted.</p>
<p>The only &quot;new&quot; part, here, is the coordination between <code>PokemonForm</code> and<br>
<code>PokemonBrowser</code> to determine if it should show a form. This is up to you to<br>
decide, if showing the create form is part of the global application state (and<br>
should exist in the Redux store), or if it is part of the &quot;local&quot; state between<br>
the two components and be managed by <code>PokemonForm</code> invoking a function passed to<br>
it by <code>PokemonBrowser</code>. The solution choose the former solution.</p>
<h2 class="mume-header" id="bonus-extend-the-functionality">Bonus: Extend the functionality</h2>

<p>Think about adding</p>
<ul>
<li>A <em>Cancel</em> button on the form that hides it</li>
<li>Error messages for the forms when something bad happens</li>
</ul>
<h2 class="mume-header" id="bonus-connected-react-router">Bonus: Connected React Router</h2>

<p>Rather than relying on <code>Redirect</code> routes in your application, you can use<br>
actions to manage the URL of your application. Install <a href="https://github.com/zalmoxisus/redux-devtools-extension#installation">Connected React<br>
Router</a> and remove all <code>Redirect</code> components from the application, replacing<br>
them with dispatched <code>push</code> actions. Check out the <a href="https://react-redux.js.org/introduction/quick-start">How to navigation with<br>
Redux action</a> article in the Connected React Router documentation.</p>
<hr>
<h1 class="mume-header" id="giphy-search-project">Giphy Search Project</h1>

<p>Today&apos;s project will help you become more comfortable with the full Redux cycle!<br>
You will build out a single Redux cycle for a Giphy search tool.</p>
<p>When a user enters a search query, a fetch action will use the search endpoint<br>
from the Giphy API to return the fetch response. The action will then be<br>
dispatched to update the application&apos;s global state provided by the Redux store.<br>
Your application will then use a slice of state to render an index of GIF<br>
results.</p>
<p>Your completed project will look something like this:</p>
<p><img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/react-hooks/assets/giphy-search.gif" alt="giphy-search"></p>
<h2 class="mume-header" id="phase-0-set-up-the-project">Phase 0: Set up the project</h2>

<p>You&apos;ll begin by cloning this repository containing basic skeleton files and the<br>
conventional frontend folders (<code>actions</code>, <code>components</code>, <code>reducers</code>, and <code>util</code>).</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">git</span> clone https://github.com/appacademy-starters/react-redux-giphy-starter.git
</pre><p>Take a moment to familiarize yourself with the file structure. Look inside all<br>
the frontend files and note the <code>TODO</code> notes in each file skeleton. Throughout<br>
the next phases of the project, you&apos;ll finish all the tasks listed in the <code>TODO</code><br>
notes to create your very own Giphy search app!</p>
<p>After you have reviewed the <code>TODO</code> notes, run <code>npm install</code> to install your<br>
application&apos;s packages. Note that you have <code>redux</code>, <code>react-redux</code>,<br>
<code>redux-thunk</code>, and <code>redux-logger</code> already listed as dependencies in your<br>
project&apos;s <code>package.json</code> file. You&apos;ll use Redux <code>thunk</code> as middleware to connect<br>
(or <em>dispatch</em>) your fetch results into the Redux store. You&apos;ll use Redux<br>
<code>logger</code> as middleware to automatically console log your dispatched actions.</p>
<h3 class="mume-header" id="component-overview">Component overview</h3>

<p>Now that you&apos;re acquainted with the file structure, let&apos;s map out an overview of<br>
the component hierarchy:</p>
<pre data-role="codeBlock" data-info class="language-"><code>Root
  AppContainer
    App
      SearchBar
      Gifs
</code></pre><ul>
<li>The <code>Root</code> component is responsible for providing the component tree with the<br>
Redux <code>store</code>. It renders the <code>AppContainer</code>.</li>
<li>The <code>AppContainer</code> passes the <code>gifs</code> slice of state and the dispatched<br>
<code>fetchGifs</code> action creator as props to the <code>App</code> component. It wraps the <code>App</code><br>
component to connect the component to the Redux store.</li>
<li>The <code>App</code> component renders the <code>GifsList</code> and the <code>SearchBar</code>. It uses its<br>
<code>gifs</code> prop (passed into <code>App</code> through <code>mapStateToProps</code>) to create and pass a<br>
<code>gifUrls</code> array as a prop to the <code>GifsList</code>. It also uses its <code>fetchGifs</code> prop<br>
(passed into <code>App</code> through <code>mapDispatchToProps</code>) as a prop to the <code>SearchBar</code><br>
component.</li>
<li>The <code>SearchBar</code> component handles all of the search logic (keeping track of<br>
the query and triggering the fetch request on submit).</li>
<li>The <code>GifsList</code> component iterates over its <code>gifUrls</code> prop, to render an image for<br>
each one.</li>
</ul>
<h3 class="mume-header" id="giphy-api-key">Giphy API key</h3>

<p>Before you start, let&apos;s create a Giphy API Key to use in your fetch requests to<br>
the Giphy API. Get started by <a href="https://giphy.com/join">creating a Giphy account</a>. Then navigate to the<br>
<a href="https://developers.giphy.com/docs/api/#quick-start-guide">Giphy API Quick Start Guide</a> and click <code>Create an App</code>.</p>
<p>Fill out the form for creating a new app, and only check the option for <code>I only want to use the GIPHY API</code>.</p>
<p><img src="https://assets.aaonline.io/fullstack/react/assets/giphy_api_key.png" alt="Giphy Example"></p>
<p>Once you&apos;ve submitted the form, you&apos;ll be taken to a dashboard, and under the<br>
<code>Your Apps</code> section, you should see your newly created app with an API Key that<br>
you will use for this project. As a reminder, API keys normally shouldn&apos;t be<br>
stored in client-side JavaScript. You would normally want to store the keys in<br>
your server-side code. To keep this project a simple, front-end only project,<br>
you&apos;ll store the API key in a front-end environment variable for convenience.<br>
Take a moment to create an <code>.env</code> file in the root of your project and set an<br>
environment variable with your API key, like so:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token constant">REACT_APP_GIPHY_API_KEY</span><span class="token operator">=</span><span class="token operator">&lt;&lt;</span><span class="token constant">YOUR</span> <span class="token constant">API</span> <span class="token constant">KEY</span><span class="token operator">&gt;&gt;</span>
</pre><p>Notice that your <code>config.js</code> file is already exporting your<br>
<code>REACT_APP_GIPHY_API_KEY</code> environment variable as <code>apiKey</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> apiKey <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">REACT_APP_GIPHY_API_KEY</span>
</pre><p>This means that you can import the API key from any of your frontend components<br>
with the following import statement:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> apiKey <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../config&apos;</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="phase-1-fetch-data-in-the-redux-cycle">Phase 1: Fetch data in the Redux cycle</h2>

<p>Before you begin to build the project, it&apos;s important to think about the state<br>
shape. You know that you want to display GIF results returned by a fetch<br>
request. This means you&apos;ll probably want a <code>gifs</code> slice of the state that holds<br>
a collection of <code>gif</code> objects.</p>
<h3 class="mume-header" id="state-shape">State shape</h3>

<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  gifs<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// gif objects  </span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</pre><p>As a reminder, you pass the <code>gifs</code> slice of state as a prop to the <code>App</code><br>
component in the <code>AppContainer</code> through the <code>mapStateToProps</code> function.</p>
<h3 class="mume-header" id="api-util">API util</h3>

<p>The first part of creating your Redux cycle for fetching GIFs is creating a<br>
fetch request that will be connected to a <em>thunk action creator</em>. Define and<br>
export a <code>fetchGifs</code> function in the <code>apiUtil.js</code> file. This function will make<br>
a fetch call to the Giphy API&apos;s search endpoint.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// apiUtil.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> apiKey <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../config&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">fetchGifs</span> <span class="token operator">=</span> <span class="token parameter">searchTerm</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token comment">// TODO: Write a fetch call to the Giphy API&apos;s search endpoint</span>
<span class="token punctuation">)</span>
</pre><p>It will take a single argument, the <code>searchQuery</code> entered by a user. You can<br>
check out the <a href="https://github.com/Giphy/GiphyAPI">Giphy API docs</a> for more details, but in short, you want to make<br>
a fetch request to the following endpoint:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token template-string"><span class="token string">`http://api.giphy.com/v1/gifs/search?api_key=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>apiKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;q=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>searchTerm<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;limit=3`</span></span>
</pre><p>The <code>searchQuery</code> will be replaced with your user&apos;s actual query. You should tag<br>
<code>&amp;limit=3</code> onto the end of your query string to tell Giphy you only want three<br>
GIF responses. The Giphy API is relatively slow, so keeping the response size<br>
down helps optimize your application&apos;s performance.</p>
<p>Remember, it&apos;s best to test small pieces as we go. Let&apos;s test out that fetch<br>
request from your developer tools console to make sure it&apos;s doing what you&apos;re<br>
intending.</p>
<p>You may need to restart your server to have your application process the<br>
environment variables set in your <code>.env</code> file.</p>
<p>Import your <code>fetchGifs</code> function to the entry <code>index.js</code> file, then go ahead and<br>
put it on the window so we have access to it in the console:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// index.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Root <span class="token keyword">from</span> <span class="token string">&apos;./components/Root&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchGifs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./util/apiUtil&apos;</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span>fetchGifs <span class="token operator">=</span> fetchGifs<span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Root <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

</pre><p>Try running this test code:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">fetchGifs</span><span class="token punctuation">(</span><span class="token string">&apos;puppy&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>This will make the fetch request, which will return a promise. You&apos;ll chain on a<br>
<code>.then</code> to parse the response and log the parsed response data. You should see<br>
an array of three objects. Those are your gif objects fetched from the Giphy<br>
API! Make sure you get this working before moving on, and don&apos;t forget to remove<br>
<code>fetchGifs</code> from the window once you&apos;re done testing.</p>
<h2 class="mume-header" id="phase-2-redux-actions">Phase 2: Redux actions</h2>

<p>Next, you&apos;ll set up an <a href="https://redux.js.org/basics/actions">action</a> to properly receive GIF payload information<br>
(your fetch responses). As always, you want to export constants for your action<br>
types set to strings of your action types. As a reminder, this is to prevent<br>
bugs from mistyping your action types.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">RECEIVE_GIFS</span> <span class="token operator">=</span> <span class="token string">&apos;RECEIVE_GIFS&apos;</span><span class="token punctuation">;</span>
</pre><p>Now it&apos;s time to write a function that returns your <code>action</code>, an object literal.<br>
Write <code>receiveGifs</code> as a function that takes in <code>gifs</code> data as a parameter and<br>
returns an action object. The object should have two keys: one for the <code>type</code><br>
and another for the <code>gifs</code> data. Your function should look like the following:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">receiveGifs</span> <span class="token operator">=</span> <span class="token parameter">gifs</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token constant">RECEIVE_GIFS</span><span class="token punctuation">,</span>
    gifs
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Before testing this action creator, you&apos;ll need a reducer.</p>
<h3 class="mume-header" id="gifsreducer">gifsReducer</h3>

<p>Let&apos;s write a switch case and default switch return in your <code>gifsReducer.js</code><br>
file. Note that the <code>gifsReducer</code> function receives the previous <code>state</code> and an<br>
<code>action</code>. Recall that a reducer describes how a slice of state should change<br>
based on a dispatched action. It should always return the new state without<br>
mutating the previous state. If the action dispatched to the reducer should not<br>
change the state, the reducer should return the previous <code>state</code> by default. You<br>
will need to import the <code>RECEIVE_GIFS</code> constant from your <code>gifActions.js</code> file.</p>
<p>Your reducer should look similar to the this one:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// TODO: Import the `RECEIVE_GIFS` constant</span>

<span class="token keyword">const</span> <span class="token function-variable function">gifsReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO: Return the GIFs from the action object if the action type is `RECEIVE_GIFS`</span>
    <span class="token comment">// TODO: Return the previous state by default</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> gifsReducer<span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="rootreducer">rootReducer</h3>

<p>Recall the state shape you saw earlier in the project instructions. The<br>
<code>gifsReducer</code> above should control the <code>gifs</code> slice of the application state.<br>
You&apos;ll create and export a <code>rootReducer</code> with Redux&apos;s <code>combineReducers</code> function<br>
to assign control of different slices of state to their prospective reducer<br>
functions to create the application state structure.</p>
<p>This project only needs one reducer, but using <code>combineReducers</code> would allow you<br>
to easily add more state slices in the future.</p>
<p>The <code>combineReducers</code> function has already been imported for you. Take a moment<br>
to import your <code>gifsReducer</code> and set the <code>gifs</code> slice of state to its reducer,<br>
like so:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">gifs<span class="token punctuation">:</span> gifsReducer<span class="token punctuation">,</span>
</pre><p>Now that you have your reducers set up to structure your application&apos;s global<br>
state, you&apos;ll need to set up the Redux store to hold that global state.</p>
<h2 class="mume-header" id="phase-3-the-redux-store">Phase 3: The Redux store</h2>

<p>The store holds the global state of an application, so you&apos;ll need to create it<br>
before you can test your reducer. Remember that Redux provides a <code>createStore</code><br>
function that receives a <code>reducer</code>, optional <code>preloadedState</code>, and an optional<br>
<code>enhancer</code>. Begin by writing a <code>configureStore</code> function that passes your<br>
<code>rootReducer</code> to <code>createStore</code>.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token comment">// TODO: Import middleware</span>
<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">configureStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> configureStore<span class="token punctuation">;</span>
</pre><p>Import <code>configureStore</code> into your entry <code>index.js</code> file, then use the function<br>
to generate the Redux store.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now you&apos;ll work on providing the store you have generated to your application&apos;s<br>
components! Begin by passing the <code>store</code> you&apos;ve generated as a prop to the<br>
<code>Root</code> component. Your <code>index.js</code> file should look something like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// index.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Root <span class="token keyword">from</span> <span class="token string">&apos;./components/Root&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> configureStore <span class="token keyword">from</span> <span class="token string">&apos;./store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchGifs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./util/apiUtil&apos;</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span>fetchGifs <span class="token operator">=</span> fetchGifs<span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Root store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;root&apos;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now go into your <code>Root.js</code> file and import <code>Provider</code> from <code>react-redux</code>. Use<br>
the <code>Provider</code> component to set the Redux store through the <code>Provider</code><br>
component&apos;s expected <code>store</code> prop. Remember how you have just configured and<br>
passed a <code>store</code> as a prop to the <code>Root</code> component in your entry file<br>
(<code>index.js</code>). Use the <code>Root</code> component&apos;s <code>store</code> prop to set the <code>store</code> prop of<br>
the <code>Provider</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// Root.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&apos;./App&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Root</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Root<span class="token punctuation">;</span>
</pre><p>Now that you have configured your Redux store and tested your <code>fetchGifs</code><br>
function, let&apos;s connect the function to the store to implement a full Redux<br>
cycle. In the next phase, you&apos;ll define a <em>thunk action creator</em> function and<br>
use the <code>thunk</code> middleware so that each fetch response is dispatched as a change<br>
to the global application <code>state</code>.</p>
<h2 class="mume-header" id="phase-4-thunk-middleware">Phase 4: Thunk middleware</h2>

<p>Let&apos;s refactor how you fetch GIFs by using a thunk action creator. Recall that<br>
we use a <em>thunk action creator</em> to return a function. When that function is<br>
called with an argument of <code>dispatch</code>, the function can dispatch additional<br>
actions.</p>
<p>Begin by refactoring your <code>configureStore</code> function in the <code>store.js</code> file to<br>
incorporate your thunk middleware. Remember that Redux provides <code>thunk</code><br>
middleware from the <code>redux-thunk</code> module. Import the <code>thunk</code> middleware and<br>
<code>applyMiddleware</code> function from Redux. You&apos;ll use the <code>applyMiddleware</code><br>
function, with your <code>thunk</code> middleware as an argument, to set the optional<br>
<code>enhancer</code> argument in the <code>createStore</code> function:</p>
<p>Your <code>store.js</code> file should now include the following:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&apos;redux-thunk&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">configureStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> configureStore<span class="token punctuation">;</span>
</pre><p>Now your Redux cycle is almost good to go! To summarize your progress to this<br>
point, you have configured your Redux store, provided the store to your<br>
application, written a fetch function in a util file, defined an action type,<br>
and defined an action creator.</p>
<p>The last step is to define a <em>thunk action creator</em> that will dispatch the<br>
<code>receiveGifs</code> action after the Giphy API call is successful!</p>
<p>Begin by importing your API util function into your <code>gifActions.js</code> file. Since<br>
you want to easily associate your <em>thunk action creators</em> with a specific<br>
action, and you&apos;ll often have more than one function exported from your util<br>
file, use a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#Description">namespace</a> to import your fetch function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> APIUtil <span class="token keyword">from</span> <span class="token string">&apos;../util/apiUtil&apos;</span><span class="token punctuation">;</span>
</pre><p>You would then invoke your <code>fetchGifs</code> function in your <code>apiUtil.js</code> file like<br>
so:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">APIUtil<span class="token punctuation">.</span><span class="token function">fetchGifs</span><span class="token punctuation">(</span>searchQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now it&apos;s time to write your <em>thunk action creator</em>! Define and export a function<br>
named <code>fetchGifs</code> that receives a search term and returns a function that can be<br>
called with <code>dispatch</code>. Your function will use a promise to parse the fetch<br>
response to JSON and dispatch the <code>receiveGifs</code> action with the fetch response<br>
data after the <code>APIUtil.fetchGifs</code> call is successful.</p>
<p>Your <em>thunk action creator</em> should look like the following:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">fetchGifs</span> <span class="token operator">=</span> <span class="token parameter">searchTerm</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> APIUtil<span class="token punctuation">.</span><span class="token function">fetchGifs</span><span class="token punctuation">(</span>searchTerm<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">receiveGifs</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Or you can clean up the function by using implicit returns with ES6 arrow<br>
functions:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">fetchGifs</span> <span class="token operator">=</span> <span class="token parameter">searchTerm</span> <span class="token operator">=&gt;</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  APIUtil<span class="token punctuation">.</span><span class="token function">fetchGifs</span><span class="token punctuation">(</span>searchTerm<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">receiveGifs</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="phase-5-test-your-thunk-action-creator">Phase 5: Test your thunk action creator</h2>

<p>Let&apos;s take a moment to test your the <code>fetchGifs</code> <em>thunk action creator</em> you just<br>
defined.</p>
<p>Import <code>fetchGifs</code> from your <code>gifActions.js</code> file to your entry <code>index.js</code> file.<br>
You&apos;ll hit the error <code>Parsing error: Identifier &apos;fetchGifs&apos; has already been declared</code> since have already imported the <code>fetchGifs</code> function from your<br>
<code>apiUtil.js</code> file. Note that this is why using a namespace to <code>import * as APIUtil</code> from your <code>apiUtil.js</code> file is important.</p>
<p>Update the import statement from your <code>./util/apiUtil.js</code> file with a namespace:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> APIUtil <span class="token keyword">from</span> <span class="token string">&apos;./util/apiUtil&apos;</span><span class="token punctuation">;</span>
</pre><p>Now you&apos;ll want to put your fetch function, thunk action creator, and Redux<br>
store on the window. This way you can view your application&apos;s global state and<br>
compare the result of your fetch function and the dispatched thunk action<br>
creator:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// index.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Root <span class="token keyword">from</span> <span class="token string">&apos;./components/Root&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> configureStore <span class="token keyword">from</span> <span class="token string">&apos;./store&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> APIUtil <span class="token keyword">from</span> <span class="token string">&apos;./util/apiUtil&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchGifs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./actions/gifActions&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span>apiFetchGifs <span class="token operator">=</span> APIUtil<span class="token punctuation">.</span>fetchGifs<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>fetchGifs <span class="token operator">=</span> fetchGifs<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>store <span class="token operator">=</span> store<span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Root store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;root&apos;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now you&apos;ll use the <code>getState()</code> and <code>dispatch(action)</code> <a href="https://redux.js.org/api/store">store methods</a> to view<br>
and update your application&apos;s global state. Try the following code in the<br>
browser&apos;s console before continuing to the next phase:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"> <span class="token comment">// Return the initial application state</span>
store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Use the thunk action creator to dispatch the fetch response and populate state</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">fetchGifs</span><span class="token punctuation">(</span><span class="token string">&apos;puppy&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Return the application state populated with GIFs</span>
store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Congratulations! You just wrote a Redux cycle to populate your application&apos;s<br>
global state with a response from the Giphy API.</p>
<p>Notice how your application&apos;s global state changed after invoking the<br>
<code>dispatch(fetchGifs(&apos;puppy))</code> method. Now you can pass the <code>fetchGifs</code> <em>thunk<br>
action creator</em> through a Redux container so that a fetch call can be dispatched<br>
from your component to update the global state in the same way!</p>
<h2 class="mume-header" id="phase-6-logger-middleware">Phase 6: Logger middleware</h2>

<p>Now instead of manually logging the status of your global state and the response<br>
of your dispatch call, you can use the Redux <code>logger</code> middleware to<br>
automatically do so. Import <code>logger</code> from <code>redux-logger</code> into your <code>store.js</code><br>
file:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> logger <span class="token keyword">from</span> <span class="token string">&apos;redux-logger&apos;</span><span class="token punctuation">;</span>
</pre><p>Just like how you applied your <code>thunk</code> middleware to your configured store,<br>
you&apos;ll invoke the <code>applyMiddleware()</code> function with your <code>logger</code> middleware.<br>
Your updated <code>store.js</code> file should look something like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// store.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&apos;redux-thunk&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> logger <span class="token keyword">from</span> <span class="token string">&apos;redux-logger&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> rootReducer <span class="token keyword">from</span> <span class="token string">&apos;./reducers/rootReducer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">configureStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">,</span> logger<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> configureStore<span class="token punctuation">;</span>
</pre><p>Now go back to your browser&apos;s console and dispatch a fetch request:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">store.dispatch<span class="token punctuation">(</span>fetchGifs<span class="token punctuation">(</span><span class="token string">&apos;puppy&apos;</span><span class="token punctuation">))</span>
</pre><p>Upon a successful fetch, you should have received a helpful log with your<br>
application&apos;s <code>prev state</code>, the dispatched <code>action</code> object, and your<br>
application&apos;s <code>next state</code> from the <code>logger</code> middleware you just utilized!</p>
<h2 class="mume-header" id="phase-7-container-component">Phase 7: Container component</h2>

<p>Now that you&apos;ve set up the global state of your application, it&apos;s time to<br>
connect your React components to the global state! Remember how you used the<br>
<code>Provider</code> component in your <code>Root.js</code> file to pass the configured <code>store</code> as a<br>
prop to the <code>Provider</code> component.</p>
<p>Just like how a <code>Context.Provider</code> component expects <code>value</code> as a prop to set<br>
the context object, the Redux <code>Provider</code> component expects <code>store</code> as a prop to<br>
share the store&apos;s global state with nested components. Instead of rendering your<br>
<code>App</code> component as the child of the <code>Provider</code>, you&apos;ll render an <code>AppContainer</code>.</p>
<h3 class="mume-header" id="appcontainer">AppContainer</h3>

<p>In your <code>AppContainer.js</code> file, you will define a <code>mapStateToProps</code> function and<br>
a <code>mapDispatchToProps</code> function and invoke the <code>connect()</code> function from Redux.<br>
Invoking the <code>connect()</code> function will connect the <code>App</code> component with the<br>
Redux store. Within the container, you will pass slices of <code>state</code> and<br>
dispatched <em>thunk action creators</em> as props to the <code>App</code> component.</p>
<p>Note that the skeleton has already imported the <code>connect</code> function from<br>
<code>react-redux</code>, your <code>fetchGifs</code> thunk action creator from the <code>gifAction.js</code><br>
file, and the <code>App</code> component.</p>
<p>Take a look at the code skeletons of the <code>mapStateToProps</code> and<br>
<code>mapDispatchToProps</code> functions. Think of these functions as functions that take<br>
in <code>state</code> or <code>dispatch</code> as arguments to return object literals that represent<br>
the props that your <code>App</code> component will receive.</p>
<p>Have your <code>mapStateToProps</code> function return an object with a <code>gifs</code> property set<br>
to the <code>state.gifs</code> slice of state. Doing this will pass a <code>gifs</code> prop into your<br>
<code>App</code> component.</p>
<p>Next, have your <code>mapDispatchToProps</code> function return an object with a<br>
<code>fetchGifs</code> property set to an arrow function that accepts a <code>searchQuery</code> value<br>
and dispatches a call to the <code>fetchGifs(searchQuery)</code> function. Remember how you<br>
tested the <code>store.dispatch(fetchGifs(searchQuery))</code> function in the browser<br>
console. Think of how you would use an arrow function to almost wait for a<br>
<code>searchQuery</code> input from the user before firing the dispatch call.</p>
<p>Lastly, take a moment to examine how your <code>AppContainer.js</code> file is simply<br>
exporting the <code>connect()</code> invocation:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now you can render your <code>AppContainer</code> instead of your <code>App</code> component so that<br>
the <code>connect()</code> method is invoked to pass a <code>gifs</code> prop and a <code>fetchGifs</code> props<br>
to <code>App</code>!</p>
<p>Take a moment to refactor your <code>Root.js</code> file to do so:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// Root.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> AppContainer <span class="token keyword">from</span> <span class="token string">&apos;./AppContainer&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Root</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>AppContainer <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Root<span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="phase-8-presentational-components">Phase 8: Presentational components</h2>

<p>Now that you&apos;ve created a container to pass (or <em>map</em>) slices of the global<br>
state and dispatched actions as props, it&apos;s time to render and update the <code>gifs</code><br>
from the global state!</p>
<h3 class="mume-header" id="app">App</h3>

<p>Have your <code>App</code> component take in and destructure your <code>gifs</code> and <code>fetchGifs</code><br>
props. Notice how your component is rendering a <code>SearchBar</code> component and a<br>
<code>GifsList</code> component. You&apos;ll want to pass in the <code>fetchGifs</code> function as a prop<br>
to the <code>SearchBar</code> component.</p>
<p>Instead of directly passing all of the <code>gifs</code> as a prop to the <code>GifsList</code><br>
component, you&apos;ll refactor your <code>mapStateToProps</code> function and use a selector to<br>
map the array of <code>gifs</code> into an array of GIF urls.</p>
<p>Currently, your <code>mapStateToProps</code> function should look something like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    gifs<span class="token punctuation">:</span> state<span class="token punctuation">.</span>gifs<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Define a <code>getGifUrls</code> selector that takes in the <code>state</code> and uses parameter<br>
destructuring to map over each gif in the <code>gifs</code> slice of state to pluck the<br>
image URL from the JSON data, like so:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">getGifUrls</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> gifs <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  gifs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">gif</span> <span class="token operator">=&gt;</span> gif<span class="token punctuation">.</span>images<span class="token punctuation">.</span>fixed_height<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    gifUrls<span class="token punctuation">:</span> <span class="token function">getGifUrls</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now you can pass in the <code>gifUrls</code> for your <code>GifsList</code> component to render GIF<br>
images without passing unnecessary data as props!</p>
<h3 class="mume-header" id="searchbar">SearchBar</h3>

<p>In your <code>SearchBar</code> component, you already have a search form, an <code>inputValue</code><br>
state, and an <code>onChange</code> handler for the form&apos;s input field set up. Right now,<br>
your component has several <code>TODO</code> notes to guide your creation of an <code>onSubmit</code><br>
handler for your search form. The <code>onSubmit</code> handler will dispatch the<br>
<code>fetchGifs</code> action creator function (don&apos;t forget to prevent the default action<br>
of a submit event).</p>
<p>After finishing your <code>SearchBar</code> component, test out your submit event handler<br>
and check your <code>logger</code> response to see if your <code>fetchGifs</code> action creator is<br>
actually being dispatched to update the application&apos;s global state! Once you see<br>
that your fetched <code>gifs</code> have been dispatched to the <code>gifs</code> slice of state, it&apos;s<br>
time to render your list of GIFs!</p>
<h3 class="mume-header" id="gifslist">GifsList</h3>

<p>Right now, your component has several <code>TODO</code> notes:</p>
<ul>
<li>Take in and destructure the <code>gifUrls</code> prop.</li>
<li>Render a <code>&lt;div&gt;</code> as the parent element of your <code>GifsList</code> component.</li>
<li>Map over your <code>gifUrls</code> array to render an <code>&lt;img&gt;</code> for each <code>url</code>.</li>
</ul>
<h3 class="mume-header" id="debugging">Debugging</h3>

<p>If you&apos;re having issues rendering a GIF in your project, that means it&apos;s a great<br>
time to practice using <code>debugger</code> statements to debug your Redux cycle code! For<br>
example, you could set a <code>debugger</code> in the:</p>
<ul>
<li><code>handleSubmit</code> method to check out the submitted search <code>inputValue</code></li>
<li><code>receiveGifs</code> action creator function to check out the value of the <code>gifs</code><br>
payload</li>
<li><code>RECEIVE_GIFS</code> case statement in the <code>gifsReducer</code> to check out the value of<br>
the dispatch <code>action</code> object</li>
</ul>
<p>If you didn&apos;t hit any issues, congratulations - you have implemented Redux with<br>
the Giphy API to create a search API that renders a list of GIFs! Before moving<br>
forward to the next project, you should still use <code>debugger</code> statements to step<br>
through this project&apos;s Redux cycle.</p>
<hr>
<h1 class="mume-header undefined" id="week-15-day-4brhooks">WEEK-15 DAY-4<br><em>Hooks</em></h1>

<hr>
<h1 class="mume-header" id="hooks-objectives">Hooks Objectives</h1>

<p>Now that you&apos;ve learned the basic objectives of using React, you should be able<br>
to gain a fundamental understanding of the React, Redux, and React-Router hooks.<br>
In your software engineering career, official documentation will be your friend!<br>
It&apos;s important to learn how to navigate through official documentation. At the<br>
end of the readings, you should use your new fundamental understanding of hooks<br>
to go through the official React Hooks documentation. At the end of this topic&apos;s<br>
articles and lectures you should be able to create function components that use<br>
state and other React features.</p>
<p>You should be able to use React&apos;s:</p>
<ul>
<li><code>useState</code> hook to manage a component&apos;s state.</li>
<li><code>useState</code> hook to set a default state, instead of setting the default state<br>
in a <code>constructor()</code> method.</li>
<li><code>useState</code> hook to update state, instead of the <code>setState()</code> method.</li>
<li><code>useEffect</code> hook to manage <em>side effect</em> operations (i.e. data fetching).</li>
<li><code>useEffect</code> hook in replacement of commonly used component lifecycle methods<br>
(<code>componentDidMount</code>, <code>componentDidUpdate</code>, and <code>componentWillUnmount</code>).</li>
<li><code>useEffect</code> (and the hook&apos;s <em>dependency array</em>) to optimize an application&apos;s<br>
performance by skipping <code>useEffect</code> calls.</li>
<li><code>useContext</code> hook to access a context object, instead of a <code>Context.Consumer</code><br>
or the <code>static contentType</code> property.</li>
</ul>
<p>You should be able to use Redux&apos;s:</p>
<ul>
<li><code>useSelector</code> hook to access the Redux store&apos;s state from within a component<br>
(instead of passing a part of state as a prop with the <code>mapStateToProps</code><br>
function).</li>
<li><code>useDispatch</code> hook to dispatch an action from within a component (instead of<br>
passing an thunk action creator function through the <code>mapDispatchToProps</code><br>
function).</li>
</ul>
<p>You should be able to use React Router&apos;s:</p>
<ul>
<li><code>useParams</code> hook to match parameters in the current route (instead of<br>
accessing the <code>match.params</code> prop).</li>
<li><code>useHistory</code> hook to navigation from within code (without <code>&lt;Link&gt;</code>,<br>
<code>&lt;NavLink&gt;</code>, or the <code>history</code> prop).</li>
<li><code>useLocation</code> hook to track url changes.</li>
<li><code>useRouteMatch</code> hook to check if the current url matches a path format.</li>
</ul>
<hr>
<h1 class="mume-header" id="intro-to-react-hooks">Intro to React Hooks</h1>

<p>React Hooks are a way for function components to have the same functionality as<br>
class components that make use of component lifecycle methods. Hooks are simply<br>
functions that allow components to utilize React features without explicitly<br>
using the lifecycle methods.</p>
<p>Before React Hooks, the only way to use lifecycle methods were through class<br>
components. Hooks allow you to manage a component&apos;s state and lifecycle within<br>
function components. They are helpful in extracting stateful logic from a<br>
component to be independently tested and reused - it&apos;s much more complicated to<br>
test the functionality of logic in a component&apos;s lifecycle methods. After<br>
reading this article, you will:</p>
<ul>
<li>Have a general understanding of the features of basic React hooks</li>
<li>Understand how the basic Hooks connect to features of React class components<br>
(i.e. lifecycle methods)</li>
<li>Create function components that use state and other React features</li>
<li>Use the <code>useState</code> hook to manage a component&apos;s state</li>
<li>Use the <code>useEffect</code> hook to manage <em>side effect</em> operations (i.e. data<br>
fetching)</li>
<li>Use the <code>useContext</code> hook to access a context object</li>
</ul>
<h2 class="mume-header" id="usestate">useState</h2>

<p>Up to this point, you have set a component&apos;s default state within a component&apos;s<br>
<code>constructor</code> method. The <code>useState</code> hook replaces the need to use a constructor<br>
to declare a default state with <code>this.state</code>. You can use the <code>useState</code> hook to<br>
set and name a default slice of state without a <code>constructor()</code> method. You can<br>
set a default state simply by invoking the <code>useState</code> hook. The <strong>with hooks</strong><br>
example below sets the default <code>inputValue</code> state to be <code>&apos;Default input value here!&apos;</code> by invoking the <code>useState</code> hook with the string <code>&apos;Default input value here!&apos;</code>.</p>
<p><strong>with hooks</strong></p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">FormWithHooks</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>inputValue<span class="token punctuation">,</span> setInputValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&apos;Default input value here!&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p><strong>without hooks</strong></p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">FormWithoutHooks</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      inputValue<span class="token punctuation">:</span> <span class="token string">&apos;Default input value here!&apos;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>When you use the <code>useState</code> hook to set up a slice of state, you also set up a<br>
prospective function to update that slice of state. In this example, you can<br>
update a slice of state by invoking <code>setInputValue</code>, instead of invoking the<br>
<code>this.setState()</code> method.</p>
<p><strong>with hooks</strong></p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">updateInputVal</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">setInputValue</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p><strong>without hooks</strong></p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function-variable function">updateInputVal</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> inputValue<span class="token punctuation">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>In general, React Hooks help clean up your code <strong>a lot</strong>! For example, when<br>
using the <code>useState</code> hook, you can also simply reference <code>inputValue</code> throughout<br>
the component, instead of <code>this.state.inputValue</code>. Compare the difference<br>
between the code for the <code>FormWithHooks</code> and <code>FormWithoutHooks</code> components<br>
below.</p>
<p><strong>with hooks</strong></p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">FormWithHooks</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>inputValue<span class="token punctuation">,</span> setInputValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">updateInputVal</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">setInputValue</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>form<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input
        type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
        value<span class="token operator">=</span><span class="token punctuation">{</span>inputValue<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span>updateInputVal<span class="token punctuation">}</span>
        placeholder<span class="token operator">=</span><span class="token string">&quot;Type something!&quot;</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p><strong>without hooks</strong></p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">FormWithoutHooks</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      inputValue<span class="token punctuation">:</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">updateInputVal</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> inputValue<span class="token punctuation">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>form<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input
          type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
          value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>inputValue<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>updateInputVal<span class="token punctuation">}</span>
          placeholder<span class="token operator">=</span><span class="token string">&quot;Type something!&quot;</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>When refactoring your projects to implement React Hooks, you can always refactor<br>
component by component, starting out with refactoring the component&apos;s state<br>
management.</p>
<h2 class="mume-header" id="useeffect">useEffect</h2>

<p>The <code>useEffect</code> hook is used to manage side effect operations. An example of a<br>
side effect operation you are familiar with is data fetching. Similarly to the<br>
<code>componentDidMount</code> or <code>componentDidUpdate</code> lifecycle methods, the <code>useEffect</code><br>
hook will automatically run.</p>
<p>Take a moment to notice how using the <code>useEffect</code> hook simply means invoking the<br>
<code>useEffect</code> function. You can invoke the function with one or two arguments,<br>
with the first argument always being a function, and then second argument being<br>
an optional <em>dependency array</em>.</p>
<p>When the <code>useEffect</code> hook is invoked <strong>without</strong> a second argument, the function<br>
will be invoked after every render:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Side effect logic invoked after every render</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>When the <code>useEffect</code> hook is invoked <strong>with an empty array</strong>, the function is<br>
only invoked once, when a component mounts (think of <code>componentDidMount</code>):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Side effect logic invoked once, when a component mounts</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>When the <code>useEffect</code> hook is invoked <strong>with an array of dependencies</strong>, the<br>
function is invoked whenever a dependency changes (think of<br>
<code>componentDidUpdate</code>):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Side effect logic invoked every time the `dependentVariable` changes</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dependentVariable<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="skipping-effects-with-the-dependency-array">Skipping effects with the dependency array</h3>

<p>This second argument of the <code>useEffect</code> hook is known as the <em>dependency array</em>.<br>
You can optimize the performance for your component by using the dependency<br>
array to skip effects. The dependency array is a collection of dependent<br>
variables. Similarly to how the <code>componentDidUpdate</code> lifecycle method listens<br>
for a change in the component, the <code>useEffect</code> hook listen for changes to<br>
variables in the dependency array to determine whether or not to run the<br>
<em>effect</em> again.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Side effect logic</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token comment">/* Dependency array */</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="asynchronous-effects">Asynchronous effects</h3>

<p>You are familiar with using <code>async/await</code> to await a database fetch. If you&apos;d<br>
like to make an asynchronous fetch within a <code>useEffect</code> hook, you would declare<br>
an asynchronous function within the hook. Then, you would invoke the<br>
asynchronous functions from within the hook.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">fetchSomething</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Fetch call</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">fetchSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token comment">/* Dependency array */</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The function passed in as the <code>useEffect</code> hook&apos;s first argument <strong>cannot</strong> be an<br>
asynchronous function - this is why you need to define and invoke the<br>
asynchronous function from within the hook&apos;s first function argument.</p>
<p>In the example below, the <code>useEffect</code> hooks runs an asynchronous fetch of a<br>
puppy, based on a <code>puppyId</code> input. The hook&apos;s dependency array references<br>
<code>props.match.params.puppyId</code>. Since the <code>useEffect</code> hook&apos;s dependency array<br>
references the <code>puppyId</code> parameter, the application will only fetch whenever the<br>
<code>puppyId</code> parameter changes. This optimizes the code, because now the effect is<br>
only run upon the change of a specific variable - <code>puppyId</code>!</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">fetchPuppy</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">puppyId</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> puppy <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`https://api.puppies.example/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>puppyId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> puppyJSON <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> puppyJSON<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">fetchData</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>match<span class="token punctuation">.</span>params<span class="token punctuation">.</span>puppyId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>props<span class="token punctuation">.</span>match<span class="token punctuation">.</span>params<span class="token punctuation">.</span>puppyId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Using a dependency array also prevents endless loops. Without the dependency<br>
array, a fetch call invoked within a <code>useEffect</code> hook would constantly run and<br>
your code would error out.</p>
<p>Alternatively, you can invoke the asynchronous effect with an <a href="https://en.wikipedia.org/wiki/Immediately_invoked_function_expression">IIFE</a><br>
(immediately invoked function expression). Take the example syntax below:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Fetch call</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token comment">/* Dependency array */</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="effect-cleanup">Effect cleanup</h3>

<p>In a class component, you might use the <code>componentWillUnmount</code> lifecycle method<br>
to handle <em>cleanup</em>. In order to <em>cleanup</em> an effect, you would need to return a<br>
function from within the <code>useEffect</code> hook. Having the <code>useEffect</code> hook&apos;s<br>
callback return another function results in the cleanup behavior of<br>
<code>componentWillUnmount</code>.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Cleanup logic</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token comment">/* Dependency array */</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>In a later lesson, you will learn about how to use WebSockets. When you use a<br>
WebSocket, you create a connection. What if you want to close that connection?<br>
Closing a connection sounds like a <em>cleanup</em> task! It is common to invoke the<br>
WebSocket&apos;s <code>close</code> method in a <em>cleanup</em> function. The example below makes use<br>
of the <em>dependency array</em> and a <em>cleanup</em> function.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&apos;ws://localhost:8080&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  webSocket<span class="token punctuation">.</span>current <span class="token operator">=</span> ws<span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>webSocket<span class="token punctuation">.</span>current <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      webSocket<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Similar to the behavior of <code>componentDidUpdate</code>, the effect is re-run whenever<br>
the <code>username</code> changes. The <code>useEffect</code> hook below takes care of setting up a<br>
new WebSocket connection. The hook&apos;s <em>cleanup</em> function will be run whenever the<br>
component unmounts. Replacing the <code>componentWillUnmount</code> lifecycle method, the<br>
<em>cleanup</em> function will take care of closing the WebSocket connection when the<br>
component unmounts.</p>
<h2 class="mume-header" id="usecontext">useContext</h2>

<p>You can use the <code>useContext</code> hook to access a context object to read and<br>
subscribe to context changes. The <code>useContext</code> hooks replaces the <code>static contextType</code> property in class components. Whenever you used the <code>static contextType</code> property in a class component, you were able to access a context<br>
object via referencing <code>this.context</code>. When you use the <code>useContext</code> hook, you<br>
can access a context object via whatever you name the context! In the example<br>
below, the <code>useContext</code> hook is invoked and its return value (the <code>MyContext</code><br>
object) is named <code>context</code> - this means you can access the <code>MyContext</code> object<br>
anywhere within the component via referencing <code>context</code>.</p>
<p><strong>with hooks</strong></p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>MyContext<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Makes `MyContext` available as `context`</span>
<span class="token keyword">const</span> banana <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>BananaContext<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Makes `BananaContext` available as `banana`</span>
<span class="token keyword">const</span> puppy <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>PuppyContext<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Makes `PuppyContext` available as `puppy`</span>
</pre><p><strong>without hooks</strong></p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">static</span> contextType <span class="token operator">=</span> MyContext<span class="token punctuation">;</span> <span class="token comment">// Makes `MyContext` available as `this.context`</span>
</pre><p>When using the <code>useContext</code> hook to access a context object, you would still use<br>
a <code>&lt;Context.Provider&gt;</code> to set the context&apos;s <code>value</code>.</p>
<h2 class="mume-header" id="what-you-have-learned">What you have learned</h2>

<p>In this article, you have learned about the general features of the basic React<br>
hooks (<code>useState</code>, <code>useEffect</code>, and <code>useContext</code>). You should now understand the<br>
functionality of how the basic Hooks connect to the features of React class<br>
components. You should be able to use the:</p>
<ul>
<li><code>useState</code> hook to manage a function component&apos;s state</li>
<li><code>useEffect</code> hook to manage running, skipping, and cleaning up effects</li>
<li><code>useContext</code> hook to access a context object</li>
</ul>
<hr>
<h1 class="mume-header" id="introduction-to-hooks-in-redux">Introduction to Hooks in Redux</h1>

<p>In previous lessons and projects, you have learned to build <strong>React</strong> components<br>
using <strong>Redux</strong>. Now it&apos;s time to explore ways to modify your approach using<br>
hooks.</p>
<p>When you complete this lesson, you will be able to</p>
<ul>
<li>Use Redux in a function component with the <code>useSelector</code> and <code>useDispatch</code><br>
hooks</li>
</ul>
<h2 class="mume-header" id="using-hooks-with-redux">Using hooks with Redux</h2>

<p>In order to use hooks in Redux, your application will need to utilize the<br>
<code>react-redux</code> package.  If you need a refresher on what this kind of application<br>
looks like, see the <a href="#starting-point-for-ip-address-project">Starting Point</a><br>
section at the end of this reading or clone the <a href="https://github.com/appacademy-starters/intro-to-redux-hooks">intro-to-redux-hooks</a><br>
repository from GitHub and look at the <strong>starter</strong> folder.</p>
<h2 class="mume-header" id="getting-started-1">Getting Started</h2>

<p>Consider a simple application that displays the user&apos;s current IP Address with<br>
a button to start the lookup. You many even include a loading message which<br>
shows while the server call is running.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/App.js</span>

<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>ip<span class="token punctuation">,</span> setIP<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>loading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">getMyIP</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setIP</span><span class="token punctuation">(</span><span class="token string">&apos;(coming soon)&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setLoading</span><span class="token punctuation">(</span>ip <span class="token operator">===</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>ip<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Get My <span class="token constant">IP</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>

      <span class="token punctuation">{</span>loading
        <span class="token operator">?</span> <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token punctuation">:</span> <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span>ip<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button 
        onClick<span class="token operator">=</span><span class="token punctuation">{</span>getMyIP<span class="token punctuation">}</span> 
        disabled<span class="token operator">=</span><span class="token punctuation">{</span>loading<span class="token punctuation">}</span>
      <span class="token operator">&gt;</span><span class="token punctuation">{</span>ip <span class="token operator">?</span> <span class="token string">&apos;Again&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;Go&apos;</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</pre><p>Notice that this framework uses your knowledge of the <code>useState</code> hook to<br>
simulate the server call and the <code>useEffect</code> hook to cause the loading indicator<br>
to show at the appropriate times.</p>
<p>Now you can update this example to use Redux hooks to replace the fake loading<br>
of <code>ip</code>.</p>
<h2 class="mume-header" id="useselector"><code>useSelector</code></h2>

<p>Begin by importing <code>useSelector</code> from the <em>React Redux</em> package.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> useSelector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
</pre><p>Assuming you have a reducer with the property <code>ipAddress</code>, then you can<br>
use the <code>useSelector</code> hook to access the <code>ipAddress</code> from your Redux store&apos;s<br>
state.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> ip <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>ipAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>In the sample <em>App.js</em> above, using the <code>useSelector</code> hook would replace<br>
<code>const [ip, setIP] = useState(&apos;&apos;)</code>. Your component would receive the <code>ip</code> via<br>
your Redux store&apos;s <code>state.ipAddress</code>, instead of the component&apos;s <code>ip</code> state.</p>
<blockquote>
<p>As a reminder, the <code>useState</code> hook in this example is simply mimicking a fetch<br>
response. Upon clicking the button with the <code>getMyIP</code> click handler, a fetch<br>
call is mimicked with the <code>setIP(&apos;(coming soon)&apos;)</code> method. You will need to<br>
remove this line as well. Don&apos;t worry you&apos;ll replace it momentarily using<br>
another Redux hook.</p>
</blockquote>
<p>You can access any available property this way and even call <code>useSelector()</code><br>
multiple times within a single function component. You can even use props<br>
or route parameters to determine what to extract from the store.</p>
<p>Here is an example using props. Assume you have a store with a <code>users</code> object in<br>
its state. Furthermore, you want to get just <code>user</code> based on the <code>id</code> provided<br>
in a prop to a function component.</p>
<p>Here is the component&apos;s code. See if you can spot where the &quot;magic&quot; happens.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useSelector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-redux&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">UserCard</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>users<span class="token punctuation">[</span>props<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> UserCard<span class="token punctuation">;</span>
</pre><p>If you said the magic happens in the function passed to the <code>useSelector</code> hook, then you would be<br>
correct. Specifically the square bracket notation is used to get just a part<br>
of the <code>users</code> object. Remember, you&apos;re passing a function as the argument to<br>
<code>useSelector</code>; therefore you can use all your skills to determine the right<br>
object or value to <code>return</code>.</p>
<h2 class="mume-header" id="usedispatch"><code>useDispatch</code></h2>

<p>In order to trigger an action in <strong>Redux</strong>, you will need to utilize a different<br>
hook; specifically, <code>useDispatch()</code>. This hook returns a function which you can<br>
call to dispatch the action.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Exactly how you use dispatch depends on your Redux setup. There are some minor<br>
differences based on whether you decided to use <code>redux-thunk</code> in your project.<br>
The configuration of Redux is beyond the scope of this reading and is something<br>
you saw in previous activities. Two solutions are provided in the sample, so you<br>
can make the choice which works best for your project. Here&apos;s a quick look at<br>
these two options.</p>
<h3 class="mume-header" id="option-a-generic-redux-no-thunk">Option A: Generic Redux (no thunk)</h3>

<p>In this configuration, you will need to dispatch actions created in your Redux<br>
component (e.g. <em>src/store/ipAddress.js</em>). For example, one possible action<br>
creator function might look like<br>
<code>export const setIP = ip =&gt; ({ type: SET_IP, ip });</code>.</p>
<p>Any functions which perform loading operations will need to be asynchronous and<br>
return the value or object retrieved; perhaps in a scenario like this...</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// relevant snippet from of src/store/ipAddress.js</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">loadIP</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// do stuff here like a fetch with await</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// return the result</span>
  <span class="token keyword">return</span> origin
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Back in the component with the UI (e.g. <em>src/App.js</em>), you&apos;ll need to start by<br>
importing these functions as well as adding <code>useDispatch</code> to the import for<br>
<strong>Redux</strong>.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> useDispatch<span class="token punctuation">,</span> useSelector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-redux&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> loadIP<span class="token punctuation">,</span> setIP <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./store/ipAddress&quot;</span><span class="token punctuation">;</span>
</pre><p>Then use these with your button click handler. Notice you dispatch is using the<br>
action to set the value of the ip variable that you just got with <code>useSelector</code>.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// relevant snippet from src/App.js</span>

  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">getMyIP</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setIP</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> origin <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setIP</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>The example dispatches two values for the IP Address. The first dispatch call<br>
sets the IP address to an empty string (so that the old value no longer shows<br>
in the UI while the newer value is loading). The second, of course, is the<br>
result of the fetch (or any other kind of service call, of course).</p>
<p>One advantage of this approach is that you will not need to install<br>
<code>redux-thunk</code> or add it to the <strong>Redux</strong> configuration. However, this comes<br>
with the trade-off that actions will be dispatched throughout the application,<br>
including in UI components.</p>
<h3 class="mume-header" id="option-b-using-redux-thunk">Option B: Using Redux Thunk</h3>

<p>Now consider the difference using <code>redux-thunk</code>. The action function remains<br>
unchanged (<code>export const setIP = ip =&gt; ({ type: SET_IP, ip });</code>). The <code>loadIP</code><br>
function will do its own dispatching (this means a double function in the<br>
declaration that results in the code below).</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// relevant snippet from ./src/App.js</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">loadIP</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">async</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setIP</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
  <span class="token comment">// do stuff here like a fetch with await</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// dispatch the result</span>
  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setIP</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>In the component (e.g. _src/App.js), you&apos;ll need to import only the <code>loadIP()</code><br>
function (and not the <code>setIP</code> action creator function) (while still importing<br>
<code>useDispatch</code>, of course).</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> useDispatch<span class="token punctuation">,</span> useSelector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-redux&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> loadIP <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./store/ipAddress&quot;</span><span class="token punctuation">;</span>
</pre><p>Then the click handler for the button simplifies to</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// relevant snippet from ./src/App.js</span>

  <span class="token keyword">const</span> <span class="token function-variable function">getMyIP</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">loadIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>The advantages of this approach using <strong>Redux Thunk</strong> is the separation of<br>
responsibilities where the load and action dispatches are all together<br>
resulting in simplified handling within the UI components.</p>
<p>The trade-off is double functions in your Redux<br>
(like <code>export const loadIP = () =&gt; async dispatch =&gt; {</code>)<br>
and the one-time install and setup of <code>redux-thunk</code>.</p>
<p>Ultimately the decision on the approach is made by each development team based<br>
on their personal preference.</p>
<h2 class="mume-header" id="refactoring-an-existing-component">Refactoring an existing component</h2>

<p>In order to refactor an existing class component from the classic approach to<br>
using hooks, there are several steps that need to be taken:</p>
<ul>
<li>Change component definition from class to function
<ul>
<li>Switch state handling to the <code>useState</code> hook</li>
<li>Use the <code>useEffect</code> hook for side-effect management, instead of the<br>
<code>componentDidMount</code> and <code>componentDidUpdate</code> methods</li>
<li>Create or move event handlers to constant functions</li>
</ul>
</li>
<li>Use one or multiple <code>useSelector</code> hooks to replace the <code>mapStateToProps</code><br>
function</li>
<li>Invoke the <code>useDispatch</code> hook to use <code>dispatch</code> and replace the<br>
<code>mapDispatchToProps</code> function</li>
<li>Simplify the <code>export</code> to just the component name by removing <code>connect</code></li>
<li>Delete any imports that are no longer in use</li>
</ul>
<p>The best way to understand exactly what to do is to see an example. This will<br>
be provided in an upcoming video lesson.</p>
<h2 class="mume-header" id="what-you-have-learned-1">What you have learned</h2>

<p>The <code>react-redux</code> package comes with several hooks which can be used to replace<br>
<code>mapStateToProps</code>, <code>mapDispatchToProps</code> and <code>connect</code>. Hooks are used with<br>
function components, so remember to start with one if you intend to use hooks;<br>
otherwise you&apos;ll need to convert your class component to a function component.</p>
<p>The <code>useSelector</code> hook give you access to any and all props that are exposed<br>
through the state in a Redux store by passing in a function to resolve the<br>
state property you want (e.g. <code>useSelector(state =&gt; state.theProp)</code>). The<br>
<code>useDispatch</code> hook allows you to trigger an action directly or by calling<br>
a function that uses <code>redux-thunk</code> to dispatch the action.</p>
<p>Using hooks with <strong>React Redux</strong> can improve the readability and maintainability<br>
of a <strong>React</strong> project.</p>
<h2 class="mume-header" id="additional-resources">Additional resources</h2>

<p>For future reference, there are a few additional (advanced and rarely used)<br>
features in the <a href="https://react-redux.js.org/next/api/hooks">official documentation on hooks in React Redux</a>.</p>
<h2 class="mume-header" id="starting-point-for-ip-address-project">Starting point for IP address project</h2>

<p>As promised, here is an example of setting up the framework with Redux for the<br>
&quot;Get My IP&quot; application discussed throughout this reading. This version includes<br>
<strong>Redux Thunk</strong>.</p>
<p>You may access the starter project, the solution project with Redux Thunk, and<br>
the solution project without Redux Thunk by cloning the <a href="https://github.com/appacademy-starters/intro-to-redux-hooks">intro-to-redux-hooks</a><br>
repository.</p>
<p>Start with <code>create-react-app</code> and install <code>react-redux</code>, <code>redux-thunk</code> and their<br>
dependencies (e.g. <code>redux</code>) as you&apos;ve done previously.</p>
<p>Wrap your application in the <strong>Redux Provider</strong> ...</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/index.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&apos;./App&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> configureStore <span class="token keyword">from</span> <span class="token string">&apos;./store/configureStore&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">configureStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;root&apos;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>... and configure a <strong>Redux</strong> store ...</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/store/configureStore.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware<span class="token punctuation">,</span> combineReducers<span class="token punctuation">,</span> compose <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;redux&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">&apos;redux-thunk&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ipAddress <span class="token keyword">from</span> <span class="token string">&apos;./ipAddress&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> composeEnhancers <span class="token operator">=</span> window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ <span class="token operator">||</span> compose<span class="token punctuation">;</span>

<span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  ipAddress<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">configureStore</span> <span class="token operator">=</span> <span class="token parameter">initialState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
    reducer<span class="token punctuation">,</span>
    initialState<span class="token punctuation">,</span>
    <span class="token function">composeEnhancers</span><span class="token punctuation">(</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> configureStore<span class="token punctuation">;</span>
</pre><p>... which includes a <strong>reducer</strong>, an <strong>action creator</strong> function, and a<br>
<strong>thunk action creator</strong> function ...</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/store/ipAddress.js</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> ipUrl <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../config&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">SET_IP</span> <span class="token operator">=</span> <span class="token string">&apos;ipAddress/SET_IP&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">setIP</span> <span class="token operator">=</span> <span class="token parameter">ip</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token constant">SET_IP</span><span class="token punctuation">,</span> ip <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">loadIP</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">async</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setIP</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ipUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/ip`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    method<span class="token punctuation">:</span> <span class="token string">&apos;get&apos;</span><span class="token punctuation">,</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">&apos;Content-Type&apos;</span><span class="token punctuation">:</span> <span class="token string">&apos;application/json&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> origin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// obscure last segment for privacy purposes</span>
    origin <span class="token operator">=</span> origin<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&apos;.&apos;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&apos;.&apos;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.xxx&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// dispatch the result</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setIP</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">SET_IP</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span>
        ip<span class="token punctuation">:</span> action<span class="token punctuation">.</span>ip<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>... that relies on the application configuration ...</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/config.js</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> ipUrl <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">REACT_APP_BASEURL</span> <span class="token operator">||</span> <span class="token template-string"><span class="token string">`https://httpbin.org`</span></span><span class="token punctuation">;</span>
</pre><p>... to fetch the IP Address using the <a href="https://httpbin.org/ip">ip query at httpbin.org</a>.</p>
<hr>
<h1 class="mume-header" id="react-router-hooks">React Router Hooks</h1>

<p>Now it&apos;s time to dig into the specifics of how hooks can simplify <strong>React</strong> code<br>
when working with React Router, specifically <code>react-router-dom</code>.</p>
<p>When you complete this lesson, you should be able to use the hooks that are<br>
built into the <code>react-router-dom</code> package:</p>
<ul>
<li><code>useParams</code> for matching parameters in the current route</li>
<li><code>useHistory</code> for navigation from code (without <code>Link</code> or <code>NavLink</code>)</li>
<li><code>useLocation</code> for tracking url changes</li>
<li><code>useRouteMatch</code> for checking if the current url matches a path format</li>
</ul>
<h2 class="mume-header" id="useparams"><code>useParams</code></h2>

<p>The most common usage of hooks with <code>react-router-dom</code> is the case where<br>
a RESTful path has one or more parameters, such as an <code>id</code>.</p>
<p>For example, the <code>id</code> in a path like <code>/user/:id</code> may be accessed as the<br>
property of an object returned by <code>useParams()</code>.</p>
<p>Option 1</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token function">useParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;User id is&apos;</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Option 2 (more common)</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;User id is&apos;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now, consider this path <code>/user/:userId/doc/:docId</code>. It has two parameters,<br>
<code>userId</code> and <code>docId</code>; therefore, they would be accessed using<br>
<code>const { userId, docId } = useParams()</code>. Notice how the variables in the path<br>
match the properties on the objects returned by <code>useParams()</code>.</p>
<p>Here&apos;s an expanded example showing a basic function component.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/components/Document.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useParams <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-router-dom&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Document</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> userId<span class="token punctuation">,</span> docId <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Document <span class="token punctuation">{</span>docId<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Created by User <span class="token punctuation">{</span>userId<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Document<span class="token punctuation">;</span>
</pre><p>As a reminder, you&apos;ll need to wrap your components within a <code>&lt;Router&gt;</code> in order<br>
to use the hooks built into the <code>react-router-dom</code> package. Perhaps like this...</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/index.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
    BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span>
    Switch<span class="token punctuation">,</span>
    Route<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-router-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Document <span class="token keyword">from</span> <span class="token string">&apos;./components/Document&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// For simplicity, Router and Switch are here instead of the traditional App.js</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&apos;/user/:userId/doc/:docId&apos;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Document<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token punctuation">{</span><span class="token comment">/* Other routes also */</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;root&apos;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="usehistory"><code>useHistory</code></h2>

<p>The <code>useHistory()</code> hook gives you access to the <strong>history</strong> object, which is<br>
a record of paths visited on the current browser tab.</p>
<p>While there are a number of possibilities for what you can do with <code>history</code>,<br>
some are more useful than others. Here are the top methods and property.</p>
<ul>
<li><code>push(path, [state])</code>
<ul>
<li>Adds a new path to the history and navigates there</li>
<li><code>state</code> object is optional</li>
</ul>
</li>
<li><code>replace(path, [state])</code>
<ul>
<li>Removes the current path from history before adding the new path<br>
and navigating there</li>
<li><code>state</code> object is optional</li>
<li>When the user goes back from the next path, they will skip the replaced path<br>
(either with the browser&apos;s BACK button or the <code>goBack()</code> function)</li>
</ul>
</li>
<li><code>goBack()</code>
<ul>
<li>Returns to the previous path in the history</li>
</ul>
</li>
<li><code>location</code> - the current location
<ul>
<li><code>pathname</code> - the path</li>
<li><code>search</code> - query params (following a <code>?</code> in the url), if any</li>
<li><code>hash</code> - value following a <code>#</code> in the url, if any</li>
<li><code>state</code> - object provided with <code>push()</code> or <code>replace()</code></li>
</ul>
</li>
</ul>
<p>The <code>state</code> object is a way for you to pass one or more data values between<br>
routes. The sender creates the object and passes it as the second argument to<br>
<code>history.push</code> or <code>history.replace</code>; the receiver accesses the object using<br>
<code>history.location.state</code>.</p>
<p>For more capabilities, you can read the <a href="https://reactrouter.com/web/api/history">documentation on History</a>, if you so<br>
desire.</p>
<p>Here&apos;s an example of a function component using history for custom navigation.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/components/ComingSoon.js</span>

<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-router-dom&apos;</span>

<span class="token keyword">const</span> <span class="token function-variable function">ComingSoon</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> history <span class="token operator">=</span> <span class="token function">useHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> tid <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            history<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&apos;/&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Coming Soon<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ComingSoon<span class="token punctuation">;</span>
</pre><blockquote>
<p>ASIDE: This example also makes use of the <code>useEffect</code> hook discussed in other<br>
lessons in order to automatically redirect the user after a timeout period.<br>
In particular, notice how <code>return</code> is used to prevent warnings in React<br>
if the user chooses to leave the page before the timeout period ends.</p>
</blockquote>
<h2 class="mume-header" id="uselocation"><code>useLocation</code></h2>

<p>The preferred approach to accessing the location from within a component is<br>
through the history object. However, there is a special case where the<br>
<code>useLocation</code> hook is useful - connecting to a service which tracks page loads.</p>
<p>One example is <strong>Google Analytics</strong>.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/index.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&apos;react-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
    BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span>
    Switch<span class="token punctuation">,</span>
    useLocation
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-router-dom&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ga <span class="token keyword">from</span> <span class="token string">&apos;react-ga&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">TrackingWrapper</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> location <span class="token operator">=</span> <span class="token function">useLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        ga<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&apos;pageview&apos;</span><span class="token punctuation">,</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>location<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> children<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>TrackingWrapper<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
                <span class="token punctuation">{</span><span class="token comment">/* App and/or Routes, etc. */</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>TrackingWrapper<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;root&apos;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

</pre><p>The setup and usage of Google Analytics is beyond the scope of this lesson.<br>
However, if you&apos;d like to learn more you can search online for examples, such as<br>
<a href="https://levelup.gitconnected.com/using-google-analytics-with-react-3d98d709399b">Google Analytics with React</a>. In short, the call to <code>ga.send()</code> logs whatever<br>
event you pass it into your GA account. Then you can sign in to GA to view and<br>
analyze the recorded data including days and times when users are most active,<br>
what country your visitors are coming from, and much more.</p>
<h2 class="mume-header" id="useroutematch"><code>useRouteMatch</code></h2>

<p>If you&apos;d like to check for a matching path before rendering a route, then<br>
turn to <code>useRouteMatch</code>. This hook accepts an argument which is compared to the<br>
current path in the same fashion as <code>Route</code> and returns a boolean (<code>true</code> or<br>
<code>false</code>).</p>
<p>For example, <code>useRouteMatch(&apos;/report/advanced&apos;)</code> could be<br>
used to show (or hide, when not matching) an advanced user interface for<br>
modifying a report on the fly.</p>
<h2 class="mume-header" id="bring-it-together">Bring it together</h2>

<p>Here is an example of a component which lays the framework for a thorough usage<br>
of React Router hooks (except <code>location</code> which is better used elsewhere). Use<br>
your detective skills to figure out as much as you can. A thorough explanation<br>
is provided in one of the video lessons.</p>
<p>Imagine the following <code>Report</code> component is placed in a router with<br>
<code>&lt;Route path={[&apos;/report/:date&apos;, &apos;/report&apos;]} component={Report}/&gt;</code>.</p>
<blockquote>
<p>BONUS: In case you didn&apos;t know already, a router can use an array to specify<br>
multiple paths to match with the provided component.</p>
</blockquote>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token comment">// ./src/components/Report.js</span>

<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>useEffect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRouteMatch<span class="token punctuation">,</span> useHistory<span class="token punctuation">,</span> useParams <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-router-dom&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Report</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> matchUC <span class="token operator">=</span> <span class="token function">useRouteMatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> <span class="token string">&apos;/REPORT*&apos;</span><span class="token punctuation">,</span>
        strict<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        sensitive<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> matchAdvanced <span class="token operator">=</span> <span class="token function">useRouteMatch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token string">&apos;/report/advanced&apos;</span><span class="token punctuation">,</span>
        <span class="token string">&apos;/report/*/advanced&apos;</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> matchAll <span class="token operator">=</span> <span class="token function">useRouteMatch</span><span class="token punctuation">(</span><span class="token string">&apos;/report/all&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> date <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> history <span class="token operator">=</span> <span class="token function">useHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>matchUC<span class="token punctuation">)</span>
            history<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>history<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>matchUC<span class="token punctuation">,</span> history<span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>matchUC<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>date<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Select Report
            <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&apos;/report/last-week&apos;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token operator">&gt;</span>Last Week<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&apos;/report/last-month&apos;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token operator">&gt;</span>Last Month<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&apos;/report/all&apos;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token operator">&gt;</span>View All<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>date <span class="token operator">===</span> <span class="token string">&apos;advanced&apos;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Select Report
            <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&apos;/report/last-week/&apos;</span><span class="token operator">+</span>date<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token operator">&gt;</span>Last Week<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&apos;/report/last-month/&apos;</span><span class="token operator">+</span>date<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token operator">&gt;</span>Last Month<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&apos;/report/all/&apos;</span><span class="token operator">+</span>date<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token operator">&gt;</span>View All<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>matchAll<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Complete Report <span class="token keyword">of</span> Everything<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
            <span class="token punctuation">{</span>matchAdvanced <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token operator">...</span> Alternate Advanced Controls <span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Report For <span class="token punctuation">{</span>date<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
            <span class="token punctuation">{</span>matchAdvanced <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token operator">...</span> Advanced Controls <span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Report<span class="token punctuation">;</span>
</pre><p>The various routes to explore include</p>
<ul>
<li><code>/REPORT</code> or <code>/REPORT/SOMETHING/ADVANCED</code> or any other variation starting with<br>
REPORT in all caps will redirect to the same url in lowercase</li>
<li><code>/report</code> or <code>/report/advanced</code> will show a few buttons</li>
<li><code>/report/all</code> will show a different title than <code>/report/something-else</code><br>
(with or without the next option)</li>
<li>any url ending in <code>/advanced</code> will show &quot;Advanced Controls&quot;</li>
</ul>
<h2 class="mume-header" id="what-youve-learned">What you&apos;ve learned</h2>

<p>The <code>react-router-dom</code> package comes with hooks you can use to simplify the code<br>
in your <strong>React</strong> applications. For example, utilizing<br>
<code>const { id } = useParams()</code> within a component displayed in the path<br>
<code>/user/:id</code> give you access to the value that replaces the <code>:id</code> parameter.<br>
Navigating can be accomplished with <code>const history = useHistory()</code> followed by<br>
<code>history.push(&apos;/a/new/path&apos;)</code>, and you can even include a <code>state</code> object as<br>
a second parameter. Additionally, <code>useLocation</code> can help you connect to tracking<br>
services, and <code>useRouteMatch</code> might come in handy once in while for pattern<br>
matching on the path itself. In short, the handling of RESTful paths in React is<br>
enhanced when you embrace the hooks available in React Router.</p>
<p>For future reference, you may want to bookmark the<br>
<a href="https://reactrouter.com/web/api/Hooks">official documentation on React Router Hooks</a>.</p>
<hr>
<h1 class="mume-header" id="react-hooks-documentation">React Hooks Documentation</h1>

<p>You now know how to manage information in a React application through <code>state</code>,<br>
<code>props</code>, <code>context</code>, and a <code>Redux</code> store. Take a moment to read through the<br>
official React Hooks documentation. Now that you&apos;ve been working with React for<br>
almost two weeks now, you should have a base level understanding of React and<br>
the component lifecycle. Congratulations on learning such a concept heavy<br>
library!</p>
<p>As you move forward in your development careers, you&apos;ll need to lean more on<br>
official documentation - React&apos;s official documentation is a great place to<br>
start! Review the following articles about from the official React Hooks<br>
documentation and try to be aware of how you navigate the documentation to aid<br>
your own learning.</p>
<h2 class="mume-header" id="why-hooks">Why hooks?</h2>

<ul>
<li><a href="https://reactjs.org/docs/hooks-intro.html#motivation">The Motivation Behind Hooks</a></li>
<li><a href="https://reactjs.org/docs/hooks-overview.html">Hooks at a Glance</a></li>
</ul>
<h2 class="mume-header" id="hook-basics">Hook basics</h2>

<ul>
<li><a href="https://reactjs.org/docs/hooks-rules.html">Rules of Hooks</a></li>
<li><a href="https://reactjs.org/docs/hooks-reference.html">Hooks API Reference</a></li>
<li><a href="https://reactjs.org/docs/hooks-state.html">useState</a></li>
<li><a href="https://reactjs.org/docs/hooks-effect.html">useEffect</a></li>
<li><a href="https://reactjs.org/docs/hooks-reference.html#usecontext">useContext</a></li>
<li><a href="https://reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects">Optimizing Performance by Skipping Effects</a></li>
</ul>
<h2 class="mume-header" id="more-about-hooks">More about hooks</h2>

<ul>
<li><a href="https://reactjs.org/docs/hooks-custom.html">Custom Hooks</a></li>
<li><a href="https://reactjs.org/docs/hooks-faq.html">Hooks FAQ</a></li>
</ul>
<hr>
<h1 class="mume-header" id="pokedex-hooks-project-phase-1">Pokedex Hooks Project: Phase 1</h1>

<p>In today&apos;s project you will refactor class-based components that make use of<br>
lifecycle methods to function components that make use of React Hooks! At this<br>
point, you have already built an application with class components and context<br>
to manage application state. You&apos;ve also built the same application to learn<br>
about how to use Redux instead of React Context for state-management.</p>
<p>In this project, you&apos;ll build your application with React and Redux hooks! You<br>
will implement the:</p>
<ul>
<li><code>useState</code> hook to manage a component&apos;s state</li>
<li><code>useEffect</code> hook to manage a component&apos;s side effect operations</li>
<li><code>useDispatch</code> hook to dispatch actions from with a component file</li>
<li><code>useSelector</code> hook access slices of state from the Redux store</li>
<li><code>useContext</code> hook to manage your application with Context instead of Redux</li>
</ul>
<h2 class="mume-header" id="phase-1-state-based-hooks-application">Phase 1: State-based hooks application</h2>

<p>You&apos;ll need the backend for the Pokedex application. Take a moment to clone it<br>
from <a href="https://github.com/appacademy-starters/pokedex-backend">https://github.com/appacademy-starters/pokedex-backend</a> and get it set up.</p>
<p>The API for the backend is also documented in repository&apos;s README.</p>
<p>Once you have that up and running, you&apos;ll begin working out of the solution for<br>
the state-based class components project. Begin by cloning the state-based<br>
application from<br>
<a href="https://github.com/appacademy-starters/react-hooks-pokedex-starter.git">https://github.com/appacademy-starters/react-hooks-pokedex-starter.git</a>.</p>
<p>Throughout today, you&apos;ll work on refactoring each class component in the<br>
application to be a function component that makes use of React Hooks!</p>
<h3 class="mume-header" id="explore-the-reference-application">Explore the reference application</h3>

<p>As you might remember, your current application comprises of the following<br>
components:</p>
<ul>
<li><code>App</code>: Does the browser routing and top-level fetches of data to draw the data</li>
<li><code>LoginPanel</code>: Shows the login panel</li>
<li><code>PokemonBrowser</code>: The browser that draws the list on the left after logging in<br>
and has a route to the <code>PokemonDetail</code> when the route matches &quot;/pokemon/:id&quot;</li>
<li><code>PokemonDetail</code>: Makes a fetch to the API on mount and update to load the<br>
details of the selected Pokemon</li>
</ul>
<h3 class="mume-header" id="refactor-components">Refactor components</h3>

<p>As you&apos;re refactoring your application&apos;s components, you&apos;ll most likely hit bugs<br>
and break your application. While you&apos;re refactoring each component, make sure<br>
to test that your refactored code is working before moving on to refactor the<br>
next component. As a general guideline, you should refactor each component from<br>
the lowest, most nested component up to the top-most parent:</p>
<ol>
<li><code>PokemonDetail</code></li>
<li><code>PokemonBrowser</code></li>
<li><code>LoginPanel</code></li>
<li><code>App</code></li>
</ol>
<p>You&apos;ll update how each component sets its default state by using the <code>useState</code><br>
hook. You&apos;ll also refactor the lifecycle methods of each component into side<br>
effect operations managed by the <code>useEffect</code> hook. At the end of this exercise,<br>
you should have a good understanding of how to use the basic <code>useState</code> and<br>
<code>useEffect</code> hooks to write function components with side effect operations.</p>
<p>Take this project as a way to practice learning new technologies by referencing<br>
official documentation:</p>
<ul>
<li><a href="https://reactjs.org/docs/hooks-state.html">Using the State Hook</a></li>
<li><a href="https://reactjs.org/docs/hooks-effect.html">Using the Effect Hook</a></li>
<li><a href="https://reactjs.org/docs/hooks-reference.html">Hooks API Reference</a></li>
</ul>
<p>Remember, Create React App will let your React application use environment<br>
variables that start with <code>REACT_APP_</code>. Just like with your state-based<br>
application built with class components, you can import environment variables<br>
from the <code>config.js</code> file to clean up your code for specifying the URL of the<br>
backend.</p>
<p>Once you have finished refactoring, take a moment to commit your changes to the<br>
main branch of your <code>react-hooks-pokedex-starter</code> project:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">git</span> add <span class="token keyword">.</span>
<span class="token function">git</span> commit -m <span class="token string">&quot;Refactor app to implement hooks&quot;</span>
</pre><p>In the next two phases, you&apos;ll create two different projects in two different<br>
branches that use this commit as a starting point. You&apos;ll branch off from this<br>
point to create a Redux-based project and a Context-based project (both<br>
utilizing hooks).</p>
<hr>
<h1 class="mume-header" id="pokedex-hooks-project-phase-2">Pokedex Hooks Project: Phase 2</h1>

<p>As you might remember from the Redux-based Pokedex project, implementing Redux<br>
results in a lot of boilerplate code. Using Redux hooks can help clean up and<br>
get rid of a lot of boilerplate code. In this phase you will refactor the<br>
Redux-based project to use React hooks and implement Redux hooks!</p>
<p>Begin by creating a new branch for your Redux-based application:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">git</span> checkout -b redux-hooks-app
</pre><p>Take a moment to download the <a href="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/react-hooks/projects/pokedex-hooks/starter-redux-based-hooks.zip">Redux-based Pokedex hooks starter project</a>. Make<br>
sure you are in your new <code>redux-hooks-app</code> branch:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">git</span> branch
</pre><p>Delete all of your project&apos;s current code and move the files of<br>
<code>redux-based-pokedex-solution</code> into your current directory<br>
(<code>react-hooks-pokedex-starter</code>). For example, if both<br>
project directories are within the same directory, you can use the <code>mv</code> command<br>
from the two project folders&apos; parent directory.</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">mv</span> -v redux-based-pokedex-solution/* react-hooks-pokedex-starter
</pre><p>Now take a moment to commit the start of your Redux-based project:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">git</span> add <span class="token keyword">.</span>
<span class="token function">git</span> commit -m <span class="token string">&quot;Initialize redux hooks starter project&quot;</span>
</pre><h2 class="mume-header" id="using-redux-hooks-to-manage-application-state">Using Redux hooks to manage application state</h2>

<p>In this phase, you&apos;ll be refactoring all your component files to use Redux hooks<br>
instead of the <code>mapStateToProps</code>, <code>mapDispatchToProps</code>, and Redux <code>connect</code><br>
functions. Just like in phase 1, you might hit bugs and break your application<br>
while refactoring your application&apos;s components. Make sure to test that your<br>
refactored code is working before moving on to refactor the next component. As a<br>
general overview, you&apos;ll be refactoring the code for the following components:</p>
<ol>
<li><code>LogoutButton</code></li>
<li><code>LoginPanel</code></li>
<li><code>PokemonDetail</code></li>
<li><code>PokemonForm</code></li>
<li><code>PokemonBrowser</code></li>
</ol>
<p>There are two ways you can refactor your project:</p>
<ol>
<li>You can refactor your project to use the <code>useDispatch</code> and <code>useSelector</code><br>
hooks in a <em>container</em> component.</li>
<li>You can refactor your project to use the <code>useDispatch</code> and <code>useSelector</code><br>
hooks within the component itself.</li>
</ol>
<p>You can choose either method to refactor your project. At this point, you are a<br>
full-fledged React developer - it&apos;s time for you to start planning your own<br>
React code! Talk things through with your partner and decide which way you would<br>
like to begin refactoring your project. Remember, as you are using this project<br>
as practice for implementing Redux hooks, you can always implement Redux hooks<br>
into a container component for one component, and then implement Redux hooks<br>
directly in another component for the next component. Just make sure to choose<br>
one method to stick with for your personal React projects!</p>
<h3 class="mume-header" id="version-1-using-redux-hooks-in-a-container-component">Version 1: Using Redux hooks in a container component</h3>

<p>If you chose to use the <code>useDispatch</code> and <code>useSelector</code> hooks in a <em>container</em><br>
component, this means you should use a namespace to import actions into each<br>
component file. For example, in the <code>LogoutButton.js</code> file, you currently have<br>
the following import statement that imports the <code>logout</code> action creator<br>
function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> logout <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;../actions/authentication&apos;</span><span class="token punctuation">;</span>
</pre><p>In order to remove confusion about whether an invocation of <code>logout()</code> is<br>
invoking the <code>logout</code> prop or the <code>logout</code> action creator function, you can<br>
update the import statement for your logout action to use an <code>AuthAction</code><br>
namespace:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> AuthAction <span class="token keyword">from</span> <span class="token string">&apos;../actions/authentication&apos;</span><span class="token punctuation">;</span>
</pre><p>This way, you can create a container component to replace what is happening<br>
under the hood with the <code>mapStateToProps</code>, <code>mapDispatchToProps</code>, and <code>connect</code><br>
functions. You can reference the logout action with the <code>AuthAction</code> namepsace,<br>
like so: <code>AuthAction.logout</code>.</p>
<p>Based on the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions in the<br>
<code>LogoutButton.js</code> file, you can tell that the component is accessing Redux by<br>
receiving <code>loggedOut</code> and <code>logout</code> props:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    loggedOut<span class="token punctuation">:</span> <span class="token operator">!</span>state<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span>token<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">logout</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>LogoutButton<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Take a moment to import the <code>useSelector</code> and <code>useDispatch</code> from the Redux<br>
library into the file:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> useDispatch<span class="token punctuation">,</span> useSelector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
</pre><p>Now you&apos;ll write a container component that will replace the <code>mapStateToProps</code>,<br>
<code>mapDispatchToProps</code>, and <code>connect</code> functions! Start by setting up the container<br>
component that returns the <code>LogoutButton</code> component to use the <code>useDispatch</code><br>
prop. You&apos;ll also want to have the <code>LogoutButton.js</code> file export the<br>
<code>LogoutButtonContainer</code> component (instead of the higher-order component<br>
returned by the <code>connect</code> function):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">LogoutButtonContainer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>LogoutButton <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> LogoutButtonContainer<span class="token punctuation">;</span>
</pre><blockquote>
<p>Feel free to visit the Redux Hooks documentation to view <a href="https://react-redux.js.org/next/api/hooks#examples"><code>useDispatch</code><br>
examples</a>.</p>
</blockquote>
<p>Now that you have the container component and <code>dispatch</code> set up, you can pass<br>
dispatched version of the <code>logout</code> action as a prop into the <code>LogoutButton</code><br>
component:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">LogoutButtonContainer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">logout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span>AuthAction<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>LogoutButton logout<span class="token operator">=</span><span class="token punctuation">{</span>logout<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>At this point, the container component is taking care of what the<br>
<code>mapDispatchToProps</code> function took care of! Now let&apos;s use the <code>useSelector</code> hook<br>
to take care of what the <code>mapStateToProps</code> function took care of:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">LogoutButtonContainer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">logout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span>AuthAction<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> loggedOut <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>state<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>LogoutButton logout<span class="token operator">=</span><span class="token punctuation">{</span>logout<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><blockquote>
<p>Feel free to visit the Redux Hooks documentation to view <a href="https://react-redux.js.org/next/api/hooks#useselector-examples"><code>useSelector</code><br>
examples</a>.</p>
</blockquote>
<p>Now that you&apos;ve gone over how to create a container component that implements<br>
Redux Hooks for the <code>LogoutButton</code> component, follow the same pattern to<br>
implement Redux hooks into container components for your <code>LoginPanel</code>,<br>
<code>PokemonDetail</code>, <code>PokemonForm</code>, and <code>PokemonBrowser</code> components. Feel free to<br>
practice implementing Redux hooks directly within a component instead!</p>
<h3 class="mume-header" id="version-2-using-redux-hooks-from-within-a-component">Version 2: Using Redux hooks from within a component</h3>

<p>If you chose to use the <code>useDispatch</code> and <code>useSelector</code> hooks within the<br>
component itself, you&apos;ll need to do some refactoring so that your component<br>
doesn&apos;t receive any props. Instead of receiving slices of state and dispatchable<br>
action functions as props, you will use the <code>useSelector</code> hook to access a slice<br>
a state from within the component and the <code>useDispatch</code> hook to dispatch actions<br>
from within the component.</p>
<p>Based on the <code>mapStateToProps</code> and <code>mapDispatchToProps</code> functions in the<br>
<code>LogoutButton.js</code> file, you can tell that the component is accessing Redux by<br>
receiving <code>loggedOut</code> and <code>logout</code> props.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    loggedOut<span class="token punctuation">:</span> <span class="token operator">!</span>state<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span>token<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">logout</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>LogoutButton<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Take a moment to import the <code>useSelector</code> and <code>useDispatch</code> from the Redux<br>
library into the file.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> useDispatch<span class="token punctuation">,</span> useSelector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-redux&apos;</span><span class="token punctuation">;</span>
</pre><p>Now you&apos;ll want to remove all the props that the <code>LogoutButton</code> receives.<br>
Instead of receiving props to access the <code>loggedOut</code> state and dispatched<br>
<code>logout</code> function, you&apos;ll use the <code>useSelector</code> and <code>useDispatch</code> hook you just<br>
imported into the file. At this point, your <code>LogoutButton</code> component should look<br>
something like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">LogoutButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>loggedOut<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Redirect to<span class="token operator">=</span><span class="token string">&quot;/login&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;logout-button-holder&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>Logout<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Now you&apos;ll use Redux hooks within the <code>LoginButton</code> component so that you can<br>
remove the <code>mapStateToProps</code>, <code>mapDispatchToProps</code>, and <code>connect</code> functions!<br>
Instead of receiving a <code>loggedOut</code> prop, you&apos;ll use the <code>useSelector</code> hook to<br>
access the state&apos;s <code>authentication.token</code>.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">LogoutButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> loggedOut <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>state<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// CODE SHORTENED FOR BREVITY</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><blockquote>
<p>Feel free to visit the Redux Hooks documentation to view <a href="https://react-redux.js.org/next/api/hooks#useselector-examples"><code>useSelector</code><br>
examples</a>.</p>
</blockquote>
<p>Notice how the <code>logout</code> thunk action creator function has already been imported<br>
into your <code>LogoutButton.js</code> file. You&apos;ll use <code>useDispatch</code> hook to return a<br>
reference to the <code>dispatch</code> function from the Redux store:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Then you can use the <code>dispatch</code> function to dispatch the <code>logout</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">LogoutButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> loggedOut <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>state<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// CODE SHORTENED FOR BREVITY</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><blockquote>
<p>Feel free to visit the Redux Hooks documentation to view <a href="https://react-redux.js.org/next/api/hooks#examples"><code>useDispatch</code><br>
examples</a>.</p>
</blockquote>
<p>Lastly, you&apos;ll want to remove the <code>mapStateToProps</code> and <code>mapDispatchToProps</code><br>
functions from the file, and replace the <code>connect</code> function to an export<br>
statement that exports the <code>LoginButton</code> component by default:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> LoginButton<span class="token punctuation">;</span>
</pre><p>Now that you&apos;ve gone over how to refactor your <code>LogoutButton</code> component, follow<br>
the same pattern to implement Redux hooks into your <code>LoginPanel</code>,<br>
<code>PokemonDetail</code>, <code>PokemonForm</code>, and <code>PokemonBrowser</code> components. Feel free to<br>
practice creating a container component that utilizes Redux hooks instead!</p>
<h3 class="mume-header" id="router-hooks-useparams">Router hooks: <code>useParams</code></h3>

<p>Notice the references to the React Router <code>match</code> prop accessed in your<br>
<code>PokemonBrowser</code> and <code>PokemonDetail</code> components. Instead of having your<br>
component take in a <code>match</code> prop to access the route parameters, you&apos;ll<br>
implement the <code>useParams</code> prop and use object destructuring to access the<br>
<code>pokemonId</code> parameter in the <code>PokemonBrowser</code> component and the <code>id</code> parameter<br>
in the <code>PokemonDetail</code> component. Feel free to visit React Router documentation<br>
to view examples of using the <a href="https://reactrouter.com/web/api/Hooks/useparams"><code>useParams</code> hook</a>.</p>
<p>Once you have finished refactoring, take a moment to commit your changes to your<br>
<code>redux-hooks-app</code> branch:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">git</span> add <span class="token keyword">.</span>
<span class="token function">git</span> commit -m <span class="token string">&quot;Refactor app to implement redux hooks&quot;</span>
</pre><p>Now that you have practiced refactoring your application to implement Redux<br>
hooks, it&apos;s time to work on a Context-based project utilizing React&apos;s<br>
<code>useContext</code> hook! In the next phase, you&apos;ll branch off from your application&apos;s<br>
main branch to create a new <code>context-hooks-app</code> branch for the project.</p>
<hr>
<h1 class="mume-header" id="pokedex-hooks-project-phase-3">Pokedex Hooks Project: Phase 3</h1>

<p>At this point, you&apos;ve managed a state-based project with the <code>useState</code> and<br>
<code>useEffect</code> hooks and a Redux-based project with the <code>useSelector</code> and<br>
<code>useDispatch</code> hooks. Now you&apos;ll work off of the state-based project you built in<br>
Phase 2 to manage your application&apos;s state with the <code>useContext</code> hook!</p>
<p>Begin by creating a new branch for your Context-based application off of your<br>
main branch:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">git</span> checkout master
<span class="token function">git</span> checkout -b context-hooks-app
</pre><h2 class="mume-header" id="using-the-usecontext-hook-to-manage-application-state">Using the <code>useContext</code> hook to manage application state</h2>

<p>Think of how you created a Redux cycle to pass Pokedex information through your<br>
components. Now you&apos;ll manage your application&apos;s global information by using<br>
React Context instead! Remember that you still generate context with the<br>
<code>createContext</code> function, just as you would for class components. You also still<br>
use <code>&lt;Context.Provider&gt;</code> components to set the <code>value</code> of your context object.</p>
<p>Think of how you would make use of the <code>useContext</code> hook instead of Redux&apos;s<br>
<code>connect()</code> function to pass slices of state as well as functions to update the<br>
global state. As you use the <code>useEffect</code> hook for side effect operations, think<br>
of conditions where you would want to prevent the effect from running. Remember<br>
to set the variables that determine these conditions in the <code>useEffect</code> hook&apos;s<br>
dependency array.</p>
<h3 class="mume-header" id="providing-context">Providing context</h3>

<p>Begin by creating a <code>PokemonContext</code> with the <code>createContext</code> function from<br>
React. Then you&apos;ll need to set the context value with a <code>&lt;Context.Provider&gt;</code><br>
component by making a wrapper Provider component for the <code>App</code> component. Create<br>
an <code>AppWithContext</code> component as the wrapper component for <code>App</code>.The wrapper<br>
component will have the following slices of state:</p>
<ul>
<li><code>pokemon</code> - defaults to an empty array.</li>
<li><code>singlePokemon</code> - defaults to <code>null</code>.</li>
<li><code>authToken</code> - defaults to the <code>state-pokedex-token</code> item stored in<br>
<code>localStorage</code>.</li>
<li><code>needLogin</code> - defaults to the <em>truthyness</em> of the <code>state-pokedex-token</code> item<br>
stored in <code>localStorage</code> (hint: you can use the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_Operators#Double_NOT_!!">double not</a> <code>!!</code> notation).</li>
</ul>
<p>The wrapper component will also pass the following functions as the context<br>
<code>value</code>:</p>
<ul>
<li><code>login(token)</code> - to set the <code>state-pokedex-token</code> item in <code>localStorage</code>,<br>
update the <code>authToken</code> state, and update the <code>needLogin</code> state to <code>false</code>.</li>
<li><code>loadPokemon()</code> - to fetch all pokemon and update the <code>pokemon</code> state.</li>
<li><code>getOnePokemon(id)</code> - to fetch one pokemon and update the <code>singlePokemon</code><br>
state.</li>
</ul>
<p>After you have set up the wrapper component, make sure to replace the <code>App</code> that<br>
is rendered in your <code>index.js</code> file with your new <code>AppWithContext</code> wrapper<br>
component. Now it&apos;s time to change your application from being a state-based<br>
application to a context-based application.</p>
<p>Begin by removing all props that are passed between components. You&apos;ll use the<br>
hooks and the <code>PokemonContext</code> value to manage the global state of your<br>
application instead. Make sure to even remove the <code>match</code> prop you access in the<br>
<code>PokemonDetail</code> component. You&apos;ll use the <a href="https://reacttraining.com/blog/react-router-v5-1/#useparams">useParams</a> hook from <a href="https://reacttraining.com/blog/react-router-v5-1/">React Router<br>
v5.1</a> instead of the <code>match</code> prop.</p>
<h3 class="mume-header" id="consuming-context-with-the-usecontext-hook">Consuming context with the useContext hook</h3>

<p>Your application&apos;s consuming components should access the <code>PokemonContext</code><br>
through using the <code>useContext</code> hook. Feel free to reference the <a href="https://reactjs.org/docs/hooks-reference.html">Hooks API<br>
Reference</a> to revisit the documentation on the <code>useContext</code> hook. As a reminder,<br>
the <code>useContext</code> hook replaces the <code>static contextType</code> property of class<br>
components:</p>
<h3 class="mume-header" id="static-contexttype">static contextType</h3>

<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// Receive access to context in class components:</span>
<span class="token keyword">static</span> contextType <span class="token operator">=</span> PokemonContext<span class="token punctuation">;</span>

<span class="token comment">// Access context with the `contextType` property:</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>context
</pre><h3 class="mume-header" id="usecontext-1">useContext</h3>

<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// Receive access to context with React Hooks in function components:</span>
<span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>PokemonContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Access context with the `useContext` hook:</span>
context
</pre><p>Now it&apos;s time to set up how your application components <em>consume</em> the<br>
<code>PokemonContext</code>!</p>
<p>Feel free to console log the <code>context</code> in any component you are accessing the<br>
<code>PokemonContext</code>. It could be helpful to create an application state logging<br>
system like so:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>PokemonContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>This way upon the mounting of a component, you have a general sense of the<br>
<code>context</code> object the component is receiving. Since you&apos;ll be using Hooks and<br>
Context to manage your user authentication, you may need to clear your<br>
<code>localStorage</code> items to reset your application to allow for future testing and<br>
debugging. As a reminder, you can go to the <code>Application</code> tab of your developer<br>
tools to find a <code>Storage</code> section with your <code>Local Storage</code> items. There you can<br>
right click to delete all items stored in <code>localStorage</code>.</p>
<h3 class="mume-header" id="app-1">App</h3>

<p>Take a moment to compare the code that currently lives in your <code>AppWithContext</code><br>
with the code that lives in you <code>App</code> component. Notice how there is a lot of<br>
duplicated logic. This is because you <code>App</code> was the main component managing your<br>
application&apos;s state-based information. Now that you have moved all the logic to<br>
your <code>AppWithContext</code> component, you can refactor your <code>App</code> component to simply<br>
use the <code>useContext</code> hook to pass the <code>needLogin</code> value to the <code>&lt;PrivateRoute&gt;</code><br>
it renders. You can also remove all other props passed through the routes. Your<br>
refactored <code>App</code> component should look something like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// App.js</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> Switch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-router-dom&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> PrivateRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./routesUtil&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> LoginPanel <span class="token keyword">from</span> <span class="token string">&apos;./LoginPanel&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PokemonBrowser <span class="token keyword">from</span> <span class="token string">&apos;./PokemonBrowser&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PokemonContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./PokemonContext&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> needLogin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>PokemonContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>BrowserRouter<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/login&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>LoginPanel<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>PrivateRoute
          path<span class="token operator">=</span><span class="token string">&quot;/&quot;</span>
          component<span class="token operator">=</span><span class="token punctuation">{</span>PokemonBrowser<span class="token punctuation">}</span>
          needLogin<span class="token operator">=</span><span class="token punctuation">{</span>needLogin<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>BrowserRouter<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="loginpanel">LoginPanel</h3>

<p>Let&apos;s begin by refactoring your <code>LoginPanel</code> component! The <code>LoginPanel</code> should<br>
access the context&apos;s <code>login</code> function. Feel free to also access the <code>authToken</code><br>
value for testing purposes. Note that you can also destructure the context<br>
object, like so:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> login<span class="token punctuation">,</span> authToken <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>PokemonContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>authToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>You&apos;ll want to make sure that your <code>LoginPanel</code> has the following slices of<br>
state:</p>
<ul>
<li><code>loggedIn</code> - defaults to <code>false</code>.</li>
<li><code>email</code> - defaults to <code>&apos;demo@example.com&apos;</code>.</li>
<li><code>password</code> - defaults to <code>&apos;password&apos;</code>.</li>
</ul>
<p>Your <code>LoginPanel</code> component should also hold the following three functions:</p>
<ul>
<li><code>handleSubmit</code> - to make a fetch request to your API, update the <code>loggedIn</code><br>
state, and invoke the context&apos;s <code>login</code> function with the <code>token</code> from the<br>
fetch response.</li>
<li><code>updateEmail</code> - to update the <code>email</code> slice of state.</li>
<li><code>updatePassword</code> - to update the <code>password</code> slice of state.</li>
</ul>
<p>Lastly, your <code>LoginPanel</code> should redirect logged in users to the home page,<br>
based on the <code>loggedIn</code> slice of state:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>loggedIn<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">&lt;</span>Redirect to<span class="token operator">=</span><span class="token string">&quot;/&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</pre><p>Now you&apos;ll want to set up your <code>PokemonBrowser</code> component before testing the<br>
login flow and home page redirection - you&apos;ll hit a lot of errors if you don&apos;t<br>
refactor your <code>PokemonBrowser</code> correctly first.</p>
<h3 class="mume-header" id="pokemonbrowser">PokemonBrowser</h3>

<p>At this point, your <code>PokemonBrowser</code> component should look something like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NavLink<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> imageUrl <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./config&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PokemonDetail <span class="token keyword">from</span> <span class="token string">&quot;./PokemonDetail&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">PokemonBrowser</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> pokemon<span class="token punctuation">,</span> token <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pokemon<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>main<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>nav<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>pokemon<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">poke</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>NavLink key<span class="token operator">=</span><span class="token punctuation">{</span>poke<span class="token punctuation">.</span>name<span class="token punctuation">}</span> to<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`/pokemon/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>poke<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;nav-entry&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;nav-entry-image&quot;</span>
                  style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                    backgroundImage<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`url(&apos;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>imageUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>poke<span class="token punctuation">.</span>imageUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&apos;)`</span></span>
                  <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token punctuation">{</span>poke<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>NavLink<span class="token operator">&gt;</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>nav<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Route
        path<span class="token operator">=</span><span class="token string">&quot;/pokemon/:id&quot;</span>
        render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>PokemonDetail <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> token<span class="token operator">=</span><span class="token punctuation">{</span>token<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>main<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PokemonBrowser<span class="token punctuation">;</span>
</pre><p>You won&apos;t need to refactor any existing code within component, except removing<br>
the props it receives. You&apos;ll simply use the <code>useContext</code> hook to access the<br>
<code>PokemonContext</code> and use the <code>useEffect</code> hook to update the context&apos;s <code>pokemon</code>.</p>
<p>Begin by having your <code>PokemonBrowser</code> component access the context&apos;s <code>pokemon</code><br>
and <code>loadPokemon</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> pokemon<span class="token punctuation">,</span> loadPokemon <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>PokemonContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pokemon<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>You&apos;ll want to update the global state by invoking <code>loadPokemon</code> upon load.<br>
Since data fetch is considered a <em>side effect operation</em>, you&apos;ll invoke the<br>
<code>loadPokemon</code> function within a <code>useEffect</code> hook:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">loadPokemon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Note that the hook&apos;s <em>dependency array</em> is empty. If you start your server,<br>
you&apos;ll notice that your application will be stuck in an infinite loop to fetch<br>
pokemon! Think of what conditions you want your <code>loadPokemon</code> function to be<br>
invoked (hint: think of how to use the length of the <code>pokemon</code> array).</p>
<p>Take a moment to test the user login flow. You want to be redirected to view the<br>
<code>PokemonBrowser</code> component. You also want to keep an eye on your backend<br>
database logs. Make sure that you are setting correct variables to optimize the<br>
fetch calls made from the <code>useEffect</code> hook from your <code>PokemonBrowser</code>!</p>
<h3 class="mume-header" id="pokemondetail">PokemonDetail</h3>

<p>Instead of using the <code>match.params.id</code> prop, your <code>PokemonDetail</code> component will<br>
make use of the <a href="https://reacttraining.com/blog/react-router-v5-1/#useparams">useParams</a> hook from <a href="https://reacttraining.com/blog/react-router-v5-1/">React Router v5.1</a>! Begin by using the<br>
<code>useContext</code> hook to give the component access to the context&apos;s <code>singlePokemon</code><br>
and <code>getOnePokemon</code> function.</p>
<p>Note that you can also rename the object keys to prevent the need to refactor<br>
your rendered JSX. In the snippet below, the context&apos;s <code>singlePokemon</code> is<br>
renamed to be <code>pokemon</code>.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> singlePokemon<span class="token punctuation">:</span> pokemon<span class="token punctuation">,</span> getOnePokemon <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>PokemonContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pokemon<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>This way, you won&apos;t need to refactor any of the render code to render the<br>
<code>pokemon</code> in the <code>PokemonContext</code>!</p>
<p>Have your <code>PokemonDetail</code> component update the global state by invoking the<br>
<code>getOnePokemon</code> function with the <code>id</code> from the route parameters upon load.<br>
Import the <a href="https://reacttraining.com/blog/react-router-v5-1/#useparams">useParams</a> hook from the <code>react-router-dom</code> package:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> useParams <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react-router-dom&apos;</span><span class="token punctuation">;</span>
</pre><p>Now you can simply invoke the function and destructure the <code>params</code> object it<br>
receives!</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>You&apos;ll need to use a <code>useEffect</code> hook to fetch a pokemon based on the <code>id</code> from<br>
the route parameters. Just like in your <code>PokemonBrowser</code> component, you need to<br>
determine what variables to place in the dependency array so that your<br>
application is not stuck in an infinite fetch loop!</p>
<p>In your <code>useEffect</code> hook, you&apos;ll need to check two conditions. If the single<br>
<code>pokemon</code> is <em>falsey</em>, have your component invoke the <code>getOnePokemon</code> function<br>
with the <code>id</code> parameter. If the pokemon&apos;s ID is not equal to the route parameter<br>
<code>id</code>, also have your component invoke the <code>getOnePokemon</code> function to fetch a<br>
specific pokemon! Remember that the <code>id</code> from your route parameters is currently<br>
a string, so you&apos;ll need to parse the <code>id</code> in order to make a valid comparison<br>
to the pokemon&apos;s ID.</p>
<p>After you have finished refactoring your state-based React application built<br>
with class components to a context-based React application built with function<br>
components and React Hooks, compare your context-based application to the<br>
redux-based solution. Using Redux instead of Context results in a lot of<br>
boilerplate code in your application. React 16 revamped the Context API and<br>
deemed the <code>useContext</code> hook as a basic hook to improve React&apos;s built-in state<br>
management.</p>
<p>Redux is a large library with a lot of conceptual knowledge involved. In the<br>
next project, you will dive deeper and have more practice with implementing the<br>
Redux library for state management. Although you are free to use either Context<br>
or Redux to manage the application state of your project next week, you can take<br>
today&apos;s bonus project as a chance to dive in deeper and truly learn Redux.<br>
Understanding all the conceptual knowledge behind the library will help you<br>
architect your own React project and plan your application&apos;s state management.</p>
<hr>
<h1 class="mume-header undefined" id="week-15-day-5brwebsockets-and-project-planning">WEEK-15 DAY-5<br><em>WebSockets and Project Planning</em></h1>

<hr>
<hr>
<h1 class="mume-header" id="websockets-learning-objectives">WebSockets Learning Objectives</h1>

<p>WebSockets enable two-way communication between the user&apos;s browser (the client)<br>
and a server. They can be used to enable dynamic, interactive web experiences.<br>
After reading and practicing, you should be able to:</p>
<ul>
<li>Use the WebSockets API to create a new WebSocket connection to a server</li>
<li>Create a WebSocket <code>onopen</code> event handler function to detect when the<br>
connection has been opened</li>
<li>Create a WebSocket <code>onmessage</code> event handler function to detect and process<br>
messages sent by the server</li>
<li>Create a WebSocket <code>onerror</code> event handler function to detect when an error<br>
has occurred</li>
<li>Use the WebSocket <code>send()</code> method to send messages to the server</li>
<li>Recall that WebSocket message data can be sent as JSON formatted string</li>
<li>Recall that WebSocket messages usually have a &quot;type&quot; associated with them so<br>
the client can determine how to process them</li>
<li>Use the WebSocket <code>close()</code> method to close the connection to the server</li>
<li>Create a WebSocket <code>onclose</code> event handler function to detect when the<br>
connection to the server has been closed</li>
<li>Use the <code>ws</code> package to create a standalone WebSocket server</li>
<li>Use the <code>ws</code> package to create a WebSocket server that shares a Node.js <code>http</code><br>
server with an Express application</li>
<li>Create an <code>connection</code> event handler listener method to detect when a client<br>
has connected to the WebSocket server</li>
<li>Create an <code>close</code> event handler listener method to detect when a client has<br>
closed the connection to the WebSocket server</li>
<li>Use the WebSocket <code>send()</code> method to send a message to a client</li>
</ul>
<hr>
<h1 class="mume-header" id="websockets-overview">WebSockets Overview</h1>

<p>Up until now, you&apos;ve seen communication between the Web browser and your backend<br>
server occur in the <em>request/response cycle</em> of HTTP 1.1.</p>
<p><img src="https://github.com/zalmoxisus/redux-devtools-extension#installation" alt="HTTP Exchange"></p>
<p>The <em>Client</em> makes an HTTP request, like <strong>GET /home HTTP/1.1</strong>. The <em>Server</em><br>
receives that request, translates it, and returns an HTTP response, like<br>
<strong>HTTP/1.1 200 OK</strong>. One request, one response. That is great for getting data<br>
and asking the server to create new resources, but it does not support the<br>
demands of Web applications that need &quot;real-time communication&quot; or to receive<br>
messages from the server <em>without</em> an HTTP request. The <a href="https://react-redux.js.org/introduction/quick-start">WebSockets</a> standard<br>
fills that hole. (That&apos;s a link to the RFC. It&apos;s ... dense.)</p>
<p>Check out this <a href="https://github.com/reduxjs/redux-thunk">link to caniuse.com</a> that tracks the support of WebSockets<br>
(and a whole bunch of other things) in browsers for the desktop and mobile. You<br>
can see that <em>everything</em> supports WebSockets (except Opera Mini which fails to<br>
support pretty much anything, stupid Opera Mini).</p>
<p>Since the technology is now well-supported, it makes sense to learn it so that<br>
you can do <em>amazing</em> things in your Web application.</p>
<p>In this article, you will learn about how WebSockets work from the perspectives<br>
of the communication between the client and the server.</p>
<p><strong>Just one thing</strong>: there are <em>lots</em> of libraries out there for you to use that<br>
make this WebSocket thing &quot;easy&quot;. In the same way that this curriculum<br>
challenges you to use <code>fetch</code> rather than some other AJAX library like <code>axios</code>,<br>
learning WebSockets teaches you about the <em>technology</em> and how it works. Once<br>
you know that, then you can use <em>any</em> library (like <a href="http://socket.io">socket.io</a>) to ease your<br>
development. But, giving you the deeper knowledge is what this is providing for<br>
you.</p>
<h2 class="mume-header" id="key-points-about-web-sockets">Key points about Web sockets</h2>

<h3 class="mume-header" id="persistent-connections">Persistent Connections</h3>

<p>In the traditional model of request/response, the client makes a connection to<br>
the server, makes the request, the server responds on the same connection, then<br>
the connection can be closed. The next time your browser wants to make a request<br>
to the Web server, it may need to establish that connection, again.</p>
<p>WebSockets create a <em>persistent connection</em>, one that doesn&apos;t close unless it<br>
doesn&apos;t get used. This means that the TCP/IP handshake that needs to occur<br>
between the browser and server does not need to happen with every single<br>
request. This has two benefits:</p>
<ol>
<li>Your front-end application does not need to establish that connection <em>every<br>
single time</em>. This makes the application feel snappier.</li>
<li>The connection is <em>two-way</em>! While it&apos;s open, the server can send messages to<br>
the client <em>whenever it wants to</em>! That is mind-blowing because HTTP 1.1<br>
cannot support that without jumping through crazy hoops that can cause your<br>
server to crash.</li>
</ol>
<p>The way it happens is an extra HTTP header in the HTTP request. Here&apos;s an<br>
example.</p>
<pre data-role="codeBlock" data-info class="language-"><code>GET ws://WebSocket.example.com/ HTTP/1.1
Origin: http://example.com
Connection: Upgrade
Host: WebSocket.example.com
Upgrade: WebSocket
</code></pre><p>So, checkout two things about this:</p>
<ol>
<li>The protocol is &quot;ws&quot; which, you can probably guess, means &quot;WebSocket&quot;.<br>
(There&apos;s also a &quot;wss&quot; which is like &quot;HTTPS&quot; but for WebSockets Secure.)</li>
<li>The &quot;Connection&quot; header tells the server that the browser is requesting an<br>
upgrade for the normal HTTP 1.1 connection</li>
<li>The &quot;Upgrade&quot; header tells the server that the browser specifically wants<br>
a WebSocket</li>
</ol>
<p>If the server supports WebSockets, it says &quot;COOL!&quot; and returns something like<br>
the following headers in the response.</p>
<pre data-role="codeBlock" data-info class="language-"><code>HTTP/1.1 101 WebSocket Protocol Handshake
Date: Thu, 7 May 2020 17:07:34 GMT
Connection: Upgrade
Upgrade: WebSocket
</code></pre><p>This confirms that the server is good with upgrading the connection. When both<br>
the client and server agree, they just don&apos;t close the connection.</p>
<p>Boom! Persistent!</p>
<h3 class="mume-header" id="messages-not-requests-and-responses">Messages, not requests and responses</h3>

<p>Once the connection exists between the browser and the server, either of the two<br>
can send a <em>message</em> over the connection. It&apos;s a <em>message</em> with a sender and a<br>
receiver. It is <em>not</em> a request/response. There is no request. There is no<br>
response. There are just two actors sending messages back and forth, like two<br>
kids in school passing notes back and forth in class. The server doesn&apos;t have to<br>
wait for a request to send a message. The client can sends a message <em>without</em><br>
the expectation of a response.</p>
<p>Just like in TCP/IP, when data gets chopped up into packets and datagrams,<br>
messages over WebSockets get chopped up into <em>frames</em>. Each frame contains extra<br>
information to help ensure the integrity of the message as it traverses between<br>
sender and recipient. It&apos;s not super important to know what those parts are<br>
because you&apos;re not writing code to implement the standard; instead, the browser<br>
will do it for you automatically, just like using <code>fetch</code> means you don&apos;t have<br>
to format the HTTP request.</p>
<h2 class="mume-header" id="client-side-code">Client-side code</h2>

<p>Just like the browser has the <code>fetch</code> method to easily make HTTP 1.1 requests,<br>
it provides a <code>WebSocket</code> class for you to create objects that manage the<br>
connection between the browser and the server. You just give the constructor the<br>
WebSocket URL that you want your browser to connect to.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// This is EXAMPLE CODE ONLY!</span>
<span class="token comment">// There is no sockets.example.com!</span>
<span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&apos;wss://sockets.example.com&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now, with <code>fetch</code>, that <em>sends</em> a request and, when a response comes back, the<br>
<code>Promise</code> gets fulfilled and you do stuff with it. That&apos;s not how <code>WebSocket</code><br>
objects work. They <em>can&apos;t</em> work that way.</p>
<p>Instead of a <code>Promise</code>, you add event listeners to the <code>WebSocket</code> object in the<br>
same way that you add event listeners to <code>input</code> or <code>button</code> elements to capture<br>
specific kinds of events. For the WebSocket, the events are</p>
<ul>
<li><strong>message</strong> fired when a message fully arrived over the WebSocket from the<br>
server</li>
<li><strong>close</strong> fired when the WebSocket closes for some reason, the status code<br>
being in the &quot;code&quot; property of the event and the reason in the &quot;reason&quot;<br>
property of the event object</li>
<li><strong>error</strong> fired when the WebSocket can&apos;t even connect</li>
<li><strong>open</strong> fired when the WebSocket opens</li>
</ul>
<p>Then, the <code>WebSocket</code> object has two methods for you to use, <code>send</code> to send a<br>
message to the server, and <code>close</code> to close the connection. Here&apos;s what some<br>
code could look like that uses that <code>socket</code> opened above.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// This is EXAMPLE CODE ONLY!</span>

<span class="token comment">// When the socket is open, send a message!</span>
socket<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;open&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&apos;I am LEGENDARY!&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// When you get a message, add it to your state store.</span>
socket<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;message&apos;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">gotMessage</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Print out that something bad happened</span>
socket<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;error&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&apos;Something bad happened... :-(&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// When the socket closes, update the state</span>
<span class="token comment">// of the application!</span>
socket<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;close&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">justDisconnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p><strong>Note</strong>: just like with DOM elements where you could use <code>el.onclick = () =&gt; {...}</code> to add an event handler. You can do something like <code>socket.onmessage = () =&gt; {...}</code>, too. But, that&apos;s just not nice because you can&apos;t add more than one<br>
listener. So, if you see that in the documentation, somewhere, remember that you<br>
can always use <code>addEventListener</code> rather than the <code>on&#xAB;event&#xBB;</code> properties.</p>
<p>All of that is just provided for you in the browser! There&apos;s a lot of code under<br>
all of that to allow your JavaScript that easy-to-use API! Thanks, browser<br>
makers!</p>
<p>You can give it a shot yourself. Create a new HTML 5 file with all of the normal<br>
stuff and add this code in there.</p>
<p>In the body of the document, put this.</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>connect<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Connect<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>send-message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Send<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>disconnect<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Disconnect<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>messages<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</pre><p>Now, create a <code>script</code> element <em>after</em> the content you just added (so you don&apos;t<br>
have to wait for &quot;DOMContentLoaded&quot;). This is just regular-old DOM code with<br>
the socket message stuff in there, too. Have a look and try it out! Change the<br>
code so that you can see how changes affect it!</p>
<p>This code uses a <em>real</em> WebSocket server, wss://echo.websocket.org!</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> connect <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;connect&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> disconnect <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;disconnect&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sendMessage <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;send-message&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> messages <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;messages&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

connect<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;click&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  messages<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&lt;p&gt;Opening WebSocket...&lt;/p&gt;`</span></span><span class="token punctuation">;</span>
  socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;wss://echo.websocket.org/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  socket<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;open&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    messages<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&lt;p&gt;CONNECTED!&lt;/p&gt;`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  socket<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;message&apos;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    messages<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&lt;p&gt;Received &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&lt;/p&gt;`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  socket<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;error&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    messages<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&lt;p&gt;ERROR&lt;/p&gt;`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  socket<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;close&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    messages<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&lt;p&gt;Socket closed&lt;/p&gt;`</span></span><span class="token punctuation">;</span>
    socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

disconnect<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;click&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>socket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    messages<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&lt;p&gt;Socket not open.&lt;/p&gt;`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

sendMessage<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;click&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>socket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    messages<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&lt;p&gt;Socket not open.&lt;/p&gt;`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  messages<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token template-string"><span class="token string">`&lt;p&gt;Sending &quot;WebSockets are cool!&quot;&lt;/p&gt;`</span></span><span class="token punctuation">;</span>
  socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&apos;WebSockets are cool!&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Here&apos;s an interesting thing. After you play around with the code, refresh the<br>
page and connect to the server. Then, just wait. Likely, eventually, the socket<br>
will close due to disuse. Many libraries (like <a href="http://socket.io">socket.io</a>) keep the connection<br>
&quot;warm&quot; by sending little <em>ping</em> methods to the server to let the server know<br>
that it really does want to keep that connection open. If it doesn&apos;t close, then<br>
you have a <em>really</em> good and stable Internet connection!</p>
<h2 class="mume-header" id="server-side-code">Server-side code</h2>

<p>If that&apos;s the client-side code above, the question that might be bothering you<br>
is &quot;How hard is the server-side code?&quot; Well, luckily, it&apos;s just about the same<br>
level of ease with the <a href="https://redux.js.org/faq/code-structure/">ws</a> package for Node.js.</p>
<p>Because WebSockets are a browser-based technology, the implementations that you<br>
will find on the server can vary widely. Luckily, the <strong>ws</strong> API is an<br>
event-driven API, too. It provides these events for you to use to build a<br>
WebSocket server using the <code>Server</code> object.</p>
<ul>
<li>The <strong>connection</strong> event occurs when the HTTP handshake completes but the<br>
connection has <em>not</em> upgraded. It&apos;s callback receives a <code>WebSocket</code> that<br>
allows you to communicate with the client.</li>
<li>The <strong>headers</strong> event which allows you to inspect and modify headers before<br>
they are sent back to the client.</li>
<li>The <strong>listening</strong> event which fires when the underlying server is bound to<br>
a <em>network socket</em>, not a Web socket.</li>
</ul>
<p>Then, the server has a <code>close</code> method which lets it shut down. It&apos;s got some<br>
other methods, too, about handling upgrades and stuff, which are outside the<br>
scope of this article. You are encouraged to go check out the API docs in a<br>
later article.</p>
<p>Those last two are some pretty low-level events that you won&apos;t necessarily have<br>
to pay attention to unless you&apos;re doing some <em>really</em> advanced stuff. However,<br>
you <em>will</em> want to pay attention to the <strong>connection</strong> property because that<br>
is how you know a client is connected. Then, when the connection gets upgraded,<br>
the callback gets a <code>WebSocket</code> object so that your server can send messages to<br>
the browser.</p>
<p>Here&apos;s the code to write an &quot;echo&quot; server like you just used in the client-side<br>
stuff above. Put this in a file, install &quot;ws&quot; using <code>npm install ws</code>, and run it<br>
with <code>node &#xAB;filename&#xBB;</code>. Then, change the URL in the HTML file that you created<br>
from wss://echo.websocket.org/ to ws://localhost:8080. Everything still works!</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> WebSocket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;ws&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">{</span> port<span class="token punctuation">:</span> <span class="token number">8080</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;connection&apos;</span><span class="token punctuation">,</span> <span class="token parameter">webSocket</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;client connecting...&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> interval <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> webSocket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&apos;Hello?&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  webSocket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;message&apos;</span><span class="token punctuation">,</span> <span class="token parameter">message</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;received: %s&apos;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    webSocket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  webSocket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;close&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;Connection closed.&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>You can see that a server gets created using port 8080. That server then waits<br>
for connections with <code>server.on(&apos;connection&apos;, ...)</code>. When the connection occurs,<br>
the callback gets called and <code>webSocket</code> gets set to the actual <code>WebSocket</code><br>
instance that you can use to send (and receive) messages to (and from) the<br>
client. Then, it creates an interval that sends a &quot;Hello?&quot; message to the client<br>
every second or so.</p>
<p>You subscribe to messages using <code>webSocket.on(&apos;message&apos;, ...)</code>. When a message<br>
arrives from the browser, the callback gets called with the content of the data<br>
in the <code>message</code> variable. Normally, that&apos;ll be a JSON-formatted string that you<br>
can use to do things with your code.</p>
<p>Finally, when the <code>WebSocket</code> object closes, it prints a message to the console<br>
and clears that interval.</p>
<p>That&apos;s how nice <strong>ws</strong> makes it to write WebSocket-enabled. Thank you, <strong>ws</strong>!</p>
<p>A really cool thing about <strong>ws</strong> is that it can track clients for you when you<br>
create the <code>Server</code> object by passing in the <a href="https://github.com/erikras/ducks-modular-redux"><code>clientTracking</code> option</a> when<br>
you construct it. Then, the <code>clients</code> property on the <code>Server</code> object will have<br>
all of the clients on it so you can broadcast messages to <em>everyone</em>!</p>
<h2 class="mume-header" id="what-youve-learned-1">What you&apos;ve learned</h2>

<ol>
<li>WebSockets are a persistent connection between the browser and server</li>
<li>It&apos;s a two-way connection, messages can flow in both directions</li>
<li>The &quot;Connection&quot; header is used to request an upgrade. The &quot;Upgrade&quot; header<br>
specifically requests a WebSocket.</li>
<li>Client-side code is an event-driven model with <strong>open</strong>, <strong>close</strong>,<br>
<strong>message</strong>, and <strong>error</strong> events</li>
<li>Server-side code is an event-driven model that waits for <strong>connection</strong><br>
events on a <code>Server</code> object which, then, provides a <code>WebSocket</code> object nearly<br>
identical to the <code>WebSocket</code> used on the client side.</li>
</ol>
<hr>
<h1 class="mume-header" id="websocket-server-applications">WebSocket Server Applications</h1>

<p>Now that you know how to use WebSockets on the client, it&apos;s time to learn how to<br>
use WebSockets on the server. To enable support for WebSockets on the server,<br>
you&apos;ll use the <a href="https://www.npmjs.com/package/ws"><code>ws</code> npm package</a>, a WebSocket server implementation for<br>
use with Node.js applications.</p>
<p>The <code>ws</code> package provides both a <em>server</em> and a <em>client</em> implementation. The<br>
client implementation is only intended for use on Node.js, to enable <em>server</em> to<br>
<em>server</em> WebSocket connections. When reading <a href="https://www.npmjs.com/package/ws">the documentation for the <code>ws</code><br>
package</a>, focus on the following <em>server</em> examples:</p>
<ul>
<li><a href="https://www.npmjs.com/package/ws#simple-server">Simple Server</a></li>
<li><a href="https://www.npmjs.com/package/ws#server-broadcast">Server Broadcast</a></li>
<li><a href="https://github.com/websockets/ws/tree/master/examples/server-stats">Example Application: Server Stats</a></li>
<li><a href="https://github.com/websockets/ws/tree/master/examples/express-session-parse">Example Application: Express Session Parse</a></li>
</ul>
<p>After reading <a href="https://www.npmjs.com/package/ws">the documentation for the <code>ws</code> package</a>, you should be<br>
able to:</p>
<ul>
<li>Use the <code>ws</code> package to create a standalone WebSocket server;</li>
<li>Use the <code>ws</code> package to create a WebSocket server that shares a Node.js <code>http</code><br>
server with an Express application;</li>
<li>Create an <code>connection</code> event handler listener method to detect when a client<br>
has connected to the WebSocket server;</li>
<li>Create an <code>close</code> event handler listener method to detect when a client has<br>
closed the connection to the WebSocket server; and</li>
<li>Use the WebSocket <code>send()</code> method to send a message to a client.</li>
</ul>
<hr>
<h1 class="mume-header" id="websocket-client-applications">WebSocket Client Applications</h1>

<p>WebSockets enable two-way communication between the user&apos;s browser (the client)<br>
and a server. Normally, the server only responds to client requests. When using<br>
WebSockets, once the client has opened a connection with the server, the server<br>
can send messages to the client.</p>
<p>A good place to start learning about Websockets on the Web is with the<br>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_client_applications">Writing WebSocket client applications</a> article on MDN web<br>
docs.</p>
<p>After reading this article, you should be able to:</p>
<ul>
<li>Use the WebSockets API to create a new WebSocket connection to a server;</li>
<li>Create a WebSocket <code>onopen</code> event handler function to detect when the<br>
connection has been opened;</li>
<li>Create a WebSocket <code>onmessage</code> event handler function to detect and process<br>
messages sent by the server;</li>
<li>Create a WebSocket <code>onerror</code> event handler function to detect when an error<br>
has occurred;</li>
<li>Use the WebSocket <code>send()</code> method to send messages to the server;</li>
<li>Recall that WebSocket message data can be sent as JSON formatted string;</li>
<li>Recall that WebSocket messages usually have a &quot;type&quot; associated with them so<br>
the client can determine how to process them;</li>
<li>Use the WebSocket <code>close()</code> method to close the connection to the server; and</li>
<li>Create a WebSocket <code>onclose</code> event handler function to detect when the<br>
connection to the server has been closed.</li>
</ul>
<hr>
<h1 class="mume-header" id="tic-tac-toe-online-project">Tic-Tac-Toe Online Project</h1>

<p>In this project, you&apos;ll get a chance to practice your newly acquired WebSockets<br>
skills by building an interactive game! Earlier, you built a Tic-Tac-Toe game<br>
that could be played locally, within a single browser session. Now you&apos;ll extend<br>
the game to use WebSockets so that it can be played online, across two different<br>
browser sessions. You&apos;ll also convert the client-side code to use React<br>
components.</p>
<h2 class="mume-header" id="phase-0-reviewing-the-application-design-and-architecture">Phase 0: Reviewing the application design and architecture</h2>

<p>Here&apos;s a high level description of the design and architecture of the<br>
application:</p>
<ul>
<li>Node.js and Express will be used to create a simple web application.
<ul>
<li>The server will serve static files from a <code>public</code> directory. In production<br>
the <code>public</code> directory would contain a production build of the React client<br>
application.</li>
</ul>
</li>
<li>The <a href="https://www.npmjs.com/package/ws"><code>ws</code> npm package</a> will be used to create a WebSocket server.
<ul>
<li>The WebSocket server will enable two-way communication between two users as<br>
they play a game of tic-tac-toe.</li>
<li>All game state will live on the server. As players take turns, the game<br>
state will be updated on the server and the WebSocket server will be used to<br>
broadcast state updates to the clients to keep their game boards in sync.</li>
</ul>
</li>
<li>The client application will be built using React web components.
<ul>
<li>Some components will require state, but you&apos;re welcome to use either class<br>
or function components with Hooks.</li>
<li>Global state requirements in the client application will be relatively<br>
simple, so while you could use a Context or Redux to maintain your<br>
application&apos;s state, neither one is really a requirement to use.</li>
</ul>
</li>
<li>Players will be prompted for their &quot;player name&quot; when they first browse to the<br>
web application.
<ul>
<li>To keep things simple, the server will start a new game as soon as two<br>
players have connected to the server.</li>
<li>If a player unexpectedly quits the game (i.e. closes their browser) then the<br>
game will abort for the remaining player.</li>
</ul>
</li>
</ul>
<p>The initial version of this project will be fun and challenging, giving you<br>
ample opportunity to practice your WebSocket skills. There&apos;s also lots of<br>
interesting ways that this project can be extended beyond the initial<br>
requirements.</p>
<p>Ready to get started building your online tic-tac-toe game? <strong>Let&apos;s go!</strong></p>
<h2 class="mume-header" id="phase-1-setting-up-the-client-and-server-projects">Phase 1: Setting up the client and server projects</h2>

<p>This project will actually be split into two projects: a Node.js project for the<br>
Express server application and a Create React App project for the client<br>
application.</p>
<h3 class="mume-header" id="stubbing-out-the-server-project">Stubbing out the server project</h3>

<p>To save you a bit of time, we&apos;ve provided you with a repo of starter files for<br>
the server project. Create a top level folder for your project; name it<br>
something like <code>tic-tac-toe-online</code>. Browse into that folder and clone this<br>
repository:</p>
<p><a href="https://github.com/appacademy-starters/tic-tac-toe-online-starter.git">https://github.com/appacademy-starters/tic-tac-toe-online-starter.git</a></p>
<p>Once the repo has finished cloning, you can browse into the <code>server</code> folder and<br>
install the server project&apos;s dependencies by running the command <code>npm install</code>.<br>
Once the dependencies have finished installing, test the application by running<br>
<code>npm start</code> and browsing to <code>http://localhost:8080/</code>. You should see a very<br>
simple web page displaying the heading &quot;Tic-Tac-Toe Online&quot;.</p>
<p>Take a moment to review the <code>app.js</code> file&apos;s contents:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./app.js</span>

<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;express&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;path&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> createServer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;http&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> morgan <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;morgan&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> port <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;./config&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">morgan</span><span class="token punctuation">(</span><span class="token string">&apos;dev&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token keyword">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&apos;/public&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">&apos;*&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&apos;public&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;index.html&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">createServer</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Listening on http://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>This simple Express application will:</p>
<ul>
<li>Attempt to match incoming requests to static files located in the <code>public</code><br>
folder; and</li>
<li>If a matching static file isn&apos;t found, then the <code>./public/index.html</code> file<br>
will be served for all other requests.</li>
</ul>
<p>In the next section, you&apos;ll use Create React App to create a client project.<br>
Once you&apos;ve built your React client application, you can create and copy the<br>
production build into the <code>public</code> folder. This allows the one Express<br>
application to serve both the client and server parts of the application.</p>
<blockquote>
<p>Remember that configuring Express to serve the <code>./public/index.html</code> file for<br>
any request that doesn&apos;t match a static file, allows you to &quot;deep link&quot; to any<br>
of your React application&apos;s routes (if you use routing in your client<br>
application).</p>
</blockquote>
<p>One thing to note about the above <code>app</code> module, is that the <code>http.createServer</code><br>
method is being used to create the HTTP server instead of calling the <code>listen</code><br>
method on the Express Application (<code>app</code>) object. In a bit, you&apos;ll see how using<br>
this approach will allow you to use the same server for both HTTP and WebSocket<br>
requests.</p>
<h3 class="mume-header" id="stubbing-out-the-client-project">Stubbing out the client project</h3>

<p>After stubbing out the server project, browse back up to the top level project<br>
folder and use Create React App to create your client project:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">npx create-react-app client --template @appacademy/simple
</pre><p>When the command completes, browse into the <code>client</code> and run <code>npm start</code>. The<br>
Create React App development server should start and open your client<br>
application into your default browser. If it doesn&apos;t automatically happen, you<br>
can manually open a browser and browse to <code>http://localhost:3000/</code>. When the<br>
page loads, you should see a heading displaying the text &quot;Hello world!&quot;</p>
<h2 class="mume-header" id="phase-2-stubbing-out-the-react-components">Phase 2: Stubbing out the React components</h2>

<p>The React client application will be relatively simple: it&apos;ll contain just three<br>
components (at least initially):</p>
<ul>
<li>An <code>App</code> component (this is already in your project);</li>
<li>A <code>Home</code> component; and</li>
<li>A <code>Game</code> component.</li>
</ul>
<p>Go ahead and stub out the <code>Home</code> and <code>Game</code> components within a <code>components</code><br>
folder. The <code>Home</code> component will require state so use a class component or a<br>
function component with the <code>useState</code> Hook (we&apos;ll be using Hooks in the<br>
instructions). The <code>Game</code> component doesn&apos;t require any state, so a function<br>
component will work fine.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/Home.js</span>

<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Home<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Home<span class="token punctuation">;</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/Game.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Game</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>Game<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Game<span class="token punctuation">;</span>
</pre><p>Import the <code>useState</code> Hook into the <code>App</code> module and refactor the <code>App</code><br>
component from a function declaration to an arrow function expression. Then<br>
update the <code>App</code> component to import and render the <code>Home</code> and <code>Game</code><br>
components:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/App.js</span>

<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">&apos;./components/Home&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Game <span class="token keyword">from</span> <span class="token string">&apos;./components/Game&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Tic<span class="token operator">-</span>Tac<span class="token operator">-</span>Toe Online<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Home <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Game <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</pre><p>Also notice that application heading was updated to &quot;Tic-Tac-Toe Online&quot;. Do the<br>
same for the title in the <code>./public/index.html</code> file:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Tic-Tac-Toe Online<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</pre><p>Go ahead and run your client application again (<code>npm start</code>) to ensure that the<br>
<code>Home</code> and <code>Game</code> components render as expected. Don&apos;t worry that they&apos;re both<br>
displaying at the same time; we&apos;ll fix that in a bit.</p>
<h2 class="mume-header" id="phase-3-rendering-the-game-board">Phase 3: Rendering the game board</h2>

<p>Before turning our attention to using WebSockets to implement the interaction<br>
between the client and server, let&apos;s update the <code>Game</code> component to render the<br>
game board.</p>
<h3 class="mume-header" id="adding-the-styles">Adding the styles</h3>

<p>To start, add a CSS module file named <code>Game.module.css</code> to the<br>
<code>./src/components</code> folder containing the following:</p>
<pre data-role="codeBlock" data-info="css" class="language-css"><span class="token comment">/* ./src/components/Game.module.css */</span>

<span class="token selector"><span class="token class">.game</span></span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">402</span><span class="token unit">px</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.players</span></span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">400</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">grid-template-columns</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">fr</span> <span class="token number">1</span><span class="token unit">fr</span><span class="token punctuation">;</span>
  <span class="token property">grid-template-rows</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">fr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.tic_tac_toe_board</span></span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">400</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">400</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">grid-template-columns</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">fr</span> <span class="token number">1</span><span class="token unit">fr</span> <span class="token number">1</span><span class="token unit">fr</span><span class="token punctuation">;</span>
  <span class="token property">grid-template-rows</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">fr</span> <span class="token number">1</span><span class="token unit">fr</span> <span class="token number">1</span><span class="token unit">fr</span><span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">32</span><span class="token unit">px</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.actions</span></span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.announcement</span></span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">1.4</span><span class="token unit">em</span><span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.col_1</span></span> <span class="token punctuation">{</span>
  <span class="token property">justify-self</span><span class="token punctuation">:</span> start<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.col_2</span></span> <span class="token punctuation">{</span>
  <span class="token property">justify-self</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.col_3</span></span> <span class="token punctuation">{</span>
  <span class="token property">justify-self</span><span class="token punctuation">:</span> end<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.row_1</span></span> <span class="token punctuation">{</span>
  <span class="token property">align-self</span><span class="token punctuation">:</span> start<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.row_2</span></span> <span class="token punctuation">{</span>
  <span class="token property">align-self</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.row_3</span></span> <span class="token punctuation">{</span>
  <span class="token property">align-self</span><span class="token punctuation">:</span> end<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.spacer</span></span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span><span class="token unit">px</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.square</span></span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">130</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">130</span><span class="token unit">px</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>Then add the following global styles to the <code>index.css</code> file:</p>
<pre data-role="codeBlock" data-info="css" class="language-css"><span class="token comment">/* ./src/index.css */</span>

<span class="token selector">body, button, input</span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> Arial<span class="token punctuation">,</span> Helvetica<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">button, input</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">1.1</span><span class="token unit">em</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="the-initial-game-board">The initial game board</h3>

<p>In the <code>Game</code> component, be sure to import your CSS module file, then update the<br>
<code>render</code> method to this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/Game.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> styles <span class="token keyword">from</span> <span class="token string">&apos;./Game.module.css&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Game</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>game<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>players<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Player <span class="token constant">X</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment">/* TODO Render player 1 name */</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Player <span class="token constant">O</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment">/* TODO Render player 2 name */</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h3 className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>announcement<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token constant">TODO</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>tic_tac_toe_board<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token comment">/* TODO Render game board squares */</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Game<span class="token punctuation">;</span>
</pre><p>Later in the project, once we have the game state available to us, we&apos;ll replace<br>
the <code>TODO</code>s with the player names. We&apos;ll also be able to render some action<br>
buttons below the game board when a game is ended to allow users to play again<br>
or quit.</p>
<h3 class="mume-header" id="rendering-the-game-board-squares">Rendering the game board squares</h3>

<p>For now, let&apos;s turn our attention to rendering the game board squares. In the<br>
original tic-tac-toe project, the game board squares were represented by the<br>
following HTML:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square-0<span class="token punctuation">&apos;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row-1 col-1<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square-1<span class="token punctuation">&apos;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row-1 col-2<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square-2<span class="token punctuation">&apos;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row-1 col-3<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square-3<span class="token punctuation">&apos;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row-2 col-1<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square-4<span class="token punctuation">&apos;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row-2 col-2<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square-5<span class="token punctuation">&apos;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row-2 col-3<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square-6<span class="token punctuation">&apos;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row-3 col-1<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square-7<span class="token punctuation">&apos;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row-3 col-2<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square-8<span class="token punctuation">&apos;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row-3 col-3<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</pre><p>In the original tic-tac-toe project, the element <code>id</code> attribute values were used<br>
to select individual elements in the DOM. We&apos;re using React instead manipulating<br>
the DOM directly, so we won&apos;t need those element <code>id</code> attributes. We&apos;re using<br>
<a href="https://github.com/css-modules/css-modules">CSS Modules</a> for our game board styles, so we need to avoid<br>
hyphens in our CSS class names. We also need to use the <code>className</code> attribute<br>
instead of <code>class</code>. Accounting for all of that, let&apos;s update the <code>TODO</code> comment<br>
for rendering game board squares in the <code>Game</code> component to this:</p>
<pre data-role="codeBlock" data-info="html" class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row_1 col_1<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row_1 col_2<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row_1 col_3<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row_2 col_1<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row_2 col_2<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row_2 col_3<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row_3 col_1<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row_3 col_2<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>square row_3 col_3<span class="token punctuation">&apos;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</pre><p>We need to track when players click on a specific square and determine which<br>
square index (<code>0</code> through <code>8</code>) that they clicked on. To do that, let&apos;s define a<br>
<code>Square</code> function component in your <code>Game.js</code> file for rendering squares:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">Square</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> squareIndex<span class="token punctuation">,</span> row<span class="token punctuation">,</span> col <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> rowStyleName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`row_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>row<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> colStyleName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`col_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>col<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Clicked on square index: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>squareIndex<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div
      onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span>
      className<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">.</span>square<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">[</span>rowStyleName<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">[</span>colStyleName<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token comment">/* TODO Render square &quot;X&quot; or &quot;O&quot; image */</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Notice how the component accepts <code>squareIndex</code>, <code>row</code>, and <code>col</code> props to<br>
determine what index this square represents and to render the correct CSS Module<br>
class names.</p>
<p>Now we can use the <code>Square</code> component in the <code>Game</code> component&apos;s <code>render</code> method.<br>
Replace each <code>&lt;div&gt;</code> with the <code>.square</code> class to be a <code>&lt;Square&gt;</code> component<br>
taking in a <code>squareIndex</code> prop, a <code>row</code> prop, and a <code>col</code> prop. For reference,<br>
here are the entire contents of the <code>./src/components/Game.js</code> file:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token comment">// ./src/components/Game.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> styles <span class="token keyword">from</span> <span class="token string">&apos;./Game.module.css&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Square</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> squareIndex<span class="token punctuation">,</span> row<span class="token punctuation">,</span> col <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> rowStyleName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`row_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>row<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> colStyleName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`col_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>col<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Clicked on square index: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>squareIndex<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div
      onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span>
      className<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">.</span>square<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">[</span>rowStyleName<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">[</span>colStyleName<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token comment">/* TODO Render square &quot;X&quot; or &quot;O&quot; image */</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Game</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>game<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>players<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Player <span class="token constant">X</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment">/* TODO Render player 1 name */</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Player <span class="token constant">O</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment">/* TODO Render player 2 name */</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h3 className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>announcement<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token constant">TODO</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>tic_tac_toe_board<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Game<span class="token punctuation">;</span>
</pre><p>Run your client application again (<code>npm start</code>); this time you should see your<br>
empty tic-tac-toe game board displayed:</p>
<p><img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/websockets/assets/websockets-initial-tic-tac-toe-game-board.png" alt="websockets-initial-tic-tac-toe-game-board"></p>
<h2 class="mume-header" id="phase-4-prompting-users-for-their-player-names">Phase 4: Prompting users for their player names</h2>

<p>Before users start a game of tic-tac-toe, let&apos;s prompt them for their player<br>
name. Requiring each user to have a player name will make it easier for us to<br>
prompt a player to take their turn (i.e. &quot;Select a square {player name}!&quot;).</p>
<h3 class="mume-header" id="setting-up-a-simple-form">Setting up a simple form</h3>

<p>In the <code>Home</code> component, add a new state variable named <code>playerName</code>. We&apos;re<br>
using Hooks, so we&apos;ll call the <code>useState</code> Hook to declare the state variable:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">[</span>playerName<span class="token punctuation">,</span> setPlayerName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now add a simple form, containing a single <code>&lt;input&gt;</code> element and a <code>&lt;button&gt;</code><br>
element, to prompt the user for their player name. Let&apos;s also change the <code>&lt;h2&gt;</code><br>
heading element to &quot;Welcome!&quot; and add a brief welcome message that prompts the<br>
user for their player name:</p>
<pre data-role="codeBlock" data-info="jsx" class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Welcome<span class="token operator">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Please provide your player name and 
    click the <span class="token string">&quot;Play Game&quot;</span> button to start a game<span class="token punctuation">.</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onSubmit<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>text<span class="token punctuation">&apos;</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>playerName<span class="token punctuation">}</span></span>
      <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onChange<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>Play Game<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</pre><p>Notice that the <code>&lt;form&gt;</code> and <code>&lt;input&gt;</code> elements respectively reference<br>
<code>onSubmit</code> and <code>onChange</code> event handler functions. Go ahead and add those event<br>
handler functions. The <code>onSubmit</code> event handler function should prevent the<br>
form&apos;s default submit action and the <code>onChange</code> event handler function should<br>
use the target <code>&lt;input&gt;</code> element&apos;s <code>value</code> to update the <code>playerName</code> state<br>
variable.</p>
<p>At this point, you should be able to enter and remove characters in the<br>
<code>&lt;input&gt;</code> element and click the &quot;Play Game&quot; button, though nothing will occur<br>
(as expected since your <code>onSubmit</code> function simply prevents the form&apos;s default<br>
submit action).</p>
<h3 class="mume-header" id="validating-the-form">Validating the form</h3>

<p>To ensure that the user enters a player name before starting a game, let&apos;s add<br>
validation to our form.</p>
<p>Add another state variable named <code>errors</code> to your <code>Home</code> component with an<br>
initial value of an empty array (i.e. <code>[]</code>):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">[</span>errors<span class="token punctuation">,</span> setErrors<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>In the <code>onSubmit</code> event handler function, declare a variable named <code>errorsToSet</code><br>
set to an empty array. If the <code>playerName</code> state variable is falsy push a<br>
message onto the <code>errorsToSet</code> array containing the text &quot;Please provide a<br>
player name.&quot; Then if the <code>errorsToSet</code> array contains an element, use it to set<br>
the <code>errors</code> state variable by invoking <code>setErrors</code>.</p>
<p>When updating state variables that reference objects and arrays, always prefer<br>
to update the state variables with new objects or arrays instead of modifying or<br>
mutating the existing objects or arrays. For example, instead of pushing an<br>
element onto the <code>errors</code> state variable in the <code>onSubmit</code> event handler<br>
function, we&apos;re creating a new array, pushing an element onto the new array, and<br>
then passing the new array into a call to <code>setErrors</code>.</p>
<p>To render the validation errors, you can create a <code>ValidationErrors</code><br>
subcomponent in your <code>Home.js</code> file like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">ValidationErrors</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> errors <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>errors <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> errors<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Please correct the following errors<span class="token punctuation">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span> errors<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>error<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>error<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>And then add it just above the form passing in the <code>errors</code> state variable:</p>
<pre data-role="codeBlock" data-info="jsx" class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ValidationErrors</span></span> <span class="token attr-name">errors</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>errors<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onSubmit<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&apos;</span>text<span class="token punctuation">&apos;</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>playerName<span class="token punctuation">}</span></span>
    <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onChange<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>Play Game<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</pre><h3 class="mume-header" id="passing-the-player-name-up-to-the-app-component">Passing the player name up to the <code>App</code> component</h3>

<p>Now that the <code>Home</code> component has a form to prompt the user for their player<br>
name, we need a way to pass the player name back up to the <code>App</code> component so<br>
that it can be kept with all of the other global state (that&apos;s yet to be<br>
defined).</p>
<p>In the <code>App</code> component, call the <code>useState</code> Hook to declare a <code>playerName</code> state<br>
variable:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">[</span>playerName<span class="token punctuation">,</span> setPlayerName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Next, declare an <code>updatePlayerName</code> function that accepts a <code>playerName</code><br>
parameter and calls <code>setPlayerName</code> to update the <code>playerName</code> state variable:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">updatePlayerName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">playerName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setPlayerName</span><span class="token punctuation">(</span>playerName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Then pass the <code>updatePlayerName</code> function into the <code>Home</code> component as a prop:</p>
<pre data-role="codeBlock" data-info="jsx" class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Home</span></span> <span class="token attr-name">updatePlayerName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>updatePlayerName<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
</pre><p>Back in the <code>App</code> component, use destructuring to get a reference to the<br>
<code>updatePlayerName</code> prop and call it within the <code>onSubmit</code> event handler<br>
function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> updatePlayerName <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Code removed for brevity.</span>

  <span class="token keyword">const</span> <span class="token function-variable function">onSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> errorsToSet <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>playerName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      errorsToSet<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&apos;Please provide a player name.&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorsToSet<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setErrors</span><span class="token punctuation">(</span>errorsToSet<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">updatePlayerName</span><span class="token punctuation">(</span>playerName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token comment">/* Code removed for brevity. */</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>Lastly, update the <code>App</code> component to render the <code>Game</code> component if there&apos;s a<br>
player name, otherwise render the <code>Home</code> component:</p>
<pre data-role="codeBlock" data-info="jsx" class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Tic<span class="token operator">-</span>Tac<span class="token operator">-</span>Toe Online<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">{</span>playerName <span class="token operator">?</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Game</span></span> <span class="token attr-name">playerName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>playerName<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Home</span></span> <span class="token attr-name">updatePlayerName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>updatePlayerName<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</pre><blockquote>
<p>There are multiple ways to conditionally display elements in JSX. The above<br>
example uses an inline expression. Earlier you saw an example of using a<br>
subcomponent to conditionally displaying validation messages. Feel free to use<br>
the approach that you feel is easiest to write and read.</p>
</blockquote>
<h3 class="mume-header" id="testing">Testing</h3>

<p>Take a moment to test your validation error rendering by submitting an empty<br>
player name. You should see your <code>&apos;Please provide a player name.&apos;</code> error<br>
rendered. Upon a valid form submission to set the <code>playerName</code>, your application<br>
should be rendering the <code>&lt;Game&gt;</code> component instead of <code>&lt;Home&gt;</code>. Test that this<br>
is working before moving forward.</p>
<p>If you test your client application again, you should see the <code>Home</code> component<br>
displayed first, prompting you to enter your player name. Click the &quot;Play Game&quot;<br>
button without entering a player name to test that you receive a validation<br>
error message asking you to enter a player name. Then provide a player name and<br>
click the &quot;Play Game&quot; button. You should now see the <code>Game</code> component being<br>
displayed.</p>
<blockquote>
<p>It&apos;s worth noting that we haven&apos;t done anything to prevent a user from<br>
entering a player name that&apos;s already been provided by another player. For<br>
now, we&apos;ll make a point to enter unique player names when testing so that we<br>
can turn our attention to setting up the client/server interaction using<br>
WebSockets.</p>
</blockquote>
<h2 class="mume-header" id="phase-5-setting-up-websockets">Phase 5: Setting up WebSockets</h2>

<p>Things are moving nicely along! With the player name available, we&apos;re ready to<br>
set up the WebSocket server and update the client to connection to the server<br>
and send a message.</p>
<p>As you set up the server and client to use WebSockets, you&apos;ll notice that the<br>
APIs are very similar. Both the server and the client can send and receive<br>
messages (that&apos;s the &quot;two-way&quot; communication that we&apos;re looking for) and both<br>
fire events when an errors occur or when connections are closed. An important<br>
distinction between the server and the client is that only the server <em>is<br>
listening for new connections</em> and only the client <em>can initiate a new<br>
connection</em>.</p>
<h3 class="mume-header" id="update-the-server">Update the server</h3>

<p>We&apos;ll be using the <code>ws</code> npm package to set up a WebSocket server, so install it<br>
in your server project using npm:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> ws@^7.0.0
</pre><p>In the <code>app</code> module (the <code>app.js</code> file), import the <code>ws</code> module as <code>WebSocket</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> WebSocket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;ws&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Just after the call to the <code>createServer</code> function (i.e. <code>const server = createServer(app);</code>), create a WebSocket server by calling the<br>
<code>WebSocket.Server</code> method with the <code>new</code> keyword:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> wss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">{</span> server <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Notice that we&apos;re passing in the existing HTTP server by setting the <code>server</code><br>
variable as a property on an options object. After creating the WebSocket server<br>
we can listen for connections by listening for <code>connection</code> events:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">wss<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;connection&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ws</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>When a WebSocket connection is established, the callback function will be called<br>
with the WebSocket passed in via the <code>ws</code> parameter. We can then listen for<br>
<code>message</code> and <code>close</code> events on the WebSocket:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">wss<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;connection&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ws</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;message&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">jsonData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;close&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p><code>message</code> events are fired when a message is received from the client while<br>
<code>close</code> events are fired when the WebSocket connection is closed. For now, just<br>
add a <code>TODO</code> comment for the <code>close</code> event handler callback function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;close&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO Cleanup the player that&apos;s associated with this WS.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>In the <code>message</code> event handler callback function, define a parameter named<br>
<code>jsonData</code> and call a function named <code>processIncomingMessage</code> passing in the<br>
<code>jsonData</code> parameter and the enclosed <code>ws</code> parameter (from the <code>connection</code><br>
event handler callback function):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;message&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">jsonData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">processIncomingMessage</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">,</span> ws<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The <code>jsonData</code> parameter is set to the data for the incoming message which will<br>
be formatted as JSON (we&apos;ll see how to do that from the client in just a bit).</p>
<p>Now declare a <code>processIncomingMessage</code> function that logs the <code>jsonData</code> to the<br>
console (to help with testing and debugging) and uses the <code>JSON.parse</code> method to<br>
parse the <code>jsonData</code> to a JavaScript object:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">processIncomingMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">jsonData<span class="token punctuation">,</span> ws</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Processing incoming message </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>jsonData<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>The structure of the WebSocket message is completely up to us to decide. The WS<br>
specification has no opinion about the structure of the message payload. For<br>
this application, on both the client and server, let&apos;s use the following message<br>
structure:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;the-message-type&apos;</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// One or more properties for the message data.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</pre><p>Using the above general message structure, when the client sends a message to<br>
add a new player, the message will look like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;add-new-player&apos;</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    playerName<span class="token punctuation">:</span> <span class="token string">&apos;[the player name]&apos;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</pre><p>After parsing the JSON formatted data to an object, we can switch on the<br>
<code>message.type</code> property to process specific message types:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">processIncomingMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">jsonData<span class="token punctuation">,</span> ws</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Processing incoming message </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>jsonData<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">switch</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&apos;add-new-player&apos;</span><span class="token punctuation">:</span>
      <span class="token function">addNewPlayer</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>data<span class="token punctuation">.</span>playerName<span class="token punctuation">,</span> ws<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Unknown message type: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Notice how we&apos;re throwing an error if the message type is an unexpected or<br>
unknown message type. This will help us when testing and debugging if something<br>
goes wrong with the client message type.</p>
<p>For now, just stub out the <code>addNewPlayer</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addNewPlayer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">playerName<span class="token punctuation">,</span> ws</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO Handle adding the new player.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="updating-the-client">Updating the client</h3>

<p>Before we can test the WebSocket server, we need to update the client to create<br>
a WebSocket connection and send a message to the server.</p>
<p>To start, add an <code>.env</code> file to the root of the <code>client</code> folder with the<br>
following contents:</p>
<pre data-role="codeBlock" data-info class="language-"><code>REACT_APP_WS_URL=ws://localhost:8080
</code></pre><p>Notice that we use <code>ws</code> instead of <code>http</code> to specify the WebSocket URL. The<br>
<code>localhost:8080</code> hostname and port is the Express server that&apos;s hosting the<br>
WebSocket server. Defining an environment variable will make it easier for you<br>
later on to set the WebSocket URL to the correct value for each environment.</p>
<blockquote>
<p>If you were using HTTPS (SSL/TLS) for your HTTP traffic, you&apos;d need to use<br>
<code>wss</code> instead of <code>ws</code> to indicate that you want to make a secure WebSocket<br>
connection. Failing to do that would result in a browser error.</p>
</blockquote>
<p>At the top of the <code>App</code> module, import two additional Hooks, <code>useEffect</code> and<br>
<code>useRef</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;react&apos;</span><span class="token punctuation">;</span>
</pre><p>The <code>useEffect</code> Hook give us a way to add code to function components that will<br>
cause side effects. We&apos;ll put all of the code that&apos;s responsible for creating<br>
and configuring the WebSocket in a <code>useEffect</code> Hook as the WebSocket will cause<br>
side effects as it sends messages to the server.</p>
<p>The <code>useRef</code> Hook gives us a convenient way to store a reference to an object<br>
that will persist for the full lifetime of the component. We&apos;ll use it in just a<br>
bit to store away the WebSocket object so that we can interact with it later on.</p>
<p>Inside of the <code>App</code> component, just after the call to the <code>useState</code> Hook to<br>
declare the <code>playerName</code> state variable, call the <code>useRef</code> Hook to declare a<br>
<code>webSocket</code> variable:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> webSocket <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Then call the <code>useEffect</code> Hook and pass in an arrow function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>By default, the function passed into the <code>useEffect</code> Hook (referred to as the<br>
&quot;effect&quot;) will run after every completed render. We can change the default<br>
behavior by passing in a second argument that&apos;s an array of values that the<br>
effect depends on:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>playerName<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now our effect will only run when the <code>playerName</code> state variable is changed. We<br>
can add an additional optimization by immediately returning from the function if<br>
the <code>playerName</code> variable doesn&apos;t have a value (for our particular use case, it<br>
doesn&apos;t make any sense to create a WebSocket if we don&apos;t have a <code>playerName</code><br>
value):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>playerName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>playerName<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Within the effect, create a new client-side WebSocket object by passing in the<br>
URL of the WebSocket server, represented by the <code>REACT_APP_WS_URL</code> environment<br>
variable. Then set the <code>webSocket</code> ref object&apos;s <code>current</code> property to an object<br>
literal with a <code>ws</code> property for the WebSocket:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>playerName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">REACT_APP_WS_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// TODO Define event listeners.</span>

  webSocket<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token punctuation">{</span>
    ws<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>playerName<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Setting the <code>webSocket</code> ref object&apos;s <code>current</code> property to an object literal<br>
(instead of the WebSocket object directly) gives us a safe, convenient way to<br>
add references to inline helper functions (we&apos;ll write one later in this<br>
project).</p>
<blockquote>
<p>It&apos;s worth noting that updating or changing the <code>webSocket</code> ref object&apos;s<br>
<code>current</code> property won&apos;t cause the component to render. The ref object&apos;s<br>
<code>current</code> property is similar in function to an ES2015 class instance field.</p>
</blockquote>
<p>We can also return a cleanup function from our effect. This function will be<br>
called before the effect is ran so that the previous execution of the effect can<br>
be properly cleaned up. To cleanup our effect, we need to call the <code>close</code><br>
method on the WebSocket object (if it&apos;s available) to close the connection to<br>
the server:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>playerName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">REACT_APP_WS_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// TODO Define event listeners.</span>

  webSocket<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token punctuation">{</span>
    ws<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>webSocket<span class="token punctuation">.</span>current <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      webSocket<span class="token punctuation">.</span>current<span class="token punctuation">.</span>ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>playerName<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The WebSocket object provides four events:</p>
<ul>
<li><code>open</code> - Fires when the connection is opened;</li>
<li><code>message</code> - Fires when a message is received;</li>
<li><code>error</code> - Fires when the connection has been closed because of an error; and</li>
<li><code>close</code> - Fires when the connection is closed.</li>
</ul>
<p>We can listen for these events by assigning an event listener to the following<br>
properties. Replace the <code>TODO</code> comment for defining event listeners to the<br>
WebSocket event listeners below:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>playerName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">REACT_APP_WS_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
  ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
  ws<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
  ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  webSocket<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token punctuation">{</span>
    ws<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>webSocket<span class="token punctuation">.</span>current <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      webSocket<span class="token punctuation">.</span>current<span class="token punctuation">.</span>ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>playerName<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><blockquote>
<p>There are two ways to assign event listeners: using the above properties (i.e.<br>
<code>onopen</code>, <code>onmessage</code>, <code>onerror</code>, or <code>onclose</code>) or using the<br>
<code>addEventListener</code> method and passing in the event name and a callback<br>
function (i.e. <code>ws.addEventListener(&apos;message&apos;, (e) =&gt; console.log(e));</code>).<br>
Either approach is valid; use the one that you or your team prefers.</p>
</blockquote>
<p>When the WebSocket connection is opened, send an <code>add-new-player</code> message to the<br>
server with the <code>playerName</code> value as the message data:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&apos;add-new-player&apos;</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      playerName<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>The message structure for the outgoing message aligns with what we described<br>
earlier when we set up the WebSocket server. Notice how you are manually<br>
structuring the <code>message</code> object to generate the message structure below. Also<br>
notice that the <code>JSON.stringify</code> method is used to format the message as JSON<br>
(as the server is expecting it to be) before passing it to the WebSocket <code>send</code><br>
method.</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;add-new-player&apos;</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    playerName<span class="token punctuation">:</span> <span class="token string">&apos;[the player name]&apos;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="testing-1">Testing</h3>

<p>Start your server by running <code>npm start</code> from a terminal within the <code>server</code><br>
folder then start the client by running <code>npm start</code> within the <code>client</code> folder.<br>
In the client, enter a player name and click the &quot;Play Game&quot; button. In the<br>
server&apos;s terminal window, you should see something similar to the following<br>
output:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Processing incoming message <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token keyword">:</span><span class="token string">&quot;add-new-player&quot;</span>,<span class="token string">&quot;data&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;playerName&quot;</span><span class="token keyword">:</span><span class="token string">&quot;[the player name you entered]&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">..</span>.
</pre><p><strong>Congrats!</strong> You just created a WebSocket server, initiated a WebSocket<br>
connection from a React application, and received the WebSocket message on the<br>
server.</p>
<p>Notice that we don&apos;t have set up CORS to give the client application access to<br>
the WebSocket server that&apos;s running on a different <code>localhost</code> port. WebSocket<br>
connections aren&apos;t restricted to same-origin like HTTP requests are.</p>
<h2 class="mume-header" id="phase-6-starting-a-game">Phase 6: Starting a game</h2>

<p>Once two players have connected to the server using WebSockets, we&apos;re ready to<br>
start a game. To do that, we need define a couple of classes to track player and<br>
game state data on the server.</p>
<h3 class="mume-header" id="tracking-player-and-game-state-data-on-the-server">Tracking player and game state data on the server</h3>

<p>Add a <code>game-state.js</code> file to the root of the server project. Then define two<br>
classes in the module:</p>
<ul>
<li>A <code>Player</code> class to track connected players; and</li>
<li>A <code>Game</code> class to encapsulate the logic and state for a game of tic-tac-toe.</li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Player</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">playerName<span class="token punctuation">,</span> ws</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>playerName <span class="token operator">=</span> playerName<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ws <span class="token operator">=</span> ws<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      playerName<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>playerName<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Game</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">player1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>player1 <span class="token operator">=</span> player1<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>player2 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>player1Symbol <span class="token operator">=</span> <span class="token string">&apos;X&apos;</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>player2Symbol <span class="token operator">=</span> <span class="token string">&apos;O&apos;</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>currentPlayer <span class="token operator">=</span> player1<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>squareValues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>gameOver <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>winner <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>statusMessage <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getPlayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>player1<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>player2<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      player1<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>player1<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      player2<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>player2<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      player1Symbol<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>player1Symbol<span class="token punctuation">,</span>
      player2Symbol<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>player2Symbol<span class="token punctuation">,</span>
      currentPlayer<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currentPlayer<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      squareValues<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>squareValues<span class="token punctuation">,</span>
      gameOver<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gameOver<span class="token punctuation">,</span>
      winner<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>winner <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>winner<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      statusMessage<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>statusMessage<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>Be sure to export both classes from the module:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  Game<span class="token punctuation">,</span>
  Player<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>The <code>Player</code> class is a simple class that&apos;s used to associate a player name with<br>
a WebSocket connection. The <code>getData</code> method is a convenience method that we&apos;ll<br>
call when creating WebSocket messages to get the data for the player.</p>
<p>The <code>Game</code> class encapsulates our game state on the server. When the client app<br>
interacts with the server, the game state on the server will be updated. We&apos;ll<br>
be adding additional methods to this class as we implement functionality in the<br>
game. This class also has a <code>getData</code> method that&apos;ll be used to get the data for<br>
the game when creating WebSocket messages.</p>
<p>Ideally, our player and game state data would be persisted to a database, so<br>
that if/when the server is restarted, the data would not be lost. To keep things<br>
as simple as possible for now, we&apos;ll just store the data in memory.</p>
<h3 class="mume-header" id="sending-the-start-game-message-to-the-client">Sending the <code>start-game</code> message to the client</h3>

<p>Now we can update the <code>addNewPlayer</code> function in the <code>app</code> module to create a<br>
new game when the first player connects and to start the game when the second<br>
player connects.</p>
<p>Import the <code>Game</code> and <code>Player</code> classes into the <code>app</code> module (the <code>app.js</code><br>
file):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> Game<span class="token punctuation">,</span> Player <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;./game-state&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Declare a <code>game</code> variable just after the line of code that creates the WebSocket<br>
server (i.e. <code>const wss = new WebSocket.Server({ server });</code>):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">let</span> game <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</pre><p>This module-level global variable is how we&apos;ll be persisting the game across<br>
WebSocket messages.</p>
<p>Navigate to the <code>addNewPlayer</code> function in the <code>app</code> module and instantiate an<br>
instance of the <code>Player</code> class, passing in the <code>playerName</code> and <code>ws</code> parameters:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addNewPlayer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">playerName<span class="token punctuation">,</span> ws</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> player <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Player</span><span class="token punctuation">(</span>playerName<span class="token punctuation">,</span> ws<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// TODO</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Then add an <code>if</code>/<code>else if</code>/<code>else</code> statement that does the following:</p>
<ul>
<li><code>if</code> the <code>game</code> global variable is <code>null</code>, then instantiate an instance of the<br>
<code>Game</code> class, passing in the new player (who becomes player &quot;1&quot;)</li>
<li><code>else if</code> the game&apos;s <code>player2</code> property is <code>null</code>, then set the game&apos;s<br>
<code>player2</code> property to the instantiated player and call the <code>startGame</code><br>
function (we&apos;ll define that function is just a bit)</li>
<li><code>else</code> log to the console that we&apos;re ignoring a player addition<br>
(<code>`Ignoring player ${playerName}...`</code>) and <code>close()</code> the player&apos;s<br>
WebSocket connection (more about this in a bit)</li>
</ul>
<blockquote>
<p>Ignoring player additions once a game has been started isn&apos;t ideal, but for<br>
now, it&apos;s a stop gap so that we can focus on implementing the game. In the<br>
bonus phases for this project, you&apos;ll get a chance to extend the server to<br>
support multiple concurrent games.</p>
</blockquote>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addNewPlayer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">playerName<span class="token punctuation">,</span> ws</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> player <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Player</span><span class="token punctuation">(</span>playerName<span class="token punctuation">,</span> ws<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>game <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    game <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Game</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>game<span class="token punctuation">.</span>player2 <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    game<span class="token punctuation">.</span>player2 <span class="token operator">=</span> player<span class="token punctuation">;</span>
    <span class="token function">startGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO Ignore any additional player connections.</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Ignoring player </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>playerName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Once the <code>game</code> global variable holds a reference to an instance of the <code>Game</code><br>
class and its <code>player1</code> and <code>player2</code> properties are both set to instances of<br>
the <code>Player</code> class, we can use the players&apos; WebSocket connections to broadcast a<br>
message containing the current game state. To do that, define a function named<br>
<code>startGame</code> that:</p>
<ul>
<li>Calls the Game <code>getData</code> method to get the data for the current game state;</li>
<li>Sets the <code>data.statusMessage</code> property to a message that prompts the current<br>
player to select a square; and</li>
<li>Calls the <code>broadcastMessage</code> function (we&apos;ll define this helper function in<br>
just a bit) to send a <code>start-game</code> message to both players.</li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">startGame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> game<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  data<span class="token punctuation">.</span>statusMessage <span class="token operator">=</span> <span class="token template-string"><span class="token string">`Select a square </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>game<span class="token punctuation">.</span>currentPlayer<span class="token punctuation">.</span>playerName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">;</span>
  <span class="token function">broadcastMessage</span><span class="token punctuation">(</span><span class="token string">&apos;start-game&apos;</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> game<span class="token punctuation">.</span><span class="token function">getPlayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Remember that the structure of the messages that are sent between the client and<br>
the server is completely up to us to define. The structure of the <code>start-game</code><br>
message type will look like this (before it&apos;s formatted as JSON):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;start-game&apos;</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    player1<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      playerName<span class="token punctuation">:</span> <span class="token string">&apos;Bob&apos;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    player2<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      playerName<span class="token punctuation">:</span> <span class="token string">&apos;Sally&apos;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    player1Symbol<span class="token punctuation">:</span> <span class="token string">&apos;X&apos;</span><span class="token punctuation">,</span>
    player2Symbol<span class="token punctuation">:</span> <span class="token string">&apos;O&apos;</span><span class="token punctuation">,</span>
    currentPlayer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      playerName<span class="token punctuation">:</span> <span class="token string">&apos;Bob&apos;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    squareValues<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    gameOver<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    winner<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    statusMessage<span class="token punctuation">:</span> <span class="token string">&apos;Select a square Bob!&apos;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><blockquote>
<p>To see where this data structure is defined, see the Game and Player <code>getData</code><br>
methods. In a bit, we&apos;ll update the React client to use this data to render<br>
the UI for the game.</p>
</blockquote>
<p>All that&apos;s left to do on the server (at least for now), is to define the<br>
<code>broadcastMessage</code> helper function!</p>
<p>The <code>broadcastMessage</code> function accepts a message <code>type</code>, the message <code>data</code>,<br>
and an array of <code>Player</code> class instances. The message <code>type</code> and <code>data</code> are used<br>
to create a simple object literal which in turn is formatted as JSON using the<br>
<code>JSON.stringify</code> method. To assist with testing and debugging, the message JSON<br>
is logged to the console. Then the <code>players</code> array is enumerated using the Array<br>
<code>forEach</code> method.</p>
<p>Remember that each <code>Player</code> class instance holds a reference to the player&apos;s<br>
WebSocket connection via the <code>ws</code> property. The WebSocket connection object<br>
provides a <code>send</code> method that when called, sends a message to the connected<br>
client. The first argument passed into the <code>send</code> method is the message to send<br>
and the second argument is a callback function that&apos;s called if an error occurs<br>
when sending the message. For now, just log any errors to the console.</p>
<p>Your <code>broadcastMessage</code> helper function should look something like this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">broadcastMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> data<span class="token punctuation">,</span> players</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token punctuation">,</span>
    data<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Broadcasting message </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  players<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">player</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    player<span class="token punctuation">.</span>ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO Handle errors.</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="processing-the-start-game-message-on-the-client">Processing the <code>start-game</code> message on the client</h3>

<p>Before we update the <code>App</code> component to handle the processing of <code>start-game</code><br>
messages received from the server, let&apos;s update the <code>Game</code> component to display<br>
a &quot;Waiting for game to start...&quot; message when the <code>Game</code> component initially<br>
loads. The first player to provide their player name and connect to the server<br>
will see this message while they wait for the second player to provide their<br>
player name and connect to the server.</p>
<p>Add another <code>useState</code> Hook to initialize a <code>game</code> state variable to the <code>App</code><br>
component just below the existing <code>useState</code> Hook that initializes the<br>
<code>playerName</code> state variable:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">[</span>game<span class="token punctuation">,</span> setGame<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Then pass the <code>game</code> state variable into the <code>Game</code> component as a prop:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token operator">&lt;</span>Game playerName<span class="token operator">=</span><span class="token punctuation">{</span>playerName<span class="token punctuation">}</span> game<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</pre><p>Update the <code>Game</code> component to destructure the <code>playerName</code> and <code>game</code> props.<br>
Then have your component use a ternary statement to check the truthiness of the<br>
<code>game</code> prop to conditionally display the following &quot;Waiting for game to<br>
start...&quot; message (instead of the game board) if the <code>game</code> prop is falsy:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token operator">&lt;</span>h3 className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>announcement<span class="token punctuation">}</span><span class="token operator">&gt;</span>Waiting <span class="token keyword">for</span> game to start<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
</pre><p>Now let&apos;s update the <code>App</code> component to process the <code>start-game</code> message from<br>
the server! Update the WebSocket <code>onmessage</code> event listener function to:</p>
<ul>
<li>Log the <code>e.data</code> property to the console;</li>
<li>Call the <code>JSON.parse</code> method to parse the JSON formatted message data; and</li>
<li>Switch on the <code>message.type</code> property to handle the <code>start-game</code> message type.</li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript">ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Processing incoming message </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">switch</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&apos;start-game&apos;</span><span class="token punctuation">:</span>
      <span class="token function">setGame</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Unknown message type: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>To process the <code>start-game</code> message and update the <code>game</code> state variable, we<br>
just need to call the <code>setGame</code> method passing in the <code>message.data</code> property.<br>
Updating the <code>game</code> state variable will cause React to re-render the <code>Game</code><br>
component.</p>
<h3 class="mume-header" id="updating-the-game-component-to-render-the-game-state">Updating the <code>Game</code> component to render the game state</h3>

<p>To render the game state, update the <code>Game</code> component&apos;s JSX to use the following<br>
game state properties:</p>
<ul>
<li>The <code>game.player1Symbol</code>, <code>game.player2Symbol</code>, <code>game.player1.playerName</code>, and<br>
<code>game.player2.playerName</code> properties can be used to display the player<br>
information above the game board (replace the <code>Player X: ...</code> and <code>Player O: ...</code> TODO notes).</li>
<li>The <code>&lt;h3&gt;</code> element with a <code>className</code> referencing <code>styles.announcement</code> can be<br>
updated to display the <code>game.statusMessage</code> property as content. The<br>
<code>game.statusMessage</code> property will be used going forward to communicate to the<br>
players the current status of the game.</li>
<li>The <code>game.squareValues</code> array can be used to set a <code>value</code> prop on each<br>
<code>Square</code> subcomponent to render either an &quot;X&quot; or &quot;O&quot; when appropriate:</li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</pre><p>To render the &quot;X&quot; and &quot;O&quot;s in the game board squares, download the following SVG<br>
files:</p>
<ul>
<li><a href="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/websockets/assets/playerX.svg">playerX.svg</a></li>
<li><a href="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/websockets/assets/playerO.svg">playerO.svg</a></li>
</ul>
<p>Then add a new folder named <code>assets</code> to the <code>src</code> folder and copy the SVG files<br>
into new folder.</p>
<p>Back in the <code>Game</code> module, import the SVG files at the top of the module:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">import</span> playerX <span class="token keyword">from</span> <span class="token string">&apos;../assets/playerX.svg&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> playerO <span class="token keyword">from</span> <span class="token string">&apos;../assets/playerO.svg&apos;</span><span class="token punctuation">;</span>
</pre><p>Just above the definition for the <code>Square</code> subcomponent, define a <code>SquareImage</code><br>
subcomponent that&apos;ll render a square&apos;s image using an <code>&lt;img&gt;</code> element:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">SquareImage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> value <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token string">&apos;X&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>playerX<span class="token punctuation">}</span> alt<span class="token operator">=</span><span class="token string">&apos;X&apos;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>playerO<span class="token punctuation">}</span> alt<span class="token operator">=</span><span class="token string">&apos;O&apos;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><blockquote>
<p>Notice that we can simply set the <code>&lt;img&gt;</code> element&apos;s <code>src</code> attribute to the<br>
imported <code>playerX</code> or <code>playerO</code> SVG files. This is possible because of the<br>
front-end build process provided by Create React App. Create React App<br>
configures webpack with support for loading images (as well as CSS, fonts, and<br>
other file types) which allows you to add an image file to your project, import<br>
it directly into a module, and render it in a React component.</p>
</blockquote>
<p>Now we can update the <code>Square</code> subcomponent. Add a <code>value</code> prop and render the<br>
<code>SquareImage</code> component inside of the <code>&lt;div&gt;</code> element:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">Square</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> squareIndex<span class="token punctuation">,</span> value<span class="token punctuation">,</span> row<span class="token punctuation">,</span> col <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> rowStyleName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`row_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>row<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> colStyleName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`col_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>col<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Clicked on square index: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>squareIndex<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div
      onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span>
      className<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">.</span>square<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">[</span>rowStyleName<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>styles<span class="token punctuation">[</span>colStyleName<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>SquareImage value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="handling-closed-connections">Handling closed connections</h3>

<p>Before we test our latest changes, let&apos;s handle closed connections on both the<br>
server and the client. If we don&apos;t handle closed connections, it&apos;d be very easy<br>
for the state to get out of sync between the server and the client.</p>
<p>On the client, handling closed connections is relatively straightforward. Update<br>
the <code>onclose</code> event listener function to log a message that the connection<br>
closed, reset the <code>webSocket</code> ref object, and reset the <code>playerName</code> and <code>game</code><br>
state variables:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Connection closed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  webSocket<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token function">setPlayerName</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setGame</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><blockquote>
<p>Resetting the ref object and state variables will return the user back to the<br>
initial application state which results in the player being prompted again for<br>
their player name. This is essentially throwing up our hands and declaring &quot;images/oh<br>
no... something went wrong... let&apos;s try that again&quot;. Not ideal, but for now,<br>
it&apos;ll allow us to keep our focus on finishing the initial implementation of<br>
the game.</p>
</blockquote>
<p>On the server, update the WebSocket <code>close</code> event handler callback function to<br>
this:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;close&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// If there&apos;s a game available...</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>game <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> player1<span class="token punctuation">,</span> player2 <span class="token punctuation">}</span> <span class="token operator">=</span> game<span class="token punctuation">;</span>

    <span class="token comment">// If the closed WS belonged to either player 1 or player 2</span>
    <span class="token comment">// then we need to abort the game.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>player1<span class="token punctuation">.</span>ws <span class="token operator">===</span> ws <span class="token operator">||</span> <span class="token punctuation">(</span>player2 <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> player2<span class="token punctuation">.</span>ws <span class="token operator">===</span> ws<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// If the closed WS doesn&apos;t belong to player 1</span>
      <span class="token comment">// then close their WS, otherwise if there&apos;s a</span>
      <span class="token comment">// player 2 then close their WS.</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>player1<span class="token punctuation">.</span>ws <span class="token operator">!==</span> ws<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        player1<span class="token punctuation">.</span>ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>player2 <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        player2<span class="token punctuation">.</span>ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      game <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Handling closed connections on the server is a little trickier than it is on the<br>
client. On the server we need to determine if there&apos;s an active game, and if<br>
there is we need to check if the closed connection belonged to either player 1<br>
or player 2 (if player 2 is available).</p>
<h3 class="mume-header" id="testing-2">Testing</h3>

<p>To test the changes to the server and the client, start both the server and the<br>
client. Then, in the browser, provide a player name for the first player. You<br>
should see the message &quot;Waiting for game to start...&quot; displayed in the browser.</p>
<p>In the terminal window where you started the server, you should see the<br>
following message:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Processing incoming message <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token keyword">:</span><span class="token string">&quot;add-new-player&quot;</span>,<span class="token string">&quot;data&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;playerName&quot;</span><span class="token keyword">:</span><span class="token string">&quot;[the player 1 name you entered]&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">..</span>.
</pre><p>Now open a second browser tab and browse to <code>http://localhost:3000</code> and enter a<br>
player name for the second player. This time, you should see the game board<br>
displayed in the browser.</p>
<p><img src="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/topics/websockets/assets/websockets-start-game-tic-tac-toe-game-board.png" alt="websockets-start-game-tic-tac-toe-game-board"></p>
<p>In the server terminal window, you should see the following messages:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Processing incoming message <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token keyword">:</span><span class="token string">&quot;add-new-player&quot;</span>,<span class="token string">&quot;data&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;playerName&quot;</span><span class="token keyword">:</span><span class="token string">&quot;[the player 2 name you entered]&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">..</span>.
Broadcasting message <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token keyword">:</span><span class="token string">&quot;start-game&quot;</span>,<span class="token string">&quot;data&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;player1&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;playerName&quot;</span><span class="token keyword">:</span><span class="token string">&quot;[player 1 name]&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;player2&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;playerName&quot;</span><span class="token keyword">:</span><span class="token string">&quot;[player 2 name]]&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;player1Symbol&quot;</span><span class="token keyword">:</span><span class="token string">&quot;X&quot;</span>,<span class="token string">&quot;player2Symbol&quot;</span><span class="token keyword">:</span><span class="token string">&quot;O&quot;</span>,<span class="token string">&quot;currentPlayer&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;playerName&quot;</span><span class="token keyword">:</span><span class="token string">&quot;[player 1 name]&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;squareValues&quot;</span>:<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span>,<span class="token string">&quot;&quot;</span>,<span class="token string">&quot;&quot;</span>,<span class="token string">&quot;&quot;</span>,<span class="token string">&quot;&quot;</span>,<span class="token string">&quot;&quot;</span>,<span class="token string">&quot;&quot;</span>,<span class="token string">&quot;&quot;</span>,<span class="token string">&quot;&quot;</span><span class="token punctuation">]</span>,<span class="token string">&quot;gameOver&quot;</span>:false,<span class="token string">&quot;winner&quot;</span>:null,<span class="token string">&quot;statusMessage&quot;</span><span class="token keyword">:</span><span class="token string">&quot;Select a square [player 1 name]!&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">..</span>.
</pre><h2 class="mume-header" id="phase-7-supporting-player-turns">Phase 7: Supporting player turns</h2>

<p>With the game started, we can turn our attention towards supporting player<br>
turns, so that they can select squares on the game board! Clicking a game board<br>
square will result in three things happening:</p>
<ul>
<li>The client will handle the game board square click in the <code>Game</code> component and<br>
send a <code>select-game-square</code> message to the server;</li>
<li>The server will receive and process the <code>select-game-square</code> message, check<br>
the status of the game to see if the game has ended, and send an <code>update-game</code><br>
or <code>end-game</code> message back to the client; and</li>
<li>The client will receive the <code>update-game</code> or <code>end-game</code> message and re-render<br>
the <code>Game</code> component with the new game state.</li>
</ul>
<blockquote>
<p>Now that the general WebSocket plumbing is in place to support the two-way<br>
communication between the server and client, the remaining phases in this<br>
project will let you apply what you&apos;ve learned with less guidance.</p>
</blockquote>
<h3 class="mume-header" id="updating-the-client-to-handle-game-board-square-clicks">Updating the client to handle game board square clicks</h3>

<p>Add an additional prop named <code>selectGameSquare</code> to the <code>Game</code> component (we&apos;ll<br>
set this prop from within the <code>App</code> component in just a bit):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">Game</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> playerName<span class="token punctuation">,</span> game<span class="token punctuation">,</span> selectGameSquare <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Code removed for brevity.</span>
<span class="token punctuation">}</span>
</pre><p>To handle game board square clicks, define a function within the <code>Game</code><br>
component named <code>selectSquare</code> that:</p>
<ul>
<li>Accepts a <code>squareIndex</code> parameter;</li>
<li>Immediately returns if the game is over or if the player is not the current<br>
player (see the <code>game.gameOver</code> and <code>game.currentPlayer.playerName</code><br>
properties); and</li>
<li>Calls the <code>selectGameSquare</code> prop and passing in the <code>squareIndex</code> parameter.</li>
</ul>
<p>In the <code>Game</code> components JSX, pass the <code>selectSquare</code> function into each of the<br>
<code>&lt;Square&gt;</code> components using a prop of the same name:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token operator">&lt;</span>Square squareIndex<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">.</span>squareValues<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span> row<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> selectSquare<span class="token operator">=</span><span class="token punctuation">{</span>selectSquare<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">{</span><span class="token comment">/* Other components removed for brevity. */</span><span class="token punctuation">}</span>
</pre><p>In the <code>Square</code> subcomponent, update the prop destructuring to get a reference<br>
to the <code>selectSquare</code> prop. Then call the <code>selectSquare</code> prop from within the<br>
<code>handleClick</code> event handler function passing in the <code>squareIndex</code> prop value.</p>
<p>In the <code>App</code> component, we need to handle the square selection and send a<br>
<code>select-game-square</code> message to the server. Start by defining a function named<br>
<code>selectGameSquare</code> that accepts a <code>squareIndex</code> parameter and sends a<br>
<code>select-game-square</code> message to the server that looks like this (before its<br>
converted to JSON):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;select-game-square&apos;</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    squareIndex<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</pre><p>To see an example of how to send a message to the server, look for where the<br>
<code>ws.send</code> method is being called. To help make it a bit easier to send messages<br>
to the server (and to keep our code DRY), define a helper function named<br>
<code>sendMessage</code> within the effect that creates the WebSocket object. Add a<br>
property to the object literal that&apos;s assigned to the <code>webSocket</code> ref object&apos;s<br>
<code>current</code> property so that you can call it from elsewhere in the component (i.e.<br>
<code>webSocket.current.sendMessage(&apos;select-game-square&apos;, { squareIndex })</code>):</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">sendMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO Create and send the message to the server.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

webSocket<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token punctuation">{</span>
  ws<span class="token punctuation">,</span>
  sendMessage<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>The <code>sendMessage</code> function should accept <code>type</code> and <code>data</code> parameters and<br>
combine them into an object literal to create our self-imposed WebSocket message<br>
structure:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;the-message-type&apos;</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// One or more properties for the message data.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</pre><p>Use the <code>JSON.stringify</code> method to convert the message to JSON, then log the<br>
message to the console (to assist with testing and debugging), and passing the<br>
JSON message into a call to the <code>ws.send</code> method. Now update the <code>onopen</code> event<br>
listener function to make use of the <code>sendMessage</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript">ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token string">&apos;add-new-player&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> playerName <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><blockquote>
<p>Be careful passing the argument for the <code>sendMessage</code> <code>data</code> parameter. Think<br>
about the shape of the <code>data</code> property for each message type. If you get the<br>
message structure wrong, the server will start to throw errors when receiving<br>
messages from the client, so keep an eye out for that.</p>
</blockquote>
<p>To wrap up this part of the updates, add a <code>selectGameSquare</code> prop on the <code>Game</code><br>
component and set it to a reference to the <code>selectGameSquare</code> function:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token operator">&lt;</span>Game playerName<span class="token operator">=</span><span class="token punctuation">{</span>playerName<span class="token punctuation">}</span> game<span class="token operator">=</span><span class="token punctuation">{</span>game<span class="token punctuation">}</span> selectGameSquare<span class="token operator">=</span><span class="token punctuation">{</span>selectGameSquare<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</pre><h3 class="mume-header" id="testing-the-changes-so-far">Testing the changes so far</h3>

<p>Start the client and the server and open an additional browser tab so that you<br>
can enter two player names. In the player 1 browser tab, click a game board<br>
square. In the browser developer tools console you should see output<br>
confirmation that a message was sent to the server:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Sending message <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token keyword">:</span><span class="token string">&quot;select-game-square&quot;</span>,<span class="token string">&quot;data&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;squareIndex&quot;</span>:0<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">..</span>.
</pre><p>In the server terminal window you should see that an &quot;unknown message type&quot;<br>
error has occurred:</p>
<pre data-role="codeBlock" data-info="sh" class="language-bash">Processing incoming message <span class="token punctuation">{</span><span class="token string">&quot;type&quot;</span><span class="token keyword">:</span><span class="token string">&quot;select-game-square&quot;</span>,<span class="token string">&quot;data&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;squareIndex&quot;</span>:0<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>path to top-level project folder<span class="token punctuation">]</span>/solution/server/app.js:75
      throw new Error<span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>Unknown message type: $<span class="token punctuation">{</span>message.type<span class="token punctuation">}</span><span class="token variable">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ^

Error: Unknown message type: select-game-square
    at processIncomingMessage <span class="token punctuation">(</span><span class="token punctuation">[</span>path to top-level project folder<span class="token punctuation">]</span>/solution/server/app.js:75:13<span class="token punctuation">)</span>
    at WebSocket.<span class="token operator">&lt;</span>anonymous<span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>path to top-level project folder<span class="token punctuation">]</span>/solution/server/app.js:81:5<span class="token punctuation">)</span>
    at WebSocket.emit <span class="token punctuation">(</span>events.js:305:20<span class="token punctuation">)</span>
    at Receiver.receiverOnMessage <span class="token punctuation">(</span><span class="token punctuation">[</span>path to top-level project folder<span class="token punctuation">]</span>/solution/server/node_modules/ws/lib/websocket.js:800:20<span class="token punctuation">)</span>
    at Receiver.emit <span class="token punctuation">(</span>events.js:305:20<span class="token punctuation">)</span>
    at Receiver.dataMessage <span class="token punctuation">(</span><span class="token punctuation">[</span>path to top-level project folder<span class="token punctuation">]</span>/solution/server/node_modules/ws/lib/receiver.js:436:14<span class="token punctuation">)</span>
    at Receiver.getData <span class="token punctuation">(</span><span class="token punctuation">[</span>path to top-level project folder<span class="token punctuation">]</span>/solution/server/node_modules/ws/lib/receiver.js:366:17<span class="token punctuation">)</span>
    at Receiver.startLoop <span class="token punctuation">(</span><span class="token punctuation">[</span>path to top-level project folder<span class="token punctuation">]</span>/solution/server/node_modules/ws/lib/receiver.js:142:22<span class="token punctuation">)</span>
    at Receiver._write <span class="token punctuation">(</span><span class="token punctuation">[</span>path to top-level project folder<span class="token punctuation">]</span>/solution/server/node_modules/ws/lib/receiver.js:77:10<span class="token punctuation">)</span>
    at doWrite <span class="token punctuation">(</span>_stream_writable.js:464:12<span class="token punctuation">)</span>
</pre><p>Stop and restart the server and enter your player names again. In the player 2<br>
browser tab, make sure that when you click a game board square a message isn&apos;t<br>
sent to the server. To confirm that a message wasn&apos;t sent, you shouldn&apos;t see any<br>
output in the browser developer tools console and you shouldn&apos;t see any errors<br>
in the server terminal window.</p>
<h3 class="mume-header" id="updating-the-server-to-process-select-game-square-messages">Updating the server to process <code>select-game-square</code> messages</h3>

<p>As the server error indicated while testing, we need to update the server so<br>
that it can process <code>select-game-square</code> messages.</p>
<p>To start, update the <code>processIncomingMessage</code> function by adding a <code>case</code><br>
statement to the <code>message.type</code> switch statement so that it can handle<br>
<code>select-game-square</code> values. Within that <code>case</code> statement, call the<br>
<code>selectGameSquare</code> function passing in the <code>message.data.squareIndex</code> property<br>
and the enclosing function&apos;s <code>ws</code> parameter.</p>
<p>Next, define three new functions: <code>endGame</code> (not a reference to the Avengers<br>
movie), <code>updateGame</code>, and <code>selectGameSquare</code>:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">endGame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">updateGame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">selectGameSquare</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>We&apos;ll implement the <code>endGame</code> and <code>updateGame</code> functions in a bit, so for now,<br>
just add <code>TODO</code> comments in their function bodies as a reminder.</p>
<p>For the <code>selectGameSquare</code> function implementation:</p>
<ul>
<li>Define two parameters, <code>squareIndex</code> and <code>ws</code>;</li>
<li>Call the <code>game.getPlayers</code> method to get the players for the game and use the<br>
<code>ws</code> parameter to determine which player is selecting the square (<em>hint:</em><br>
remember that the <code>Player</code> class contains a property that holds a reference to<br>
the player&apos;s WebSocket connection);</li>
<li>After determining the player that&apos;s taking a turn (i.e. selecting a square),<br>
call a new method on the <code>game</code> object, <code>selectSquare</code>, passing in the player<br>
and the <code>squareIndex</code> parameter;</li>
<li>After selecting the square, call another new method on the <code>game</code> object,<br>
<code>checkGameStatus</code>, to determine if the game has ended (either as a win for a<br>
player or in a draw);</li>
<li>If the game has ended, call the <code>endGame</code> method and set the <code>game</code> variable<br>
to <code>null</code> (setting the <code>game</code> variable to <code>null</code> allows a new game to be<br>
started); and</li>
<li>If the game hasn&apos;t ended, call the <code>updateGame</code> method.</li>
</ul>
<p>In the <code>Game</code> class (located in the <code>game-state</code> module), we have two new<br>
methods to implement: <code>selectSquare</code> and <code>checkGameStatus</code>.</p>
<p>For the <code>selectSquare</code> method implementation:</p>
<ul>
<li>Define two parameters, <code>player</code> and <code>squareIndex</code>;</li>
<li>As a bit of defensive coding, immediately return from the function if the<br>
selected square index value (i.e. <code>this.squareValues[squareIndex]</code>) is not an<br>
empty string (i.e. <code>&apos;&apos;</code> or <code>&quot;&quot;</code>);</li>
<li>Using the <code>this.player1</code> and <code>this.player2</code> properties, determine if the<br>
<code>player</code> parameter represents player &quot;1&quot; or player &quot;2&quot;, then set the selected<br>
square index to that player&apos;s symbol using either the <code>this.player1Symbol</code> or<br>
<code>this.player2Symbol</code> property; and</li>
<li>Now that the selected square index has been set the current player&apos;s symbol,<br>
it&apos;s time to end the current player&apos;s turn by updating the<br>
<code>this.currentPlayer</code> property to reference the other player.</li>
</ul>
<p>For the <code>checkGameStatus</code> method implementation:</p>
<ul>
<li>Use the <code>this.squareValues</code> property, which is an array of the game board&apos;s<br>
square values, to determine if either player has won the game (be sure to<br>
check each row, column, diagonal) or if the game has ended in a draw;
<ul>
<li>There are <em>many</em> ways to iterate over the array of square values to<br>
determine if a player has won the game;</li>
<li>Remember that you built a tic-tac-toe game in an earlier project, so feel<br>
free to reference that project for a solution to this coding problem;</li>
</ul>
</li>
<li>If the game is over (either in a win or draw), set the <code>this.gameOver</code><br>
property to <code>true</code>;</li>
<li>Set the <code>this.winner</code> property to the player that won the game (if the game<br>
ended in a draw, leave the property set to <code>null</code>); and</li>
<li>Optionally return the <code>this.gameOver</code> property value from the function so that<br>
it can be called from within a conditional statement expression.</li>
</ul>
<p>Back in the <code>app</code> module, we can turn our attention back to implementing the<br>
<code>endGame</code> and <code>updateGame</code> functions.</p>
<p>For the <code>endGame</code> function implementation:</p>
<ul>
<li>Call the <code>game.getPlayers</code> method to get an array of the players;</li>
<li>Call the <code>game.getData</code> method to get the game state data;</li>
<li>Set the <code>data.statusMessage</code> property to an appropriate message to indicate<br>
the end of the game (e.g. &quot;Winner: [player name]&quot; or &quot;Winner: Draw!&quot;);
<ul>
<li>Consider adding a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get">class getter function</a> named<br>
<code>gameOverMessage</code> to the <code>Game</code> class that returns a string for the<br>
<code>data.statusMessage</code>; and</li>
</ul>
</li>
<li>Send an <code>end-game</code> message to each of the players by calling the<br>
<code>broadcastMessage</code> function passing in the string literal <code>&apos;end-game&apos;</code>, the<br>
data returned by the <code>game.getData</code> method, and the array of players returned<br>
by the <code>game.getPlayers</code> method.</li>
</ul>
<p>For the <code>updateGame</code> function implementation:</p>
<ul>
<li>Call the <code>game.getPlayers</code> method to get an array of the players;</li>
<li>Call the <code>game.getData</code> method to get the game state data;</li>
<li>Set the <code>data.statusMessage</code> property to an appropriate message to prompt the<br>
next player to take their turn (i.e. &quot;Select a square [current player<br>
name]!&quot;); and</li>
<li>Send an <code>update-game</code> message to each of the players by calling the<br>
<code>broadcastMessage</code> function passing in the string literal <code>&apos;update-game&apos;</code>, the<br>
data returned by the <code>game.getData</code> method, and the array of players returned<br>
by the <code>game.getPlayers</code> method.</li>
</ul>
<p>That&apos;s a lot of coding! Pat yourself on the back; you just completed the server<br>
part of the project!</p>
<h3 class="mume-header" id="updating-the-client-to-process-update-game-and-end-game-messages">Updating the client to process <code>update-game</code> and <code>end-game</code> messages</h3>

<p>Now it&apos;s time to complete the client part of the project by updating it to<br>
process <code>update-game</code> and <code>end-game</code> messages.</p>
<p>In the <code>App</code> component&apos;s effect function that creates the WebSocket object,<br>
update the <code>onmessage</code> event listener function to process <code>update-game</code> and<br>
<code>end-game</code> message types by updating the <code>game</code> state variable. To do this, call<br>
the <code>setGame</code> function and pass in the <code>message.data</code> property.</p>
<p>Updating the <code>game</code> state variable will cause the <code>Game</code> component to re-render.<br>
When it does, we need to display two buttons within the <code>Game</code> if the game has<br>
ended (i.e. the <code>game.gameOver</code> property is set to <code>true</code>):</p>
<ul>
<li>A &quot;Play Again&quot; button that when clicked allows the user to play another game;
<ul>
<li>To play another game, set the <code>game</code> state variable in the <code>App</code> component<br>
to <code>null</code> and call the <code>sendMessage</code> function to send an <code>add-new-player</code><br>
message (be sure to pass the player&apos;s name for the message&apos;s data); and</li>
</ul>
</li>
<li>A &quot;Quit&quot; button that when clicked resets all of the local state in the client;
<ul>
<li>A convenient way to reset all of the local state is to set the <code>playerName</code><br>
state variable to an empty string (i.e. <code>&apos;&apos;</code> or <code>&quot;&quot;</code>). Doing this results in<br>
the effect&apos;s <code>cleanup</code> function being called which will close the WebSocket<br>
connection.</li>
</ul>
</li>
</ul>
<p>For the layout of the buttons, render the following JSX below the game board:</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token punctuation">{</span> game<span class="token punctuation">.</span>gameOver <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>actions<span class="token punctuation">}</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>playAgainClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>Play Again<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>spacer<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>quit<span class="token punctuation">}</span><span class="token operator">&gt;</span>Quit<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="testing-3">Testing</h3>

<p>Everything is in place now to play a complete game of tic-tac-toe! Start the<br>
client and the server and run through (at a minimum) the following testing<br>
scenarios:</p>
<ul>
<li>Test that player 1 can win a game;</li>
<li>Test that player 2 can win a game;</li>
<li>Test that completing any row, column, or diagonal wins the game;</li>
<li>Test that a game can be played to a draw;</li>
<li>Test that you can choose to play again at the conclusion of a game; and</li>
<li>Test that you can quit at the conclusion of a game.</li>
</ul>
<p>Excellent job using WebSockets to create an online version of tic-tac-toe!</p>
<h2 class="mume-header" id="bonus-phases">Bonus Phases</h2>

<p>Now that you&apos;ve built a <em>basic</em> version of the tic-tac-toe game, there are a lot<br>
of ways that you could extend this application.</p>
<h3 class="mume-header" id="adding-redux-or-context">Adding Redux or Context</h3>

<p>The state needs for the React application were relatively simple, so we didn&apos;t<br>
use Redux or Context. But that doesn&apos;t mean that you can&apos;t still add either one<br>
for additional practice.</p>
<h3 class="mume-header" id="support-multiple-concurrent-games">Support multiple concurrent games</h3>

<p>After two players have connected to the server and a game is started, all<br>
subsequent WebSocket connections are ignored (i.e. closed immediately after<br>
they&apos;re opened). Ideally, you&apos;d continue to add new games as players are<br>
connected to the server. To do this, you&apos;ll need a way to track multiple game<br>
instances on the server and to cleanup those instances when a game has been<br>
completed.</p>
<h3 class="mume-header" id="player-name-validation">Player name validation</h3>

<p>Currently, when adding a new player, the player name isn&apos;t validated to ensure<br>
that it&apos;s unique. Ideally, when a user submits a player name that&apos;s already<br>
being used in an active game, the server would return a message to indicate to<br>
the client that the supplied player name is already in use so the user could<br>
provide a different player name.</p>
<h3 class="mume-header" id="connection-health-checks">Connection health checks</h3>

<p>In production, servers can be aggressive about closing inactive WebSocket<br>
connections. In some environments, WebSocket connections might be closed after<br>
only 60 seconds of inactivity. To keep connections alive, you can add ping/pong<br>
health checks to the WebSocket server.</p>
<p>The WebSockets protocol supports the idea of a server sending a &quot;ping&quot; message<br>
to a client, and if the client is still connected, it&apos;ll send a &quot;pong&quot; message<br>
back to the server. For details on how to do this with the <code>ws</code> npm package, see<br>
<a href="https://www.npmjs.com/package/ws#how-to-detect-and-close-broken-connections">this example in the official documentation</a>.</p>
<blockquote>
<p>Technically speaking, there&apos;s no reason why a client couldn&apos;t also send &quot;ping&quot;<br>
messages to the server (instead of waiting for the server to send a &quot;ping&quot;)<br>
but the browser&apos;s WebSocket API doesn&apos;t currently support sending &quot;ping&quot;<br>
messages.</p>
</blockquote>
<h3 class="mume-header" id="adding-a-player-lobby">Adding a player lobby</h3>

<p>Instead of immediately associating new players with games, you could place them<br>
into a player &quot;lobby&quot;. If the server arbitrarily limited the number of active<br>
games to a small number of games (1-3), the server could add the first two<br>
players in line to a game upon the conclusion of one of the active games.<br>
Alternatively, you could allow players in the lobby to challenge another player<br>
in the lobby. There are lots of ways to implement a lobby... have fun with it!</p>
<h3 class="mume-header" id="adding-database-persistence">Adding database persistence</h3>

<p>Instead of keeping player and game state in memory on the server, you could<br>
persist both to a PostgreSQL database. This would allow the server to be<br>
restarted without losing all of the data. You could also implement win/loss/draw<br>
history for each player.</p>
<h3 class="mume-header" id="deploying-to-production">Deploying to production</h3>

<p>Deploying applications into a new environment can often be challenging. As with<br>
most things in life, practice helps, so deploy your Tic-Tac-Toe Online game into<br>
a cloud platform like <a href="https://www.heroku.com/">Heroku</a>.</p>
<hr>
<h1 class="mume-header" id="react-solo-project-expectations">React Solo Project Expectations</h1>

<p>Next week, you get a full week to write a compelling front-end application to go<br>
into your portfolio.</p>
<h2 class="mume-header" id="expectations">Expectations</h2>

<p>The following is the list of expectations that must be met for a project to be<br>
considered complete.</p>
<ol>
<li>Project will be picked from the list of projects from the previous reading or<br>
come up with your own idea.</li>
<li>You should have the following documentation either in the Wiki of your GitHub<br>
repo <em>or</em> in a documentation folder in your root directory:
<ul>
<li>Schema</li>
<li>Feature Document outlining MVP features as well as additional features<br>
(user stories and acceptance criteria <em>strongly</em> encouraged)</li>
</ul>
</li>
<li>A README with instructions on how to launch the application</li>
<li>Your app must have user authentication
<ul>
<li>Sign Up</li>
<li>Login / Logout</li>
<li>Demo User Login</li>
</ul>
</li>
<li>Must have at least one major CRUD feature in addition to user authentication</li>
<li>Front-end:
<ul>
<li>React</li>
<li>Redux</li>
<li>Hooks are optional (but encouraged)</li>
</ul>
</li>
<li>Backend:
<ul>
<li>Express</li>
<li>Sequelize</li>
</ul>
</li>
</ol>
<h2 class="mume-header" id="student-responsibilities">Student Responsibilities</h2>

<ol>
<li>By EOD today, create your project repo, upload your feature list to your repo<br>
and send your project advisor your list of features for sign-off</li>
<li>Join your new &quot;circle&quot; slack which you will be invited to by the end of day.<br>
Your circle consists of all the students that have the same project advisor<br>
as you. You will be having stand up and end of day chats with this circle.</li>
<li>Every day you will attend stand up with your advisor and the other students<br>
in your circle -- be prepared to discuss what you worked on the day before<br>
and have a plan for what you want to accomplish that day.</li>
<li>Complete all nightly reports as per usual and use these reports to reflect on<br>
your progress. We rely on these reports to check in on your progress so<br>
please, as always, take them seriously. Some examples:
<ul>
<li>&quot;I expected to finish the back- and frontend for logging in, but still<br>
need to debug my onSubmit.&quot;</li>
<li>&quot;At the beginning of the day, I was very confused about the Redux cycle,<br>
but going through debugger waterfalls while testing my action creators on<br>
the window really helped.&quot;</li>
<li>&quot;Today I really struggled with destructuring my state. I think the next<br>
time I do a project like this, I will structure my frontend state to use<br>
more slices and less nesting.&quot;</li>
</ul>
</li>
</ol>
<h2 class="mume-header" id="question-asking">Question Asking</h2>

<p>During this project, you will get practice expressing yourself when running into<br>
trouble without just saying &quot;it doesn&apos;t work&quot;. In a professional environment,<br>
knowing when to ask for help and not spending too much time on any one problem<br>
is critical, but making the most out of the time with your manager or Senior<br>
Engineers is also vital.</p>
<p>Questions should be asked in Slack to your entire circle. Before asking a<br>
question, please have the following available:</p>
<ul>
<li>What you are working on</li>
<li>A description of the problem</li>
<li>What the error message says on the server/frontend console (if there is one)</li>
<li>A relevant code snippet</li>
<li>The debugging process you&#x2019;ve done so far (MANDATORY)</li>
</ul>
<p>This process allows your fellow students to also help you out -- further, it<br>
will allow us to know if multiple students are having similar issues and if so<br>
we can have a group session to clarify if necessary.</p>
<hr>
<h1 class="mume-header" id="react-project">React Project</h1>

<p>You&apos;ve spent the last two weeks on a whirlwind tour of React and some of its<br>
most popular features and libraries in its ecosystem. Now, you get to do<br>
something substantial with it while its fresh in your minds.</p>
<p>Next week, you get a full week to write a compelling front-end application to go<br>
into your portfolio. It should be something that you can display to demonstrate<br>
the skills that you&apos;ve picked up over the past two weeks. While you do have to<br>
use React, the rest is up to you, but we recommend that you use Hooks in your<br>
project because those are the latest way that people build things in React and<br>
will be most appealing to people that are looking at your project.</p>
<p>Because this is an individual project, you have full freedom (and ultimately<br>
responsibility) of being able to get something done. If you want to build the<br>
entire fullstack application yourself, that&apos;s great! Just make sure you scope<br>
the amount of work into something that you feel is best for your week&apos;s worth<br>
of time. Use your newly-found knowledge of how long it took you to build your<br>
other project to determine how much you could get done on your own.</p>
<p>If you choose not to build a full-stack project, but just want to spend all of<br>
your time on the front-end, consider building a front-end for <em>any</em> of the<br>
group projects, it doesn&apos;t have to be your own. Or, you can check out<br>
<a href="https://github.com/zalmoxisus/redux-devtools-extension#installation">Programmable Web</a> which lists thousands of APIs that you can use in your<br>
project.</p>
<p>Now that you have an understanding of how Websockets work, use the<br>
<a href="https://appacademy-open-assets.s3-us-west-1.amazonaws.com/Modular-Curriculum/content/react-redux/aggregates/pokedex/redux-based/assets/redux-initial-state-devtools.png">socket.io</a> library on your backend to make Websocket development easy.</p>
<p>Moreover, search for <em>third-party React libraries</em> that you can use to help<br>
speed your development or give your application a polished look. Here are some<br>
suggestions for you to look at as a start:</p>
<ul>
<li><a href="https://redux.js.org/faq/code-structure/">Grommet</a>: A react-based framework that provides accessibility, modularity,<br>
responsiveness, and theming in a tidy package</li>
<li><a href="https://react-redux.js.org/introduction/quick-start">Material UI</a>: A library of components that adhere to the Material design<br>
specifications</li>
<li><a href="https://github.com/reduxjs/redux-thunk">React Bootstrap</a>: A library of React components that wrap Bootstrap</li>
<li><a href="https://github.com/erikras/ducks-modular-redux">Semantic UI React</a>: A development framework that helps create beautiful,<br>
responsive layouts using human-friendly HTML.</li>
</ul>
<p>Those are just starting points. You can look for more by using your favorite<br>
search engine and terms like &quot;react libraries&quot;.</p>
<h2 class="mume-header" id="homework">Homework</h2>

<p>Think about what you&apos;d like to do, poke around <a href="https://github.com/zalmoxisus/redux-devtools-extension#installation">Programmable Web</a>, go back<br>
and look at all of the group projects, look at the list of projects at the end<br>
of this article. Find something that you would like to do. You already have a<br>
strong knowledge of how to build a data API. You have the code to hook in<br>
authentication using JWTs. You can reuse your models and migrations from earlier<br>
projects.</p>
<h2 class="mume-header" id="planning-day">Planning Day</h2>

<p>Put together your proposal. In software development, normally, a week of<br>
planning can give you about three months of work. So, your day of figuring out<br>
what you&apos;d like your app to do should give you a week</p>
<h2 class="mume-header" id="project-ideas">Project ideas</h2>

<p>Here is that list of project suggestions, again, with their different<br>
requirements. Feel free to do one of them, if you think you have time.</p>
<ul>
<li><a href="http://www.airbnb.com">AirBnB</a>
<ul>
<li>Spots</li>
<li>Bookings</li>
<li>Spots search (by location &amp; availability) &amp; Google Maps on search</li>
<li>Reviews</li>
<li><strong>Bonus</strong>: Messaging</li>
<li><strong>Bonus</strong>: User/host profiles</li>
</ul>
</li>
<li><a href="http://www.asana.com">Asana</a>
<ul>
<li>Projects</li>
<li>Tasks</li>
<li>Teams</li>
<li>Profile for each user</li>
<li><strong>Bonus</strong>: Calendar</li>
<li><strong>Bonus</strong>: Comments on tasks</li>
</ul>
</li>
<li><a href="http://www.bandcamp.com">Bandcamp</a>
<ul>
<li>Artist page</li>
<li>Song player</li>
<li>Search</li>
<li>Upload/download songs</li>
<li><strong>Bonus</strong>: Purchase songs</li>
<li><strong>Bonus</strong>: Follows</li>
</ul>
</li>
<li><a href="http://www.basecamp.com">Basecamp</a>
<ul>
<li>To-do Lists</li>
<li>Basecamp Home View</li>
<li>Message Board (post questions and allow comments/answers)</li>
<li>Schedule</li>
<li><strong>Bonus</strong>: Upload Documents &amp; Files</li>
<li><strong>Bonus</strong>: Messaging within a basecamp</li>
</ul>
</li>
<li><a href="http://www.billpin.com">BillPin</a>
<ul>
<li>Friends</li>
<li>Feed with transactions</li>
<li>Owes me/ I owe</li>
<li>Split bill</li>
<li><strong>Bonus</strong>: profile</li>
</ul>
</li>
<li><a href="https://www.brainscape.com">BrainScape</a>
<ul>
<li>Create/Delete Decks</li>
<li>Study Decks</li>
<li>Tags/Categories</li>
<li>Search</li>
<li><strong>Bonus</strong>: Badges (associated with progress)</li>
<li><strong>Bonus</strong>: Animation</li>
</ul>
</li>
<li><a href="http://www.couchsurfing.com">Couchsurfing</a>
<ul>
<li>Spots</li>
<li>Bookings</li>
<li>Spots search (by location &amp; availability) &amp; Google Maps on search</li>
<li>Reviews</li>
<li><strong>Bonus</strong>: Messaging</li>
<li><strong>Bonus</strong>: User/host profiles</li>
</ul>
</li>
<li><a href="https://discordapp.com/">Discord</a>
<ul>
<li>Servers</li>
<li>Channels within servers</li>
<li>Live Chat</li>
<li>Direct Messaging via private servers</li>
</ul>
</li>
<li><a href="http://www.etsy.com">Etsy</a>
<ul>
<li>Product Listings</li>
<li>Shopping Cart</li>
<li>Comments / Reviews</li>
<li>Search</li>
<li><strong>Bonus</strong>: Categories</li>
<li><strong>Bonus</strong>: Favorites</li>
</ul>
</li>
<li><a href="http://www.eventbrite.com">Eventbrite</a>
<ul>
<li>Events</li>
<li>Registration / Tickets</li>
<li>Categories</li>
<li>Bookmark events</li>
<li><strong>Bonus</strong>: Google Maps integration</li>
<li><strong>Bonus</strong>: Search</li>
</ul>
</li>
<li><a href="http://www.evernote.com">Evernote</a>
<ul>
<li>Notes</li>
<li>Notebooks</li>
<li>Tags</li>
<li>Rich-text editing</li>
<li><strong>Bonus</strong>: Reminders</li>
<li><strong>Bonus</strong>: Search</li>
<li><strong>Bonus</strong>: Auto save</li>
</ul>
</li>
<li><a href="http://www.feedly.com">Feedly</a>
<ul>
<li>Feeds</li>
<li>Sources</li>
<li>Articles</li>
<li>Reads</li>
<li><strong>Bonus</strong>: Favorites</li>
<li><strong>Bonus</strong>: Search</li>
</ul>
</li>
<li><a href="http://www.flickr.com">Flickr</a>
<ul>
<li>Photos</li>
<li>Albums</li>
<li>Comments</li>
<li>Tags</li>
<li><strong>Bonus</strong>: Favorites</li>
<li><strong>Bonus</strong>: Follows</li>
</ul>
</li>
<li><a href="http://www.genius.com">Genius</a>
<ul>
<li>Tracks</li>
<li>Annotations</li>
<li>Comments</li>
<li>Upvotes</li>
<li><strong>Bonus</strong>: Tags</li>
<li><strong>Bonus</strong>: Search</li>
</ul>
</li>
<li><a href="http://www.goodreads.com">Goodreads</a>
<ul>
<li>Books</li>
<li>Bookshelves</li>
<li>Reviews</li>
<li>Read Status (will read, have read, etc.)</li>
<li><strong>Bonus</strong>: Search across multiple models</li>
<li><strong>Bonus</strong>: Tags</li>
</ul>
</li>
<li><a href="https://www.hipcamp.com/">HipCamp</a>
<ul>
<li>Spots</li>
<li>Bookings</li>
<li>Spots search (by location &amp; availability) &amp; Google Maps on search</li>
<li>Reviews</li>
<li><strong>Bonus</strong>: Messaging</li>
<li><strong>Bonus</strong>: User/host profiles</li>
</ul>
</li>
<li><a href="https://www.indiegogo.com/">Indiegogo</a>
<ul>
<li>Profiles</li>
<li>Campaigns</li>
<li>Contributions</li>
<li>Rewards</li>
<li><strong>Bonus</strong>: Categories</li>
<li><strong>Bonus</strong>: Follows</li>
</ul>
</li>
<li><a href="http://www.instructables.com/">Instructables</a>
<ul>
<li>Projects</li>
<li>Commenting on projects</li>
<li>Adding photos and videos to projects</li>
<li>Searching projects by keyword</li>
<li><strong>Bonus</strong>: Featured project channels</li>
<li><strong>Bonus</strong>: Categories</li>
</ul>
</li>
<li><a href="http://www.kickstarter.com">Kickstarter</a>
<ul>
<li>Projects</li>
<li>Backing projects &amp; rewards</li>
<li>Search</li>
<li>Categories / Discover feature</li>
<li><strong>Bonus</strong>: Likes</li>
<li><strong>Bonus</strong>: Credit card payments</li>
</ul>
</li>
<li><a href="http://www.medium.com">Medium</a>
<ul>
<li>Stories</li>
<li>Commenting on stories</li>
<li>Follows and feed</li>
<li>Likes</li>
<li><strong>Bonus</strong>: Topics/categories</li>
<li><strong>Bonus</strong>: Bookmarks</li>
</ul>
</li>
<li><a href="http://www.meetup.com">Meetup</a>
<ul>
<li>Groups and joining groups</li>
<li>Events and RSVPs</li>
<li>Calendar (on group page)</li>
<li>Search by location and group info (name, description)</li>
<li><strong>Bonus</strong>: Categories</li>
<li><strong>Bonus</strong>: Calendar (for all groups in search results)</li>
</ul>
</li>
<li><a href="http://www.newsblur.com">Newsblur</a>
<ul>
<li>RSS feeds</li>
<li>Story tagging</li>
<li>Sharing on Blurblog/profile</li>
<li>Full text search of stories</li>
<li><strong>Bonus</strong>: hide or highlight stories</li>
<li><strong>Bonus</strong>: Real-time updating of RSS feeds</li>
</ul>
</li>
<li><a href="http://www.opentable.com/">OpenTable</a>
<ul>
<li>Create and search restaurants</li>
<li>Reservations</li>
<li>Ratings/reviews</li>
<li>Favorites</li>
<li><strong>Bonus</strong>: Discover/explore</li>
<li><strong>Bonus</strong>: points for bookings and usage of site</li>
</ul>
</li>
<li><a href="http://www.pinterest.com">Pinterest</a>
<ul>
<li>Profile</li>
<li>Boards and Pins</li>
<li>Follows</li>
<li>Discover feed on home page</li>
<li><strong>Bonus</strong>: notifications</li>
<li><strong>Bonus</strong>: private boards</li>
<li><strong>Bonus</strong>: likes</li>
</ul>
</li>
<li><a href="http://www.pivotaltracker.com">Pivotal Tracker</a>
<ul>
<li>Projects/Project Page</li>
<li>Stories</li>
<li>Story Workflow</li>
<li>Drag and Drop Prioritization</li>
<li><strong>Bonus</strong>: Iterations</li>
<li><strong>Bonus</strong>: Velocity</li>
</ul>
</li>
<li><a href="http://www.polleverywhere.com">Poll Everywhere</a>
<ul>
<li>Questions</li>
<li>Web URL to take poll</li>
<li>Live-update Poll view</li>
<li>Group/Ungroup Questions</li>
<li><strong>Bonus</strong>: Text to polls</li>
<li><strong>Bonus</strong>: Reports</li>
</ul>
</li>
<li><a href="https://www.producthunt.com/">Product Hunt</a>
<ul>
<li>Products</li>
<li>Profile Page</li>
<li>Product Discussion</li>
<li>Search (Users or Products)</li>
<li><strong>Bonus</strong>: Collections</li>
<li><strong>Bonus</strong>: Upvotes and Tags</li>
</ul>
</li>
<li><a href="http://www.quora.com">Quora</a>
<ul>
<li>Questions</li>
<li>Answers/comments on answers</li>
<li>Search Questions</li>
<li>Topics/Tags</li>
<li><strong>Bonus</strong>: Upvotes, order questions by popularity</li>
<li><strong>Bonus</strong>: Replies to comments</li>
</ul>
</li>
<li><a href="https://www.rememberthemilk.com/">Remember the Milk</a>
<ul>
<li>Tasks</li>
<li>Lists</li>
<li>List summary (time, num tasks, num completed)</li>
<li>Search</li>
<li><strong>Bonus</strong>: Autocomplete SmartAdd of task properties</li>
<li><strong>Bonus</strong>: Subtasks</li>
</ul>
</li>
<li><a href="https://robinhood.com/">Robinhood</a>
<ul>
<li>Dashboard + Portfolio</li>
<li>Asset/Stock Detail</li>
<li>Watchlist</li>
<li>Asset/Stock Search</li>
</ul>
</li>
<li><a href="http://www.slack.com">Slack</a>
<ul>
<li>Live chat</li>
<li>Channels</li>
<li>Direct Message</li>
<li>Teams or multi-person DM</li>
<li><strong>Bonus</strong>: Search Messages</li>
<li><strong>Bonus</strong>: Notifications</li>
</ul>
</li>
<li><a href="http://www.soundcloud.com">Soundcloud</a>
<ul>
<li>Song CRUD</li>
<li>Playing songs with progress bar with continuous play</li>
<li>Comments</li>
<li>User pages</li>
<li><strong>Bonus</strong>: Wave Forms</li>
<li><strong>Bonus</strong>: Playlists</li>
<li><strong>Bonus</strong>: Likes</li>
</ul>
</li>
<li><a href="http://www.splitwise.com">SplitWise</a>
<ul>
<li>Friending</li>
<li>Bills</li>
<li>Transaction History</li>
<li>Comments</li>
<li><strong>Bonus</strong>: Groups</li>
<li><strong>Bonus</strong>: Fake &#x201C;checkout&#x201D;</li>
</ul>
</li>
<li><a href="http://www.stackoverflow.com">Stack Overflow</a>
<ul>
<li>Ask Questions</li>
<li>Answer Questions</li>
<li>Search for Questions</li>
<li>Upvote / Downvote Answer</li>
<li><strong>Bonus</strong>: Question Categories</li>
<li><strong>Bonus</strong>: Comment on Questions / Answers</li>
<li><strong>Bonus</strong>: Polymorphic Up/Down Votes: Questions, Answers, Comments</li>
<li><strong>Bonus</strong>: Code Snippets in Answers</li>
</ul>
</li>
<li><a href="http://www.strava.com">Strava</a>
<ul>
<li>Creating Routes</li>
<li>Saving Workouts</li>
<li>Workout Feed</li>
<li>Workout Stats/Totals</li>
<li><strong>Bonus</strong>: Friends</li>
<li><strong>Bonus</strong>: Workout Comments</li>
<li><strong>Bonus</strong>: Social Feed</li>
</ul>
</li>
<li><a href="http://www.taskrabbit.com">TaskRabbit</a>
<ul>
<li>Choose a task</li>
<li>Provide task details</li>
<li>Select price &amp; confirm</li>
<li>Get assigned a tasker</li>
<li><strong>Bonus</strong>: Become a Tasker</li>
<li><strong>Bonus</strong>: Fake Payment &amp; Billing</li>
</ul>
</li>
<li><a href="http://www.teawithstrangers.com/">TeaWithStrangers</a>
<ul>
<li>Choose City</li>
<li>Host Event</li>
<li>Join Event in your city</li>
<li>Dashboard of joined events/hosted events</li>
<li><strong>Bonus</strong>: Google Map API showing events based on location</li>
<li><strong>Bonus</strong>: Suggestions based on event details and user profiles</li>
</ul>
</li>
<li><a href="http://www.tumblr.com/">Tumblr</a>
<ul>
<li>Posts form for various post types</li>
<li>Feed</li>
<li>Follows</li>
<li>Likes</li>
<li><strong>Bonus</strong>: Reblog</li>
<li><strong>Bonus</strong>: User show page (blog)</li>
</ul>
</li>
<li><a href="https://untappd.com">Untappd</a>
<ul>
<li>Drinks CRUD</li>
<li>Checkins / reviews</li>
<li>Review feed</li>
<li>Profile</li>
<li><strong>Bonus</strong>: Friendships</li>
<li><strong>Bonus</strong>: Search</li>
<li><strong>Bonus</strong>: Venues</li>
<li><strong>Bonus</strong>: Badges</li>
</ul>
</li>
<li><a href="http://www.yammer.com">Yammer</a>
<ul>
<li>News feed</li>
<li>Groups</li>
<li>Profile</li>
<li>Likes</li>
<li><strong>Bonus</strong>: Reply</li>
<li><strong>Bonus</strong>: Inbox (personal messages)</li>
<li><strong>Bonus</strong>: Notifications</li>
</ul>
</li>
<li><a href="http://www.yelp.com">Yelp</a>
<ul>
<li>Business Page</li>
<li>Search / filters</li>
<li>Reviews / ratings</li>
<li>Map</li>
<li><strong>Bonus</strong>: Mark reviews funny, cool, useful etc.</li>
<li><strong>Bonus</strong>: Profile</li>
<li><strong>Bonus</strong>: Friends</li>
</ul>
</li>
<li><a href="http://www.wufoo.com">Wufoo</a>
<ul>
<li>Build Forms</li>
<li>Build various question types</li>
<li>Share Forms</li>
<li>Display Results</li>
<li><strong>Bonus</strong>: Graph results</li>
</ul>
</li>
</ul>

      </div>
      <div class="md-sidebar-toc"><ul>
<li><a href="#redux-learning-objectives-part-1">Redux Learning Objectives: Part 1</a></li>
<li><a href="#redux-explained">Redux Explained</a>
<ul>
<li><a href="#where-did-redux-come-from">Where did Redux come from?</a></li>
<li><a href="#when-is-it-appropriate-to-use-redux">When is it appropriate to use Redux?</a></li>
<li><a href="#vocabulary">Vocabulary</a>
<ul>
<li><a href="#state">State</a></li>
<li><a href="#store">Store</a></li>
<li><a href="#actions">Actions</a></li>
<li><a href="#pure-functions">Pure functions</a></li>
<li><a href="#reducer">Reducer</a></li>
<li><a href="#middleware">Middleware</a></li>
<li><a href="#time-traveling-dev-tools">Time traveling dev tools</a></li>
<li><a href="#thunks">Thunks</a></li>
</ul>
</li>
<li><a href="#what-you-learned">What you learned</a></li>
<li><a href="#see-also">See also...</a></li>
</ul>
</li>
<li><a href="#flux-and-redux">Flux and Redux</a>
<ul>
<li><a href="#what-is-flux">What is Flux?</a>
<ul>
<li><a href="#actions-1">Actions</a></li>
<li><a href="#dispatcher">Dispatcher</a></li>
<li><a href="#store-1">Store</a></li>
<li><a href="#view">View</a></li>
</ul>
</li>
<li><a href="#redux">Redux</a></li>
<li><a href="#what-you-learned-1">What you learned</a></li>
</ul>
</li>
<li><a href="#store-2">Store</a>
<ul>
<li><a href="#creating-the-store">Creating the store</a></li>
<li><a href="#store-api">Store API</a>
<ul>
<li><a href="#store-methods">Store methods</a></li>
</ul>
</li>
<li><a href="#updating-the-store">Updating the store</a></li>
<li><a href="#subscribing-to-the-store">Subscribing to the store</a></li>
<li><a href="#reviewing-a-simple-example">Reviewing a simple example</a></li>
<li><a href="#what-you-learned-2">What you learned</a></li>
<li><a href="#see-also-1">See also...</a></li>
</ul>
</li>
<li><a href="#reducers">Reducers</a>
<ul>
<li><a href="#updating-the-reducer-to-handle-additional-action-types">Updating the reducer to handle additional action types</a>
<ul>
<li><a href="#reviewing-how-arrayslice-works">Reviewing how <code>Array#slice</code> works</a></li>
</ul>
</li>
<li><a href="#avoiding-state-mutations">Avoiding state mutations</a></li>
<li><a href="#what-you-learned-3">What you learned</a></li>
<li><a href="#see-also-2">See also...</a></li>
</ul>
</li>
<li><a href="#actions-2">Actions</a>
<ul>
<li><a href="#using-action-creators">Using action creators</a></li>
<li><a href="#preventing-typos-in-action-type-string-literals">Preventing typos in action type string literals</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example">Reviewing a completed Fruit Stand example</a></li>
<li><a href="#what-you-learned-4">What you learned</a></li>
<li><a href="#see-also-3">See also...</a></li>
</ul>
</li>
<li><a href="#debugging-arrow-functions">Debugging Arrow Functions</a>
<ul>
<li><a href="#understanding-the-limitations-of-implicit-return-values">Understanding the limitations of implicit return values</a></li>
<li><a href="#rewriting-an-arrow-function-to-use-an-explicit-return-statement">Rewriting an arrow function to use an explicit return statement</a></li>
<li><a href="#what-you-learned-5">What you learned</a></li>
</ul>
</li>
<li><a href="#redux-to-do-list-project">Redux To-do List Project</a>
<ul>
<li><a href="#phase-1-create-redux-store-actions-and-reducer">Phase 1: Create Redux store, actions, and reducer</a>
<ul>
<li><a href="#store-3">Store</a></li>
<li><a href="#actions-3">Actions</a></li>
<li><a href="#reducer-1">Reducer</a>
<ul>
<li><a href="#create_task-case-statement"><code>CREATE_TASK</code> case statement</a></li>
<li><a href="#delete_task-case-statement"><code>DELETE_TASK</code> case statement</a></li>
<li><a href="#reset_task_list-case-statement"><code>RESET_TASK_LIST</code> case statement</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#phase-2-testing">Phase 2: Testing</a>
<ul>
<li><a href="#dispatch-the-create_task-action">Dispatch the <code>CREATE_TASK</code> action</a></li>
<li><a href="#dispatch-the-delete_task-action">Dispatch the <code>DELETE_TASK</code> action</a></li>
<li><a href="#dispatch-the-reset_task_list-action">Dispatch the <code>RESET_TASK_LIST</code> action</a></li>
<li><a href="#subscribe-to-redux-store-updates">Subscribe to Redux store updates</a></li>
<li><a href="#debug-to-follow-the-redux-cycle">Debug to follow the Redux cycle</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#redux-learning-objectives-part-2">Redux Learning Objectives: Part 2</a></li>
<li><a href="#using-redux-with-react">Using Redux with React</a>
<ul>
<li><a href="#integrating-redux-into-a-react-application">Integrating Redux into a React application</a></li>
<li><a href="#organizing-your-redux-code">Organizing your Redux code</a>
<ul>
<li><a href="#following-along">Following along</a></li>
<li><a href="#adding-the-actions">Adding the actions</a></li>
<li><a href="#adding-the-reducer">Adding the reducer</a></li>
<li><a href="#adding-the-store">Adding the store</a></li>
</ul>
</li>
<li><a href="#writing-redux-aware-react-components">Writing Redux aware React components</a>
<ul>
<li><a href="#listening-for-state-changes">Listening for state changes</a></li>
<li><a href="#dispatching-actions">Dispatching actions</a></li>
<li><a href="#listening-for-state-changes-and-dispatching-actions">Listening for state changes and dispatching actions</a></li>
<li><a href="#practicing-on-your-own">Practicing on your own</a></li>
</ul>
</li>
<li><a href="#reviewing-a-completed-fruit-stand-example-1">Reviewing a completed Fruit Stand example</a></li>
<li><a href="#what-you-learned-6">What you learned</a></li>
</ul>
</li>
<li><a href="#splitting-and-combining-reducers">Splitting and Combining Reducers</a>
<ul>
<li><a href="#splitting-reducers">Splitting reducers</a></li>
<li><a href="#combining-reducers">Combining reducers</a></li>
<li><a href="#delegating-to-reducers">Delegating to reducers</a>
<ul>
<li><a href="#catching-and-preventing-state-mutation-bugs">Catching and preventing state mutation bugs</a></li>
</ul>
</li>
<li><a href="#destructuring-state-in-your-component">Destructuring State in your component</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example-2">Reviewing a completed Fruit Stand example</a></li>
<li><a href="#what-you-learned-7">What you learned</a></li>
</ul>
</li>
<li><a href="#container-components">Container Components</a>
<ul>
<li><a href="#comparing-presentational-and-container-components">Comparing presentational and container components</a></li>
<li><a href="#determining-where-to-create-containers">Determining where to create containers</a></li>
<li><a href="#writing-a-container-component">Writing a container component</a>
<ul>
<li><a href="#using-a-container-component-to-retrieve-state">Using a container component to retrieve state</a></li>
<li><a href="#using-a-container-component-to-dispatch-actions">Using a container component to dispatch actions</a></li>
<li><a href="#reviewing-the-completed-container-component">Reviewing the completed container component</a></li>
</ul>
</li>
<li><a href="#reviewing-a-completed-fruit-stand-example-3">Reviewing a completed Fruit Stand example</a></li>
<li><a href="#what-you-learned-8">What you learned</a></li>
</ul>
</li>
<li><a href="#freezing-objects">Freezing Objects</a>
<ul>
<li><a href="#using-objectfreeze-to-prevent-state-mutations">Using <code>Object.freeze</code> to prevent state mutations</a>
<ul>
<li><a href="#understanding-the-difference-between-deep-and-shallow-freezes">Understanding the difference between deep and shallow freezes</a></li>
<li><a href="#objectfreeze-and-arrays"><code>Object.freeze</code> and arrays</a></li>
</ul>
</li>
<li><a href="#what-you-learned-9">What you learned</a></li>
</ul>
</li>
<li><a href="#preloaded-state">Preloaded State</a>
<ul>
<li><a href="#creating-a-store-with-preloaded-state">Creating a store with preloaded state</a></li>
<li><a href="#creating-local-storage-helper-functions">Creating local storage helper functions</a></li>
<li><a href="#saving-state-to-local-storage">Saving state to local storage</a></li>
<li><a href="#loading-state-from-local-storage">Loading state from local storage</a></li>
<li><a href="#what-you-learned-10">What you learned</a></li>
</ul>
</li>
<li><a href="#react-and-redux-to-do-list-project">React and Redux To-Do List Project</a>
<ul>
<li><a href="#phase-1-set-up-project-and-redux-store">Phase 1: Set up project and Redux store</a>
<ul>
<li><a href="#local-storage">Local storage</a></li>
<li><a href="#generate-applications-redux-store">Generate application&apos;s Redux store</a></li>
</ul>
</li>
<li><a href="#phase-2-actions-and-reducers">Phase 2: Actions and reducers</a>
<ul>
<li><a href="#define-action-creator-functions">Define action creator functions</a></li>
<li><a href="#define-tasks-reducer-function">Define tasks reducer function</a></li>
</ul>
</li>
<li><a href="#phase-3-dispatch-actions-from-the-devtools-console">Phase 3: Dispatch actions from the DevTools console</a></li>
<li><a href="#phase-4-dispatch-actions-from-components">Phase 4: Dispatch actions from components</a>
<ul>
<li><a href="#todoform">TodoForm</a></li>
<li><a href="#todolist">TodoList</a></li>
<li><a href="#task">Task</a></li>
</ul>
</li>
<li><a href="#phase-5-implement-a-full-redux-cycle">Phase 5: Implement a full Redux cycle</a></li>
</ul>
</li>
<li><a href="#redux-learning-objectives-part-3">Redux Learning Objectives: Part 3</a></li>
<li><a href="#higher-order-components">Higher-Order Components</a>
<ul>
<li><a href="#reviewing-higher-order-functions">Reviewing higher-order functions</a>
<ul>
<li><a href="#using-closures-with-higher-order-functions">Using closures with higher-order functions</a></li>
<li><a href="#defining-higher-order-functions-with-arrow-functions">Defining higher-order functions with arrow functions</a></li>
</ul>
</li>
<li><a href="#leveraging-higher-order-components-hocs">Leveraging higher-order components (HOCs)</a>
<ul>
<li><a href="#protectedroute-and-authroute"><code>ProtectedRoute</code> and <code>AuthRoute</code></a></li>
</ul>
</li>
<li><a href="#using-hocs-to-keep-code-dry">Using HOCs to keep code DRY</a>
<ul>
<li><a href="#react-redux-connect">React-Redux <code>connect</code></a></li>
<li><a href="#writing-a-hoc-for-creating-container-components">Writing a HOC for creating container components</a></li>
<li><a href="#comparing-nested-arrow-functions-to-regular-functions">Comparing nested arrow functions to regular functions</a></li>
<li><a href="#dynamically-setting-component-attributes">Dynamically setting component attributes</a></li>
</ul>
</li>
<li><a href="#reviewing-a-completed-fruit-stand-example-4">Reviewing a completed Fruit Stand example</a></li>
<li><a href="#what-you-learned-11">What you learned</a></li>
</ul>
</li>
<li><a href="#react-redux-provider">React-Redux: <code>&lt;Provider/&gt;</code></a>
<ul>
<li><a href="#understanding-the-advantages-of-the-provider-component">Understanding the advantages of the <code>&lt;Provider /&gt;</code> component</a>
<ul>
<li><a href="#preparing-your-react-application-for-server-side-rendering">Preparing your React application for server-side rendering</a></li>
</ul>
</li>
<li><a href="#adding-provider">Adding <code>&lt;Provider /&gt;</code></a></li>
<li><a href="#understanding-how-provider-relates-to-the-react-context-api">Understanding how <code>&lt;Provider /&gt;</code> relates to the React Context API</a></li>
<li><a href="#what-you-learned-12">What you learned</a></li>
</ul>
</li>
<li><a href="#react-redux-connect-1">React-Redux: <code>connect()</code></a>
<ul>
<li><a href="#calling-connect">Calling <code>connect</code></a></li>
<li><a href="#defining-mapstatetopropsstate-ownprops">Defining <code>mapStateToProps(state, [ownProps])</code></a>
<ul>
<li><a href="#ownprops-optional"><code>ownProps</code> (optional)</a></li>
</ul>
</li>
<li><a href="#defining-mapdispatchtoprops">Defining <code>mapDispatchToProps</code></a></li>
<li><a href="#putting-it-all-together">Putting it all together</a></li>
<li><a href="#reviewing-a-completed-fruit-stand-example-5">Reviewing a completed Fruit Stand example</a></li>
<li><a href="#what-you-learned-13">What you learned</a></li>
</ul>
</li>
<li><a href="#selectors">Selectors</a>
<ul>
<li><a href="#writing-a-selector">Writing a selector</a></li>
<li><a href="#selector-examples">Selector examples</a></li>
<li><a href="#what-you-learned-14">What you learned</a></li>
</ul>
</li>
<li><a href="#middleware-1">Middleware</a>
<ul>
<li><a href="#applying-middleware-to-a-redux-store">Applying middleware to a Redux store</a></li>
<li><a href="#reviewing-the-signature-of-middleware-functions">Reviewing the signature of middleware functions</a></li>
<li><a href="#creating-your-own-logger-middleware">Creating your own <code>logger</code> middleware</a></li>
<li><a href="#installing-and-applying-the-redux-logger-middleware">Installing and applying the <code>redux-logger</code> middleware</a></li>
<li><a href="#what-you-learned-15">What you learned</a></li>
</ul>
</li>
<li><a href="#thunks-1">Thunks</a>
<ul>
<li><a href="#looking-at-how-thunks-work">Looking at how thunks work</a></li>
<li><a href="#reviewing-a-concrete-example">Reviewing a concrete example</a>
<ul>
<li><a href="#adding-configuration-for-the-api-base-url">Adding configuration for the API base URL</a></li>
</ul>
</li>
<li><a href="#reviewing-a-completed-fruit-stand-example-6">Reviewing a completed Fruit Stand example</a>
<ul>
<li><a href="#running-the-api">Running the API</a></li>
<li><a href="#running-the-react-application">Running the React application</a></li>
</ul>
</li>
<li><a href="#what-you-learned-16">What you learned</a></li>
</ul>
</li>
<li><a href="#advanced-containers">Advanced Containers</a>
<ul>
<li><a href="#knowing-when-to-break-the-rules">Knowing when to break the rules</a></li>
<li><a href="#what-you-learned-17">What you learned</a></li>
</ul>
</li>
<li><a href="#redux-developer-tools">Redux Developer Tools</a>
<ul>
<li><a href="#instructions">Instructions</a></li>
<li><a href="#use">Use</a></li>
<li><a href="#resources">Resources</a></li>
</ul>
</li>
<li><a href="#redux-based-pokedex-project">Redux-Based Pokedex Project</a>
<ul>
<li><a href="#getting-started">Getting started</a></li>
<li><a href="#tour-the-application">Tour the application</a></li>
<li><a href="#install-redux-and-devtools">Install Redux and DevTools</a></li>
<li><a href="#setting-up-the-store">Setting up the store</a></li>
<li><a href="#your-first-action-workflow">Your first action workflow</a>
<ul>
<li><a href="#the-thunk">The thunk</a></li>
<li><a href="#the-action">The action</a></li>
</ul>
</li>
<li><a href="#the-reducer">The reducer</a>
<ul>
<li><a href="#adding-the-reducer-to-the-store">Adding the reducer to the store</a></li>
</ul>
</li>
<li><a href="#using-the-token">Using the token</a></li>
</ul>
</li>
<li><a href="#more-state-moving">More State Moving</a>
<ul>
<li><a href="#fixing-the-loop">Fixing the loop</a></li>
<li><a href="#getting-the-list-of-pokemon">Getting the list of Pokemon</a></li>
<li><a href="#clean-up-the-app-component">Clean up the App component</a></li>
<li><a href="#storing-the-token-in-local-storage">Storing the token in local storage</a></li>
<li><a href="#reading-the-token-out-of-local-storage">Reading the token out of local storage</a></li>
</ul>
</li>
<li><a href="#making-decisions-about-state">Making Decisions About State</a></li>
<li><a href="#the-rest-of-it">The Rest Of It</a>
<ul>
<li><a href="#select-the-current-pokemon">Select the current Pokemon</a></li>
<li><a href="#creating-a-new-pokemon">Creating a new Pokemon</a></li>
<li><a href="#bonus-extend-the-functionality">Bonus: Extend the functionality</a></li>
<li><a href="#bonus-connected-react-router">Bonus: Connected React Router</a></li>
</ul>
</li>
<li><a href="#giphy-search-project">Giphy Search Project</a>
<ul>
<li><a href="#phase-0-set-up-the-project">Phase 0: Set up the project</a>
<ul>
<li><a href="#component-overview">Component overview</a></li>
<li><a href="#giphy-api-key">Giphy API key</a></li>
</ul>
</li>
<li><a href="#phase-1-fetch-data-in-the-redux-cycle">Phase 1: Fetch data in the Redux cycle</a>
<ul>
<li><a href="#state-shape">State shape</a></li>
<li><a href="#api-util">API util</a></li>
</ul>
</li>
<li><a href="#phase-2-redux-actions">Phase 2: Redux actions</a>
<ul>
<li><a href="#gifsreducer">gifsReducer</a></li>
<li><a href="#rootreducer">rootReducer</a></li>
</ul>
</li>
<li><a href="#phase-3-the-redux-store">Phase 3: The Redux store</a></li>
<li><a href="#phase-4-thunk-middleware">Phase 4: Thunk middleware</a></li>
<li><a href="#phase-5-test-your-thunk-action-creator">Phase 5: Test your thunk action creator</a></li>
<li><a href="#phase-6-logger-middleware">Phase 6: Logger middleware</a></li>
<li><a href="#phase-7-container-component">Phase 7: Container component</a>
<ul>
<li><a href="#appcontainer">AppContainer</a></li>
</ul>
</li>
<li><a href="#phase-8-presentational-components">Phase 8: Presentational components</a>
<ul>
<li><a href="#app">App</a></li>
<li><a href="#searchbar">SearchBar</a></li>
<li><a href="#gifslist">GifsList</a></li>
<li><a href="#debugging">Debugging</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#hooks-objectives">Hooks Objectives</a></li>
<li><a href="#intro-to-react-hooks">Intro to React Hooks</a>
<ul>
<li><a href="#usestate">useState</a></li>
<li><a href="#useeffect">useEffect</a>
<ul>
<li><a href="#skipping-effects-with-the-dependency-array">Skipping effects with the dependency array</a></li>
<li><a href="#asynchronous-effects">Asynchronous effects</a></li>
<li><a href="#effect-cleanup">Effect cleanup</a></li>
</ul>
</li>
<li><a href="#usecontext">useContext</a></li>
<li><a href="#what-you-have-learned">What you have learned</a></li>
</ul>
</li>
<li><a href="#introduction-to-hooks-in-redux">Introduction to Hooks in Redux</a>
<ul>
<li><a href="#using-hooks-with-redux">Using hooks with Redux</a></li>
<li><a href="#getting-started-1">Getting Started</a></li>
<li><a href="#useselector"><code>useSelector</code></a></li>
<li><a href="#usedispatch"><code>useDispatch</code></a>
<ul>
<li><a href="#option-a-generic-redux-no-thunk">Option A: Generic Redux (no thunk)</a></li>
<li><a href="#option-b-using-redux-thunk">Option B: Using Redux Thunk</a></li>
</ul>
</li>
<li><a href="#refactoring-an-existing-component">Refactoring an existing component</a></li>
<li><a href="#what-you-have-learned-1">What you have learned</a></li>
<li><a href="#additional-resources">Additional resources</a></li>
<li><a href="#starting-point-for-ip-address-project">Starting point for IP address project</a></li>
</ul>
</li>
<li><a href="#react-router-hooks">React Router Hooks</a>
<ul>
<li><a href="#useparams"><code>useParams</code></a></li>
<li><a href="#usehistory"><code>useHistory</code></a></li>
<li><a href="#uselocation"><code>useLocation</code></a></li>
<li><a href="#useroutematch"><code>useRouteMatch</code></a></li>
<li><a href="#bring-it-together">Bring it together</a></li>
<li><a href="#what-youve-learned">What you&apos;ve learned</a></li>
</ul>
</li>
<li><a href="#react-hooks-documentation">React Hooks Documentation</a>
<ul>
<li><a href="#why-hooks">Why hooks?</a></li>
<li><a href="#hook-basics">Hook basics</a></li>
<li><a href="#more-about-hooks">More about hooks</a></li>
</ul>
</li>
<li><a href="#pokedex-hooks-project-phase-1">Pokedex Hooks Project: Phase 1</a>
<ul>
<li><a href="#phase-1-state-based-hooks-application">Phase 1: State-based hooks application</a>
<ul>
<li><a href="#explore-the-reference-application">Explore the reference application</a></li>
<li><a href="#refactor-components">Refactor components</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#pokedex-hooks-project-phase-2">Pokedex Hooks Project: Phase 2</a>
<ul>
<li><a href="#using-redux-hooks-to-manage-application-state">Using Redux hooks to manage application state</a>
<ul>
<li><a href="#version-1-using-redux-hooks-in-a-container-component">Version 1: Using Redux hooks in a container component</a></li>
<li><a href="#version-2-using-redux-hooks-from-within-a-component">Version 2: Using Redux hooks from within a component</a></li>
<li><a href="#router-hooks-useparams">Router hooks: <code>useParams</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#pokedex-hooks-project-phase-3">Pokedex Hooks Project: Phase 3</a>
<ul>
<li><a href="#using-the-usecontext-hook-to-manage-application-state">Using the <code>useContext</code> hook to manage application state</a>
<ul>
<li><a href="#providing-context">Providing context</a></li>
<li><a href="#consuming-context-with-the-usecontext-hook">Consuming context with the useContext hook</a></li>
<li><a href="#static-contexttype">static contextType</a></li>
<li><a href="#usecontext-1">useContext</a></li>
<li><a href="#app-1">App</a></li>
<li><a href="#loginpanel">LoginPanel</a></li>
<li><a href="#pokemonbrowser">PokemonBrowser</a></li>
<li><a href="#pokemondetail">PokemonDetail</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#websockets-learning-objectives">WebSockets Learning Objectives</a></li>
<li><a href="#websockets-overview">WebSockets Overview</a>
<ul>
<li><a href="#key-points-about-web-sockets">Key points about Web sockets</a>
<ul>
<li><a href="#persistent-connections">Persistent Connections</a></li>
<li><a href="#messages-not-requests-and-responses">Messages, not requests and responses</a></li>
</ul>
</li>
<li><a href="#client-side-code">Client-side code</a></li>
<li><a href="#server-side-code">Server-side code</a></li>
<li><a href="#what-youve-learned-1">What you&apos;ve learned</a></li>
</ul>
</li>
<li><a href="#websocket-server-applications">WebSocket Server Applications</a></li>
<li><a href="#websocket-client-applications">WebSocket Client Applications</a></li>
<li><a href="#tic-tac-toe-online-project">Tic-Tac-Toe Online Project</a>
<ul>
<li><a href="#phase-0-reviewing-the-application-design-and-architecture">Phase 0: Reviewing the application design and architecture</a></li>
<li><a href="#phase-1-setting-up-the-client-and-server-projects">Phase 1: Setting up the client and server projects</a>
<ul>
<li><a href="#stubbing-out-the-server-project">Stubbing out the server project</a></li>
<li><a href="#stubbing-out-the-client-project">Stubbing out the client project</a></li>
</ul>
</li>
<li><a href="#phase-2-stubbing-out-the-react-components">Phase 2: Stubbing out the React components</a></li>
<li><a href="#phase-3-rendering-the-game-board">Phase 3: Rendering the game board</a>
<ul>
<li><a href="#adding-the-styles">Adding the styles</a></li>
<li><a href="#the-initial-game-board">The initial game board</a></li>
<li><a href="#rendering-the-game-board-squares">Rendering the game board squares</a></li>
</ul>
</li>
<li><a href="#phase-4-prompting-users-for-their-player-names">Phase 4: Prompting users for their player names</a>
<ul>
<li><a href="#setting-up-a-simple-form">Setting up a simple form</a></li>
<li><a href="#validating-the-form">Validating the form</a></li>
<li><a href="#passing-the-player-name-up-to-the-app-component">Passing the player name up to the <code>App</code> component</a></li>
<li><a href="#testing">Testing</a></li>
</ul>
</li>
<li><a href="#phase-5-setting-up-websockets">Phase 5: Setting up WebSockets</a>
<ul>
<li><a href="#update-the-server">Update the server</a></li>
<li><a href="#updating-the-client">Updating the client</a></li>
<li><a href="#testing-1">Testing</a></li>
</ul>
</li>
<li><a href="#phase-6-starting-a-game">Phase 6: Starting a game</a>
<ul>
<li><a href="#tracking-player-and-game-state-data-on-the-server">Tracking player and game state data on the server</a></li>
<li><a href="#sending-the-start-game-message-to-the-client">Sending the <code>start-game</code> message to the client</a></li>
<li><a href="#processing-the-start-game-message-on-the-client">Processing the <code>start-game</code> message on the client</a></li>
<li><a href="#updating-the-game-component-to-render-the-game-state">Updating the <code>Game</code> component to render the game state</a></li>
<li><a href="#handling-closed-connections">Handling closed connections</a></li>
<li><a href="#testing-2">Testing</a></li>
</ul>
</li>
<li><a href="#phase-7-supporting-player-turns">Phase 7: Supporting player turns</a>
<ul>
<li><a href="#updating-the-client-to-handle-game-board-square-clicks">Updating the client to handle game board square clicks</a></li>
<li><a href="#testing-the-changes-so-far">Testing the changes so far</a></li>
<li><a href="#updating-the-server-to-process-select-game-square-messages">Updating the server to process <code>select-game-square</code> messages</a></li>
<li><a href="#updating-the-client-to-process-update-game-and-end-game-messages">Updating the client to process <code>update-game</code> and <code>end-game</code> messages</a></li>
<li><a href="#testing-3">Testing</a></li>
</ul>
</li>
<li><a href="#bonus-phases">Bonus Phases</a>
<ul>
<li><a href="#adding-redux-or-context">Adding Redux or Context</a></li>
<li><a href="#support-multiple-concurrent-games">Support multiple concurrent games</a></li>
<li><a href="#player-name-validation">Player name validation</a></li>
<li><a href="#connection-health-checks">Connection health checks</a></li>
<li><a href="#adding-a-player-lobby">Adding a player lobby</a></li>
<li><a href="#adding-database-persistence">Adding database persistence</a></li>
<li><a href="#deploying-to-production">Deploying to production</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#react-solo-project-expectations">React Solo Project Expectations</a>
<ul>
<li><a href="#expectations">Expectations</a></li>
<li><a href="#student-responsibilities">Student Responsibilities</a></li>
<li><a href="#question-asking">Question Asking</a></li>
</ul>
</li>
<li><a href="#react-project">React Project</a>
<ul>
<li><a href="#homework">Homework</a></li>
<li><a href="#planning-day">Planning Day</a></li>
<li><a href="#project-ideas">Project ideas</a></li>
</ul>
</li>
</ul>
</div>
      <a id="sidebar-toc-btn">&#x2261;</a>
    
    
    
    
    
    
    
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>