<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
<link rel="stylesheet" href="./prism.css">
<script async defer src="./prism.js"></script>
</head>
<body>;
<h1 id="week-6-promises-testing-and-http" data-ignore="true">WEEK 6<br><em>Promises, Testing, and HTTP</em></h1>
<hr />
<!-- code_chunk_output -->
<p><a href="#http-learning-objectives"><strong>HTTP Learning Objectives</strong></a> - <a href="#http-basics">HTTP Basics</a> - <a href="#first-some-context">First, some context</a> - <a href="#breaking-it-down">Breaking it down…</a> - <a href="#and-bringing-it-back-together">…and bringing it back together</a> - <a href="#properties-of-http">Properties of HTTP</a> - <a href="#digging-deeper-with-the-http-spec">Digging deeper with the HTTP spec</a> - <a href="#http-requests">HTTP Requests</a> - <a href="#retrieving-hypertext">Retrieving hypertext</a> - <a href="#structure-of-an-http-request">Structure of an HTTP request</a> - <a href="#sending-an-http-request-from-the-command-line">Sending an HTTP request from the command line</a> - <a href="#http-responses">HTTP Responses</a> - <a href="#hypertext-delivered">Hypertext delivered</a> - <a href="#structure-of-a-response">Structure of a Response</a> - <a href="#using-a-custom-server-to-generate-responses">Using a custom server to generate responses</a> - <a href="#http-project-from-zero-to-server">HTTP Project: From Zero To Server</a> - <a href="#phase-1-proof-of-concept">Phase 1: Proof of concept</a> - <a href="#phase-2-status-code-all-the-things">Phase 2: Status code all the things!</a> - <a href="#phase-3-confirming-functionality">Phase 3: Confirming functionality</a> - <a href="#phase-3a-a-command-line-client">Phase 3a: A command line client</a> - <a href="#phase-3b-double-check-your-work">Phase 3b: Double-check your work</a> - <a href="#bonus-phase-take-it-up-a-notch">Bonus phase: Take it up a notch</a></p>
<p><a href="#promises-learning-objectives-i"><strong>Promises Learning Objectives I</strong></a> - <a href="#a-promise-is-a-promise-a-mostly-complete-guide-to-javascript-promises-i">A Promise is a Promise: A Mostly Complete Guide to JavaScript Promises I</a> - <a href="#a-quick-review-of-function-declarations">A quick review of function declarations</a> - <a href="#the-looming-problem-of-asynchronous-code-with-callbacks">The looming problem of asynchronous code with callbacks</a> - <a href="#designing-a-better-solution">Designing a better solution</a> - <a href="#so-what-is-a-promise">So, what is a "Promise"?</a> - <a href="#a-promise-is-a-promise-a-mostly-complete-guide-to-javascript-promises-ii">A Promise is a Promise: A Mostly Complete Guide to JavaScript Promises II</a> - <a href="#handling-success-with-then">Handling success with <code>then</code></a> - <a href="#chaining-thens">Chaining <code>then</code>s.</a> - <a href="#handling-failure-with-then">Handling failure with <code>then</code></a> - <a href="#handling-failure-with-catch">Handling failure with <code>catch</code></a> - <a href="#using-promiseall-for-many-future-values">Using <code>Promise.all</code> for many future values</a> - <a href="#flattening-promises">Flattening <code>Promises</code></a> - <a href="#putting-it-all-together">Putting it all together</a> - <a href="#creating-your-own-promises">Creating your own <code>Promise</code>s</a> - <a href="#see-also">See also</a> - <a href="#a-promise-is-a-promise-a-mostly-complete-guide-to-javascript-promises-ii-1">A Promise is a Promise: A Mostly Complete Guide to JavaScript Promises II</a> - <a href="#handling-success-with-then-1">Handling success with <code>then</code></a> - <a href="#chaining-thens-1">Chaining <code>then</code>s.</a> - <a href="#handling-failure-with-then-1">Handling failure with <code>then</code></a> - <a href="#handling-failure-with-catch-1">Handling failure with <code>catch</code></a> - <a href="#using-promiseall-for-many-future-values-1">Using <code>Promise.all</code> for many future values</a> - <a href="#flattening-promises-1">Flattening <code>Promises</code></a> - <a href="#putting-it-all-together-1">Putting it all together</a> - <a href="#creating-your-own-promises-1">Creating your own <code>Promise</code>s</a> - <a href="#see-also-1">See also</a> - <a href="#project-curl-up-with-a-nice-promise">Project: Curl Up With A Nice Promise</a> - <a href="#getting-started">Getting started</a> - <a href="#step-1-just-getting-a-url">Step 1: Just getting a URL</a> - <a href="#step-2-command-line-arguments">Step 2: Command-line arguments</a> - <a href="#step-3-now-put-it-in-a-file">Step 3: Now, put it in a file</a> - <a href="#bonus-a-setting-an-arbitrary-header">Bonus A: Setting an arbitrary header</a> - <a href="#bonus-b-capturing-response-headers">Bonus B: Capturing response headers</a> - <a href="#bonus-c-sending-data">Bonus C: Sending data</a> - <a href="#bonus-d-multiple-files-multiple-output-destinations">Bonus D: Multiple files, multiple output destinations</a> - <a href="#bonus-e-list-globbing">Bonus E: List globbing</a> - <a href="#nightmare-round-a-the-progress-meter">Nightmare round A: The progress meter</a> - <a href="#nightmare-round-b-progress-meter-for-multiple-files">Nightmare round B: Progress meter for multiple files</a></p>
<p><a href="#promises-learning-objectives-ii"><strong>Promises Learning Objectives II</strong></a> <a href="#html-learning-objectives"><strong>HTML Learning Objectives</strong></a> - <a href="#modern-promises-with-async-and-await">Modern <code>Promise</code>s With <code>async</code> And <code>await</code></a> - <a href="#classic-promise-example">Classic promise example</a> - <a href="#async-function-declarations"><code>async</code> function declarations</a> - <a href="#awaiting-a-promise"><code>await</code>ing a promise</a> - <a href="#refactoring-a-promise-chain">Refactoring a promise chain</a> - <a href="#error-handling">Error handling</a> - <a href="#the-basics-of-html">The Basics of HTML</a> - <a href="#the-three-components-of-html">The three components of HTML</a> - <a href="#whitespace-tags-attributes-and-content">Whitespace, tags, attributes, and content</a> - <a href="#walk-through-building-a-web-page">Walk-Through Building A Web Page</a> - <a href="#creating-the-basic-html5-structure">Creating the basic HTML5 structure</a> - <a href="#add-a-style-sheet-to-your-html-document">Add a style sheet to your HTML document</a> - <a href="#creating-some-lists">Creating some lists</a> - <a href="#now-youre-going-places">Now, you’re going places!</a> - <a href="#wait-sections">Wait. Sections!</a> - <a href="#add-an-image">Add an image</a> - <a href="#adding-tabular-data">Adding tabular data</a> - <a href="#other-content-section-tags">Other content section tags</a> - <a href="#forms">Forms</a> - <a href="#project-trivia-game-three-ways">Project: Trivia Game Three Ways</a> - <a href="#create-the-html-and-css">Create the HTML and CSS</a> - <a href="#using-a-callback">Using a callback</a> - <a href="#using-a-promise-object-with-fetch">Using a Promise object with fetch</a> - <a href="#using-async-and-await">Using async and await</a> - <a href="#make-it-a-game">Make it a game</a> - <a href="#bonus-round-make-a-progressively-enhanced-application">Bonus round: make a progressively enhanced application</a> - <a href="#nightmare-round-mark-clues-as-invalid">Nightmare round: mark clues as invalid</a> - <a href="#nightmare-round-create-new-clues">Nightmare round: create new clues</a> - <a href="#code-samples">Code samples</a></p>
<p><a href="#testing-learning-objectives"><strong>Testing Learning Objectives</strong></a> - <a href="#all-about-testing">All About Testing!</a> - <a href="#why-do-we-test">Why do we test?</a> - <a href="#how-we-test">How we Test</a> - <a href="#what-do-we-test">What do we test?</a> - <a href="#reading-tests">Reading Tests</a> - <a href="#test-driven-development">Test-Driven Development</a> - <a href="#motivations-for-tdd">Motivations for TDD</a> - <a href="#the-three-steps-of-tdd-red-green-refactor">The three steps of TDD: red, green, refactor!</a> - <a href="#a-comedy-of-errors-in-javascript">A Comedy of Errors in JavaScript</a> - <a href="#javascript-errors">JavaScript Errors</a> - <a href="#types-of-javascript-errors">Types of JavaScript errors</a> - <a href="#practice-writing-tests">Practice: Writing Tests</a> - <a href="#part-zero-testing-file-structure">Part Zero: Testing file structure</a> - <a href="#part-one-writing-tests-with-mocha-and-assert">Part One: Writing tests with Mocha and Assert</a> - <a href="#part-two-testing-errors">Part Two: Testing errors</a> - <a href="#part-three-testing-classes-using-mocha-and-chai">Part Three: Testing classes using Mocha and Chai</a> - <a href="#part-four-mocha-hooks-and-chai-spies">Part Four: Mocha Hooks and Chai Spies</a> - <a href="#towers-of-hanoi-project-reading-and-passing-tests">Towers of Hanoi Project: Reading and Passing Tests</a> - <a href="#test-driven-development-project">Test-Driven Development Project</a> - <a href="#phase-0-testing-the-reversestring-function">Phase 0: Testing the reverseString function</a> - <a href="#phase-1-testing-multiple-functions">Phase 1: Testing multiple functions</a> - <a href="#phase-2-testing-the-mymap-function">Phase 2: Testing the myMap Function</a> - <a href="#phase-3-testing-classes">Phase 3: Testing Classes</a> - <a href="#well-tested-full-stack-to-do-items">Well-Tested Full-Stack To-Do Items Project</a> - <a href="#create-and-serve-the-category-screen">Create And Serve the Category Screen</a> - <a href="#save-submitted-category-information">Save Submitted Category Information</a> - <a href="#create-and-serve-a-to-do-item-form">Create And Serve A To-Do Item Form</a> - <a href="#save-and-show-to-do-items">Save And Show To-Do Items</a> - <a href="#show-and-complete-a-to-do-item">Show And Complete A To-Do Item</a> - <a href="#search-for-to-do-items">Search For To-Do Items</a> - <a href="#refactor-to-use-a-template-engine">Refactor To Use A Template Engine</a></p>
<!-- /code_chunk_output -->
<hr />
<h1 id="week-06-day-1-http" data-ignore="true">WEEK-06 DAY-1<br><em>HTTP</em></h1>
<hr />
<h1 id="http-learning-objectives">HTTP Learning Objectives</h1>
<p><strong>The objective of this lesson</strong> is for you to get comfortable with the main concepts of HTTP. HTTP is the underlying protocol used by the World Wide Web. It’s essential knowledge for developers who work with the web. At the end of it, you’ll be able to identify common HTTP verbs and status codes, as well as demonstrating how HTTP is used by setting up a simple server.</p>
<p>When you finish, you should be able to</p>
<ul>
<li>match the header fields of HTTP with a bank of definitions.</li>
<li>matching HTTP verbs (GET, PUT, PATCH, POST, DELETE) to their common uses.</li>
<li>match common HTTP status codes (200, 302, 400, 401, 402, 403, 404, 500) to their meanings.</li>
<li>send a simple HTTP request to <code>google.com</code></li>
<li>write a very simple HTTP server using ‘http’ in node with paths that will result in the common HTTP status codes.main concepts of HTTP. HTTP is the underlying protocol used by the World Wide Web. It’s essential knowledge for developers who work with the web. At the end of it, you’ll be able to identify common HTTP verbs and status codes, as well as demonstrating how HTTP is used by setting up a simple server.</li>
</ul>
<p>When you finish, you should be able to</p>
<ul>
<li>match the header fields of HTTP with a bank of definitions.</li>
<li>matching HTTP verbs (GET, PUT, PATCH, POST, DELETE) to their common uses.</li>
<li>match common HTTP status codes (200, 302, 400, 401, 402, 403, 404, 500) to their meanings.</li>
<li>send a simple HTTP request to <code>google.com</code></li>
<li>write a very simple HTTP server using ‘http’ in node with paths that will result in the common HTTP status codes.</li>
</ul>
<hr />
<h1 id="http-basics">HTTP Basics</h1>
<p>In the late 1980s, a computer scientist named Tim Berners-Lee proposed the concept of the "WorldWideWeb", laying the foundation for our modern Internet. A critical part of this concept was <em>HTTP</em>, the <em>Hypertext Transfer Protocol</em>.</p>
<p>We’re going to to dive into what makes HTTP such an important part of Web browsing and learn how to leverage it in our applications.</p>
<p>We’ll cover:</p>
<ul>
<li>the vocabulary of the Web,</li>
<li>how stateless connections work,</li>
<li>and HTTP request &amp; response types.</li>
</ul>
<h2 id="first-some-context">First, some context</h2>
<blockquote>
<p>"If you want to build a ship, don’t drum up the men and women to gather wood, divide the work, and give orders. Instead, teach them to yearn for the vast and endless sea."</p>
<p>– <em>Antoine de Saint-Exupéry (paraphrased)</em></p>
</blockquote>
<p>So far, you’ve written code that runs in isolation on your own system. Now it’s time to set sail into the "vast and endless" Internet! Before we can do so, we need to review the fundamentals: what makes the Web a "web"?</p>
<p>We’re going to share a lot of vocabulary here, and it may be a little dry at times, but remember that these are the principles upon which the rest of your journey will be built! You’ll find these concepts missing from most programming tutorials, so you’ll be ahead of the game if you lay a strong foundation now.</p>
<h2 id="breaking-it-down">Breaking it down…</h2>
<p>Like many disciplines, computer science is built around a shared vocabulary. Let’s demystify the acronym "HTTP" to understand it better.</p>
<h3 id="ht--hypertext"><strong>HT-</strong>: HyperText</h3>
<p><em>Hypertext</em> is simply "content with references to other content". This term is used specifically to refer to content in computing, and may include text, images, video, or any other digital content. If "hypertext" sounds familiar, that’s because you’ve heard it before: <em>HTML</em> stands for "<strong>H</strong>yper<strong>T</strong>ext <strong>M</strong>arkup <strong>L</strong>anguage".</p>
<p>Hypertext is what makes the Web a "web", and it’s the most fundamental part of how we interact online. We refer to references between hypertext resources as <em>hyperlinks</em>, though you’re probably used to hearing them referred to as <em>links</em>. Without links, the Internet would resemble a massive collection of separate books: each blog, news report, and social media site would exist in total isolation from each other. The ability to link these pages is what makes the kind of interactivity you’re learning to build possible, and it was a revolutionary concept when it was introduced!</p>
<h3 id="tp-transfer-protocol"><strong>-TP</strong>: Transfer Protocol</h3>
<p>A <em>protocol</em> in computer science is a set of guidelines surrounding the transmission of data. Protocols define the process of exchanging data, but don’t define exactly what that data must be. Think of it like a multi-course meal: we expect the appetizer, then the entree, then the dessert, but we could have any type of food for each of those courses! As long as the plates arrive in the particular order we expect, protocol is being followed.</p>
<p>HTTP acts as a <em>transfer protocol</em>. It defines the expectations for both ends of the transfer, and it defines some ways the transfer might fail. More specifically, HTTP is defined as a <em>request/response</em> protocol. An HTTP exchange is more like a series of distinct questions &amp; answers than a conversation between two systems.</p>
<h2 id="and-bringing-it-back-together">…and bringing it back together</h2>
<p>HTTP defines the process of exchanging hypertext between systems. Specifically, HTTP works between <em>clients</em> and <em>servers</em>. A <em>client</em> (sometimes called the <em>user agent</em>) is the data consumer. This is usually your web browser. A <em>server</em> (sometimes referred to as the <em>origin</em>) is the data provider, often where an application is running. In a typical HTTP exchange, the client sends a <em>request</em> to the server for a particular <em>resource</em>: a webpage, image, or application data. The server provides a <em>response</em> containing either the resource that the client requested or an explanation of why it can’t provide the resource.</p>
<p>Here’s a high-level overview of the exchange:</p>
<figure>
<img src="images/image-http-exchange.svg" alt="HTTP Exchange" /><figcaption>HTTP Exchange</figcaption>
</figure>
<p>We’ll look more closely at the <em>request</em> and <em>response</em> in separate lessons.</p>
<h2 id="properties-of-http">Properties of HTTP</h2>
<p>There are a few important properties of HTTP that we need to understand in order to use it effectively.</p>
<h3 id="reliable-connections">Reliable connections</h3>
<p>Let’s consider the example of two friends passing a note. If the note contains important information, the sender will want to make sure that it gets to its destination. They’ll likely take a little extra time to deliver it carefully, and they’ll expect confirmation once it’s been received. In computing, we’d refer to this as a <em>reliable connection</em>: messages passed between a client &amp; server sacrifice a little speed for the sake of trust, and we can rest assured that each message will be confirmed.</p>
<p>HTTP doesn’t work well if messages aren’t received in the correct order, so it’s critical that the connection your hypertext is crossing is reliable! Tim Berners-Lee chose <em>TCP</em>, another transmission protocol, as HTTP’s preferred connection type. We’ll discuss TCP in greater detail when we get into network models in a future lesson.</p>
<h3 id="stateless-transfer">Stateless transfer</h3>
<p>HTTP is considered a <em>stateless</em> protocol, meaning it doesn’t store any information. Each request you send across an HTTP connection should contain all its own context. This is unlike a <em>stateful</em> protocol, that might include specifications for storing data between requests.</p>
<p>This can be nice because we only ever need to read a single HTTP request to understand its intent, but it can cause headaches when it comes to things like maintaining your login status or the contents of your shopping cart!</p>
<p>To help us with this, HTTP supports <em>cookies</em>, bits of data that a client sends in with their request. The server can examine this data and look up a <em>session</em> for your account, or it can act on the info in the cookie directly. Note that neither the cookie nor the session are part of HTTP. They’re just workarounds we’ve created due to the protocol’s stateless nature.</p>
<h3 id="intermediaries">Intermediaries</h3>
<p>The Web is a big place, and it’s unlikely that your request will go directly to its destination! Instead, it will pass through a series of <em>intermediaries</em>: other servers or devices that pass your request along. These intermediaries come in three types:</p>
<ul>
<li><em>proxies</em>, which may modify your request so it appears to come from a different source,</li>
<li><em>gateways</em>, which pretend to be the resource server you requested,</li>
<li>and <em>tunnels</em>, which simply pass your request along.</li>
</ul>
<p>Here’s an idea of how these intermediaries might be laid out:</p>
<p>
<img src="images/image-http-proxy-tunnel-gateway.svg" style="width: 100%; height: auto;">
</p>
<p>Notice that these are interchangeable depending on the flow of data. When the response is sent back, "Their Router" is acting as a proxy and "Your Router" is acting as a gateway! This is an important part of HTTP: a single server may act as any of the intermediary types, depending on the needs of the HTTP message it’s transmitting.</p>
<p>We’ll discuss some of these intermediaries more in later lessons. For now, the takeaway is that HTTP isn’t limited to your browser &amp; application server. Lots of devices support HTTP in their own special way.</p>
<h2 id="digging-deeper-with-the-http-spec">Digging deeper with the HTTP spec</h2>
<p>We’re just scratching the surface of how HTTP works. If you’re interested in learning more, you can go straight to the source: <a href="https://nodejs.org/api/http.html#http_response_writehead_statuscode_statusmessage_headers">the HTTP spec</a>. A <em>spec</em> (short for <em>specification</em>) describes a protocol in great detail. It’s the document generated by an idea’s founders, and it’s reviewed and carefully edited before being adopted by the <a href="http://www.useragentstring.com/">IETF</a> (<em>Internet Engineering Task Force</em>).</p>
<p>Specs are intended to be exhaustive, so they can be overwhelming at first! This is definitely not light reading but any question you have about a particular protocol can likely be answered from its spec.</p>
<h2 id="what-weve-learned">What we’ve learned</h2>
<p>Whew, that’s a lot of jargon! Hopefully the fundamental aspects of HTTP are clearer to you now. Next up, we’ll look at an HTTP request &amp; response, and we’ll cover how to generate each.</p>
<p>After completing this lesson, you should have a clear understanding of:</p>
<ul>
<li>HTTP’s origin &amp; purpose,</li>
<li>special properties of HTTP,</li>
<li>and how to learn more from the HTTP spec.</li>
</ul>
<hr />
<h1 id="http-requests">HTTP Requests</h1>
<p>Without a query, there wouldn’t be a need for a response! Let’s take a look at the <em>request</em>: the client-initiated portion of an HTTP exchange.</p>
<p>We’ll cover:</p>
<ul>
<li>what an HTTP request looks like,</li>
<li>fields that make up a request,</li>
<li>and how to send a request of your own!</li>
</ul>
<h2 id="retrieving-hypertext">Retrieving hypertext</h2>
<p>Years ago, daily shopping looked very different. Instead of walking the aisles and picking up what they wanted, customers would approach a counter and ask a clerk to retrieve the items on their list. The clerk was responsible for knowing where those items were located and how best to get them to the customer.</p>
<p>While the retail industry has changed dramatically since that time, the Web follows that old tried-and-true pattern. You tell your browser which website you would like to access, and your browser hands that request off to a server that can get you what you’ve asked for. At the simplest level, the Web is just made up of computers asking each other for things!</p>
<p>Your browser’s part in this transaction is called the <em>request</em>. Since the browser is acting on your behalf, we sometimes refer to it as the <em>user-agent</em> (you being the <em>user</em>). You might also hear this referred to more generically as the <em>client</em> in the exchange.</p>
<h2 id="structure-of-an-http-request">Structure of an HTTP request</h2>
<p>Your browser is designed to be compliant with the HTTP specification, so it knows how to translate your instructions into a well-formatted HTTP request. An important part of the HTTP spec is that it’s simple to read, so let’s take a look at an example.</p>
<p>Here’s what the HTTP request looks like for visiting <code>.io</code>:</p>
<pre class="text"><code>GET / HTTP/1.1
Host: .io
Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9</code></pre>
<p>Let’s break it down!</p>
<h3 id="request-line-http-verbs">Request-line &amp; HTTP verbs</h3>
<p>The first line of an HTTP request is called the <strong>request-line</strong>, and it sets the stage for everything to come. It’s made up of three parts, separated by spaces:</p>
<ul>
<li>the <em>method</em>, indicated by an <em>HTTP verb</em>,</li>
<li>the <em>URI (Uniform Resource Indicator)</em> that identifies what we’ve requested,</li>
<li>and the <em>HTTP version</em> we expect to use (usually <code>HTTP/1.1</code> or <code>HTTP/2</code>).</li>
</ul>
<p>In our <code>.io</code> example, we can see that our version matches the most common HTTP version (<code>1.1</code>) and that our URI is <code>/</code>, or the <em>root</em> resource of our target. That first word, <code>GET</code> is the HTTP verb we’re using for this request.</p>
<p>HTTP verbs are a simple way of declaring our intention to the server. We do the same thing with English verbs when asking for help: "Can you <strong>get</strong> me that?", "Should I <strong>remove</strong> this?", etc. HTTP has a small handful of verbs available, but we’re going to look at the five most common: <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>PATCH</code>, and <code>DELETE</code>.</p>
<ul>
<li><p><code>GET</code> is used for direct requests. A <code>GET</code> request is generally how websites are retrieved, and they only require that the server return a resource. These types of requests will never have a body. Any data you need to send in a <code>GET</code> request must be shared via the URI.</p></li>
<li><p><code>POST</code> is typically used for creating new resources on the server. Most of the time, when you submit a form a <code>POST</code> request is generated. These types of requests can have a <em>body</em> containing any data the server might need to complete your request, like your username &amp; password or the contents of your shopping cart.</p></li>
<li><p><code>PUT</code> requests are used to update a resource on the server. These will contain the whole resource you’d like to update. For example: when updating your name on a website, a <code>PUT</code> request will be generated containing not just your new name but also your user ID, email, etc.</p></li>
<li><p><code>PATCH</code> requests are very similar to <code>PUT</code> requests, but do not require the whole resource to perform the update. Keeping with our example of updating your name: a <code>PATCH</code> request would only require your new name, not the rest of your account details, to succeed.</p></li>
<li><p><code>DELETE</code> requests destroy resources on the server. These might be saved database records, like removing a product that’s sold out, or more ephemeral resources, like logging a user out of their current session.</p></li>
</ul>
<p>Ultimately, how these verbs get acted upon is up to the server. You could write an application that totally ignores these rules and uses a <code>DELETE</code> request to log in, but that’s only going to confuse your teammates and frustrate you in the future! It’s best to use them as the spec intends.</p>
<h3 id="headers">Headers</h3>
<p>The <em>request-line</em> sets the table, but it’s the headers that describe the menu! <em>Headers</em> are key/value pairs that come after the <em>request-line</em>. They each appear on separate lines and define metadata needed to process the request. Here are some common request headers you’ll see:</p>
<ul>
<li><p><code>Host</code>: The root path for our URI. This is typically the <em>domain</em> we’d like to request our resource from. As you can see above, our <code>Host</code> header for <code>.io</code> is, appropriately, <code>.io</code>.!</p></li>
<li><p><code>User-Agent</code>: This header displays information about which browser the request originated from. It’s generally formatted as <code>name/version</code>. You can see in the <code>User-Agent</code> header above that we’re using <code>Chrome/76.0</code> &gt; Our <code>User-Agent</code> has much more content, including references to Mozilla, &gt;makers of the popular Firefox browser, and Safari, Apple’s default browser of &gt;choice. What gives? &gt; &gt;There is some <a href="https://nodejs.org/api/http.html#http_response_writehead_statuscode_statusmessage_headers">interesting history</a> behind those additional references, &gt;and you can use <a href="http://www.useragentstring.com/">www.useragentstring.com</a> for additional details about &gt;your current browser’s <code>user-agent</code>.</p></li>
<li><p><code>Referer</code>: This defines the URL you’re coming from. There’s none in our example since we navigated directly to the website, but if we click any link on the page, the resulting HTTP request will have <code>Referer: https://.io/</code> in its headers. Also, you’re not reading it wrong - this header is misspelled! It should be "referrer", but it was written incorrectly in the original specification and the typo stuck. Let this be a lesson: your poorly-written code might still be around in 20 years, too!</p></li>
<li><p><code>Accept</code>: "Accept-" headers indicate what the client can receive. When we go to most websites, our <code>Accept</code> header will be long to ensure we get all the various types of content that site might include. However, we can modify this header in our requests to only get back certain types of data. One common use is setting <code>Accept: application/json</code> to get a response in JSON format instead of HTML. You may see variations of this header like <code>Accept-Language</code> for internationalized websites or <code>Accept-Encoding</code> for sites that support alternative compression formats.</p></li>
<li><p><code>Content-*</code>: Content headers define details about the body of the request. The most common content header is <code>Content-Type</code>, which lets the server know what format we’re sending our body data as. This might be <code>application/json</code> from a JavaScript app or <code>application/x-www-form-urlencoded</code> for info submitted from a web form. Content headers will only show up on requests that support content in the body, so <code>GET</code> requests should never have this!</p></li>
</ul>
<p>There are LOTS of other header keys! <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">MDN</a> has an exhaustive reference list with examples.</p>
<h3 id="body">Body</h3>
<p>When we need to send data that doesn’t fit in a header &amp; is too complex for the URI, we can place it in the <em>body</em> of our HTTP request. The body comes right after the headers and can be formatted a few different ways.</p>
<p>The most common way form data is formatted is <em>URL encoding</em>. This is the default for data from web forms and looks a little like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb2-1" title="1">name=claire<span class="er">&amp;</span>age=29<span class="er">&amp;</span>iceCream=vanilla</a></code></pre></div>
<p>Alternatively, you might format your request body using JSON or XML or some other standard. What’s most important is that you remember to set the appropriate <code>Content-Type</code> header so the server knows how to interpret your body.</p>
<h2 id="sending-an-http-request-from-the-command-line">Sending an HTTP request from the command line</h2>
<p>We’ve discussed HTTP requests mostly in the context of your web browser, but that’s not the only way. There are lots of HTTP clients out there you can use to send requests.</p>
<p>Let’s stay close to the exchange itself with a lightweight tool that requires us to do most of the work ourselves. We’ll use <code>netcat</code> (also known as <code>nc</code>), a utility that comes as part of Unix-like environments such as Ubuntu and macOS.</p>
<p><code>netcat</code> allows you to open a direct connection with a URL and manually send HTTP requests. Let’s see how this works with a quick <code>GET</code> request to App Academy’s homepage.</p>
<p>From your command line, type <code>nc -v .io 80</code>. This will open a connection to <code>.io</code> on port 80 (the port most-often used for web connections). Once the connection is established, you’ll be able to type out a simple HTTP request by hand! Let’s copy the <em>request-line</em> and <code>Host:</code> header from our request above:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="ex">GET</span> / HTTP/1.1</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="ex">Host</span>: .io</a></code></pre></div>
<p>Now hit "Return" on your keyboard twice. This will send the request and display the server’s response. You should see something similar to this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="ex">HTTP/1.1</span> 301 Moved Permanently</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="ex">Date</span>: Thu, 03 Oct 2019 04:17:23 GMT</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="ex">Transfer-Encoding</span>: chunked</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="ex">Connection</span>: keep-alive</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="ex">Cache-Control</span>: max-age=3600</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="ex">Expires</span>: Thu, 03 Oct 2019 05:17:23 GMT</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="ex">Location</span>: https://www..io/</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="ex">Server</span>: cloudflare</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="ex">CF-RAY</span>: 51fc1b0f8b98d304-ATL</a></code></pre></div>
<p>Congratulations! You’ve sent your first manual HTTP request. We’ll discuss the parts of the HTTP response you received in an upcoming lesson.</p>
<p>Try it one more time, this time typing <code>nc -v neverssl.com 80</code> and making the same HTTP request with the command <code>GET / HTTP/1.1</code> and the header <code>Host: neverssl.com</code>. Don’t forget to hit Enter twice. Look! That’s the HTML coming back from the server! Neat-o!</p>
<p>You can read much more about <code>netcat</code> by invoking the manual: <code>man nc</code>. We’ll also use it in an upcoming project for extra practice.</p>
<h2 id="what-weve-learned-1">What we’ve learned</h2>
<p>HTTP requests are the first step to getting what you want on the web. Having completed this lesson, you should be able to recount:</p>
<ul>
<li>what an HTTP request is,</li>
<li>some common HTTP request verbs,</li>
<li>a rough outline of the HTTP request format,</li>
<li>and how to use <code>netcat</code> to send HTTP requests from your command line.</li>
</ul>
<hr />
<h1 id="http-responses">HTTP Responses</h1>
<p>A web server delivers content via <em>responses</em>, the second part of the HTTP’s request/response cycle. Let’s dive into how a response is structured and what your client can expect from the server.</p>
<p>We’ll cover:</p>
<ul>
<li>HTTP response structure,</li>
<li>differentiating errors &amp; successful transfers,</li>
<li>and how to use a server to generate your own responses.</li>
</ul>
<h2 id="hypertext-delivered">Hypertext delivered</h2>
<p>An HTTP response contains either the content we requested or an explanation of why that content couldn’t be delivered. It’s just like ordering at a restaurant: you place your order and receive either a plate of delicious food or an apology from the chef. In a good restaurant, the apology will include some extra help: "I’m sorry, we’re out of broccoli. Can we get you something else? How can we make this right?".</p>
<p>When designing your own HTTP responses, remember that restaurant example. It’s important to note that there’s a problem, but it’s equally important to provide reliable, helpful details. We’ll look at some examples of this when we build our own HTTP server in a later lesson.</p>
<h2 id="structure-of-a-response">Structure of a Response</h2>
<p>Responses are formatted similarly to requests: we’ll have a <em>status-line</em> (instead of a request-line), headers that provide helpful metadata about the response, and the response body: a representation of the requested resource.</p>
<p>Here’s what the HTTP response looks like when visiting <code>.io</code>:</p>
<pre class="text"><code>HTTP/1.1 200 OK
Content-Type: text/html; charset=utf-8
Transfer-Encoding: chunked
Connection: close
X-Frame-Options: SAMEORIGIN
X-Xss-Protection: 1; mode=block
X-Content-Type-Options: nosniff
Cache-Control: max-age=0, private, must-revalidate
Set-Cookie: _rails-class-site_session=BAh7CEkiD3Nlc3Npb25faWQGOgZFVEkiJTM5NWM5YTVlNTEyZDFmNTNlN; path=/; secure; HttpOnly
X-Request-Id: cf5f30dd-99d0-46d7-86d7-6fe57753b20d
X-Runtime: 0.006894
Strict-Transport-Security: max-age=31536000
Vary: Origin
Via: 1.1 vegur
Expect-CT: max-age=604800, report-uri=&quot;https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct&quot;
Server: cloudflare
CF-RAY: 51d641d1ca7d2d45-TXL

&lt;!DOCTYPE html&gt;
&lt;html&gt;
...
...
&lt;/html&gt;</code></pre>
<p>Oof! That’s a lot of unfamiliar stuff. Let’s walk through the important bits together.</p>
<h3 id="status">Status</h3>
<p>Like the request, an HTTP response’s first line gives you a high-level overview of the server’s intention. For the response, we refer to this as the <em>status-line</em>.</p>
<p>Here’s the status line from our <code>.io</code> response:</p>
<pre class="text"><code>HTTP/1.1 200 OK</code></pre>
<p>We open with the HTTP version the server is responding with. <code>1.1</code> is still the most commonly used, though you may occasionally see <code>2</code> or even <code>1.0</code>. We follow this with a <code>Status-Code</code> and <code>Reason-Phrase</code>. These give us a quick way of understanding if our request was successful or not.</p>
<p><em>HTTP status codes</em> are a numeric way of representing a server’s response. Each code is a three-digit number accompanied by a short description. They’re grouped by the first digit (so, for example, all "Informational" codes begin with a <code>1</code>: <code>100</code> - <code>199</code>).</p>
<p>Let’s take a look at the most common codes in each group.</p>
<h4 id="status-codes-100---199-informational">Status codes 100 - 199: Informational</h4>
<p>Informational codes let the client know that a request was received, and provide extra info from the server. There are very few informational codes defined by the HTTP specification and you’re unlikely to see them, but it’s good to know that they exist!</p>
<h4 id="status-codes-200---299-successful">Status codes 200 - 299: Successful</h4>
<p>Successful response codes indicate that the request has succeeded and the server is handling it. Here are a couple common examples:</p>
<ul>
<li><p><strong>200 OK</strong>: Request received and fulfilled. These usually come with a <code>body</code> that contains the resource you requested.</p></li>
<li><p><strong>201 Created</strong>: Your request was received and a new record was created as a result. You’ll often see this response to <code>POST</code> requests.</p></li>
</ul>
<h4 id="status-codes-300---399-redirection">Status codes 300 - 399: Redirection</h4>
<p>These responses let the client know that there has been a change. There are a few different ways for a server to note a redirect, but the two most common are also the most important:</p>
<ul>
<li><p><strong>301 Moved Permanently</strong>: The resource you requested is in a totally new location. This might be used if a webpage has changed domains, or if resources were reorganized on the server. Most clients will automatically process this redirect and send you to the new location, so you may not notice this response at all.</p></li>
<li><p><strong>302 Found</strong>: Similarly, to <em>301 Moved Permanently</em>, this indicates that a resource has moved. However, this code is used to indicate a temporary move. It’s not often that you see temporary moves online, but this code may be used to indicate a permanent move where the old domain should still be valid too. Clients will usually follow this redirect automatically as well, but you shouldn’t necessarily update your links until the server returns a <code>301</code>.</p></li>
</ul>
<blockquote>
<p><em>301 Moved Permanently</em> and <em>302 Found</em> often get confused. When might we want to use a <em>302 Found</em>`_? The most common use case today is for the transition from HTTP to HTTPS. <em>HTTPS</em> is secure HTTP messaging, where requests &amp; responses are <em>encrypted</em> so they can’t be read by prying eyes while en route to their destinations.</p>
<p>This is a much safer way of communicating online, so most websites require access via <code>https://</code> before the domain. However, we don’t want to ignore folks still trying to access our content from the older <code>http://</code> approach!</p>
<p>In this case, we’ll return a <em>302 Found</em> response to the client, letting them know that it’s okay to keep navigating to <code>http://our-website.com</code>, but we’re going to redirect them to <code>https://our-website.com</code> for their protection.</p>
</blockquote>
<h4 id="status-codes-400---499-client-error">Status codes 400 - 499: Client Error</h4>
<p>The status codes from 400 to 499, inclusive, indicate that there is a problem with the client’s request. Maybe there was a typo, or maybe the resource we requested is no longer available. You’ll see lots of these as you’re learning to format HTTP requests. Here are the most common ones:</p>
<ul>
<li><p><strong>400 Bad Request</strong>: Whoops! The server received your request, but couldn’t understand it. You might see a <em>400 Bad Request</em> in response to a typo or accidentally truncated request. We often refer to these as <em>malformed</em> requests.</p></li>
<li><p><strong>401 Unauthorized</strong>: The resource you requested may exist, but you’re not allowed to see it without authentication. These type of responses might mean one of two things: either you didn’t log in yet, or you tried to log in but your credentials aren’t being accepted.</p></li>
<li><p><strong>403 Forbidden</strong>: The resource you requested may exist, but you’re not allowed to see it <em>at all</em>. This response code means this resource isn’t accessible to you, even if you’re logged in. You just don’t have the correct permission to see it.</p></li>
<li><p><strong>404 Not Found</strong>: The resource you requested doesn’t exist. You may see this response if you have a typo in your request (for example: going to <code>appaccccademy.io</code>), or if you’re looking for something that has been removed.</p></li>
</ul>
<blockquote>
<p><em>403 Forbidden</em> requests let the client know that a valid resource was requested. This can be a security risk! For example: if I guess that you have <em>passwords.html</em> on your website because you just <em>want</em> to be hacked, a <em>403 Forbidden</em> response tells me I’m correct. For this reason, some sites will return a <em>404 Not Found</em> for resources that exist but aren’t accessible.</p>
<p>A well-known example is GitHub. If you try to open a repository you don’t have permission to access, GitHub will return a <em>404 Not Found</em> even if your URL is correct! This protects you from random users guessing the names of your projects.</p>
</blockquote>
<h4 id="status-codes-500---599-server-error">Status codes 500 - 599: Server Error</h4>
<p>This range of response codes are the Web’s way of saying "It’s not you, it’s me." These indicate that your request was formatted correctly, but that the server couldn’t do what you asked due to an internal problem.</p>
<p>There are two common codes in this range you’ll see while getting started:</p>
<ul>
<li><p><strong>500 Internal Server Error</strong>: Your request was received, and the server tried to process it, but something went awry! As you’re learning to write your own servers, you’ll often see a <em>500 Internal Server Error</em> as your code fails unexpectedly.</p></li>
<li><p><strong>504 Gateway Timeout</strong>: Your request was received but the server didn’t respond in a reasonable amount of time. Timeout errors can be tricky: your first instinct may be that your own connection is bad, but this code means the problem is likely on the server’s side. You’ll often see these when a server is no longer reachable (maybe due to an unexpected outage or power failure).</p></li>
</ul>
<h3 id="headers-1">Headers</h3>
<p>Headers on HTTP responses work identically to those on requests. They establish metadata that the receiving client might need to process the response. Here are a few common response headers you’ll see:</p>
<ul>
<li><p><strong>Location</strong>: Used by the client for redirection responses. This contains the URL the client should redirect to.</p></li>
<li><p><strong>Content-Type</strong>: Lets the client know what format the body is in. Your client will display different types of response content in different ways, to setting the <em>Content-Type</em> is important! Notice that this header can be present on responses <strong>and</strong> requests. It’s a generic header for any HTTP interaction involving content.</p></li>
<li><p><strong>Expires</strong>: When the response should be considered <em>stale</em>, or no longer valid. The <em>Expires</em> header lets your client <em>cache</em> responses (that is: save them locally to prevent having to repeatedly re-download them). The client may ignore requests to that same resource until after the date set in the <em>Expires</em> header.</p></li>
<li><p><strong>Content-Disposition</strong>: This header lets the client know how to display the response, and is specifically devoted to whether the response should be visible to the client or delivered as a download. Think about your own experience online: sometimes you click a button and get an immediate download, while in other cases you click a button and get to "preview" the content before you download it. This is controlled by the <em>Content-Disposition</em> header.</p></li>
<li><p><strong>Set-Cookie</strong>: This header sends data back to the client to set on the <em>cookie</em>, a set of key/value pairs associated with the server’s domain. Remember how HTTP is <em>stateless</em>? Cookies are one way to get around that! <em>Set-Cookie</em> may send back information like a unique ID for the user you’ve logged in as or details about other resources you’ve requested on this domain.</p></li>
</ul>
<p>Remember - this isn’t an exhaustive list of headers! Sites and intermediate gateways/proxies can define their own custom headers, so you’ll see many more than these. If you’re unsure what a header does, the <a href="https://nodejs.org/api/http.html#http_response_writehead_statuscode_statusmessage_headers">MDN HTTP Header documentation</a> is a great place to start searching.</p>
<h3 id="body-1">Body</h3>
<p>Assuming a successful request, the <em>body</em> of the response contains the resource you’ve requested. For a website, this means the HTML of the page you’re accessing.</p>
<p>The format of the body is dictated by the <em>Content-Type</em> header. This is an important detail! If you accidentally configure your server to send "Content-Type: application/json" along with a body containing HTML, your HTML won’t be rendered properly and your users will see plain text instead of beautifully-rendered elements. In the same way, API responses should be clearly marked so that other applications know how to manage them.</p>
<p>We can see in our <code>.io</code> response above that the body begins with <code>!&lt;DOCTYPE html&gt;</code> and ends with <code>&lt;/html&gt;</code>. If you inspect the source of the page in your browser, you’ll see that this is exactly what’s being rendered. Headers may change <strong>how</strong> the browser handles the body, but they won’t <strong>modify</strong> the body’s content.</p>
<h2 id="using-a-custom-server-to-generate-responses">Using a custom server to generate responses</h2>
<p>At its most basic, a web server is just a tool to generate HTTP responses. Therefore, the best way to practice is to build your own webserver!</p>
<p>We’ll walk through building our own server from scratch using Node.js in an upcoming video lesson.</p>
<h2 id="what-weve-learned-2">What we’ve learned</h2>
<p>Like HTTP requests, HTTP responses involve lots of new lingo and details. Hang in there - we’ll start doing practical work with this new vocabulary in the projects &amp; video demos coming up.</p>
<p>After this reading, you should:</p>
<ul>
<li>Understand the parts of an HTTP response,</li>
<li>be able to identify common status codes &amp; their meanings,</li>
<li>recognize common response headers,</li>
<li>and be prepared to build your own server!</li>
</ul>
<hr />
<h1 id="http-project-from-zero-to-server">HTTP Project: From Zero To Server</h1>
<p>We’ve been knee-deep in everyone else’s HTTP workflow; let’s build one of our own! Together we’re going to build an HTTP server from scratch. We’ll cover:</p>
<ul>
<li>Node’s <code>http</code> module &amp; <code>createServer</code> method,</li>
<li>Routing requests based on multiple factors,</li>
<li>Returning content and headers in your response,</li>
<li>and testing your server locally using command line tools.</li>
</ul>
<p><strong>DO NOT GIVE INTO COPY &amp; PASTE!</strong> In the following instructions, you will see code samples. Do <em>not</em> copy and paste them. Type them in or watch someone type them in. Do this so that you <em>feel</em> the syntax. If you just copy and paste, when it comes to typing the code yourself, you will be at a loss.</p>
<h2 id="phase-1-proof-of-concept">Phase 1: Proof of concept</h2>
<p>Your goal is to go from "zero to server" in this project, so let’s get "zero" ready. Clone this project’s starter repo:</p>
<pre><code>git clone https://github.com/-starters/http-from-zero-to-server-starter.git</code></pre>
<p>You’ll notice that this starter project only has a <code>test</code> directory. In the project directory, outside of the <code>test</code> folder, create an empty file named <code>server.js</code>.</p>
<p>You’ll be basing your server on the <code>http</code> module that’s built into Node.js. You can’t use this module until we include it in your application! Use the <code>require</code> directive to import Node’s <code>http</code> module right away and assign it to a variable named <code>http</code>.</p>
<p>Next, time to get a bare bones server up and running. Drop down a line and call the <code>createServer</code> method on <code>http</code>. This method accepts a single argument that is a function. The function should have two parameters. By convention, we name the parameters <code>req</code> (short for "<em>req</em>uest") and <code>res</code> (short for "<em>res</em>ponse"). Within the body of that function argument, call the <code>end</code> method on <code>response</code>. This will generate a simple <code>200 OK</code> response to any request at all, regardless of what’s asking for.</p>
<p>Remember that you can’t run your server without letting it know where to expect requests from! Chain the <code>listen</code> method on to the end of the <code>createServer</code> call we just made. <code>listen</code> accepts two parameters: a port number and a function. The port number indicates where the server will be accessible from, and the function argument is meant for any initialization code you’d like to run when the server starts. Use port <code>3000</code> and, within your function argument, <code>console.log</code> a helpful startup message. Make sure you include the port number in your message in case your users forget!</p>
<p>By now you should have a dead-simple HTTP server. This app will accept requests and respond with <code>http</code>’s default response: <code>200 OK</code>, no custom headers, no body content. You can confirm this by running the server in your terminal and visiting <code>http://localhost:3000</code> in your browser. You won’t see any content in the browser, but check the "Network" tab in your dev tools to confirm that the server response matches what you expect. You may need to refresh the page to see the request/response.</p>
<p>Save and commit your changes to version control! This completes your first unit of work and results in a runnable server that’s all your own. We know we can do better, though! Let’s look into routing.</p>
<p>To see what this should look like, have a peek at [About Node.js®].</p>
<h2 id="phase-2-status-code-all-the-things">Phase 2: Status code all the things!</h2>
<p>When discussing Web servers, <em>routing</em> generally refers to controlling which part of your application processes each request. For example, you may route emails differently than website requests. There are lots of complex, high throughput routing libraries available for Node, but you’ll keep it as simple as possible here and rely on your hard work.</p>
<p>You need something to control how we route each request. For your server, the best bet is the request’s <code>url</code> property. This is a key provided by <code>http</code> that’s present on every <code>request</code> our server processes. You can check the <code>url</code> of each inbound request and decide what we want to return for that particular resource.</p>
<h3 id="phase-2a-start-small">Phase 2a: Start small</h3>
<p>Build out your routing like so: when someone requests a particular <code>Reason-Phrase</code>, you should respond with the matching HTTP <code>Status-Code</code>. For example:</p>
<ul>
<li><code>http://localhost:300/OK</code> should return <code>HTTP/1.1 200 OK</code></li>
</ul>
<p>You can use the [<code>writeHead</code>] method on the <code>response</code> object to control which status code gets returned.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="cf">if</span> (<span class="va">req</span>.<span class="at">url</span> <span class="op">===</span> <span class="st">&quot;/OK&quot;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Inbound &#39;OK&#39; request being processed...&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="va">res</span>.<span class="at">writeHead</span>(<span class="dv">200</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="va">res</span>.<span class="at">end</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>There are a couple important details to note in this condition:</p>
<ul>
<li>Your <code>url</code> property includes a leading slash.</li>
<li>You still have to <code>end()</code> each response to send it back to the client. If you don’t do this, the browser will wait and wait and wait and, eventually, tell you that the request timed out.</li>
</ul>
<p>This code should go in the function argument of <code>createServer</code>, where your <code>req</code> and <code>res</code> params are accessible.</p>
<p>You’re only controlling for one <code>url</code> option here. What about all the other possibilities? Before you save this portion of our work as done, you should add an <code>else</code> to this condition that returns a appropriate status code. A perfect choice would be status code 404! Don’t forget to include a relevant <code>console.log</code> in your else condition as well.</p>
<p>Before saving &amp; committing, make sure you can run your server, and that visiting <code>http://localhost:3000/OK</code> returns a <code>200</code>, while visiting any other URL returns a <code>404</code>. You should see a new line in your terminal, consistent with the messages in your <code>console.log</code>s, for each request that’s made.</p>
<h3 id="phase-2b-rinse-repeat">Phase 2b: Rinse, repeat</h3>
<p>You’ve read about many more codes than <code>200</code> and <code>404</code>. Extend your server to respond to each reason phrase we discussed in our readings. You can omit <code>OK</code> and <code>Not Found</code> because we’ve already handled those cases.</p>
<p>Here’s an alphabetical list of each <code>url</code> your server should respond to:</p>
<pre class="text"><code>- /Bad-Request
- /Created
- /Forbidden
- /Found
- /Gateway-Timeout
- /Internal-Server-Error
- /Moved-Permanently
- /Unauthorized</code></pre>
<p>It’s up to you to look up the matching HTTP status codes each will need to return. Use [DuckDuckGo] (or your favorite search engine) to search for HTTP status codes. You can bet there’s at least a Wikipedia entry on it!</p>
<p>Follow the pattern you used with <code>/OK</code> and don’t forget the details. This may feel a little repetitive, but it’s a great opportunity to practice matching status codes to reasons. This is the sort of minutiae that technical interviewers will want to quiz you on during your job hunt - try to lock it down now!</p>
<p>Save, commit, and test your new server out.</p>
<h2 id="phase-3-confirming-functionality">Phase 3: Confirming functionality</h2>
<p>The tricky thing about the HTTP specification that most clients are configured to respond to certain codes in certain ways. Browsers, for example, will try to follow redirection codes and will show special pages for server errors unless directed otherwise. This means that browser testing can be a little flaky.</p>
<p>Try using one of a couple tools you already know how to use to test our server, instead of hoping the browser will keep working the way you’d like.</p>
<h2 id="phase-3a-a-command-line-client">Phase 3a: A command line client</h2>
<p>The lowest-friction approach you can take is using a native command line tool to test our HTTP server like <code>netcat</code>.</p>
<p>Run your server in one terminal, and in another terminal run <code>nc -v localhost 3000</code>. This will run <code>netcat</code> in "verbose" mode, so you get a little extra info with each request. Now you can manually craft HTTP requests to your server.</p>
<p>Try typing (or copying/pasting) <code>GET /OK HTTP/1.1</code> first. Remember to press the "Return" key twice after entering that request line. You should receive a <code>200 OK</code> response immediately. If your response is taking more than a couple seconds to process, try restarting <code>netcat</code> by pressing <code>Ctrl</code> + <code>C</code> on your keyboard and starting over.</p>
<p>Now test your other routes - do they all return what you expect?</p>
<h2 id="phase-3b-double-check-your-work">Phase 3b: Double-check your work</h2>
<p>Automated testing can be a little more work, but don’t worry: we’ve put some tests together for you!</p>
<p>With your server running on port 3000 and run <code>mocha</code> on your command line to watch the tests fly!</p>
<p>Your tests will confirm that your routes are all returning the expected status codes, and will let you know of any that might have been missed. If you get confused, don’t be afraid to read the test file for extra details. The code &amp; comments within may be clearer than mocha’s error messaging.</p>
<h2 id="bonus-phase-take-it-up-a-notch">Bonus phase: Take it up a notch</h2>
<p>Ready to go beyond the basics? Here are some improvements to explore:</p>
<ul>
<li><p>The [<code>writeHead</code>] on <em>response</em> accepts a second argument: an object containing custom headers. Knowing this, try to update your responses with redirection codes to <em>actually</em> redirect. Is there a custom header you can use to tell your browser where the request should be directed to? Try searching for more information about the status code that redirects the browser to another resource.</p></li>
<li><p>This project didn’t discuss the <a href="https://nodejs.org/api/http.html#http_response_write_chunk_encoding_callback"><code>write</code></a> method on the <em>response</em> object, but it adds content to the body of your response. Using both the correct <code>Content-Type</code> header and the <code>write</code> method, try sending some HTML back with responses. Can you render a very simple webpage from your server?</p></li>
<li><p>Certain codes (like <em>201</em>, for example) are often only seen in response to <code>POST</code> requests. You’ve only been using <code>GET</code> requests so far, but you could improve your server by having it check the <code>request.method</code> before responding to some URLs. Try limiting the <code>Created</code> response to <code>POST</code> requests only. Otherwise, it should respond with a <em>405 Method Not Allowed</em>, a status code created for just the purpose of telling clients that they’ve used an HTTP method (GET, POST, PUT, PATCH, or DELETE) that the URL doesn’t support.</p></li>
</ul>
<h2 id="what-youve-learned">What you’ve learned</h2>
<p>You’ve mastered the art of the HTTP server - congratulations! You’ll soon grow into larger, more fully-featured frameworks, but don’t forget your basics. Every server out there is based on these same simple principles.</p>
<p>After completing this project, you should be able to:</p>
<ul>
<li>write up a basic server for Node,</li>
<li>respond to requests of all types with appropriate status codes &amp; data,</li>
<li>and test servers (both your own and others’) using reliable command line tools.</li>
</ul>
<p>[About Node.js®]: https://nodejs.org/en/about/#about-node-js [<code>writeHead</code>]: https://nodejs.org/api/http.html#http_response_writehead_statuscode_statusmessage_headers [DuckDuckGo]: https://www.duckduckgo.com</p>
<hr />
<h1 id="week-06-day-2-promises" data-ignore="true">WEEK-06 DAY-2<br><em>Promises</em></h1>
<hr />
<h1 id="promises-learning-objectives-i">Promises Learning Objectives I</h1>
<p>Below is a complete list of the terminal learning objectives for this lesson. When you complete this lesson, you should be able to perform each of the following objectives. These objectives capture how you may be evaluated on the assessment for this lesson.</p>
<ol type="1">
<li>Instantiate a <code>Promise</code> object</li>
<li>Use <code>Promises</code> to write more maintainable asynchronous code</li>
<li><p>Use the <code>fetch</code> API to make <code>Promise</code>-based API callsl learning objectives for this lesson. When you complete this lesson, you should be able to perform each of the following objectives. These objectives capture how you may be evaluated on the assessment for this lesson.</p></li>
<li>Instantiate a <code>Promise</code> object</li>
<li>Use <code>Promises</code> to write more maintainable asynchronous code</li>
<li><p>Use the <code>fetch</code> API to make <code>Promise</code>-based API calls</p></li>
</ol>
<hr />
<h1 id="a-promise-is-a-promise-a-mostly-complete-guide-to-javascript-promises-i">A Promise is a Promise: A Mostly Complete Guide to JavaScript Promises I</h1>
<p>This article is about a JavaScript feature formally introduced into the language in 2015: the <code>Promise</code> object. The technical committee that governs the JavaScript language recognized that programmers had a hard time reasoning about and maintaining asynchronous code. They included <code>Promise</code>s as a way to encourage writing asynchronous code in a way that <em>appeared</em> synchronous.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Provide examples of why <code>Promise</code>-based code is easier to maintain than traditional asynchronous callbacks;</li>
<li>Recall the three states of a <code>Promise</code>, what each state means, and any associated data with that state.</li>
</ul>
<h2 id="a-quick-review-of-function-declarations">A quick review of function declarations</h2>
<p>It’s important to remember about how JavaScript handles the declaration of a function. Please look at the following code.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">function</span> <span class="at">loudLog</span>(message) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="va">message</span>.<span class="at">toUpperCase</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="op">}</span></a></code></pre></div>
<p>When JavaScript encounters that code, it does not run the function. You probably know that, but it’s important to read again. When JavaScript encounters that code, it does not run the function.</p>
<p>It <em>does</em> create a <code>Function</code> object and stores that in a variable named <code>loudLog</code>. At some time later, you can run the function object in that variable with the syntax <code>loudLog("error occurred");</code>. That <em>runs</em> the function. Just declaring a function doesn’t run it. Look at this following code.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;How did you call me?&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="op">}</span></a></code></pre></div>
<p>JavaScript will, again, create a <code>Function</code> object. However, there’s no name for the function, so it doesn’t get assigned to any variable, and just disappears with no way for us to use it. So, why would you declare functions without names?</p>
<h2 id="the-looming-problem-of-asynchronous-code-with-callbacks">The looming problem of asynchronous code with callbacks</h2>
<p>Let’s look at the documentation for how to read files in Node.js. Don’t worry if you haven’t used Node.js, yet. It’s just like any other JavaScript.</p>
<pre><code>readFile(path, encoding, callback)

Arguments:
  path      &lt;string&gt;    path to the file
  encoding  &lt;string&gt;    the encoding of the file
  callback  &lt;function&gt;  two arguments:
                        err      &lt;error object&gt;
                        content  &lt;string&gt;

Asynchronously reads the entire contents of a file.</code></pre>
<p>The function named <code>readFile</code> accepts three arguments: a string that contains the <code>path</code> to the file, the <code>encoding</code> of the file, and a callback function that <code>readFile</code> calls once it’s read the content of the file. If you wanted to write out the content of the file with a header, you could write code like this.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">function</span> <span class="at">writeWithHeader</span>(err<span class="op">,</span> content) <span class="op">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;YOUR FILE CONTAINS:&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(content)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="op">}</span></a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="at">readFile</span>(<span class="st">&#39;~/Documents/todos.txt&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> writeWithHeader)<span class="op">;</span></a></code></pre></div>
<p>Recall that when JavaScript found the function declaration at the beginning of that code block, it created a <code>Function</code> object and stored it in a variable named <code>writeWithHeader</code>. Now, that variable contains the actual function that can later be run. That code passes the value of that variable, the <code>Function</code> object, into the <code>readFile</code> function so the <code>readFile</code> function can run it later.</p>
<p>If you’re not going to use the <code>writeWithHeader</code> function anywhere else in your code, idiomatic JavaScript instructs you to get rid of the name of the function and declare it directly as the second argument of the <code>readFile</code> functions. That would turn the above code block into the following.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="at">readFile</span>(<span class="st">&#39;~/Documents/todos.txt&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> content) <span class="op">{</span></a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;YOUR FILE CONTAINS:&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(content)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Since 2015, idiomatic JavaScript would instruct you to get rid of the function keyword and just use an arrow function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="at">readFile</span>(<span class="st">&#39;~/Documents/todos.txt&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> content) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;YOUR FILE CONTAINS:&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(content)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The key to remember here is that you have only declared that function that <code>readFile</code> will call later, <code>readFile</code> is in charge of running that function.</p>
<p>Imagine that you have a file that has a list of other file names in it named <code>manifest.txt</code>. You want to read the file and read each of the files listed in it. Then, you want to count the characters in each of those files and print those numbers.</p>
<p>You would start out by reading <code>manifest.txt</code> and splitting the content on the newline character to get the names of the files. That would look like this:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="at">readFile</span>(<span class="st">&#39;manifest.txt&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> manifest) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="kw">const</span> fileNames <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4">  <span class="co">// More to come</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now that you have the list of file names, you can loop over them to read each of those files. As each of those files are read, you want to count the characters in each file. Imagine that you already have the function named <code>countCharacters</code> somewhere. The looping code could look like this:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="at">readFile</span>(<span class="st">&#39;manifest.txt&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> manifest) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="kw">const</span> fileNames <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb17-3" title="3">  <span class="kw">const</span> characterCounts <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb17-4" title="4"></a>
<a class="sourceLine" id="cb17-5" title="5">  <span class="co">// Loop over each file name</span></a>
<a class="sourceLine" id="cb17-6" title="6">  <span class="cf">for</span> (<span class="kw">let</span> fileName <span class="kw">of</span> fileNames) <span class="op">{</span></a>
<a class="sourceLine" id="cb17-7" title="7">    <span class="co">// Read that file&#39;s content</span></a>
<a class="sourceLine" id="cb17-8" title="8">    <span class="at">readFile</span>(fileName<span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> content) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb17-9" title="9">      <span class="co">// Count the characters and store it in</span></a>
<a class="sourceLine" id="cb17-10" title="10">      <span class="co">// characterCounts</span></a>
<a class="sourceLine" id="cb17-11" title="11">      <span class="at">countCharacters</span>(characterCounts<span class="op">,</span> content)<span class="op">;</span></a>
<a class="sourceLine" id="cb17-12" title="12">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb17-13" title="13">  <span class="op">}</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>At this point, you feel pretty good. There’s only one thing left to do: print out the total of all the characters in the files. So, where do you put that <code>console.log</code> statement?</p>
<p>This is kind of a trick question because there’s no place to put it in the way the code works now.</p>
<p>If you put it here:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="at">readFile</span>(<span class="st">&#39;manifest.txt&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> manifest) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="kw">const</span> fileNames <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-3" title="3">  <span class="kw">const</span> characterCounts <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb18-4" title="4"></a>
<a class="sourceLine" id="cb18-5" title="5">  <span class="co">// Loop over each file name</span></a>
<a class="sourceLine" id="cb18-6" title="6">  <span class="cf">for</span> (<span class="kw">let</span> fileName <span class="kw">of</span> fileNames) <span class="op">{</span></a>
<a class="sourceLine" id="cb18-7" title="7">    <span class="co">// Read that file&#39;s content</span></a>
<a class="sourceLine" id="cb18-8" title="8">    <span class="at">readFile</span>(fileName<span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> content) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-9" title="9">      <span class="co">// Count the characters and store it in</span></a>
<a class="sourceLine" id="cb18-10" title="10">      <span class="co">// characterCounts</span></a>
<a class="sourceLine" id="cb18-11" title="11">      <span class="at">countCharacters</span>(characterCounts<span class="op">,</span> content)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-12" title="12">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-13" title="13">  <span class="op">}</span></a>
<a class="sourceLine" id="cb18-14" title="14"></a>
<a class="sourceLine" id="cb18-15" title="15">  <span class="co">// MY PRINT STATEMENT HERE</span></a>
<a class="sourceLine" id="cb18-16" title="16">  <span class="va">console</span>.<span class="at">log</span>(characterCounts)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>then you will get the output <code>{}</code> every time because the code in the inner <code>readFile</code>s doesn’t run until after the <code>console.log</code> because <code>readFile</code> doesn’t run the function with the arguments <code>(err, content)</code> until <em>after</em> the file is read and the current function completes.</p>
<p>If you put it here:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb19-1" title="1"><span class="at">readFile</span>(<span class="st">&#39;manifest.txt&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> manifest) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb19-2" title="2">  <span class="kw">const</span> fileNames <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-3" title="3">  <span class="kw">const</span> characterCounts <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb19-4" title="4"></a>
<a class="sourceLine" id="cb19-5" title="5">  <span class="co">// Loop over each file name</span></a>
<a class="sourceLine" id="cb19-6" title="6">  <span class="cf">for</span> (<span class="kw">let</span> fileName <span class="kw">of</span> fileNames) <span class="op">{</span></a>
<a class="sourceLine" id="cb19-7" title="7">    <span class="co">// Read that file&#39;s content</span></a>
<a class="sourceLine" id="cb19-8" title="8">    <span class="at">readFile</span>(fileName<span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> content) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb19-9" title="9">      <span class="co">// Count the characters and store it in</span></a>
<a class="sourceLine" id="cb19-10" title="10">      <span class="co">// characterCounts</span></a>
<a class="sourceLine" id="cb19-11" title="11">      <span class="at">countCharacters</span>(characterCounts<span class="op">,</span> content)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-12" title="12"></a>
<a class="sourceLine" id="cb19-13" title="13">      <span class="co">// MY PRINT STATEMENT HERE</span></a>
<a class="sourceLine" id="cb19-14" title="14">      <span class="va">console</span>.<span class="at">log</span>(characterCounts)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-15" title="15">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-16" title="16">  <span class="op">}</span></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>then it will print the number of times that your code reads a file. That’s not what you want, either. To get it to work, you have to count the number of files that have been read each time one completes. Then, you only print when that number equals the total number of files to be read. The code could like this:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="at">readFile</span>(<span class="st">&#39;manifest.txt&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> manifest) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="kw">const</span> fileNames <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-3" title="3">  <span class="kw">const</span> characterCounts <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb20-4" title="4">  <span class="kw">let</span> numberOfFilesRead <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-5" title="5"></a>
<a class="sourceLine" id="cb20-6" title="6">  <span class="co">// Loop over each file name</span></a>
<a class="sourceLine" id="cb20-7" title="7">  <span class="cf">for</span> (<span class="kw">let</span> fileName <span class="kw">of</span> fileNames) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-8" title="8">    <span class="co">// Read that file&#39;s content</span></a>
<a class="sourceLine" id="cb20-9" title="9">    <span class="at">readFile</span>(fileName<span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> content) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb20-10" title="10">      <span class="co">// Count the characters and store it in</span></a>
<a class="sourceLine" id="cb20-11" title="11">      <span class="co">// characterCounts</span></a>
<a class="sourceLine" id="cb20-12" title="12">      <span class="at">countCharacters</span>(characterCounts<span class="op">,</span> content)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-13" title="13"></a>
<a class="sourceLine" id="cb20-14" title="14">      <span class="co">// Increment the number of files read</span></a>
<a class="sourceLine" id="cb20-15" title="15">      numberOfFilesRead <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-16" title="16"></a>
<a class="sourceLine" id="cb20-17" title="17">      <span class="co">// If the number of files read is equal to the</span></a>
<a class="sourceLine" id="cb20-18" title="18">      <span class="co">// number of files to read, then print because</span></a>
<a class="sourceLine" id="cb20-19" title="19">      <span class="co">// you&#39;re done!</span></a>
<a class="sourceLine" id="cb20-20" title="20">      <span class="cf">if</span> (numberOfFilesRead <span class="op">===</span> <span class="va">fileNames</span>.<span class="at">length</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-21" title="21">        <span class="va">console</span>.<span class="at">log</span>(characterCounts)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-22" title="22">      <span class="op">}</span></a>
<a class="sourceLine" id="cb20-23" title="23">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-24" title="24">  <span class="op">}</span></a>
<a class="sourceLine" id="cb20-25" title="25"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The asynchronous nature of this code requires you to do a lot of housekeeping just to figure out when everything is done. Imagine writing this code and going back to it in six months to add a new feature. It’s not the clearest code in the world, even with code comments. That leads to a maintenance nightmare. The JavaScript community wanted a way to code better and clearer.</p>
<p><a name="designing-a-better-solution"></a> ## Designing a better solution</p>
<p>Look at the following code that has numbers in the order in which the <code>console.log</code> statements are run. It will print out "Q", "W", "E", "R", and "T" on separate lines.†</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Q&#39;</span>)<span class="op">;</span> <span class="co">//---- 1</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb21-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;E&#39;</span>)<span class="op">;</span> <span class="co">//-- 3</span></a>
<a class="sourceLine" id="cb21-4" title="4">  <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb21-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;T&#39;</span>)<span class="op">;</span> <span class="co">// 5</span></a>
<a class="sourceLine" id="cb21-6" title="6">  <span class="op">},</span> <span class="dv">100</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-7" title="7">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;R&#39;</span>)<span class="op">;</span> <span class="co">//-- 4</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="op">},</span> <span class="dv">200</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;W&#39;</span>)<span class="op">;</span> <span class="co">//---- 2</span></a></code></pre></div>
<p>What would really help is if you could get those numbers in order so that what appears in the code at least <strong>appears</strong> to be synchronous even though it might be asynchronous in nature. As humans, we understand things from top-to-bottom much better than in the order 1, 3, 5, 4, 2.</p>
<p>Reordering the code above to reflect how it really runs, you’d get this somewhat more maintainable block.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Q&#39;</span>)<span class="op">;</span> <span class="co">//---- 1</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;W&#39;</span>)<span class="op">;</span> <span class="co">//---- 2</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb22-4" title="4">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;E&#39;</span>)<span class="op">;</span> <span class="co">//-- 3</span></a>
<a class="sourceLine" id="cb22-5" title="5">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;R&#39;</span>)<span class="op">;</span> <span class="co">//-- 4</span></a>
<a class="sourceLine" id="cb22-6" title="6">  <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb22-7" title="7">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;T&#39;</span>)<span class="op">;</span> <span class="co">// 5</span></a>
<a class="sourceLine" id="cb22-8" title="8">  <span class="op">},</span> <span class="dv">100</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="op">},</span> <span class="dv">200</span>)<span class="op">;</span></a></code></pre></div>
<p>But, now you’re stuck with those human-necessary indents to understand the function calls that occur in the code. And, to know how long the <code>setTimeout</code>s run, you have to go way to the bottom of the code blocks. The JavaScript community agreed with you and decided it’d be great if they could somehow just chain a bunch of those things together without the indentation, something like this. (The function names are completely invented for this code block.);</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="at">log</span>(<span class="st">&#39;Q&#39;</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">log</span>(<span class="st">&#39;W&#39;</span>))</a>
<a class="sourceLine" id="cb23-3" title="3">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">pause</span>(<span class="dv">200</span>))</a>
<a class="sourceLine" id="cb23-4" title="4">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">log</span>(<span class="st">&#39;E&#39;</span>))</a>
<a class="sourceLine" id="cb23-5" title="5">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">log</span>(<span class="st">&#39;R&#39;</span>))</a>
<a class="sourceLine" id="cb23-6" title="6">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">pause</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb23-7" title="7">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">log</span>(<span class="st">&#39;T&#39;</span>))<span class="op">;</span></a></code></pre></div>
<p>The JavaScript community realized that they’d have to use functions in the <code>then</code> blocks lest the function be immediately invoked. Remember, a function declaration is not invoked when interpreted. That means each function in each of the <code>then</code> calls is passed into the <code>then</code> function for it to run at a later time, presumably when the previous thing finishes, a previous <code>log</code> or <code>pause</code> in this example. They decided to create a new kind of abstraction in JavaScript named the "Promise".</p>
<p><a name="so-what-is-a-promise"></a> ## So, what is a "Promise"?</p>
<p>Look at a line of code using the <code>readFile</code> method found in Node.js. Don’t worry if you don’t know the specifics about this function. It’s the <em>form</em> of the code to which you should draw your attention.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb24-1" title="1"><span class="at">readFile</span>(<span class="st">&#39;manifest.txt&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> (err<span class="op">,</span> manifest) <span class="kw">=&gt;</span> <span class="op">{</span></a></code></pre></div>
<p>You could interpret that line of code as "Read the file named"manifest.txt" and, when done, call the method that is declared with <code>(err, manifest) =&gt; {</code>.</p>
<p>The important part to understand is the "when done, call the method…". That’s the part that’s potentially asynchronous, the part that is beyond your control. When it calls that function, it will either provide an error in the <code>err</code> parameter or a value in the <code>manifest</code> parameter. When you change it to the <code>then</code> version, you still get the same kind of guarantee: eventually, you will get an error or the value of the operation. So that’s what a <code>Promise</code> is.</p>
<blockquote>
<p>A <code>Promise</code> in JavaScript is a commitment that sometime in the future, your code will get <strong>a value</strong> from some operation (like reading a file or getting JSON from a Web site) or your code will get <strong>an error</strong> from that operation (like the file doesn’t exist or the Web site is down).</p>
</blockquote>
<p>Promises can exist in three states. They are:</p>
<ul>
<li><strong>Pending</strong>: The <code>Promise</code> object has not resolved. Once it does, the state of the <code>Promise</code> object may transition to either the fulfilled or rejected state.</li>
<li><strong>Fulfilled</strong>: Whatever operation the <code>Promise</code> represented succeeded and your success handler will get called. Now that it’s <em>fulfilled</em>, the <code>Promise</code>:
<ul>
<li>must not transition to any other state.</li>
<li>must have a value, which must not change.</li>
</ul></li>
<li><strong>Rejected</strong>: Whatever operation the <code>Promise</code> represented failed and your error handler will get called. Now that it’s <em>rejected</em>, the <code>Promise</code>:
<ul>
<li>must not transition to any other state.</li>
<li>must have a reason, which must not change.</li>
</ul></li>
</ul>
<p><code>Promise</code> objects have the following methods available on them so that you can handle the state change from <em>pending</em> to either <em>fulfilled</em> or <em>rejected</em>.</p>
<ul>
<li><code>then(successHandler, errorHandler)</code> is a way to handle a <code>Promise</code> when it leaves the <em>pending</em> state.</li>
<li><code>catch(errorHandler)</code></li>
</ul>
<p>The handlers mentioned in the previous list are:</p>
<ul>
<li><strong>Success Handler</strong> is a function that has one parameter, the value that a <em>fulfilled</em> <code>Promise</code> has.</li>
<li><strong>Error Handler</strong> is a function that has one parameter, the reason that the <code>Promise</code> failed.</li>
</ul>
<p>We’ll elaborate on these methods in part two of this article.</p>
<h2 id="what-youve-learned-1">What you’ve learned</h2>
<p>In this reading, you learned some fancy new things that allows you to turn asynchronous code into seemingly synchronous-looking code. You did that by learning that…</p>
<ul>
<li>A <code>Promise</code> in JavaScript is a commitment that sometime in the future, your code will get <strong>a value</strong> from some operation (like reading a file or getting JSON from a Web site) or your code will get <strong>an error</strong> from that operation (like the file doesn’t exist or the Web site is down).</li>
</ul>
<p>†: One can argue that the code following this statement is already very bad and shouldn’t be written that way. I would agree. Please don’t write code like that. It is <em>only</em> for demonstration purposes. However, do not be surprised if you find <strong>someone else</strong> wrote code like that. ;-)</p>
<hr />
<h1 id="a-promise-is-a-promise-a-mostly-complete-guide-to-javascript-promises-ii">A Promise is a Promise: A Mostly Complete Guide to JavaScript Promises II</h1>
<p>This is part two of an article about classic JavaScript promises. If you have not read part one, we recommend that you navigate to the previous task to do so.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Create your own <code>Promise</code>s</li>
<li>Use <code>Promise</code> objects returned by language and framework libraries</li>
</ul>
<h2 id="handling-success-with-then">Handling success with <code>then</code></h2>
<p>Returning to another file-reading example, consider the following block of code.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb25-1" title="1"><span class="at">readFile</span>(<span class="st">&quot;manifest.txt&quot;</span><span class="op">,</span> <span class="st">&quot;utf8&quot;</span><span class="op">,</span> (err<span class="op">,</span> manifest) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb25-2" title="2">  <span class="cf">if</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb25-3" title="3">    <span class="va">console</span>.<span class="at">error</span>(<span class="st">&quot;Badness happened&quot;</span><span class="op">,</span> err)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-4" title="4">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb25-5" title="5">    <span class="kw">const</span> fileList <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-6" title="6">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Reading&quot;</span><span class="op">,</span> <span class="va">fileList</span>.<span class="at">length</span><span class="op">,</span> <span class="st">&quot;files&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>If this succeeds, then you would expect a statement like "Reading 12 files" to appear if the file contained a list of 12 files.</p>
<p>Now, to rewrite that using a <code>Promise</code> and printing that same statement, you would get a file-reading function that returns a <code>Promise</code> object. Later on, you’ll see how to create one for yourself. At this moment, just presume that a function named <code>readFilePromise</code> exists. When you call it, it would return a promise that, when <em>fulfilled</em>, would invoke the success handler registered for the object through the <code>then</code> method. Very explicitly, you could write that code like this.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb26-1" title="1"><span class="co">/* EXPLICIT CODE: NOT FOR REAL USE */</span></a>
<a class="sourceLine" id="cb26-2" title="2"></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co">// Declare a function that will handle the content of</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co">// the file read by readFilePromise.</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="kw">function</span> <span class="at">readFileSuccessHandler</span>(manifest) <span class="op">{</span></a>
<a class="sourceLine" id="cb26-6" title="6">  <span class="kw">const</span> fileList <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-7" title="7">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Reading&quot;</span><span class="op">,</span> <span class="va">fileList</span>.<span class="at">length</span><span class="op">,</span> <span class="st">&quot;files&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb26-9" title="9"></a>
<a class="sourceLine" id="cb26-10" title="10"><span class="co">// Get a promise that will return the contents of the</span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="co">// file.</span></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="kw">const</span> filePromise <span class="op">=</span> <span class="at">readFilePromise</span>(<span class="st">&quot;manifest.txt&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-13" title="13"></a>
<a class="sourceLine" id="cb26-14" title="14"><span class="co">// Register a success handler to process the contents</span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="co">// of the file. In this case, it is the function</span></a>
<a class="sourceLine" id="cb26-16" title="16"><span class="co">// defined above.</span></a>
<a class="sourceLine" id="cb26-17" title="17"><span class="va">filePromise</span>.<span class="at">then</span>(readFileSuccessHandler)<span class="op">;</span></a></code></pre></div>
<p>Most <code>Promise</code>-based code does <strong>not</strong> look like that, though. Idiomatic JavaScript instructs to not create variables that don’t need to be created. You would see the above code in a real-live code base written like this, instead. Spend a moment comparing and contrasting the forms from <strong>very explicit</strong> to <strong>idiomatic</strong>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb27-1" title="1"><span class="at">readFilePromise</span>(<span class="st">&quot;manifest.txt&quot;</span>).<span class="at">then</span>(manifest <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb27-2" title="2">  <span class="kw">const</span> fileList <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb27-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Reading&quot;</span><span class="op">,</span> <span class="va">fileList</span>.<span class="at">length</span><span class="op">,</span> <span class="st">&quot;files&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>That’s slightly easier to read than the weird callback thing you had above. But, you still have that nasty double indentation. The designers of the <code>Promise</code> didn’t want that for you, so they allow you to chain <code>then</code>s.</p>
<h2 id="chaining-thens.">Chaining <code>then</code>s.</h2>
<p>In the above code that uses <code>readFilePromise</code>, it does not look like the ideal code that JavaScript could give us because of the success-handling function being on multiple lines that require another indent. It may be a little thing, but it still prevents you from the most readable code. Again, the Technical Committee 39 had your back. They designed "chainable thens" for you. The rules are a little complex to read.</p>
<ul>
<li>Each <code>Promise</code> has a <code>then</code> method that handles what happens when the <code>Promise</code> transitions out of the <strong>pending</strong> state.</li>
<li>Each <code>then</code> method returns a <code>Promise</code> that transitions out of its <strong>pending</strong> state when the <code>then</code> that created it completes.</li>
<li>(One more condition described below.)</li>
</ul>
<p>That chaining property gives you the ability to break apart the two lines of the success handler in the previous example to two one-line functions that do the same thing with less code! If you write that form explicitly, you’d have the following.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb28-1" title="1"><span class="co">/* EXPLICIT CODE: NOT FOR REAL USE */</span></a>
<a class="sourceLine" id="cb28-2" title="2"></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co">// Get a Promise that fulfills when the file is read</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="co">// with the value of the content of the file.</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="kw">const</span> filePromise <span class="op">=</span> <span class="at">readFilePromise</span>(<span class="st">&quot;manifest.txt&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb28-6" title="6"></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="co">// Register a success handler that takes the fulfilled</span></a>
<a class="sourceLine" id="cb28-8" title="8"><span class="co">// value of the filePromise in the parameter named &quot;manifest&quot;,</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="co">// which is the content of the file, split it on newline</span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="co">// characters, and return a Promise whose fulfilled value is</span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="co">// list of lines.</span></a>
<a class="sourceLine" id="cb28-12" title="12"><span class="kw">const</span> fileListPromise <span class="op">=</span> <span class="va">filePromise</span>.<span class="at">then</span>(manifest <span class="kw">=&gt;</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb28-13" title="13"></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="co">// Register a success handler to the fileListPromise that</span></a>
<a class="sourceLine" id="cb28-15" title="15"><span class="co">// receives the fulfilled value in the &quot;fileList&quot; parameter</span></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="co">// and returns a Promise whose fulfilled value is the length </span></a>
<a class="sourceLine" id="cb28-17" title="17"><span class="co">// of the fileList array.</span></a>
<a class="sourceLine" id="cb28-18" title="18"><span class="kw">const</span> lengthPromise <span class="op">=</span> <span class="va">fileListPromise</span>.<span class="at">then</span>(fileList <span class="kw">=&gt;</span> <span class="va">fileList</span>.<span class="at">length</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb28-19" title="19"></a>
<a class="sourceLine" id="cb28-20" title="20"><span class="co">// Register a success handler to the lengthPromise that</span></a>
<a class="sourceLine" id="cb28-21" title="21"><span class="co">// receives the fulfilled value in the &quot;numberOfFiles&quot; parameter</span></a>
<a class="sourceLine" id="cb28-22" title="22"><span class="co">// and uses it to print the number of files to be read.</span></a>
<a class="sourceLine" id="cb28-23" title="23"><span class="va">lengthPromise</span>.<span class="at">then</span>(numberOfFiles <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb28-24" title="24">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Reading&quot;</span><span class="op">,</span> numberOfFiles<span class="op">,</span> <span class="st">&quot;files&quot;</span>)</a>
<a class="sourceLine" id="cb28-25" title="25">)<span class="op">;</span></a></code></pre></div>
<p>That code block has a lot of words to describe what happens at each step of the process of using "chainable thens". In the real world, were you to find that code in a real application, it would likely look like the following.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb29-1" title="1"><span class="at">readFilePromise</span>(<span class="st">&quot;manifest.txt&quot;</span>)</a>
<a class="sourceLine" id="cb29-2" title="2">  .<span class="at">then</span>(manifest <span class="kw">=&gt;</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</a>
<a class="sourceLine" id="cb29-3" title="3">  .<span class="at">then</span>(fileList <span class="kw">=&gt;</span> <span class="va">fileList</span>.<span class="at">length</span>)</a>
<a class="sourceLine" id="cb29-4" title="4">  .<span class="at">then</span>(numberOfFiles <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Reading&quot;</span><span class="op">,</span> numberOfFiles<span class="op">,</span> <span class="st">&quot;files&quot;</span>))<span class="op">;</span></a></code></pre></div>
<p>Here’s a diagram of what happens in the above code.</p>
<p>
<img src="images/promise-success-diagram-source.svg" alt="promise errors" style="width: 100%; height: auto">
</p>
<p>You can see that each call to <code>then</code> creates a new <code>Promise</code> object that resolves to the value of the output of the previous success handler. That’s what happens when everything works out. What happens when it doesn’t?</p>
<h2 id="handling-failure-with-then">Handling failure with <code>then</code></h2>
<p>As you may recall from the section <a href="#so-what-is-a-promise">So, what is a "Promise"?</a>, you learned that the <code>then</code> method can also accept a second argument that is an error handler that takes care of things should something go wrong. Back to the file reading example from above, you add a second method to the <code>then</code> which accepts a <strong>reason</strong> that the error happened. For reading a file, that could be that the file doesn’t exist, the current user doesn’t have permissions to read it, or it ran out of memory trying to read a <em>huge</em> file.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb30-1" title="1"><span class="at">readFilePromise</span>(<span class="st">&quot;manifest.txt&quot;</span>).<span class="at">then</span>(</a>
<a class="sourceLine" id="cb30-2" title="2">  manifest <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb30-3" title="3">    <span class="kw">const</span> fileList <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb30-4" title="4">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Reading&quot;</span><span class="op">,</span> <span class="va">fileList</span>.<span class="at">length</span><span class="op">,</span> <span class="st">&quot;files&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb30-5" title="5">  <span class="op">},</span></a>
<a class="sourceLine" id="cb30-6" title="6">  reason <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb30-7" title="7">    <span class="va">console</span>.<span class="at">error</span>(<span class="st">&quot;Badness happened&quot;</span><span class="op">,</span> reason)<span class="op">;</span></a>
<a class="sourceLine" id="cb30-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb30-9" title="9">)<span class="op">;</span></a></code></pre></div>
<p>That works, but has taken you back to the original bad multiline form of the success handler. What happens if you did it like this? How does this work?</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb31-1" title="1"><span class="at">readFilePromise</span>(<span class="st">&quot;manifest.txt&quot;</span>)</a>
<a class="sourceLine" id="cb31-2" title="2">  .<span class="at">then</span>(</a>
<a class="sourceLine" id="cb31-3" title="3">    manifest <span class="kw">=&gt;</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb31-4" title="4">    reason <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">err</span>(<span class="st">&quot;Badness happened&quot;</span><span class="op">,</span> reason)</a>
<a class="sourceLine" id="cb31-5" title="5">  )</a>
<a class="sourceLine" id="cb31-6" title="6">  .<span class="at">then</span>(fileList <span class="kw">=&gt;</span> <span class="va">fileList</span>.<span class="at">length</span>)</a>
<a class="sourceLine" id="cb31-7" title="7">  .<span class="at">then</span>(numberOfFiles <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Reading&quot;</span><span class="op">,</span> numberOfFiles<span class="op">,</span> <span class="st">&quot;files&quot;</span>))<span class="op">;</span></a></code></pre></div>
<p>Here’s what happens with regard to the <code>Promise</code>s in this chain of <code>then</code>s.</p>
<p>
<img src="images/promise-error-diagram-source.svg" alt="promise errors" style="width: 100%; height: auto">
</p>
<p>As you can see, the first <code>Promise</code> object from the <code>readFilePromise</code> function goes into the <strong>rejected</strong> state because, according to the error message, the file didn’t exist at the time the system tried to read it. That reason is represented as an object that has a code of "ENOENT" which a Unix error code and a message that provides a human-readable explanation of the error. That error reason object gets passed to the error handler of the first <code>then</code>. It’s what happens after that that is crazy neat.</p>
<p>The second <code>Promise</code> object is <strong>fulfilled</strong>! Because the first <code>then</code> doesn’t have any errors, because the error handler in the first then completes without any problem (printing out the error reason), the <code>Promise</code> returned by that <code>then</code> <em>does not</em> get <strong>rejected</strong>. Because of that, the <code>Promise</code> resolves with the value returned by the <code>console.error('Badness happened', err)</code> call. The <code>console.error</code> method returns <code>undefined</code>, so that becomes the value passed into the next <code>then</code> handler.</p>
<p>Because the second <code>then</code> success handler relies on an object with a <code>length</code> property, when it runs, an exception gets raised because the <code>undefined</code> value has no <code>length</code> property. This causes the <code>Promise</code> returned by the second <code>then</code> to become <strong>rejected</strong> because the code threw an exception.</p>
<p>Because that <code>Promise</code> is in the <strong>rejected</strong> state, it attempts to run the error handler of the next (third) <code>then</code>. There is no error handler. In the browser, it just looks like nothing happened. In Node.js, an <code>UnhandledPromiseRejectionWarning</code> is emitted to the console. In a future version of Node.js, it will cause the process to terminate with an exit code indicating an error bringing your service to a halt.</p>
<p>To correctly handle the exception of no file to read and still have all of the other lines of code run properly, you should write the following code.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb32-1" title="1"><span class="at">readFilePromise</span>(<span class="st">&quot;manifest.txt&quot;</span>)</a>
<a class="sourceLine" id="cb32-2" title="2">  .<span class="at">then</span>(manifest <span class="kw">=&gt;</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</a>
<a class="sourceLine" id="cb32-3" title="3">  .<span class="at">then</span>(fileList <span class="kw">=&gt;</span> <span class="va">fileList</span>.<span class="at">length</span>)</a>
<a class="sourceLine" id="cb32-4" title="4">  .<span class="at">then</span>(</a>
<a class="sourceLine" id="cb32-5" title="5">    numberOfFiles <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Reading&quot;</span><span class="op">,</span> numberOfFiles<span class="op">,</span> <span class="st">&quot;files&quot;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb32-6" title="6">    reason <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">err</span>(<span class="st">&quot;Badness happened&quot;</span><span class="op">,</span> reason)</a>
<a class="sourceLine" id="cb32-7" title="7">  )<span class="op">;</span></a></code></pre></div>
<p>Now, if an error occurs, the chain of <code>then</code>s evaluates like this:</p>
<ol type="1">
<li>First <code>then</code>: I do not have an error handler. I will pass the error on and not run the success handler.</li>
<li>Second <code>then</code>: I do not have an error handler. I will pass the error on and not run the success handler.</li>
<li>Third <code>then</code>: I have an error handler and will run it.</li>
</ol>
<p>Now, the code looks almost like you’d imagined back in the <a href="#designing-a-better-solution">Designing a better solution</a> section. There’s still that annoying last double handler code that makes us use indentation and passing in two function objects to a <code>then</code> which looks kind of yucky. The Technical Committee gave you a solution for that, too.</p>
<blockquote>
<p><code>then</code> can handle both success and failures. The success handler is called with the value of the operation of the <code>Promise</code> when the <code>Promise</code> object transitions to the <strong>fulfilled</strong> state. If an error condition occurs, them the error handler of the <code>then</code> is called.</p>
<p>If a <code>Promise</code> object transitions to the <strong>rejected</strong> state and no error handler exists for the <code>then</code>, then that <code>then</code> is skipped altogether.</p>
<p>If an error handler is called and does not raise an exception, then the next <code>Promise</code> object transitions to the <strong>fulfilled</strong> state and the next success handler is called.</p>
</blockquote>
<h2 id="handling-failure-with-catch">Handling failure with <code>catch</code></h2>
<p>Rather than using a <code>then</code> with a success and error handler, you can use the similar <code>catch</code> method that takes just an error handler. By doing that, the code from the last section ends up looking like this.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb33-1" title="1"><span class="at">readFilePromise</span>(<span class="st">&quot;manifest.txt&quot;</span>)</a>
<a class="sourceLine" id="cb33-2" title="2">  .<span class="at">then</span>(manifest <span class="kw">=&gt;</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</a>
<a class="sourceLine" id="cb33-3" title="3">  .<span class="at">then</span>(fileList <span class="kw">=&gt;</span> <span class="va">fileList</span>.<span class="at">length</span>)</a>
<a class="sourceLine" id="cb33-4" title="4">  .<span class="at">then</span>(numberOfFiles <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Reading&quot;</span><span class="op">,</span> numberOfFiles<span class="op">,</span> <span class="st">&quot;files&quot;</span>))</a>
<a class="sourceLine" id="cb33-5" title="5">  .<span class="at">catch</span>(reason <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">err</span>(<span class="st">&quot;Badness happened&quot;</span><span class="op">,</span> reason))<span class="op">;</span></a></code></pre></div>
<p>That is exactly what the design expressed. The <code>catch</code> acts just like an error handler in the last <code>then</code>. If the <code>catch</code> doesn’t throw an exception, then it returns a <code>Promise</code> in a fulfilled state with whatever the return value is, just like the error handler of a <code>then</code>.</p>
<blockquote>
<p><code>catch</code> is a convenient way to do error handling in a <code>then</code> chain that looks kind of like part of a try/catch block.</p>
</blockquote>
<h2 id="using-promise.all-for-many-future-values">Using <code>Promise.all</code> for many future values</h2>
<p>You’re almost to the place where you can read the manifest file, get the list, and then count the characters in each of the files, and print out the result. You need to learn about two more features of JavaScript <code>Promise</code>s.</p>
<p>Imagine that you have three files that you want to read with the <code>readFilePromise</code> method. You want to wait until all three are done, but let them read files simultaneously. How do you manage all three <code>Promise</code>s as one <code>Promise</code>? That’s what the <code>Promise.all</code> method allows you to do.</p>
<p>For example, imagine you have the following array.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">const</span> values <span class="op">=</span> [</a>
<a class="sourceLine" id="cb34-2" title="2">  <span class="at">readFilePromise</span>(<span class="st">&quot;file-boop.txt&quot;</span>)<span class="op">,</span> <span class="co">// this is a Promise object: pending</span></a>
<a class="sourceLine" id="cb34-3" title="3">  <span class="at">readFilePromise</span>(<span class="st">&quot;file-doop.txt&quot;</span>)<span class="op">,</span> <span class="co">// this is a Promise object: pending</span></a>
<a class="sourceLine" id="cb34-4" title="4">  <span class="at">readFilePromise</span>(<span class="st">&quot;file-goop.txt&quot;</span>)<span class="op">,</span> <span class="co">// this is a Promise object: pending</span></a>
<a class="sourceLine" id="cb34-5" title="5">]<span class="op">;</span></a></code></pre></div>
<p>When you pass that array into <code>Promise.all</code>, it returns a <code>Promise</code> object that manages all of the <code>Promise</code>s in the array!</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">const</span> superPromise <span class="op">=</span> <span class="va">Promise</span>.<span class="at">all</span>(values)<span class="op">;</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">// superPromise is a Promise object in the pending state.</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="co">//</span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="co">// Inside superPromise is an array of Promise objects</span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="co">// that look like this:</span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="co">//</span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="co">// 1. file reading promise in pending state, same as the one passed in</span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="co">// 2. file reading promise in pending state, same as the one passed in</span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co">// 3. file reading promise in pending state, same as the one passed in</span></a></code></pre></div>
<p>When all of the <code>Promise</code> objects in the super <code>Promise</code> transition out of the pending state, then the super <code>Promise</code> will also transition out of the pending state. If any one of the <code>Promise</code> objects in the array transition to the <strong>rejected</strong> state, then the super <code>Promise</code> will immediately transition to the <strong>rejected</strong> state with the same reason as the inner <code>Promise</code> failed with. If <em>all</em> of the internal <code>Promise</code> objects transition to the <strong>fulfilled</strong> state, then the super <code>Promise</code> will transition to the <strong>fulfilled</strong> state and its value will be an array of <em>all</em> of the resolved values of the original array.</p>
<p>With that in mind, you could continue the above code with a <code>then</code> and a <code>catch</code> that would demonstrate what happens.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb36-1" title="1">superPromise</a>
<a class="sourceLine" id="cb36-2" title="2">  .<span class="at">then</span>(values <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(values))</a>
<a class="sourceLine" id="cb36-3" title="3">  .<span class="at">catch</span>(reason <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">error</span>(reason))<span class="op">;</span></a>
<a class="sourceLine" id="cb36-4" title="4"></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="co">// If the function successfully reads the file, the values passed</span></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="co">// to the then come from the values that were in the superPromise</span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="co">//</span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="co">// 1. the content of file-boop.txt</span></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="co">// 2. the content of file-doop.txt</span></a>
<a class="sourceLine" id="cb36-10" title="10"><span class="co">// 3. the content of file-goop.txt</span></a>
<a class="sourceLine" id="cb36-11" title="11"></a>
<a class="sourceLine" id="cb36-12" title="12"><span class="co">// If something goes wrong with reading the file, then the `catch`</span></a>
<a class="sourceLine" id="cb36-13" title="13"><span class="co">// gets called with the error reason from the Promise object that</span></a>
<a class="sourceLine" id="cb36-14" title="14"><span class="co">// first failed.</span></a></code></pre></div>
<blockquote>
<p><code>Promise.all</code> accepts an array of values and returns a new <code>Promise</code> object in the <strong>pending</strong> state colloquially called a "super promise". It converts all non-<code>Promise</code> values into <code>Promise</code> objects that are immediately in the <strong>fulfilled</strong> state. Then,</p>
<ul>
<li>If any one of the <code>Promise</code>s in the array transitions to the <strong>rejected</strong> state, then the "super promise" transitions to the <strong>rejected</strong> state with the same reason that the inner <code>Promise</code> object failed.</li>
<li>If all of the inner <code>Promise</code> objects in the array transition to the <strong>fulfilled</strong> state, then the "super promise" transitions to the <strong>fulfilled</strong> state with a value of an array populated, in order, of the resolved values of the original array.</li>
</ul>
</blockquote>
<h2 id="flattening-promises">Flattening <code>Promises</code></h2>
<p>The last thing you need to learn about <code>Promise</code>s is the coolest feature of them all. If you return a <code>Promise</code> object from either a success or error handler, the next step doesn’t get run until that <code>Promise</code> object resolves! Here’s what happens when you type the following code. It’s step 4 that is the amazing part.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb37-1" title="1"><span class="at">readFilePromise</span>(<span class="st">&quot;manifest.txt&quot;</span>)</a>
<a class="sourceLine" id="cb37-2" title="2">  .<span class="at">then</span>(manifestContent <span class="kw">=&gt;</span> <span class="va">manifestContent</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</a>
<a class="sourceLine" id="cb37-3" title="3">  .<span class="at">then</span>(manifestList <span class="kw">=&gt;</span> manifestList[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb37-4" title="4">  .<span class="at">then</span>(fileName <span class="kw">=&gt;</span> <span class="at">readFilePromise</span>(fileName))</a>
<a class="sourceLine" id="cb37-5" title="5">  .<span class="at">then</span>(otherFileContent <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(otherFileContent))<span class="op">;</span></a>
<a class="sourceLine" id="cb37-6" title="6"></a>
<a class="sourceLine" id="cb37-7" title="7"><span class="co">// Interpreted as:</span></a>
<a class="sourceLine" id="cb37-8" title="8"><span class="co">// 1. Read the file of the manifest.txt file and pass the</span></a>
<a class="sourceLine" id="cb37-9" title="9"><span class="co">//    content to the first then.</span></a>
<a class="sourceLine" id="cb37-10" title="10"><span class="co">// 2. Split the content from manifest.txt on newline chars</span></a>
<a class="sourceLine" id="cb37-11" title="11"><span class="co">//    to get the full list of files.</span></a>
<a class="sourceLine" id="cb37-12" title="12"><span class="co">// 3. Return just the first entry in the list of files.</span></a>
<a class="sourceLine" id="cb37-13" title="13"><span class="co">// 4. RETURN A PROMISE THAT WILL READ THE FILE NAMED ON THE</span></a>
<a class="sourceLine" id="cb37-14" title="14"><span class="co">//    FIRST LINE OF THE manifest.txt! The next then method</span></a>
<a class="sourceLine" id="cb37-15" title="15"><span class="co">//    doesn&#39;t get called until this Promise object completes!</span></a>
<a class="sourceLine" id="cb37-16" title="16"><span class="co">// 5. Get the content of the file just read and print it.</span></a></code></pre></div>
<p>Again, here’s the rule.</p>
<blockquote>
<p>If you return a <code>Promise</code> from a success or error handler, the next handler isn’t called until that <code>Promise</code> completes.</p>
</blockquote>
<h2 id="putting-it-all-together">Putting it all together</h2>
<p>You can now use all of this knowledge to use <code>Promise</code>s to read a manifest file, read each of the files in the manifest files, and count all of the characters in those files with code that reads much better than this.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb38-1" title="1"><span class="at">readFile</span>(<span class="st">&quot;manifest.txt&quot;</span><span class="op">,</span> <span class="st">&quot;utf8&quot;</span><span class="op">,</span> (err<span class="op">,</span> manifest) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb38-2" title="2">  <span class="kw">const</span> fileNames <span class="op">=</span> <span class="va">manifest</span>.<span class="at">split</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb38-3" title="3">  <span class="kw">const</span> characterCounts <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb38-4" title="4">  <span class="kw">let</span> numberOfFilesRead <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb38-5" title="5"></a>
<a class="sourceLine" id="cb38-6" title="6">  <span class="co">// Loop over each file name</span></a>
<a class="sourceLine" id="cb38-7" title="7">  <span class="cf">for</span> (<span class="kw">let</span> fileName <span class="kw">of</span> fileNames) <span class="op">{</span></a>
<a class="sourceLine" id="cb38-8" title="8">    <span class="co">// Read that file&#39;s content</span></a>
<a class="sourceLine" id="cb38-9" title="9">    <span class="at">readFile</span>(fileName<span class="op">,</span> <span class="st">&quot;utf8&quot;</span><span class="op">,</span> (err<span class="op">,</span> content) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb38-10" title="10">      <span class="co">// Count the characters and store it in</span></a>
<a class="sourceLine" id="cb38-11" title="11">      <span class="co">// characterCounts</span></a>
<a class="sourceLine" id="cb38-12" title="12">      <span class="at">countCharacters</span>(characterCounts<span class="op">,</span> content)<span class="op">;</span></a>
<a class="sourceLine" id="cb38-13" title="13"></a>
<a class="sourceLine" id="cb38-14" title="14">      <span class="co">// Increment the number of files read</span></a>
<a class="sourceLine" id="cb38-15" title="15">      numberOfFilesRead <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb38-16" title="16"></a>
<a class="sourceLine" id="cb38-17" title="17">      <span class="co">// If the number of files read is equal to the</span></a>
<a class="sourceLine" id="cb38-18" title="18">      <span class="co">// number of files to read, then print because</span></a>
<a class="sourceLine" id="cb38-19" title="19">      <span class="co">// we&#39;re done!</span></a>
<a class="sourceLine" id="cb38-20" title="20">      <span class="cf">if</span> (numberOfFilesRead <span class="op">===</span> <span class="va">fileNames</span>.<span class="at">length</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb38-21" title="21">        <span class="va">console</span>.<span class="at">log</span>(characterCounts)<span class="op">;</span></a>
<a class="sourceLine" id="cb38-22" title="22">      <span class="op">}</span></a>
<a class="sourceLine" id="cb38-23" title="23">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb38-24" title="24">  <span class="op">}</span></a>
<a class="sourceLine" id="cb38-25" title="25"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Remember that you’ve created a <code>countCharacters</code> methods elsewhere that does the grunt work of counting characters. So, now, if you were to list out the steps that you’d like to have the code perform, you should be able to write a <code>Promise</code>-based chain of <code>then</code>s that does that work.</p>
<ol type="1">
<li>Read <code>manifest.txt</code>.</li>
<li>Split the content into a list of files.</li>
<li>Read the contents of each file.</li>
<li>If all of them succeed, then
<ul>
<li>count the characters in each file and</li>
<li>print the character counts.</li>
</ul></li>
<li>If anything fails, print the error.</li>
</ol>
<p>So, in code, that you would translate that to the following.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">const</span> characterCounts <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="at">readFilePromise</span>(<span class="st">&#39;manifest.txt&#39;</span>)</a>
<a class="sourceLine" id="cb39-3" title="3">  .<span class="at">then</span>(fileContent <span class="kw">=&gt;</span> <span class="va">fileContent</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</a>
<a class="sourceLine" id="cb39-4" title="4">  .<span class="at">then</span>(fileList <span class="kw">=&gt;</span> <span class="va">fileList</span>.<span class="at">map</span>(fileName <span class="kw">=&gt;</span> <span class="at">readFilePromise</span>(fileName)))</a>
<a class="sourceLine" id="cb39-5" title="5">  .<span class="at">then</span>(lotsOfReadFilePromises <span class="kw">=&gt;</span> <span class="va">Promise</span>.<span class="at">all</span>(lotsOfReadFilePromises))</a>
<a class="sourceLine" id="cb39-6" title="6">  .<span class="at">then</span>(contentsArray <span class="kw">=&gt;</span> <span class="va">contentsArray</span>.<span class="at">forEach</span>(c <span class="kw">=&gt;</span> <span class="at">countCharacters</span>(characterCounts<span class="op">,</span> c))</a>
<a class="sourceLine" id="cb39-7" title="7">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(characterCounts))</a>
<a class="sourceLine" id="cb39-8" title="8">  .<span class="at">catch</span>(reason <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">error</span>(reason))<span class="op">;</span></a></code></pre></div>
<p>Through the magic of <code>Promise</code>s, you have now been able to do lots of asynchronous work but make it look synchronous!</p>
<h2 id="creating-your-own-promises">Creating your own <code>Promise</code>s</h2>
<p>Early on, you designed the way <code>Promise</code>s should work to look something like this.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb40-1" title="1"><span class="at">log</span>(<span class="st">&quot;Q&quot;</span>)</a>
<a class="sourceLine" id="cb40-2" title="2">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">log</span>(<span class="st">&quot;W&quot;</span>))</a>
<a class="sourceLine" id="cb40-3" title="3">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">pause</span>(<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb40-4" title="4">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">log</span>(<span class="st">&quot;E&quot;</span>))</a>
<a class="sourceLine" id="cb40-5" title="5">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">log</span>(<span class="st">&quot;R&quot;</span>))</a>
<a class="sourceLine" id="cb40-6" title="6">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">pause</span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb40-7" title="7">  .<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="at">log</span>(<span class="st">&quot;T&quot;</span>))<span class="op">;</span></a></code></pre></div>
<p>That code uses two functions that you can define:</p>
<ul>
<li>a <code>log</code> function that takes a value to print and returns a <code>Promise</code> object that is in the <strong>fulfilled</strong> state; and,</li>
<li>a <code>pause</code> function that takes a number and returns a <code>Promise</code> object that, after the indicated number of seconds, transitions to the <strong>fulfilled</strong> state.</li>
</ul>
<p>Here is a way that you could create those functions.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">function</span> <span class="at">log</span>(message) <span class="op">{</span></a>
<a class="sourceLine" id="cb41-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(message)<span class="op">;</span></a>
<a class="sourceLine" id="cb41-3" title="3">  <span class="cf">return</span> <span class="va">Promise</span>.<span class="at">resolve</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="op">}</span></a></code></pre></div>
<p>The above function logs the message passed to it and, then creates a <code>Promise</code> object already transitioned to the <strong>fulfilled</strong> state. If you provide a value to the resolve method, then that becomes the value of the <code>Promise</code> object.†</p>
<p>The <code>pause</code> method is a little more difficult. You have to create a new <code>Promise</code> object from scratch to pause and then continue. To do that, you will use the <code>Promise</code> constructor.</p>
<p>The <code>Promise</code> constructor accepts a function that has two parameters. Each of those parameters will be functions, themselves. The first parameter is the so-called <strong>resolve</strong> parameter which, when called, transitions the <code>Promise</code> object to the <strong>fulfilled</strong> state. The second parameter is the so-called <strong>reject</strong> parameter which, when called, transitions the <code>Promise</code> object to the <strong>rejected</strong> state.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">function</span> <span class="at">pause</span>(numberOfSeconds) <span class="op">{</span></a>
<a class="sourceLine" id="cb42-2" title="2">  <span class="cf">return</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb42-3" title="3">    <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="at">resolve</span>()<span class="op">,</span> numberOfSeconds <span class="op">*</span> <span class="dv">1000</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb42-4" title="4">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>As you can see from the above code, the <code>new Promise</code> gets a single argument, a two-parameter function that does some asynchronous thing. The two parameters are the <strong>resolve</strong> and the <strong>reject</strong> functions that you can use to transition the state of the <code>Promise</code> object being constructed. In this case, after a certain amount of time, the <code>resolve()</code> method is invoked which transitions the <code>Promise</code> object to the <strong>fulfilled</strong> state. The value is <code>undefined</code> because you’ve passed no value into the <code>resolve()</code> function invocation. If you wanted the <code>Promise</code> to have the value of 6.28, then you would invoke it like this <code>resolve(6.28)</code>. You can pass any one value into the <code>resolve</code> function, be it a number, a boolean, an array, an object, or whatever.</p>
<p>With that knowledge, think about how you would write a function using the <code>readFile</code> function that would return a <code>Promise</code> object that would resolve to the contents of the file on success and reject the <code>Promise</code> if an error occurred. Take a moment to scratch that out into an editor or something.</p>
<p>If you wrote something similar to the following, then you did a great job! If you didn’t, work through the following in a Node.js JavaScript environment to figure out how it works. You can use it like in any of the above examples.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">const</span> <span class="op">{</span> readFile <span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;fs&quot;</span>)<span class="op">;</span> <span class="co">// This is just the way to get</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="co">// the readFile method into the</span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="co">// current file. If you don&#39;t</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="co">// understand it, that&#39;s ok.</span></a>
<a class="sourceLine" id="cb43-5" title="5"></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="kw">function</span> <span class="at">readFilePromise</span>(path) <span class="op">{</span></a>
<a class="sourceLine" id="cb43-7" title="7">  <span class="cf">return</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb43-8" title="8">    <span class="at">readFile</span>(path<span class="op">,</span> <span class="st">&quot;utf8&quot;</span><span class="op">,</span> (err<span class="op">,</span> content) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb43-9" title="9">      <span class="cf">if</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb43-10" title="10">        <span class="at">reject</span>(err)<span class="op">;</span></a>
<a class="sourceLine" id="cb43-11" title="11">      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb43-12" title="12">        <span class="at">resolve</span>(content)<span class="op">;</span></a>
<a class="sourceLine" id="cb43-13" title="13">      <span class="op">}</span></a>
<a class="sourceLine" id="cb43-14" title="14">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb43-15" title="15">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb43-16" title="16"><span class="op">}</span></a></code></pre></div>
<h2 id="what-youve-learned-2">What you’ve learned</h2>
<p>In this reading, you learned some fancy new things that let’s you turn asynchronous code into seemingly synchronous-looking code. You did that by learning that…</p>
<ul>
<li><code>then</code> can handle both success and failures. The success handler is called with the value of the operation of the <code>Promise</code> when the <code>Promise</code> object transitions to the <strong>fulfilled</strong> state. If an error condition occurs, them the error handler of the <code>then</code> is called.</li>
<li>If a <code>Promise</code> object transitions to the <strong>rejected</strong> state and no error handler exists for the <code>then</code>, then that <code>then</code> is skipped altogether.</li>
<li>If an error handler is called and does not raise an exception, then the next <code>Promise</code> object transitions to the <strong>fulfilled</strong> state and the next success handler is called.</li>
<li><code>catch</code> is a convenient way to do error handling in a <code>then</code> chain that looks kind of like part of a try/catch block.</li>
<li><code>Promise.all</code> accepts an array of values and returns a new <code>Promise</code> object in the <strong>pending</strong> state colloquially called a "super promise". It converts all non-<code>Promise</code> values into <code>Promise</code> objects that are immediately in the <strong>fulfilled</strong> state. Then,
<ul>
<li>If any one of the <code>Promise</code>s in the array transitions to the <strong>rejected</strong> state, then the "super promise" transitions to the <strong>rejected</strong> state with the same reason that the inner <code>Promise</code> object failed.</li>
<li>If all of the inner <code>Promise</code> objects in the array transition to the <strong>fulfilled</strong> state, then the "super promise" transitions to the <strong>fulfilled</strong> state with a value of an array populated, in order, of the resolved values of the original array.</li>
</ul></li>
<li>If you return a <code>Promise</code> from a success or error handler, the next handler isn’t called until that <code>Promise</code> completes.</li>
<li>You can create a <strong>fulfilled</strong> <code>Promise</code> object by using the <code>Promise.resolve(value)</code> method.</li>
<li><p>You can create your own <code>Promise</code> objects from scratch by using the <code>Promise</code> constructor with the form</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb44-2" title="2">  <span class="co">// do some async stuff</span></a>
<a class="sourceLine" id="cb44-3" title="3">  <span class="co">// call resolve(value) to make the Promise succeed</span></a>
<a class="sourceLine" id="cb44-4" title="4">  <span class="co">// call reject(reason) to make the Promise fail</span></a>
<a class="sourceLine" id="cb44-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div></li>
</ul>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects">Section: Promises, ECMAScript® 2015 Language Specification</a> is the minimum standard for how JavaScript Promises should act in <strong>all</strong> JavaScript environments. Language standards are dense and hard to read. You may want to give it a shot. The more you grow in your knowledge of how JavaScript works, the clearer it should become.</li>
<li><a href="https://promisesaplus.com/">The Promises/A+ Specification</a> has a very nice terse description of how Promises work. It is mostly the standard that was adopted by the Technical Committee 39 when including the <code>Promise</code> object into JavaScript.</li>
</ul>
<p>†: There’s a corresponding <code>Promise.reject(reason)</code> method that creates a <code>Promise</code> object immediately in the <strong>rejected</strong> state.</p>
<hr />
<h1 id="project-curl-up-with-a-nice-promise">Project: Curl Up With A Nice Promise</h1>
<p>You’ve learned about how to use Promise objects to help master the problems of asynchronous program logic. Now, you can really get your hands dirty by building a Node.js-based version of the popular <a href="https://curl.haxx.se/">curl</a> utility!</p>
<p>You may not know, but <code>curl</code> is a command line program to get the <code>c</code>ontent at <code>URL</code>s. <code>cURL</code>. Get it?</p>
<h2 id="this-project">This project</h2>
<p>You will create a version of the <code>curl</code> utility that will be able to</p>
<ul>
<li>Download content from the Internet</li>
<li>Save it into files</li>
<li>Modify the HTTP request using command-line arguments</li>
<li>Send data with the HTTP request</li>
<li>Save the metadata of the HTTP response</li>
</ul>
<p>Detailed steps will be provided for the project setup, so you can follow along and get the pieces in place for your practice with promises.</p>
<p>You’re going to do great!</p>
<h2 id="getting-started">Getting started</h2>
<p>You’ll build this in steps. Eventually, you’ll have something pretty powerful.</p>
<p>To get started, create a project directory, create file in it named "curl.js", and open it up in Visual Studio Code.</p>
<p>Now, use the <code>npm</code> command to install "node-fetch".</p>
<h3 id="a-word-about-fetch">A word about fetch</h3>
<p>The <code>fetch</code> command allows you to call another server or service hosted on the web and returns you the results. Since <code>fetch</code> is asynchronous, you will need to use a promise to handle the response when it returns from the remote server.</p>
<p>Specifically, <code>fetch</code> makes HTTP requests for XML, JSON, text, files or any content that can be sent through the REST protocol.</p>
<p>The <strong>node-fetch</strong> package includes a <code>fetch</code> function which has two arguments: a url and an options object. This function returns a promise. The promise is what allows you to wait for the response and <code>then</code> handle it.</p>
<p>The response from the fetch promise includes a <code>text()</code> function that also returns a promise. That is because the text can stream when it’s long. Streaming text is the same as streaming video you are probably familiar with where the first part is available after a short time and the rest continues to load in the background.</p>
<p>To learn more about using fetch within NodeJS, you may look at the npm page for <a href="https://www.npmjs.com/package/node-fetch">node-fetch</a>, specifically the [section on fetch] and <a href="https://www.npmjs.com/package/node-fetch#bodytext">section on body text</a>, or additional documentation such as <a href="https://flaviocopes.com/fetch-api/#body-content">body content</a> and <a href="https://flaviocopes.com/fetch-api/#catching-errors">catching errors</a>.</p>
<h3 id="as-you-go-along">As you go along</h3>
<p>Every new feature that you add should <em>not</em> break a previously-implemented feature. If your utility can print out a file to the console and then it doesn’t after you add the "save to a file" feature, you broke it. Make sure everything works every time you do something new.</p>
<p>A good way to help with this is to initialize a Git repository at the beginning of your project. Then, whenever you get something to work, add and commit those changes. That way, you can get yourself out of an "oh, geez, I really messed it up right now" moment by doing something like <code>git checkout -- .</code>.</p>
<h2 id="step-1-just-getting-a-url">Step 1: Just getting a URL</h2>
<p>The first feature that you need to support is making a normal GET request to a URL and printing out the content to "standard out" (console.logging it).</p>
<p>This service is a great starting point: <a href="https://artii.herokuapp.com/make?text=curl++this">https://artii.herokuapp.com/make?text=curl++this</a></p>
<p>It points to the ASCII art API. It takes some text in the URL and turns it into ASCII art. You can try it in standard <code>curl</code> if you’d like to see how it works before you write your code. In you terminal, run this command.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb45-1" title="1"><span class="op">&gt;</span> <span class="ex">curl</span> https://artii.herokuapp.com/make?text=curl++this</a></code></pre></div>
<p>Now write code in your <strong>curl.js</strong> file to make the fetch call using a promise to grab the result and log it out to the console.</p>
<blockquote>
<p>Tip: Put the above url into a constant or variable as you’ll be replacing it soon with a command-line parameter.</p>
</blockquote>
<p>When you run your program you should see the following.</p>
<pre><code>&gt; node curl.js https://artii.herokuapp.com/make?text=curl++this
                  _    _   _     _
                 | |  | | | |   (_)
   ___ _   _ _ __| |  | |_| |__  _ ___
  / __| | | | &#39;__| |  | __| &#39;_ \| / __|
 | (__| |_| | |  | |  | |_| | | | \__ \
  \___|\__,_|_|  |_|   \__|_| |_|_|___/

&gt;</code></pre>
<p>Congrats! That’s ASCII art. :)</p>
<h3 id="just-failing-to-get-a-url">Just failing to get a URL</h3>
<p>Let’s say the host server doesn’t exist. You should handle that gracefully. You’re using Promises. That means this probably goes in a <code>catch</code> handler somewhere.</p>
<p>Since you are emulating the <code>curl</code> command, you can see what it does with an invalid url.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb47-1" title="1"><span class="op">&gt;</span> <span class="ex">curl</span> https://artii.herokuFLAP.com/make?text=curl++this</a>
<a class="sourceLine" id="cb47-2" title="2">  <span class="ex">curl</span>: (6) <span class="ex">Could</span> not resolve host: artii.herokuFLAP.com</a>
<a class="sourceLine" id="cb47-3" title="3"><span class="op">&gt;</span></a></code></pre></div>
<p>You can check for this error (hint 1 - the code is <code>ENOTFOUND</code>) to output an equivalent message (hint 2 - the <code>URL</code> object can help you get the <code>host</code> property from a url string). Since the error message is showing that the process ended with status code "6", you can and should do the same from your program.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb48-1" title="1"><span class="va">process</span>.<span class="at">exit</span>(<span class="dv">6</span>)<span class="op">;</span></a></code></pre></div>
<p>Any other errors can be sent as-is through to console as an error.</p>
<p>You can temporarily change the URL in your code to see both of these errors.</p>
<ul>
<li>ENOTFOUND: <code>https://artii.herokuappxxxx.com/make?text=curl++this</code></li>
<li>Other error: <code>https://artii.herokuapp.com/makexxxx?text=curl++this</code></li>
</ul>
<blockquote>
<p>Hint: Remember to change the URL back to the working one before continuing.</p>
</blockquote>
<h2 id="step-2-command-line-arguments">Step 2: Command-line arguments</h2>
<p>Instead of hard-coding the URL, it would be nice to pass it to the program for more flexibility and reuse. When you’ve completed this upgrade, the command to run your program will look like this.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb49-1" title="1"><span class="op">&gt;</span> <span class="ex">node</span> curl.js https://artii.herokuapp.com/make?text=curl++this</a></code></pre></div>
<p>There are three types of command-line arguments.</p>
<ul>
<li>arguments with values (e.g. <code>-o output-file.txt</code>)</li>
<li>arguments without values, sometimes referred to as "flags" (e.g. <code>-h</code> and <code>--help</code> are often used to output help or usage information)</li>
<li>positional arguments (e.g. the url or urls to fetch)</li>
</ul>
<p>Throughout the rest of this project you’ll get to try them all.</p>
<p>In order to accept command-line arguments, you’ll want to include a package to help you access them. One of the better options is <a href="https://www.npmjs.com/package/dashdash">dashdash</a>. Install it now using <code>npm</code>.</p>
<p>To get you started quickly, here’s some code you can add to your <strong>curl.js</strong>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">const</span> dash <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;dashdash&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb50-2" title="2"></a>
<a class="sourceLine" id="cb50-3" title="3"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb50-4" title="4">  <span class="dt">allowUnknown</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb50-5" title="5">  <span class="dt">options</span><span class="op">:</span> []<span class="op">,</span></a>
<a class="sourceLine" id="cb50-6" title="6"><span class="op">};</span></a>
<a class="sourceLine" id="cb50-7" title="7"><span class="kw">const</span> parser <span class="op">=</span> <span class="va">dash</span>.<span class="at">createParser</span>(options)<span class="op">;</span></a>
<a class="sourceLine" id="cb50-8" title="8"></a>
<a class="sourceLine" id="cb50-9" title="9"><span class="kw">const</span> opts <span class="op">=</span> <span class="va">parser</span>.<span class="at">parse</span>(options)<span class="op">;</span></a>
<a class="sourceLine" id="cb50-10" title="10"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Options are:&#39;</span><span class="op">,</span> opts)<span class="op">;</span></a></code></pre></div>
<p>Remember to run your program with some options following the program name.</p>
<pre><code>&gt; node curl.js
&gt; node curl.js -h
&gt; node curl.js https://.io
&gt; node curl.js -o output.txt https://.io</code></pre>
<h3 id="predefined-options">Predefined options</h3>
<p>Now, try adding a predefined option to the configuration, one that you would use to specify the output file name. (This isn’t the <em>entire</em> JavaScript file, here. It’s just the snippet of the <code>options</code> variable declaration. Please just modify the <code>options</code> variable.)</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb52-2" title="2">  <span class="dt">allowUnknown</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb52-3" title="3">  <span class="dt">options</span><span class="op">:</span> [<span class="op">{</span></a>
<a class="sourceLine" id="cb52-4" title="4">    <span class="dt">names</span><span class="op">:</span> [<span class="st">&#39;output&#39;</span><span class="op">,</span> <span class="st">&#39;o&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb52-5" title="5">    <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;string&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb52-6" title="6">    <span class="dt">help</span><span class="op">:</span> <span class="st">&#39;file in which to store the fetched content&#39;</span></a>
<a class="sourceLine" id="cb52-7" title="7">  <span class="op">}</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb52-8" title="8"><span class="op">};</span></a></code></pre></div>
<p>Run the last command again and see how the output differs from before.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb53-1" title="1"><span class="op">&gt;</span> <span class="ex">node</span> curl.js -o output.txt https://.io</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="ex">Options</span> are: {</a>
<a class="sourceLine" id="cb53-3" title="3">  <span class="ex">output</span>: <span class="st">&#39;output.txt&#39;</span>,</a>
<a class="sourceLine" id="cb53-4" title="4">  <span class="ex">_order</span>: [ { key: <span class="st">&#39;output&#39;</span>, value: <span class="st">&#39;output.txt&#39;</span>, from: <span class="st">&#39;argv&#39;</span> } ],</a>
<a class="sourceLine" id="cb53-5" title="5">  <span class="ex">_args</span>: [ <span class="st">&#39;https://.io&#39;</span> ]</a>
<a class="sourceLine" id="cb53-6" title="6">}</a>
<a class="sourceLine" id="cb53-7" title="7"><span class="ex">...</span></a></code></pre></div>
<p>Notice that you can get the list of URLs from the <code>_args</code> property. Then, you can get the value of the "output" argument that you wrote using the <code>-o</code> signifier through the <code>output</code> property on the <code>opts</code> value.</p>
<p>Go ahead and add the option for <code>-h</code> as well. (Hint: the <code>type</code> of a flag option is <code>bool</code>.) Verify it’s working by running <code>node curl.js -h</code>.</p>
<h3 id="url-from-command-line">Url from command-line</h3>
<p>Now change your <code>url</code> variable (or constant) to use the argument instead of a hard-coded string. Then test it with several calls to your program with different urls.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb54-1" title="1"><span class="op">&gt;</span> <span class="ex">node</span> curl.js https://.io</a>
<a class="sourceLine" id="cb54-2" title="2"><span class="op">&gt;</span> <span class="ex">node</span> curl.js https://artii.herokuapp.com/make?text=curl++this</a></code></pre></div>
<p>It is pleasing for users if you provide a message when they forget to include a required option, such as at least one url. Go ahead and add that (obviously before using <code>args</code> to set the <code>url</code> so the program doesn’t crash). Verify by running <code>node curl.js</code>.</p>
<p>Also, you may comment out or remove the logging of the options whenever you feel you don’t need them any more.</p>
<h3 id="help-message">Help message</h3>
<p>It is useful to map variables to the various properties of the options, if you’d like. For example, you might want to do something like this.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">const</span> <span class="op">{</span> help<span class="op">,</span> output<span class="op">,</span> <span class="dt">_args</span><span class="op">:</span> urls <span class="op">}</span> <span class="op">=</span> opts<span class="op">;</span></a></code></pre></div>
<p>Also output the help information, if that flag is set.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb56-1" title="1"><span class="cf">if</span> (help) <span class="op">{</span></a>
<a class="sourceLine" id="cb56-2" title="2">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;node curl.js [OPTIONS] URL&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb56-3" title="3">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;OPTIONS:&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb56-4" title="4">    <span class="va">console</span>.<span class="at">log</span>(<span class="va">parser</span>.<span class="at">help</span>().<span class="at">trimRight</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb56-5" title="5">    <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb56-6" title="6"><span class="op">}</span></a></code></pre></div>
<h2 id="step-3-now-put-it-in-a-file">Step 3: Now, put it in a file</h2>
<p>When the person using your utility specifies that they’d like the content of the fetch to be stored in a file, they will do it with one of these forms. Of course the string "«file-name»" will be an actual file name and not have those fancy guillemets (or those funky double bracket things).</p>
<ul>
<li><code>-o «file-name»</code></li>
<li><code>--output «file-name»</code></li>
</ul>
<p>When your program gets that argument, it will <em>not</em> "console log" it. Instead, it will write it to the specified file. It should do that <em>asynchronously</em>, as well. In fact, node-fetch is designed to work directly with writing files, so it has built-in support for <a href="https://www.npmjs.com/package/node-fetch#streams">streams with node-fetch</a>.</p>
<p>Remember to import <code>fs</code> (you don’t need to install, of course, because it is a native part of NodeJS), then use the documentation to write the fetched content to the <code>output</code> file, if provided by the user calling your program. (Hint: <code>process.stdout</code> works like a file stream.)</p>
<p>Make sure you can still run without the <code>-o</code> flag or if the filename is missing (after the <code>-o</code> option in the command line).</p>
<blockquote>
<p>Test a variety of different commands to ensure all supported variations and previous error handling are still working.</p>
</blockquote>
<h3 id="error-handling-for-writing-files">Error handling for writing files</h3>
<p>If the file fails to get written, then it should look like this. You need to modify your code to make this happen.</p>
<pre><code>&gt; node curl.js -o node_modules https://artii.herokuapp.com/make?text=curl++this
curl: (23) Failed writing body</code></pre>
<p>(Though you’re still using Promises, because you’re saving as a writable stream, then it’s at that point that you’re getting this error. Hint: <code>on('error')</code> is a good place to begin according to the <a href="https://nodejs.org/api/errors.html#errors_error_propagation_and_interception">node error handling documentation</a> under the bullet that starts with "When an asynchronous method is called" because "use of the ‘error’ event mechanism is most common for stream-based … APIs".)</p>
<h2 id="congratulations">Congratulations!</h2>
<p>You made it through the minimum project exploring promises and command-line arguments. As time and desire permits, you may continue with the following bonus rounds to make your program more like the <code>curl</code> command.</p>
<h2 id="bonus-a-setting-an-arbitrary-header">Bonus A: Setting an arbitrary header</h2>
<p>Have a look at <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Examples">Examples using Fetch</a> to see how to add headers on an invocation of <code>fetch</code> in the second code example of the section. You may also want to check out the <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Syntax">Syntax of Fetch</a> for a property on the object you pass into for the "init" parameter that would allow you to set the <em>headers</em> of the request. Or, <a href="https://lmgtfy.com/?q=fetch+set+request+headers&amp;s=d">let me DuckDuckGo that for you</a>.</p>
<p>Use that knowledge to be able to handle one or more of the <code>-H</code> or <code>--header</code> command line option. It’s value should have the form "«Header Name»: «Header Value»" like "Accept: application/json" or "Content-Type: application/json".</p>
<h3 id="setting-special-headers">Setting special headers</h3>
<p>Now that you can set arbitrary headers, support the command line arguments and their meaning.</p>
<table>
<thead>
<tr class="header">
<th>Command Line Argument</th>
<th>Meaning</th>
<th>HTTP Header</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-A «string»</code></td>
<td>Set the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent">user agent header</a></td>
<td>"User-Agent: «string»"</td>
</tr>
<tr class="even">
<td><code>-e «URL»</code></td>
<td>Set the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer">referer header</a></td>
<td>"Referer: «URL»"</td>
</tr>
</tbody>
</table>
<h2 id="bonus-b-capturing-response-headers">Bonus B: Capturing response headers</h2>
<p>Sometimes the person using the command wants to see the output of the metadata of the request, too. That’s where the "–dump-header" flag comes into play. When someone issues the command with that flag</p>
<pre><code>&gt; node curl.js --dump-header ./headers.txt \
               https://artii.herokuapp.com/make?text=curl++this</code></pre>
<p>Then it will print out the content of the response like it normally does. In addition to that, though, it will create a file named "./headers.txt" and put the HTTP response status line and all of the headers of the response in it. An example content of the file would look like this.</p>
<pre><code>HTTP/1.1 200 OK
Connection: keep-alive
Content-Type: text/plain
Content-Length: 319
Server: Goliath
Date: Tue, 03 Feb 2019 05:52:55 GMT
Via: 1.1 vegur</code></pre>
<h2 id="bonus-c-sending-data">Bonus C: Sending data</h2>
<p>When someone adds the <code>-d «string»</code> or <code>--data «string»</code> flag to the command, that should become the body of the HTTP request. So, make it the body of your <code>fetch</code>. Check out the <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Syntax">Syntax of Fetch</a> for a property on the object you pass into for the "init" parameter that would allow you to set the <em>body</em> of a request. This should also set the method of the request to POST.</p>
<h3 id="overriding-the-method-of-the-request">Overriding the method of the request</h3>
<p>When someone adds the <code>-X</code> command line argument followed by an HTTP method, then set that method on the fetch request. You’ll want to find the property on the "init" parameter that would allow you to override the <em>method</em> of the HTTP request.</p>
<pre><code>&gt; node curl.js -X &#39;POST&#39;                              \
               -d &#39;{&quot;title&quot;: &quot;Sir&quot;, &quot;name&quot;: &quot;Robin&quot;}&#39; \
               -H &#39;Content-Type: application/json&#39;    \
               https://jsonplaceholder.typicode.com/posts</code></pre>
<p>which should result in something like</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb61-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb61-2" title="2">  <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;Sir&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb61-3" title="3">  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Robin&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb61-4" title="4">  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">101</span></a>
<a class="sourceLine" id="cb61-5" title="5"><span class="fu">}</span></a></code></pre></div>
<h2 id="bonus-d-multiple-files-multiple-output-destinations">Bonus D: Multiple files, multiple output destinations</h2>
<p>Now that you can download a single file, make it like the way <code>curl</code> handles multiple URLs and <code>-o</code> parameters.</p>
<ul>
<li>Do the transfers in parallel, not one right after another</li>
<li>For each URL provided, a corresponding <code>-o</code> or <code>--output</code> is its target. If there are more URLs than there are output targets, the remainder of the content gets output to standard out.</li>
</ul>
<p>Here are some examples to get you used to it.</p>
<p>Prints both files to standard out</p>
<pre><code>&gt; node curl.js https://artii.herokuapp.com/make?text=curl++this \
              https://artii.herokuapp.com/make?text=curl++that</code></pre>
<p>Saves the first to the file "first.txt" and prints the second to standard out</p>
<pre><code>&gt; node curl.js -o first.txt \
               https://artii.herokuapp.com/make?text=curl++this \
               https://artii.herokuapp.com/make?text=curl++that</code></pre>
<p>Saves the first to the file "first.txt" and saves the second to the file "second.txt"</p>
<pre><code>&gt; node curl.js -o first.txt \
               -o second.txt \
               https://artii.herokuapp.com/make?text=curl++this \
               https://artii.herokuapp.com/make?text=curl++that</code></pre>
<h2 id="bonus-e-list-globbing">Bonus E: List globbing</h2>
<p>If a person specifies a "list glob", then expand it to all of the files that it represents. A list glob uses curly braces to specify a list.</p>
<pre><code>&gt; node curl.js https://artii.herokuapp.com/make?text={this,that,the+other}</code></pre>
<p>The previous statement would "expand" to the following equivalent command.</p>
<pre><code>&gt; node curl.js https://artii.herokuapp.com/make?text=this \
              https://artii.herokuapp.com/make?text=that \
              https://artii.herokuapp.com/make?text=the+other</code></pre>
<h2 id="nightmare-round-a-the-progress-meter">Nightmare round A: The progress meter</h2>
<p>When your utility saves all of its contents into files, then show a progress meter for the download. It should show the percent total that it is at. You’ll need to look at the "Content-Length" header of the <em>response</em> headers. Then, you can get a reader from the response body to monitor how much has been read.</p>
<pre><code>      %  Total
     --  -----
make 18  151M</code></pre>
<h2 id="nightmare-round-b-progress-meter-for-multiple-files">Nightmare round B: Progress meter for multiple files</h2>
<p>What you just did for the download progress meter, do it so that it can track multiple files, too.</p>
<pre><code>      %  Total
     --  -----
make 18  151M
make 14  111M</code></pre>
<hr />
<h1 id="week-06-day-3-async-and-await" data-ignore="true">WEEK-06 DAY-3<br><em>async and await</em></h1>
<hr />
<h1 id="promises-learning-objectives-ii">Promises Learning Objectives II</h1>
<p>Below is a complete list of the terminal learning objectives for this lesson. When you complete this lesson, you should be able to perform each of the following objectives. These objectives capture how you may be evaluated on the assessment for this lesson.</p>
<ol type="1">
<li><p>Use <code>async</code>/<code>await</code> with promise-based functions to write asynchronous code that behaves synchronously.al learning objectives for this lesson. When you complete this lesson, you should be able to perform each of the following objectives. These objectives capture how you may be evaluated on the assessment for this lesson.</p></li>
<li><p>Use <code>async</code>/<code>await</code> with promise-based functions to write asynchronous code that behaves synchronously.</p></li>
</ol>
<hr />
<h1 id="html-learning-objectives">HTML Learning Objectives</h1>
<p><strong>The objective of this lesson</strong> is for you to know how to effectively use HTML5 to build semantically and structurally correct Web pages. HTML is the language that renders the cross-platform human-computer interfaces that made the World Wide Web accessible by the world! You’ll be able to create structurally and semantically valid HTML5 pages using the following elements:</p>
<ul>
<li>html</li>
<li>head</li>
<li>title</li>
<li>link</li>
<li>script</li>
<li>The six header tags</li>
<li>p</li>
<li>article</li>
<li>section</li>
<li>main</li>
<li>nav</li>
<li>header</li>
<li>footer</li>
<li>Itemized list tags
<ul>
<li>ul</li>
<li>ol</li>
<li>li</li>
</ul></li>
<li>a</li>
<li>img</li>
<li>Tabular-data tags
<ul>
<li>table</li>
<li>thead</li>
<li>tbody</li>
<li>tfoot</li>
<li>tr</li>
<li>th</li>
<li>tdhow to effectively use HTML5 to build semantically and structurally correct Web pages. HTML is the language that renders the cross-platform human-computer interfaces that made the World Wide Web accessible by the world! You’ll be able to create structurally and semantically valid HTML5 pages using the following elements:</li>
</ul></li>
<li>html</li>
<li>head</li>
<li>title</li>
<li>link</li>
<li>script</li>
<li>The six header tags</li>
<li>p</li>
<li>article</li>
<li>section</li>
<li>main</li>
<li>nav</li>
<li>header</li>
<li>footer</li>
<li>Itemized list tags
<ul>
<li>ul</li>
<li>ol</li>
<li>li</li>
</ul></li>
<li>a</li>
<li>img</li>
<li>Tabular-data tags
<ul>
<li>table</li>
<li>thead</li>
<li>tbody</li>
<li>tfoot</li>
<li>tr</li>
<li>th</li>
<li>td</li>
</ul></li>
</ul>
<hr />
<h1 id="modern-promises-with-async-and-await">Modern <code>Promise</code>s With <code>async</code> And <code>await</code></h1>
<p>While <code>Promise</code>s helped revolutionize the way that JavaScript programmers could structure asynchronous code, the technical committee that governs JavaScript realized it could take this feature one step further. It could design a language feature that allowed programmers to write true synchronous code based on <code>Promise</code>s. Thus, the <code>async</code> and <code>await</code> keywords came into being in 2017.</p>
<p>When you finish this article, you should be able to:</p>
<ul>
<li>Properly implement a function declaration with the <code>async function</code> expression;</li>
<li>Explain how the JavaScript runtime creates an implicit <code>Promise</code> for <code>async function</code> declarations; and,</li>
<li>Execute functions marked with the <code>async</code> keyword using the <code>await</code> keyword.</li>
</ul>
<h2 id="classic-promise-example">Classic promise example</h2>
<p>Let’s review with an example of classic promise handling using two functions. <code>walkTheDog</code> will return a promise that resolves with a <code>'happy dog'</code> after 1 second. <code>doChores</code> will act as our main function and will handle that promise with a <code>then</code>:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">function</span> <span class="at">walkTheDog</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb69-2" title="2">  <span class="cf">return</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-3" title="3">    <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-4" title="4">      <span class="at">resolve</span>(<span class="st">&#39;happy dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb69-5" title="5">    <span class="op">},</span> <span class="dv">1000</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb69-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb69-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb69-8" title="8"></a>
<a class="sourceLine" id="cb69-9" title="9"><span class="kw">function</span> <span class="at">doChores</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb69-10" title="10">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;before walking the dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb69-11" title="11">  <span class="at">walkTheDog</span>()</a>
<a class="sourceLine" id="cb69-12" title="12">    .<span class="at">then</span>(res <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-13" title="13">        <span class="va">console</span>.<span class="at">log</span>(res)<span class="op">;</span></a>
<a class="sourceLine" id="cb69-14" title="14">        <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;after walking the dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb69-15" title="15">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb69-16" title="16">  <span class="cf">return</span> <span class="st">&#39;done&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb69-17" title="17"><span class="op">}</span></a>
<a class="sourceLine" id="cb69-18" title="18"></a>
<a class="sourceLine" id="cb69-19" title="19"><span class="va">console</span>.<span class="at">log</span>(<span class="at">doChores</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb69-20" title="20"></a>
<a class="sourceLine" id="cb69-21" title="21"><span class="co">// prints:</span></a>
<a class="sourceLine" id="cb69-22" title="22"><span class="co">//</span></a>
<a class="sourceLine" id="cb69-23" title="23"><span class="co">// before walking the dog</span></a>
<a class="sourceLine" id="cb69-24" title="24"><span class="co">// done</span></a>
<a class="sourceLine" id="cb69-25" title="25"><span class="co">// happy dog</span></a>
<a class="sourceLine" id="cb69-26" title="26"><span class="co">// after walking the dog</span></a></code></pre></div>
<p>Notice that <code>'done'</code> will be returned by <code>doChores</code> before the promise resolves, because it is asynchronous.</p>
<p>If we want to take any actions after the promise resolves, we can do so by chaining <code>then</code>. This code works, but we may have one complaint regarding aesthetics: there is some added bulk because the <code>then</code> accepts a callback containing the code we want to execute after the promise resolves. This bulk compounds further if we want to chain multiple <code>then</code>s. Let’s refactor this. Enter <code>async</code> and <code>await</code>.</p>
<h2 id="async-function-declarations"><code>async</code> function declarations</h2>
<p>Declaring a function with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function"><code>async</code></a> will create the function so it returns an implicit promise containing it’s result. Let’s declare our <code>doChores</code> function as <code>async</code> and check it’s return value. For now we’ll leave out the explicit <code>walkTheDog</code> promise:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">async</span> <span class="kw">function</span> <span class="at">doChores</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb70-2" title="2">  <span class="co">// ...</span></a>
<a class="sourceLine" id="cb70-3" title="3">  <span class="cf">return</span> <span class="st">&#39;done&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb70-4" title="4"><span class="op">}</span></a>
<a class="sourceLine" id="cb70-5" title="5"></a>
<a class="sourceLine" id="cb70-6" title="6"><span class="va">console</span>.<span class="at">log</span>(<span class="at">doChores</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb70-7" title="7"><span class="co">// prints:</span></a>
<a class="sourceLine" id="cb70-8" title="8"><span class="co">// Promise { &#39;done&#39; }</span></a></code></pre></div>
<p>This function now returns a promise automatically! Notice that the promise returned contains the immediately resolved value of <code>'done'</code>. An <code>async</code> declaration isn’t super useful by itself. However, it allows us to utilize the <code>await</code> keyword inside the function.</p>
<h2 id="awaiting-a-promise"><code>await</code>ing a promise</h2>
<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await"><code>await</code></a> operator can be used to wait for promise to be fulfilled. We are only allowed to use <code>await</code> in an <code>async</code> function. Using <code>await</code> outside of an <code>async</code> will result in a SyntaxError. When a promise is <code>await</code>ed, execution of the containing <code>async</code> function will pause until the promise is fulfilled.</p>
<p>Let’s use <code>await</code> in our <code>doChores</code> function:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">function</span> <span class="at">walkTheDog</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb71-2" title="2">  <span class="cf">return</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb71-3" title="3">    <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb71-4" title="4">      <span class="at">resolve</span>(<span class="st">&#39;happy dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb71-5" title="5">    <span class="op">},</span> <span class="dv">1000</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb71-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb71-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb71-8" title="8"></a>
<a class="sourceLine" id="cb71-9" title="9"><span class="kw">async</span> <span class="kw">function</span> <span class="at">doChores</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb71-10" title="10">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;before walking the dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb71-11" title="11">  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="at">walkTheDog</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb71-12" title="12">  <span class="va">console</span>.<span class="at">log</span>(res)<span class="op">;</span></a>
<a class="sourceLine" id="cb71-13" title="13">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;after walking the dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb71-14" title="14"><span class="op">}</span></a>
<a class="sourceLine" id="cb71-15" title="15"></a>
<a class="sourceLine" id="cb71-16" title="16"><span class="at">doChores</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb71-17" title="17"><span class="co">// prints:</span></a>
<a class="sourceLine" id="cb71-18" title="18"><span class="co">// before walking the dog</span></a>
<a class="sourceLine" id="cb71-19" title="19"><span class="co">// happy dog</span></a>
<a class="sourceLine" id="cb71-20" title="20"><span class="co">// after walking the dog</span></a></code></pre></div>
<p>Whoa! This code looks synchronous. Instead of using <code>then</code>, we can <code>await</code> the <code>walkTheDog()</code> promise, pausing execution until the promise is fulfilled. Once fulfilled, the <code>await</code> expression will evaluate to the <code>resolve</code>d value, <code>'happy dog'</code> in this case.</p>
<p>Remember that the <code>async doChores</code> function will implicitly return a promise. Now that promise will fulfill once the entire function is finished executing. The function’s return value will be the resolved value of the implicit promise. Let’s handle it with <code>then</code>:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">function</span> <span class="at">walkTheDog</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb72-2" title="2">  <span class="cf">return</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb72-3" title="3">    <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb72-4" title="4">      <span class="at">resolve</span>(<span class="st">&#39;happy dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb72-5" title="5">    <span class="op">},</span> <span class="dv">1000</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb72-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb72-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb72-8" title="8"></a>
<a class="sourceLine" id="cb72-9" title="9"><span class="kw">async</span> <span class="kw">function</span> <span class="at">doChores</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb72-10" title="10">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;before walking the dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb72-11" title="11">  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="at">walkTheDog</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb72-12" title="12">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;after walking the dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb72-13" title="13">  <span class="cf">return</span> <span class="va">res</span>.<span class="at">toUpperCase</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb72-14" title="14"><span class="op">}</span></a>
<a class="sourceLine" id="cb72-15" title="15"></a>
<a class="sourceLine" id="cb72-16" title="16"><span class="at">doChores</span>().<span class="at">then</span>(result <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(result))<span class="op">;</span></a>
<a class="sourceLine" id="cb72-17" title="17"><span class="co">// prints:</span></a>
<a class="sourceLine" id="cb72-18" title="18"><span class="co">// before walking the dog</span></a>
<a class="sourceLine" id="cb72-19" title="19"><span class="co">// after walking the dog</span></a>
<a class="sourceLine" id="cb72-20" title="20"><span class="co">// HAPPY DOG</span></a></code></pre></div>
<p>You’re probably wondering why we chain <code>then</code> and not simply use <code>await doChores()</code>, that’s because we can only use <code>await</code> <em>inside</em> of an <code>async</code> function. Currently our call to <code>doChores</code> is not within any function.</p>
<p>For fun, let’s use a surrounding <code>async</code> function to <code>await doChores()</code>. We’ll also add some numbered print statements to show the order of execution:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">function</span> <span class="at">walkTheDog</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb73-2" title="2">  <span class="cf">return</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb73-3" title="3">    <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb73-4" title="4">      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;2&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb73-5" title="5">      <span class="at">resolve</span>(<span class="st">&#39;happy dog&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb73-6" title="6">    <span class="op">},</span> <span class="dv">1000</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb73-7" title="7">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb73-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb73-9" title="9"></a>
<a class="sourceLine" id="cb73-10" title="10"><span class="kw">async</span> <span class="kw">function</span> <span class="at">doChores</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb73-11" title="11">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;1&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb73-12" title="12">  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="at">walkTheDog</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb73-13" title="13">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;3&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb73-14" title="14">  <span class="cf">return</span> <span class="va">res</span>.<span class="at">toUpperCase</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb73-15" title="15"><span class="op">}</span></a>
<a class="sourceLine" id="cb73-16" title="16"></a>
<a class="sourceLine" id="cb73-17" title="17"><span class="kw">async</span> <span class="kw">function</span> <span class="at">wrapper</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb73-18" title="18">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;0&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb73-19" title="19">  <span class="kw">const</span> finalResult <span class="op">=</span> <span class="cf">await</span> <span class="at">doChores</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb73-20" title="20">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;4&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb73-21" title="21">  <span class="va">console</span>.<span class="at">log</span>(finalResult <span class="op">+</span> <span class="st">&#39;!!!&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb73-22" title="22"><span class="op">}</span></a>
<a class="sourceLine" id="cb73-23" title="23"></a>
<a class="sourceLine" id="cb73-24" title="24"><span class="at">wrapper</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb73-25" title="25"><span class="co">// prints:</span></a>
<a class="sourceLine" id="cb73-26" title="26"><span class="co">// 0</span></a>
<a class="sourceLine" id="cb73-27" title="27"><span class="co">// 1</span></a>
<a class="sourceLine" id="cb73-28" title="28"><span class="co">// 2</span></a>
<a class="sourceLine" id="cb73-29" title="29"><span class="co">// 3</span></a>
<a class="sourceLine" id="cb73-30" title="30"><span class="co">// 4</span></a>
<a class="sourceLine" id="cb73-31" title="31"><span class="co">// HAPPY DOG!!!</span></a></code></pre></div>
<h2 id="refactoring-a-promise-chain">Refactoring a promise chain</h2>
<p>Refactoring a promise chain is straightforward with <code>async</code>/<code>await</code>. Let’s say wanted to print the resolved values for 3 promises in order:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">function</span> <span class="at">wrapper</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb74-2" title="2">  promise1</a>
<a class="sourceLine" id="cb74-3" title="3">    .<span class="at">then</span>(res1 <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb74-4" title="4">      <span class="va">console</span>.<span class="at">log</span>(res1)<span class="op">;</span></a>
<a class="sourceLine" id="cb74-5" title="5">      <span class="cf">return</span> promise2<span class="op">;</span></a>
<a class="sourceLine" id="cb74-6" title="6">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb74-7" title="7">    .<span class="at">then</span>(res2 <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb74-8" title="8">      <span class="va">console</span>.<span class="at">log</span>(res2)<span class="op">;</span></a>
<a class="sourceLine" id="cb74-9" title="9">      <span class="cf">return</span> promise3<span class="op">;</span></a>
<a class="sourceLine" id="cb74-10" title="10">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb74-11" title="11">    .<span class="at">then</span>(res3 <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb74-12" title="12">      <span class="va">console</span>.<span class="at">log</span>(res3)<span class="op">;</span></a>
<a class="sourceLine" id="cb74-13" title="13">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb74-14" title="14"><span class="op">}</span></a></code></pre></div>
<p>We can refactor it into this:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">async</span> <span class="kw">function</span> <span class="at">wrapper</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb75-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="cf">await</span> promise1)<span class="op">;</span></a>
<a class="sourceLine" id="cb75-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(<span class="cf">await</span> promise2)<span class="op">;</span></a>
<a class="sourceLine" id="cb75-4" title="4">  <span class="va">console</span>.<span class="at">log</span>(<span class="cf">await</span> promise3)<span class="op">;</span></a>
<a class="sourceLine" id="cb75-5" title="5">  <span class="va">console</span>.<span class="at">log</span>(<span class="cf">await</span> promise4)<span class="op">;</span></a>
<a class="sourceLine" id="cb75-6" title="6"><span class="op">}</span></a></code></pre></div>
<h2 id="error-handling">Error handling</h2>
<p>Since <code>async</code> / <code>await</code> allows for seemingly synchronous execution, we can use a normal <code>try...catch</code> pattern to handle errors when the promise is rejected:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">function</span> <span class="at">action</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb76-2" title="2">  <span class="cf">return</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb76-3" title="3">    <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb76-4" title="4">      <span class="at">reject</span>(<span class="st">&#39;uh-oh&#39;</span>)<span class="op">;</span> <span class="co">// rejected</span></a>
<a class="sourceLine" id="cb76-5" title="5">    <span class="op">},</span> <span class="dv">3000</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb76-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb76-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb76-8" title="8"></a>
<a class="sourceLine" id="cb76-9" title="9"><span class="kw">async</span> <span class="kw">function</span> <span class="at">handlePromise</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb76-10" title="10">  <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb76-11" title="11">    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="at">action</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb76-12" title="12">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;resolved with&#39;</span><span class="op">,</span> res)<span class="op">;</span></a>
<a class="sourceLine" id="cb76-13" title="13">  <span class="op">}</span> <span class="cf">catch</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb76-14" title="14">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;rejected because of&#39;</span><span class="op">,</span> err)<span class="op">;</span></a>
<a class="sourceLine" id="cb76-15" title="15">  <span class="op">}</span></a>
<a class="sourceLine" id="cb76-16" title="16"><span class="op">}</span></a>
<a class="sourceLine" id="cb76-17" title="17"></a>
<a class="sourceLine" id="cb76-18" title="18"><span class="at">handlePromise</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb76-19" title="19"><span class="co">// prints:</span></a>
<a class="sourceLine" id="cb76-20" title="20"><span class="co">// rejected because of: uh-oh</span></a></code></pre></div>
<h2 id="what-you-learned">What you learned</h2>
<p>In this article, you learned how to use the <code>async</code> and <code>await</code> keywords in modern JavaScript to truly turn asynchronous code into synchronous style code. You will want to do this to make the code more readable and maintainable. The steps to do this are to</p>
<ul>
<li>mark a function with the <code>async</code> keyword to make JavaScript have it return a <code>Promise</code> if your code doesn’t, and</li>
<li>use the <code>await</code> keyword to turn the invocation of a function marked <code>async</code> into a blocking call that returns the resolved value of the underlying <code>Promise</code> or throws an exception.</li>
</ul>
<hr />
<h1 id="the-basics-of-html">The Basics of HTML</h1>
<p>The <em>HyperText Markup Language</em> (HTML) revolutionized the way that we use computers. Before HTML and Web browsers, all computer applications were so-called "desktop applications" that had to be created by software developers using Win32 C and other such specialized languages. With the advent of HTML, anyone with a text editor and a way to host HTML files could create content that people all over the world could see!</p>
<p>In this reading, you will either get to know HTML or brush up on the basics. At the end, you should know</p>
<ul>
<li>The three components that are the building blocks of HTML</li>
<li>How to add a title to a Web page</li>
<li>Add some headings to your HTML document</li>
<li>Add blocks of paragraph text</li>
<li>Use lists to itemize or define content</li>
<li>Use hyperlinks to instruct the browser to go from one page (or <em>resource</em>) to another</li>
<li>Put an image in your Web page</li>
<li>Properly display tabular data</li>
<li>Put comments in the source of your HTML code</li>
</ul>
<h2 id="the-three-components-of-html">The three components of HTML</h2>
<p>HTML has three components that form its basic building blocks: <strong>tags</strong>, <strong>elements</strong>, and <strong>attributes</strong>. Once you’ve learned the rules for how each of these components function, you should have no trouble writing and editing HTML.</p>
<h3 id="these-things-called-tags">These things called "tags"</h3>
<p>Any text that you write inside the angle brackets "&lt;" and "&gt;" will not be displayed in the browser. The text inside the angle brackets is just used to tell the browser how to display or transform regular text located between the opening tag (also called the start tag) and the closing tag (also called the end tag).</p>
<p>Tags usually come in pairs, and the difference between an opening tag and a closing tag is that the first symbol inside the brackets of a closing tag is a slash "/" symbol.</p>
<p>For example, here’s a pair of h1 tags (used to identify heading text), with some content in-between:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">&lt;h1&gt;</span>This is some content.<span class="kw">&lt;/h1&gt;</span></a></code></pre></div>
<p>In that example, the &amp;lth1&amp;gt is the opening tag and the &amp;lt/h1&amp;gt is the closing tag.</p>
<p>There are a whole mess of tags in HTML for you to use. The ones that you should know because you’ll put them to use are in the following list. Go read <em>each of the following documentation pages</em>.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/html"><code>html</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/head"><code>head</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/title"><code>title</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link"><code>link</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script"><code>script</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/h1">Header tags</a> There are six of these. This link is to just "h1".</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/p"><code>p</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/article"><code>article</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/section"><code>section</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/main"><code>main</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/nav"><code>nav</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/header"><code>header</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/footer"><code>footer</code></a></li>
<li>Itemized list tags
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ul"><code>ul</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ol"><code>ol</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/li"><code>li</code></a></li>
</ul></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a"><code>a</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img"><code>img</code></a></li>
<li>Table tags
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/table"><code>table</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/thead"><code>thead</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/tbody"><code>tbody</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/tfoot"><code>tfoot</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/tr"><code>tr</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/th"><code>th</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/td"><code>td</code></a></li>
</ul></li>
</ul>
<p>There are two main rules that you need to follow when using tags. So, don’t forget them.</p>
<ol type="1">
<li><em>You must always use angle brackets for tags.</em> Square brackets, curly braces, parentheses, none of those are for tags in HTML. Just the "&lt;" and "&gt;".</li>
<li>Tags almost <em>always come in pairs</em>. This means that, except for a few number of tags, you <em>must always close a tag after opening it</em>. If you forget to add a closing tag, sometimes the browser will kindly figure it out and insert one for you when it renders your content. However, <em>don’t rely on that behavior</em>! Different browsers will do different things. Put the closing tag when you are supposed to put it.</li>
</ol>
<p>There’s also a general guideline for writing tags: <em>please write them in lower case letters</em>. Sure, you can write them with upper case letters. The browsers will accept "img" and "IMG" and "ImG" and "iMg" as the image tag. However, for consistency, convention, and clarity, please choose lower case.</p>
<h3 id="these-things-called-elements">These things called "elements"</h3>
<p>You now know that most tags come in pairs, and some tags don’t have a closing tag. An <strong>HTML element</strong> is defined as</p>
<ul>
<li>If a tag is supposed to have both an opening tag and a closing tag, then when you refer to it as an <em>HTML element</em>, you actually mean:
<ul>
<li>The opening tag</li>
<li>The closing tag</li>
<li>All of the content between the opening and closing tags</li>
</ul></li>
<li>If a tag is <em>not</em> supposed to have a closing tag, then when you refer to it as an <em>HTML element</em>, you mean just the tag itself.</li>
</ul>
<p>Here’s an example of how to specify a title in an HTML document.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">&lt;title&gt;</span>Pictures of Barry&#39;s Beautiful Baby<span class="kw">&lt;/title&gt;</span></a></code></pre></div>
<p>The <em>HTML element</em> is the opening tag (<code>&lt;title&gt;</code>), the closing tag (<code>&lt;/title&gt;</code>), and the content inside the tags ("Pictures of Barry’s Beautiful Baby").</p>
<p>Here’s an example of how you can show an image in an HTML document.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;images/baby-bess-bouncing-backwards.jpg&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>Because images don’t have closing tags, the <em>HTML element</em> is everything from <code>&lt;img</code> to the <code>&gt;</code>. Tags that don’t have closing tags are called <strong>empty tags</strong>.</p>
<p>In some examples you find on the Internet, you are going to see empty tags with a weird slash at the end like this.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb80-1" title="1"><span class="co">&lt;!-- This is bad code with the slash --&gt;</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;images/baby-bess-bouncing-backwards.jpg&quot;</span> <span class="kw">/&gt;</span></a></code></pre></div>
<p>That is <em><em>OLD SYNTAX</em></em> and should not be used unless you are working on an old Web site where <em>all</em> of the empty elements have that syntax. (It is from an old standard called "XHTML", an abomination if ever there was one on the face of the World Wide Web.)</p>
<h3 id="these-things-called-attributes">These things called "attributes"</h3>
<p>Attributes are used to define additional information about an element. They are located inside the opening tag, and usually come in name/value pairs (name= "value").</p>
<p>All HTML elements can have attributes, but for most elements, we only use them when we need to. Attributes common to <em>all</em> HTML elements are the <em>class</em> and <em>id</em> attributes that you can use to categorize and identify HTML elements in your HTML document. Of course, the most common reason to use those is so that you can write CSS to style those elements or write JavaScript to manipulate the elements through the document object model.</p>
<p>You may have noticed that the previous example had a name-value pair in it. That is an attribute. Here’s the example, again, for convenience.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;images/baby-bess-bouncing-backwards.jpg&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>The attribute’s <em>name</em> is "src" and the attribute’s <em>value</em> is "./images/baby-bess-bouncing-backwards.jpg". The "src" attribute provides the additional information to the browser that this specific image’s source file can be found at that path.</p>
<p>There are three main guidelines for using attributes. They’re not really rules. However, you should follow them irrespective of the examples you see on the Internet, especially some of the sludge found on Stack Overflow.</p>
<ol type="1">
<li><em>Write attributes in lower case only.</em> You can write them in upper case. HTML tags and attributes are "case insensitive". So, <code>&lt;img src="images/..."&gt;</code> is the same to a browser as <code>&lt;IMG SRC="..."&gt;</code> is the same as <code>&lt;Img Src="..."&gt;</code>. Just use lower case. Everybody else does it, too. Be cool. Stay in the lower-case HTML school.</li>
<li><em>Put quotation marks around the value.</em> This makes it easy to identify. In some cases, you will find it necessary because you’ll need to put a space in the value of the attribute.</li>
<li><em>Those quotations marks, make them double quotes.</em> HTML will take single quotes as delimiters for attributes. Just don’t do it. Double quotes are the convention, even though you’ll see plenty of people railing against the convention, proclaiming "It doesn’t matter! I like single quotes better!" Let them do what they want. If you don’t have any real compelling reason, please use double quotes.</li>
</ol>
<p>When you put together all of these guidelines, the general way an HTML element should look is</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">&lt;closeabletag</span><span class="ot"> attribute=</span><span class="st">&quot;value&quot;</span><span class="kw">&gt;</span>Some content<span class="kw">&lt;/closeabletag&gt;</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">&lt;noclosetag</span><span class="ot"> attribute=</span><span class="st">&quot;value&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<h2 id="whitespace-tags-attributes-and-content">Whitespace, tags, attributes, and content</h2>
<p>When a browser is parsing an HTML document, it ignores whitespace, including line breaks, between the tag name and the attributes. So, the three element declarations are considered the same to the browser. The whitespace that is ignored is called <strong>negligible whitespace</strong>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">&lt;tag</span><span class="ot"> attr1=</span><span class="st">&quot;value1&quot;</span><span class="ot"> attr2=</span><span class="st">&quot;value2&quot;</span><span class="ot"> attr3=</span><span class="st">&quot;really-long-attribute-value-that-is-really-long&quot;</span><span class="kw">&gt;</span>content<span class="kw">&lt;/tag&gt;</span></a>
<a class="sourceLine" id="cb83-2" title="2"></a>
<a class="sourceLine" id="cb83-3" title="3"><span class="kw">&lt;tag</span><span class="ot"> attr1=</span><span class="st">&quot;value1&quot;</span></a>
<a class="sourceLine" id="cb83-4" title="4"><span class="ot">     attr2=</span><span class="st">&quot;value2&quot;</span></a>
<a class="sourceLine" id="cb83-5" title="5"><span class="ot">     attr3=</span><span class="st">&quot;really-long-attribute-value-that-is-really-long&quot;</span><span class="kw">&gt;</span>content<span class="kw">&lt;/tag&gt;</span></a>
<a class="sourceLine" id="cb83-6" title="6"></a>
<a class="sourceLine" id="cb83-7" title="7"><span class="kw">&lt;tag</span></a>
<a class="sourceLine" id="cb83-8" title="8"><span class="ot">  attr1=</span><span class="st">&quot;value1&quot;</span></a>
<a class="sourceLine" id="cb83-9" title="9"><span class="ot">  attr2=</span><span class="st">&quot;value2&quot;</span></a>
<a class="sourceLine" id="cb83-10" title="10"><span class="ot">  attr3=</span><span class="st">&quot;really-long-attribute-value-that-is-really-long&quot;</span></a>
<a class="sourceLine" id="cb83-11" title="11"><span class="kw">&gt;</span>content<span class="kw">&lt;/tag&gt;</span></a></code></pre></div>
<p>You <em>cannot</em> put space between the opening angle bracket and the tag name. This is wrong HTML.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb84-1" title="1"><span class="co">&lt;!-- This is NOT HTML. --&gt;</span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="er">&lt;</span> tag attr1=&quot;value&quot;&gt;content<span class="kw">&lt;/tag&gt;</span></a></code></pre></div>
<p>Whitespace between the opening tag and the closing tag is _part of the content of the tag. So, the two elements in the following HTML snippet are not the same because the second one has a line break and two spaces before the words and a line break after the words. This kind of whitespace is called <strong>non-negligible whitespace</strong>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">&lt;tag</span><span class="ot"> attr1=</span><span class="st">&quot;value&quot;</span><span class="kw">&gt;</span>Some content<span class="kw">&lt;/tag&gt;</span></a>
<a class="sourceLine" id="cb85-2" title="2"></a>
<a class="sourceLine" id="cb85-3" title="3"><span class="kw">&lt;tag</span><span class="ot"> attr1=</span><span class="st">&quot;value&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb85-4" title="4">  Some content</a>
<a class="sourceLine" id="cb85-5" title="5"><span class="kw">&lt;/tag&gt;</span></a></code></pre></div>
<h2 id="what-youve-learned-3">What you’ve learned</h2>
<p>You’ve learned about the three components of HTML documents: tags, elements, and attributes. You’ve learned about how to write them in the document. You’ve also gone and read about some of the most commonly used elements. You also know about how to add line breaks in-between attributes to make your document easier to read.</p>
<hr />
<h1 id="walk-through-building-a-web-page">Walk-Through Building A Web Page</h1>
<p>In this walk through, you are <em>highly encouraged</em> to open Visual Studio Code and type along to familiarize (or continue to practice) creating HTML documents. You are going to build your own HTML cheat sheet. You can come back and refer to it if your forget how to add an image to an HTML document, or how to properly structure tabular data.</p>
<p><strong>Do not copy and paste</strong>. Really. Practice makes perfect. If you’re still fairly new to HTML, type it out so that you can get the hang of it. If you can type HTML in your sleep, then this will take no time at all for you to complete. Whatever skill level you are, make with the typing, friend.</p>
<p>The best way to learn the basics of programming is to think about what you’re doing while typing. Don’t just copy. Copy and think! If you practice writing out all your code now, before long you’ll be closing elements and using double quotations without having to think about it. This will make things much easier when the projects that you’re expected to complete become more and more complex.</p>
<p>So, create a new directory, open Visual Studio Code to that directory, create a file in it named "index.html", and open the HTML document in a browser. Now, start with the…</p>
<h2 id="creating-the-basic-html5-structure">Creating the basic HTML5 structure</h2>
<p>On the first line of your HTML file, you want to tell the browser that your HTML document will follow the rules of HTML Version 5 as opposed to HTML 4 or XHTML or XML or whatever. To do that, the first line should read:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb86-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a></code></pre></div>
<p>The <em>DOCTYPE</em> declaration officially tells the browser that you plan on using HTML 5 in your document. Don’t worry. If you mess up, the browser is very forgiving. However, try not to mess up.</p>
<p>Now, you need to specify the <em>root element</em> of the HTML document, the <code>html</code> element. All of the content of your HTML document will be the content of this element.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb87-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb87-3" title="3"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p>The <code>html</code> element has two valid child elements, the <code>head</code> element and the <code>body</code> element. Both of those tags are <strong>non-empty tags</strong>, which means they will have both an open tag and a close tag. Generally, when you add a child element to an existing element, you indent one level. By convention, indentation is normally two or four spaces, depending on your team’s preferences. Sometimes, people use tabs instead of spaces. Relationships have <a href="https://www.youtube.com/watch?v=SsoOG6ZeyUI">broken up over this issue</a>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb88-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb88-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb88-4" title="4">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb88-5" title="5">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb88-6" title="6">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb88-7" title="7"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p>Finally, add an opening and closing <code>title</code> tag as a child of the <code>head</code>. Make sure it has content reading "My HTML Cheat Sheet". That is the content that you will see in the tab or the title bar of your browser. It can be (and is, in this case) different from the name of your HTML file.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb89-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb89-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb89-4" title="4">    <span class="kw">&lt;title&gt;</span>My HTML Cheat Sheet<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb89-5" title="5">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb89-6" title="6">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb89-7" title="7">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb89-8" title="8"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p>And, that is a valid, minimal HTML 5 document just waiting for some happy content. (It is not the <em>most minimal</em> as pedants across the Internet will happily tell you. Technically, the <em>most minimal</em> is <code>&lt;!DOCTYPE html&gt;&lt;title&gt;.&lt;/title&gt;</code>. But, that’s not really usable, now, is it?)</p>
<h2 id="add-a-style-sheet-to-your-html-document">Add a style sheet to your HTML document</h2>
<p>This isn’t necessary. But, hey, no one likes looking at the ugly that is the default browser settings. There are a whole lot of CSS modules and frameworks out there for you to use and add to accelerate your Web page styling. Since this walk through is primarily about HTML, you’re asked to use a small CSS project named <a href="https://purecss.io">Pure.css</a>.</p>
<p>You do this using a <code>link</code> tag. The <code>link</code> tag is an <strong>empty tag</strong>, which means that it has no content and no end tag in its element. When you link another file to this file, you have to specify the <em>relation</em> of the link using the "rel" attribute. For stylesheets, you set the value of the "rel" attribute to "stylesheet". Then you specify the URL of the linked file using the "href" attribute. To link <a href="https://purecss.io">Pure.css</a>, add the following.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb90-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb90-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb90-4" title="4">    <span class="kw">&lt;title&gt;</span>My HTML Cheat Sheet<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb90-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span></a>
<a class="sourceLine" id="cb90-6" title="6"><span class="ot">          href=</span><span class="st">&quot;https://unpkg.com/purecss@1.0.1/build/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb90-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb90-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb90-9" title="9">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb90-10" title="10"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p>It doesn’t matter that this is the one you’re using for this project. If you’d like to try a different one, search for <a href="https://duckduckgo.com/?q=small+css+frameworks">"small css frameworks" using DuckDuckGo</a> and choose one that shows up.</p>
<p>Document this as part of the body. Add a <code>main</code> element as a child to the <code>body</code>. As the content of the <code>main</code>, add an <code>h1</code> element with the content "Linking a stylesheet". After it, add a <code>p</code> element with the content describing what you just did.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb91-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb91-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb91-4" title="4">    <span class="kw">&lt;title&gt;</span>My HTML Cheat Sheet<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb91-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span></a>
<a class="sourceLine" id="cb91-6" title="6"><span class="ot">          href=</span><span class="st">&quot;https://unpkg.com/purecss@1.0.1/build/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb91-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb91-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb91-9" title="9">    <span class="kw">&lt;main&gt;</span></a>
<a class="sourceLine" id="cb91-10" title="10">      <span class="kw">&lt;h1&gt;</span>Linking a stylesheet<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb91-11" title="11">      <span class="kw">&lt;p&gt;</span>Describe here what you just did to add a stylesheet to the page<span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb91-12" title="12">    <span class="kw">&lt;/main&gt;</span></a>
<a class="sourceLine" id="cb91-13" title="13">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb91-14" title="14"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
The <code>main</code> element represents "the dominant content of the
<body>
<p>of a document. The main content area consists of content that is directly related to or expands upon the central topic of a document, or the central functionality of an application." (from MDN)</p>
<h2 id="creating-some-lists">Creating some lists</h2>
<p>There are three types of lists in HTML: <strong>unordered lists</strong> (bullet lists), <strong>ordered lists</strong> (numbered lists), and <strong>definition lists</strong>. Very few programmers use definition lists, so you can investigate those on your own.</p>
<h3 id="the-unordered-list">The unordered list</h3>
<p>Create a new <code>h1</code> element after the paragraph element containing the description of how you added a stylesheet. Set it’s content to "List-o-rama!". After that element, create an <em>unordered list</em> element (<code>ul</code>). Add three <strong>list item</strong> elements as children of the <em>unordered list</em> element and set the content to "Lettuce", "Bananas", and "Jalapeños", respectively. Refresh your page to see your list.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb92-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb92-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb92-4" title="4">    <span class="kw">&lt;title&gt;</span>My HTML Cheat Sheet<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb92-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span></a>
<a class="sourceLine" id="cb92-6" title="6"><span class="ot">          href=</span><span class="st">&quot;https://unpkg.com/purecss@1.0.1/build/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb92-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb92-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb92-9" title="9">    <span class="kw">&lt;main&gt;</span></a>
<a class="sourceLine" id="cb92-10" title="10">      <span class="kw">&lt;h1&gt;</span>Linking a stylesheet<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb92-11" title="11">      <span class="kw">&lt;p&gt;</span>Describe here what you just did to add a stylesheet to the page<span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb92-12" title="12"></a>
<a class="sourceLine" id="cb92-13" title="13">      <span class="kw">&lt;h1&gt;</span>List-o-rama!<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb92-14" title="14">      <span class="kw">&lt;ul&gt;</span></a>
<a class="sourceLine" id="cb92-15" title="15">        <span class="kw">&lt;li&gt;</span>Lettuce<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb92-16" title="16">        <span class="kw">&lt;li&gt;</span>Bananas<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb92-17" title="17">        <span class="kw">&lt;li&gt;</span>Jalapeños<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb92-18" title="18">      <span class="kw">&lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb92-19" title="19">    <span class="kw">&lt;/main&gt;</span></a>
<a class="sourceLine" id="cb92-20" title="20">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb92-21" title="21"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p><strong>Challenge</strong>: Change the type of bullets from circles to squares using an attribute of the <code>ul</code> element.</p>
<h3 id="the-ordered-list">The ordered list</h3>
<p>After the <em>unordered list</em> element, add an <strong>ordered list</strong> (<code>ol</code>) element with three <em>list item</em> elements with the content "Have an idea", "Write an app", "Profit!", respectively. Refresh your page and see the steps to success!</p>
<p>Note that the <em>ordered list</em> and the <em>unordered list</em> both use the common <em>list item</em> element to provide the structure to each list. The browser then determines to show each with either a bullet or a number depending on the type of enclosing list.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb93-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb93-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb93-4" title="4">    <span class="kw">&lt;title&gt;</span>My HTML Cheat Sheet<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb93-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span></a>
<a class="sourceLine" id="cb93-6" title="6"><span class="ot">          href=</span><span class="st">&quot;https://unpkg.com/purecss@1.0.1/build/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb93-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb93-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb93-9" title="9">    <span class="kw">&lt;main&gt;</span></a>
<a class="sourceLine" id="cb93-10" title="10">      <span class="kw">&lt;h1&gt;</span>Linking a stylesheet<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb93-11" title="11">      <span class="kw">&lt;p&gt;</span>Describe here what you just did to add a stylesheet to the page<span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb93-12" title="12"></a>
<a class="sourceLine" id="cb93-13" title="13">      <span class="kw">&lt;h1&gt;</span>List-o-rama!<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb93-14" title="14">      <span class="kw">&lt;ul&gt;</span></a>
<a class="sourceLine" id="cb93-15" title="15">        <span class="kw">&lt;li&gt;</span>Lettuce<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb93-16" title="16">        <span class="kw">&lt;li&gt;</span>Bananas<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb93-17" title="17">        <span class="kw">&lt;li&gt;</span>Jalapeños<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb93-18" title="18">      <span class="kw">&lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb93-19" title="19">      <span class="kw">&lt;ol&gt;</span></a>
<a class="sourceLine" id="cb93-20" title="20">        <span class="kw">&lt;li&gt;</span>Have an idea<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb93-21" title="21">        <span class="kw">&lt;li&gt;</span>Write an app<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb93-22" title="22">        <span class="kw">&lt;li&gt;</span>Profit!<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb93-23" title="23">      <span class="kw">&lt;/ol&gt;</span></a>
<a class="sourceLine" id="cb93-24" title="24">    <span class="kw">&lt;/main&gt;</span></a>
<a class="sourceLine" id="cb93-25" title="25">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb93-26" title="26"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p><strong>Challenge</strong>: Change the numbering type from numbers to lowercase Roman numerals using an attribute of the <code>ol</code> element.</p>
<p><strong>Challenge</strong>: Change the starting number of the ordered list from 1 to 10 using an attribute of the <code>ol</code> element.</p>
<p><strong>Challenge</strong>: Reverse the order of the numbers in the list using an attribute of the <code>ol</code> element.</p>
<p>Add a paragraph element between the <code>h1</code> and the <code>ul</code>. Describe what you did to make your lists.</p>
<h2 id="now-youre-going-places">Now, you’re going places!</h2>
<p>People navigate between Web pages by clicking on links. Now, you think you’d use the <code>link</code> element to do that. NOPE! SURPRISE! GOTCHA! That’s not what you use. Instead, you use an <strong>anchor element</strong> (<code>a</code>). According to <em>HTML for Dummies</em>, "An anchor element is called an anchor because web designers can use it to"anchor" a URL to some text on a web page."</p>
<p>The <em>anchor element</em> uses the same attributes as the <em>link element</em>, primarily relying on the "href" attribute to point where the link goes. After the lists, add a new <code>h1</code> element that describes the section, add a paragraph that contains some text about how links work, and then, in the paragraph, add an <em>anchor element</em> with an "href" attribute that points to DuckDuckGo with the content "Go to DuckDuckGo to search for more information."</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb94-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb94-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb94-4" title="4">    <span class="kw">&lt;title&gt;</span>My HTML Cheat Sheet<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb94-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span></a>
<a class="sourceLine" id="cb94-6" title="6"><span class="ot">          href=</span><span class="st">&quot;https://unpkg.com/purecss@1.0.1/build/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb94-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb94-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb94-9" title="9">    <span class="kw">&lt;main&gt;</span></a>
<a class="sourceLine" id="cb94-10" title="10">      <span class="kw">&lt;h1&gt;</span>Linking a stylesheet<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb94-11" title="11">      <span class="kw">&lt;p&gt;</span>Describe here what you just did to add a stylesheet to the page<span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb94-12" title="12"></a>
<a class="sourceLine" id="cb94-13" title="13">      <span class="kw">&lt;h1&gt;</span>List-o-rama!<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb94-14" title="14">      <span class="kw">&lt;ul&gt;</span></a>
<a class="sourceLine" id="cb94-15" title="15">        <span class="kw">&lt;li&gt;</span>Lettuce<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb94-16" title="16">        <span class="kw">&lt;li&gt;</span>Bananas<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb94-17" title="17">        <span class="kw">&lt;li&gt;</span>Jalapeños<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb94-18" title="18">      <span class="kw">&lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb94-19" title="19">      <span class="kw">&lt;ol&gt;</span></a>
<a class="sourceLine" id="cb94-20" title="20">        <span class="kw">&lt;li&gt;</span>Have an idea<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb94-21" title="21">        <span class="kw">&lt;li&gt;</span>Write an app<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb94-22" title="22">        <span class="kw">&lt;li&gt;</span>Profit!<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb94-23" title="23">      <span class="kw">&lt;/ol&gt;</span></a>
<a class="sourceLine" id="cb94-24" title="24"></a>
<a class="sourceLine" id="cb94-25" title="25">      <span class="kw">&lt;h1&gt;</span>Anchors (which are really links)<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb94-26" title="26">      <span class="kw">&lt;p&gt;</span></a>
<a class="sourceLine" id="cb94-27" title="27">        Some text about anchor tags.</a>
<a class="sourceLine" id="cb94-28" title="28">        <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;https://duckduckgo.com&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb94-29" title="29">          Go to DuckDuckGo to search for more information.</a>
<a class="sourceLine" id="cb94-30" title="30">        <span class="kw">&lt;/a&gt;</span></a>
<a class="sourceLine" id="cb94-31" title="31">      <span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb94-32" title="32">    <span class="kw">&lt;/main&gt;</span></a>
<a class="sourceLine" id="cb94-33" title="33">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb94-34" title="34"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<h2 id="wait.-sections">Wait. Sections!</h2>
<p>That’s right! HTML 5 introduced a new element called the <strong>section element</strong>! You now have three sections on the page! Go put _section element_s around each of the sections. Indent properly for human readability.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb95-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb95-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb95-4" title="4">    <span class="kw">&lt;title&gt;</span>My HTML Cheat Sheet<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb95-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span></a>
<a class="sourceLine" id="cb95-6" title="6"><span class="ot">          href=</span><span class="st">&quot;https://unpkg.com/purecss@1.0.1/build/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb95-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb95-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb95-9" title="9">    <span class="kw">&lt;main&gt;</span></a>
<a class="sourceLine" id="cb95-10" title="10">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb95-11" title="11">        <span class="kw">&lt;h1&gt;</span>Linking a stylesheet<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb95-12" title="12">        <span class="kw">&lt;p&gt;</span>Describe here what you just did to add a stylesheet to the page<span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb95-13" title="13">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb95-14" title="14"></a>
<a class="sourceLine" id="cb95-15" title="15">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb95-16" title="16">        <span class="kw">&lt;h1&gt;</span>List-o-rama!<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb95-17" title="17">        <span class="kw">&lt;ul&gt;</span></a>
<a class="sourceLine" id="cb95-18" title="18">          <span class="kw">&lt;li&gt;</span>Lettuce<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb95-19" title="19">          <span class="kw">&lt;li&gt;</span>Bananas<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb95-20" title="20">          <span class="kw">&lt;li&gt;</span>Jalapeños<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb95-21" title="21">        <span class="kw">&lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb95-22" title="22">        <span class="kw">&lt;ol&gt;</span></a>
<a class="sourceLine" id="cb95-23" title="23">          <span class="kw">&lt;li&gt;</span>Have an idea<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb95-24" title="24">          <span class="kw">&lt;li&gt;</span>Write an app<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb95-25" title="25">          <span class="kw">&lt;li&gt;</span>Profit!<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb95-26" title="26">        <span class="kw">&lt;/ol&gt;</span></a>
<a class="sourceLine" id="cb95-27" title="27">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb95-28" title="28"></a>
<a class="sourceLine" id="cb95-29" title="29">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb95-30" title="30">        <span class="kw">&lt;h1&gt;</span>Anchors (which are really links)<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb95-31" title="31">        <span class="kw">&lt;p&gt;</span></a>
<a class="sourceLine" id="cb95-32" title="32">          Some text about anchor tags.</a>
<a class="sourceLine" id="cb95-33" title="33">          <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;https://duckduckgo.com&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb95-34" title="34">            Go to DuckDuckGo to search for more information.</a>
<a class="sourceLine" id="cb95-35" title="35">          <span class="kw">&lt;/a&gt;</span></a>
<a class="sourceLine" id="cb95-36" title="36">        <span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb95-37" title="37">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb95-38" title="38">    <span class="kw">&lt;/main&gt;</span></a>
<a class="sourceLine" id="cb95-39" title="39">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb95-40" title="40"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p>When you refresh the page, you will notice that there is no difference to what is shown. That’s because <em>section elements</em> are about the structure of the document. You can now look at this document and see that it has three stand-alone sections to it and understand the content is independent of one another. Structure is very important in HTML 5.</p>
<h2 id="add-an-image">Add an image</h2>
<p>Add a new section. Add a new header that labels this is the image section. Add a paragraph. Now, in the paragraph, add an <strong>image element</strong> (<code>img</code>) that has a source attribute named "src" to which you assign the URL of the image that you want to see. Here’s a list of URLs from which you can choose.</p>
<pre><code>Cute kitty: http://images.freeimages.com/images/premium/large-thumbs/2582/25827620-itty-bitty-kitty.jpg
Cute hippo: https://www.babyanimalzoo.com/wp-content/uploads/2011/10/cute-baby-hippo-tortoise-friends-pic-150x150.jpg
Cute lemur: images/Lemur-5-150x150.jpg</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb97-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb97-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb97-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb97-4" title="4">    <span class="kw">&lt;title&gt;</span>My HTML Cheat Sheet<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb97-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span></a>
<a class="sourceLine" id="cb97-6" title="6"><span class="ot">          href=</span><span class="st">&quot;https://unpkg.com/purecss@1.0.1/build/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb97-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb97-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb97-9" title="9">    <span class="kw">&lt;main&gt;</span></a>
<a class="sourceLine" id="cb97-10" title="10">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb97-11" title="11">        <span class="kw">&lt;h1&gt;</span>Linking a stylesheet<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb97-12" title="12">        <span class="kw">&lt;p&gt;</span>Describe here what you just did to add a stylesheet to the page<span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb97-13" title="13">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb97-14" title="14"></a>
<a class="sourceLine" id="cb97-15" title="15">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb97-16" title="16">        <span class="kw">&lt;h1&gt;</span>List-o-rama!<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb97-17" title="17">        <span class="kw">&lt;ul&gt;</span></a>
<a class="sourceLine" id="cb97-18" title="18">          <span class="kw">&lt;li&gt;</span>Lettuce<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb97-19" title="19">          <span class="kw">&lt;li&gt;</span>Bananas<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb97-20" title="20">          <span class="kw">&lt;li&gt;</span>Jalapeños<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb97-21" title="21">        <span class="kw">&lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb97-22" title="22">        <span class="kw">&lt;ol&gt;</span></a>
<a class="sourceLine" id="cb97-23" title="23">          <span class="kw">&lt;li&gt;</span>Have an idea<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb97-24" title="24">          <span class="kw">&lt;li&gt;</span>Write an app<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb97-25" title="25">          <span class="kw">&lt;li&gt;</span>Profit!<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb97-26" title="26">        <span class="kw">&lt;/ol&gt;</span></a>
<a class="sourceLine" id="cb97-27" title="27">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb97-28" title="28"></a>
<a class="sourceLine" id="cb97-29" title="29">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb97-30" title="30">        <span class="kw">&lt;h1&gt;</span>Anchors (which are really links)<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb97-31" title="31">        <span class="kw">&lt;p&gt;</span></a>
<a class="sourceLine" id="cb97-32" title="32">          Some text about anchor tags.</a>
<a class="sourceLine" id="cb97-33" title="33">          <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;https://duckduckgo.com&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb97-34" title="34">            Go to DuckDuckGo to search for more information.</a>
<a class="sourceLine" id="cb97-35" title="35">          <span class="kw">&lt;/a&gt;</span></a>
<a class="sourceLine" id="cb97-36" title="36">        <span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb97-37" title="37">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb97-38" title="38"></a>
<a class="sourceLine" id="cb97-39" title="39">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb97-40" title="40">        <span class="kw">&lt;h1&gt;</span>Images<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb97-41" title="41">        <span class="kw">&lt;p&gt;</span></a>
<a class="sourceLine" id="cb97-42" title="42">          You can use the img tag to add images to your page.</a>
<a class="sourceLine" id="cb97-43" title="43">          <span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;images/Lemur-5-150x150.jpg&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb97-44" title="44">        <span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb97-45" title="45">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb97-46" title="46">    <span class="kw">&lt;/main&gt;</span></a>
<a class="sourceLine" id="cb97-47" title="47">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb97-48" title="48"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<h2 id="adding-tabular-data">Adding tabular data</h2>
<p>Add a new section. Add a new header that labels this is the table section.</p>
<p>Tables in HTML are great for displaying tabular data, such as an address book or a list of product descriptions and prices. Although tables are good for keeping things organized, tables should only be used for displaying data, not for defining the layout of a page.</p>
<p>Creating tables can be a little confusing at first. The best way to learn tables is to create an example.</p>
<p>You create a table using the <code>&lt;table&gt;</code> tag.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">&lt;table&gt;</span></a>
<a class="sourceLine" id="cb98-2" title="2"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
<p>If your table has a header, that is, rows that should be considered as the column headers, you add a <code>&lt;thead&gt;</code>. Then you add a <code>&lt;tbody&gt;</code> which should contain the data of your table. If your table has a footer, that is, rows that summarize the tabular data, then you add a <code>&lt;tfoot&gt;</code>, too. Finally</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">&lt;table&gt;</span></a>
<a class="sourceLine" id="cb99-2" title="2">  <span class="kw">&lt;thead&gt;</span></a>
<a class="sourceLine" id="cb99-3" title="3">  <span class="kw">&lt;/thead&gt;</span></a>
<a class="sourceLine" id="cb99-4" title="4">  <span class="kw">&lt;tbody&gt;</span></a>
<a class="sourceLine" id="cb99-5" title="5">  <span class="kw">&lt;/tbody&gt;</span></a>
<a class="sourceLine" id="cb99-6" title="6">  <span class="kw">&lt;tfoot&gt;</span></a>
<a class="sourceLine" id="cb99-7" title="7">  <span class="kw">&lt;/tfoot&gt;</span></a>
<a class="sourceLine" id="cb99-8" title="8"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
Now, add rows to the table, row by row, using the
<tr>
<p>table row tag for each row.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">&lt;table&gt;</span></a>
<a class="sourceLine" id="cb100-2" title="2">  <span class="kw">&lt;thead&gt;</span></a>
<a class="sourceLine" id="cb100-3" title="3">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb100-4" title="4">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb100-5" title="5">  <span class="kw">&lt;/thead&gt;</span></a>
<a class="sourceLine" id="cb100-6" title="6">  <span class="kw">&lt;tbody&gt;</span></a>
<a class="sourceLine" id="cb100-7" title="7">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb100-8" title="8">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb100-9" title="9">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb100-10" title="10">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb100-11" title="11">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb100-12" title="12">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb100-13" title="13">  <span class="kw">&lt;/tbody&gt;</span></a>
<a class="sourceLine" id="cb100-14" title="14">  <span class="kw">&lt;tfoot&gt;</span></a>
<a class="sourceLine" id="cb100-15" title="15">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb100-16" title="16">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb100-17" title="17">  <span class="kw">&lt;/tfoot&gt;</span></a>
<a class="sourceLine" id="cb100-18" title="18"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
<p>In the rows, put <code>&lt;th&gt;</code> elements and signify that it is a column or row header using the "scope" attribute. Put <code>&lt;td&gt;</code> to hold the data.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">&lt;table&gt;</span></a>
<a class="sourceLine" id="cb101-2" title="2">  <span class="kw">&lt;thead&gt;</span></a>
<a class="sourceLine" id="cb101-3" title="3">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb101-4" title="4">      <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;column&quot;</span><span class="kw">&gt;</span>Insect<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb101-5" title="5">      <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;column&quot;</span><span class="kw">&gt;</span>Family<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb101-6" title="6">      <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;column&quot;</span><span class="kw">&gt;</span>Fact<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb101-7" title="7">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb101-8" title="8">  <span class="kw">&lt;/thead&gt;</span></a>
<a class="sourceLine" id="cb101-9" title="9">  <span class="kw">&lt;tbody&gt;</span></a>
<a class="sourceLine" id="cb101-10" title="10">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb101-11" title="11">      <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;row&quot;</span><span class="kw">&gt;</span>Ladybug<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb101-12" title="12">      <span class="kw">&lt;td&gt;</span>Coccinellidae<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb101-13" title="13">      <span class="kw">&lt;td&gt;</span>Can eat more than 5,000 insects!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb101-14" title="14">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb101-15" title="15">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb101-16" title="16">      <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;row&quot;</span><span class="kw">&gt;</span>Fruit flies<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb101-17" title="17">      <span class="kw">&lt;td&gt;</span>Drosophilidae<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb101-18" title="18">      <span class="kw">&lt;td&gt;</span>First living creatures in outer space!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb101-19" title="19">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb101-20" title="20">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb101-21" title="21">      <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;row&quot;</span><span class="kw">&gt;</span>Caterpillars<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb101-22" title="22">      <span class="kw">&lt;td&gt;</span>Heterobathmiidae<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb101-23" title="23">      <span class="kw">&lt;td&gt;</span>Have 12 eyes!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb101-24" title="24">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb101-25" title="25">  <span class="kw">&lt;/tbody&gt;</span></a>
<a class="sourceLine" id="cb101-26" title="26">  <span class="kw">&lt;tfoot&gt;</span></a>
<a class="sourceLine" id="cb101-27" title="27">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb101-28" title="28">      <span class="kw">&lt;td&gt;&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb101-29" title="29">      <span class="kw">&lt;td&gt;</span>I had no idaes!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb101-30" title="30">      <span class="kw">&lt;td&gt;</span>Those are neat!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb101-31" title="31">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb101-32" title="32">  <span class="kw">&lt;/tfoot&gt;</span></a>
<a class="sourceLine" id="cb101-33" title="33"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
<p>Just to make it pretty with the Pure.css on the page, add the classes "pure-table" and "pure-table-striped" to the opening "table" tag.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">&lt;table</span><span class="ot"> class=</span><span class="st">&quot;pure-table pure-table-striped&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>Add a paragraph and describe the structure of a table and how it works.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb103-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb103-2" title="2"><span class="kw">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb103-3" title="3">  <span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb103-4" title="4">    <span class="kw">&lt;title&gt;</span>My HTML Cheat Sheet<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb103-5" title="5">    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span></a>
<a class="sourceLine" id="cb103-6" title="6"><span class="ot">          href=</span><span class="st">&quot;https://unpkg.com/purecss@1.0.1/build/pure-min.css&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb103-7" title="7">  <span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb103-8" title="8">  <span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb103-9" title="9">    <span class="kw">&lt;main&gt;</span></a>
<a class="sourceLine" id="cb103-10" title="10">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb103-11" title="11">        <span class="kw">&lt;h1&gt;</span>Linking a stylesheet<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb103-12" title="12">        <span class="kw">&lt;p&gt;</span>Describe here what you just did to add a stylesheet to the page<span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb103-13" title="13">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb103-14" title="14"></a>
<a class="sourceLine" id="cb103-15" title="15">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb103-16" title="16">        <span class="kw">&lt;h1&gt;</span>List-o-rama!<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb103-17" title="17">        <span class="kw">&lt;ul&gt;</span></a>
<a class="sourceLine" id="cb103-18" title="18">          <span class="kw">&lt;li&gt;</span>Lettuce<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb103-19" title="19">          <span class="kw">&lt;li&gt;</span>Bananas<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb103-20" title="20">          <span class="kw">&lt;li&gt;</span>Jalapeños<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb103-21" title="21">        <span class="kw">&lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb103-22" title="22">        <span class="kw">&lt;ol&gt;</span></a>
<a class="sourceLine" id="cb103-23" title="23">          <span class="kw">&lt;li&gt;</span>Have an idea<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb103-24" title="24">          <span class="kw">&lt;li&gt;</span>Write an app<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb103-25" title="25">          <span class="kw">&lt;li&gt;</span>Profit!<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb103-26" title="26">        <span class="kw">&lt;/ol&gt;</span></a>
<a class="sourceLine" id="cb103-27" title="27">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb103-28" title="28"></a>
<a class="sourceLine" id="cb103-29" title="29">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb103-30" title="30">        <span class="kw">&lt;h1&gt;</span>Anchors (which are really links)<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb103-31" title="31">        <span class="kw">&lt;p&gt;</span></a>
<a class="sourceLine" id="cb103-32" title="32">          Some text about anchor tags.</a>
<a class="sourceLine" id="cb103-33" title="33">          <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;https://duckduckgo.com&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb103-34" title="34">            Go to DuckDuckGo to search for more information.</a>
<a class="sourceLine" id="cb103-35" title="35">          <span class="kw">&lt;/a&gt;</span></a>
<a class="sourceLine" id="cb103-36" title="36">        <span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb103-37" title="37">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb103-38" title="38"></a>
<a class="sourceLine" id="cb103-39" title="39">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb103-40" title="40">        <span class="kw">&lt;h1&gt;</span>Images<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb103-41" title="41">        <span class="kw">&lt;p&gt;</span></a>
<a class="sourceLine" id="cb103-42" title="42">          You can use the img tag to add images to your page.</a>
<a class="sourceLine" id="cb103-43" title="43">          <span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;http://wanderlord.com/wp-content/uploads/2015/11/Lemur-5-150x150.jpg&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb103-44" title="44">        <span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb103-45" title="45">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb103-46" title="46"></a>
<a class="sourceLine" id="cb103-47" title="47">      <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb103-48" title="48">        <span class="kw">&lt;h1&gt;</span>Tables<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb103-49" title="49">        <span class="kw">&lt;table&gt;</span></a>
<a class="sourceLine" id="cb103-50" title="50">          <span class="kw">&lt;thead&gt;</span></a>
<a class="sourceLine" id="cb103-51" title="51">            <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb103-52" title="52">              <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;column&quot;</span><span class="kw">&gt;</span>Insect<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb103-53" title="53">              <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;column&quot;</span><span class="kw">&gt;</span>Family<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb103-54" title="54">              <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;column&quot;</span><span class="kw">&gt;</span>Fact<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb103-55" title="55">            <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb103-56" title="56">          <span class="kw">&lt;/thead&gt;</span></a>
<a class="sourceLine" id="cb103-57" title="57">          <span class="kw">&lt;tbody&gt;</span></a>
<a class="sourceLine" id="cb103-58" title="58">            <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb103-59" title="59">              <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;row&quot;</span><span class="kw">&gt;</span>Ladybug<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb103-60" title="60">              <span class="kw">&lt;td&gt;</span>Coccinellidae<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb103-61" title="61">              <span class="kw">&lt;td&gt;</span>Can eat more than 5,000 insects!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb103-62" title="62">            <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb103-63" title="63">            <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb103-64" title="64">              <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;row&quot;</span><span class="kw">&gt;</span>Fruit flies<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb103-65" title="65">              <span class="kw">&lt;td&gt;</span>Drosophilidae<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb103-66" title="66">              <span class="kw">&lt;td&gt;</span>First living creatures in outer space!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb103-67" title="67">            <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb103-68" title="68">            <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb103-69" title="69">              <span class="kw">&lt;th</span><span class="ot"> scope=</span><span class="st">&quot;row&quot;</span><span class="kw">&gt;</span>Caterpillars<span class="kw">&lt;/th&gt;</span></a>
<a class="sourceLine" id="cb103-70" title="70">              <span class="kw">&lt;td&gt;</span>Heterobathmiidae<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb103-71" title="71">              <span class="kw">&lt;td&gt;</span>Have 12 eyes!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb103-72" title="72">            <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb103-73" title="73">          <span class="kw">&lt;/tbody&gt;</span></a>
<a class="sourceLine" id="cb103-74" title="74">          <span class="kw">&lt;tfoot&gt;</span></a>
<a class="sourceLine" id="cb103-75" title="75">            <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb103-76" title="76">              <span class="kw">&lt;td&gt;&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb103-77" title="77">              <span class="kw">&lt;td&gt;</span>I had no idaes!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb103-78" title="78">              <span class="kw">&lt;td&gt;</span>Those are neat!<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb103-79" title="79">            <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb103-80" title="80">          <span class="kw">&lt;/tfoot&gt;</span></a>
<a class="sourceLine" id="cb103-81" title="81">        <span class="kw">&lt;/table&gt;</span></a>
<a class="sourceLine" id="cb103-82" title="82">        <span class="kw">&lt;p&gt;</span>Write some text about your experience with tables, here.<span class="kw">&lt;/p&gt;</span></a>
<a class="sourceLine" id="cb103-83" title="83">      <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb103-84" title="84">    <span class="kw">&lt;/main&gt;</span></a>
<a class="sourceLine" id="cb103-85" title="85">  <span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb103-86" title="86"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<h2 id="other-content-section-tags">Other content section tags</h2>
<p>Here are some tags that you will definitely want to use in your own work. However, there’s not really a section on this page to use them, really. So, add a new section, and add them and their summaries to a list or table of your cheat sheet.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/article">article</a> element</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/footer">footer</a> element</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/header">header</a> element</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/nav">nav</a> element</li>
</ul>
<h2 id="forms">Forms</h2>
<p>Please read the following articles on Mozilla Developer Network to give yourself good exposure to forms. Add the forms that you build to one or more new sections in this cheat sheet.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/Your_first_form">Your first form</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/How_to_structure_a_web_form">How to structure a web form</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/HTML5_input_types">The HTML5 input types</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/Other_form_controls">Other form controls</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation">Client-side form validation</a></li>
</ul>
<h2 id="what-youve-learned-4">What you’ve learned</h2>
<p>You’ve learned how to create valid HTML 5 pages using structural and form elements with client side validation. Moreover, using those elements, you created a cheat sheet for yourself so that you can come back and refer to it as you continue to grow familiar with how to wield HTML 5 as a markup language to create compelling Web experiences!</p>
<hr />
<h1 id="project-trivia-game-three-ways">Project: Trivia Game Three Ways</h1>
<p>In this project, you are going to create a trivia game using the three different asynchronous programming styles that you know: using callbacks, using <code>Promise</code> objects, and using <code>async</code> and <code>await</code>. You will use <a href="https://jservice.xyz">jservice.xyz</a>, a data service that contains the data of over 6000 Jeopardy games.</p>
<p>You’ll be using ES6 modules in this project. After you create your project directory, don’t forget to start a local HTTP server using <code>python3 -m http.server</code> and opening your browser to http://localhost:8000 (or whatever the correct port number is).</p>
<h2 id="create-the-html-and-css">Create the HTML and CSS</h2>
<p>Create the following files:</p>
<ul>
<li><strong>game.js</strong>: This will be the entry point for your game.</li>
<li><strong>game.css</strong>: This will contain the CSS to make your HTML look good.</li>
<li><strong>index.html</strong>: This will contain the HTML for your game.</li>
</ul>
<p>Create HTML that has the following structure inside a well-formed HTML document that contains <code>html</code>, <code>head</code>, <code>title</code>, <code>body</code>, and <code>main</code> elements.</p>
<p>In the <code>head</code>, add a <code>link</code> element that links in the CSS from <a href="https://purecss.io">Pure.css</a>. Click on the link to get the exact text for the <code>link</code> element from the Pure Web site. Also, use the <code>link</code> element to include the "game.css" file. Use a <code>script</code> element to include the "game.js" file as an <em>ES6 module</em>.</p>
<p>In the <code>main</code> element, add the following:</p>
<ul>
<li>A <code>div</code> element with an "id" of "game-board"</li>
<li>Inside the "game-board" element
<ul>
<li>Laid out in a row,
<ul>
<li>A <code>button</code> element with an "id" of "use-callback" that reads "Use a callback" and the class "pure-button"</li>
<li>A <code>button</code> element with an "id" of "use-promise" that reads "Use a Promise" and the class "pure-button"</li>
<li>A <code>button</code> element with an "id" of "use-async-await" that reads "Use async/await" and the class "pure-button"</li>
</ul></li>
<li>A <code>div</code> element with an "id" of "score"</li>
<li>A <code>div</code> element with an "id" of "category-title"</li>
<li>A <code>div</code> element with an "id" of "question"</li>
<li>A <code>div</code> element with an "id" of "value"</li>
<li>A <code>div</code> element with an "id" of "invalid-count"</li>
<li>A <code>form</code> element with a class of "pure-form" and a child element of
<ul>
<li>A <code>textarea</code> element with an "id" of "player-response" and the class "pure-input-1"</li>
</ul></li>
<li>A <code>button</code> element with an "id" of "check-response" that reads "Check response" and the class "pure-button"</li>
<li>A <code>div</code> element with an "id" of "answer"</li>
</ul></li>
</ul>
<p>Now, add the following to your CSS file</p>
<ul>
<li>A rule for the "body" element that sets the background color to "#DFDFDF"</li>
<li>A rule for the element with the id of "game-board" that sets its "width" to 600px, its "margin" to "auto", its "padding" to "1em", and its background color to "white"</li>
<li>A rule for the element with the id of "score" that sets its "font-size" to "1.5em" and its "margin" to "1.25em 0"</li>
<li>A rule for the element with the id of "answer" that sets its "font-size" to "1.5em" and its "margin" to "1.25em 0"</li>
<li>A rule for the element with the id of "value" that sets its "font-size" to "1.25em" and its "margin" to "1.25em 0"</li>
<li>A rule for the element with the id of "category-title" that sets its "font-size" to "1em" and its "margin" to "1.25em 0"</li>
<li>A rule for the element with the id of "invalid-count" that sets its "font-size" to "1em" and its "margin" to "1.25em 0"</li>
<li>A rule for the element with the id of "question" that sets its "font-size" to "1.25em" and its "margin" to "1.25em 0"</li>
</ul>
<h2 id="using-a-callback">Using a callback</h2>
<p>You will now use a callback to get a random clue from the data service. The JSON string that will be returned will have the following structure when the call succeeds.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb104-1" title="1"><span class="op">{</span></a>
<a class="sourceLine" id="cb104-2" title="2">  <span class="st">&quot;id&quot;</span><span class="op">:</span> number<span class="op">,</span></a>
<a class="sourceLine" id="cb104-3" title="3">  <span class="st">&quot;answer&quot;</span><span class="op">:</span> string<span class="op">,</span></a>
<a class="sourceLine" id="cb104-4" title="4">  <span class="st">&quot;question&quot;</span><span class="op">:</span> string<span class="op">,</span></a>
<a class="sourceLine" id="cb104-5" title="5">  <span class="st">&quot;value&quot;</span><span class="op">:</span> number<span class="op">,</span></a>
<a class="sourceLine" id="cb104-6" title="6">  <span class="st">&quot;categoryId&quot;</span><span class="op">:</span> number<span class="op">,</span></a>
<a class="sourceLine" id="cb104-7" title="7">  <span class="st">&quot;category&quot;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb104-8" title="8">    <span class="st">&quot;id&quot;</span><span class="op">:</span> number<span class="op">,</span></a>
<a class="sourceLine" id="cb104-9" title="9">    <span class="st">&quot;title&quot;</span><span class="op">:</span> string</a>
<a class="sourceLine" id="cb104-10" title="10">  <span class="op">},</span></a>
<a class="sourceLine" id="cb104-11" title="11">  <span class="st">&quot;invalid_count&quot;</span><span class="op">?</span>: number</a>
<a class="sourceLine" id="cb104-12" title="12"><span class="op">}</span></a></code></pre></div>
<p>Create a new file named "callback-version.js". Declare and export a function named <code>getClue</code> with a single parameter that is a callback. This is going to use the <code>XMLHttpRequest</code> object to get data from the jservice.xyz data service.</p>
<h3 id="using-callbacks-and-xmlhttprequest">Using Callbacks and XMLHttpRequest</h3>
<p>Back in the early 2000s, Microsoft released its Outlook for the Web Application, otherwise called "OWA" by those that had to install, configure, and use it. It was a beast. It was slow. It was hard to navigate. Then, Microsoft came up with this <em>great</em> idea: what if we invent a way to make an HTTP request in the browser <em>without</em> refreshing the page that the person is currently looking at? What if we could have some kind of "background request"? And, because we <em>love</em> this stuff called <a href="http://www.xmlhowto.com/is-xml-dead">XML</a>, we’ll put that in the name! Even though nowadays we almost never use it to transfer <a href="http://www.xmlhowto.com/is-xml-dead">XML</a>, we almost exclusively use JSON.</p>
<p>Hence, the <code>XMLHttpRequest</code> object was born into Microsoft Internet Explorer 5.5 and Web 2.0 was born.</p>
<p>This kind of object, the <code>XMLHttpRequest</code> object, it works exactly like the way you’d expect software designed by C++ programmers in the early 2000s to design anything: like yuck. Serious yuck. It performs an asynchronous HTTP request and expects you to register callbacks to make it do its thing. Say you wanted to get the forecast data for Linn, KS. Well, you’d want to issue an HTTP GET request for the URL https://api.weather.gov/points/39.7456,-97.0892. To do that with <code>XMLHttpRequest</code>, it’s a three step process:</p>
<ol type="1">
<li>Create an instance of the <code>XMLHttpRequest</code> class</li>
<li><p>Add an event listener for the "readystatechange" event on the object</p>
<ol type="1">
<li><p>In the event handler, check the <code>readyState</code> property to be equal to <code>XMLHttpRequest.DONE</code>. If it’s not, return.</p></li>
<li>If it is done, check the <code>status</code> property to make sure that its in the range 200 - 299, the "good" range. If it’s not, return.</li>
<li>Since everything is ok, do something with the content of the <code>responseText</code> property.</li>
</ol></li>
<li>Use the <code>open</code> method to specify the method and the URL. This doesn’t really "open" anything. It’s named that because it <em>could</em> open something. It doesn’t open something. It just registers the HTTP method and URL.</li>
<li><p>Use the <code>send</code> method to actually make the network request.</p></li>
</ol>
<p>In code, that looks like this.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb105-1" title="1"><span class="co">// Step 1</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="kw">const</span> xhr <span class="op">=</span> <span class="kw">new</span> <span class="at">XMLHttpRequest</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb105-3" title="3"></a>
<a class="sourceLine" id="cb105-4" title="4"><span class="co">// Step 2</span></a>
<a class="sourceLine" id="cb105-5" title="5"><span class="va">xhr</span>.<span class="at">addEventListener</span>(<span class="st">&#39;readystatechange&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb105-6" title="6">  <span class="co">// Step 2.1</span></a>
<a class="sourceLine" id="cb105-7" title="7">  <span class="cf">if</span> (<span class="va">xhr</span>.<span class="at">readyState</span> <span class="op">!==</span> <span class="va">XMLHttpRequest</span>.<span class="at">DONE</span>) <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb105-8" title="8"></a>
<a class="sourceLine" id="cb105-9" title="9">  <span class="co">// Step 2.2</span></a>
<a class="sourceLine" id="cb105-10" title="10">  <span class="cf">if</span> (<span class="va">xhr</span>.<span class="at">status</span> <span class="op">&lt;</span> <span class="dv">200</span> <span class="op">||</span> <span class="va">xhr</span>.<span class="at">status</span> <span class="op">&gt;=</span> <span class="dv">300</span>) <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb105-11" title="11"></a>
<a class="sourceLine" id="cb105-12" title="12">  <span class="co">// Step 2.3</span></a>
<a class="sourceLine" id="cb105-13" title="13">  <span class="kw">const</span> data <span class="op">=</span> <span class="va">JSON</span>.<span class="at">parse</span>(<span class="va">xhr</span>.<span class="at">responseText</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb105-14" title="14">  <span class="va">console</span>.<span class="at">log</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb105-15" title="15"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb105-16" title="16"></a>
<a class="sourceLine" id="cb105-17" title="17"><span class="co">// Step 3</span></a>
<a class="sourceLine" id="cb105-18" title="18"><span class="va">xhr</span>.<span class="at">open</span>(<span class="st">&#39;GET&#39;</span><span class="op">,</span> <span class="st">&#39;https://api.weather.gov/gridpoints/TOP/31,80/forecast&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb105-19" title="19"></a>
<a class="sourceLine" id="cb105-20" title="20"><span class="co">// Step 4</span></a>
<a class="sourceLine" id="cb105-21" title="21"><span class="va">xhr</span>.<span class="at">send</span>()<span class="op">;</span></a></code></pre></div>
<p>The order in which those actually execute are:</p>
<ul>
<li>Step 1</li>
<li>Step 2</li>
<li>Step 3</li>
<li>Step 4</li>
<li>Step 2.1 (more than once)</li>
<li>Step 2.2</li>
<li>Step 2.3</li>
</ul>
<p>So, asynchronous programming with a callback. Ugly, asynchronous programming with a callback. Ick. Guess what. Now you have to do your own version. Why? Because the industry moves slowly and not everyone has adopted the Fetch API.</p>
<h3 id="back-to-the-code">Back to the code</h3>
<p>The function should take a callback function as its only parameter. Write code in your <code>getClue</code> function that does the following.</p>
<p>Review the example at <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/AJAX/Getting_Started">Getting Started</a> to see how to use an <code>XMLHttpRequest</code> object.</p>
<ol type="1">
<li><p>Create an instance of the <code>XMLHttpRequest</code> class using the <code>new</code> operator.</p></li>
<li><p>Add an event listener for the <code>"readystatechange"</code> event on the object. In the event listener do the following:</p>
<ol type="1">
<li>If the <code>readyState</code> property of the object created in step 1 is not equal to the value <code>XMLHttpRequest.DONE</code>, then return from the method. This should look something like the following, assuming you named the object in step 1 "xhr":</li>
</ol>
<div class="sourceCode" id="cb106"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb106-1" title="1"><span class="cf">if</span> (<span class="va">xhr</span>.<span class="at">readyState</span> <span class="op">!==</span> <span class="va">XMLHttpRequest</span>.<span class="at">DONE</span>) <span class="cf">return</span><span class="op">;</span></a></code></pre></div>
<ol start="2" type="1">
<li><p>If the <code>status</code> property of the object created in step 1 is <em>not</em> 200, then something went awry. Call the callback function that is the argument to the <code>getClue</code> function with the value of the <code>status</code> property.</p></li>
<li><p>If the <code>status</code> property of the object created in step 1 <em>is</em> 200, then all is well and you got a clue back. Use the <code>JSON.parse</code> method to turn the value in the <code>responseText</code> property of the object created in step 1 into an object that contains the clue information. Call the callback method that is the argument to the <code>getClue</code> method with <code>null</code> as the first parameter and the deserialized object as the second.</p></li>
</ol></li>
<li><p>Use the <code>open</code> method of the object created in step 1, passing in "GET" as the first argument and "https://jservice.xyz/api/random-clue" as the second argument.</p></li>
<li><p>Invoke the <code>send</code> method of the object created in step 1, giving no arguments.</p></li>
</ol>
<p>In the "game.js" file, import the <code>getClue</code> function (using ES6 import syntax) from the "callback-version.js" file and alias it as <code>getClueFromCallback</code>.</p>
<p>Create a click handler for the button with the id "use-callback". In that event handler, call the <code>getClueFromCallback</code> function that you just imported, providing a callback function that takes two arguments, the error status code as the first parameter and the clue object as the second.</p>
<p>If the error status code is not null, then use <code>console.error</code> to write the error status code to the console.</p>
<p>Otherwise, set the content (<code>innerHTML</code>) of the <code>div</code> elements with the following ids to the values of the corresponding properties in the deserialized object:</p>
<ul>
<li>#question</li>
<li>#answer</li>
<li>#value</li>
<li>#categoryTitle</li>
</ul>
<blockquote>
<p>Hint: use <code>console.log</code> to print out the clue object to see what it contains. You can also use the Network tab in the Chrome developer tools to see the JSON being returned.</p>
</blockquote>
<p>For the <code>div</code> with the id "invalid-count", if the key "invalid_count" exists on the clue object and is greater than zero, then set the <code>innerHTML</code> of "invalid-count" to "invalid". Otherwise, set it to "valid".</p>
<p>Please try to implement the above code from your understanding of how it should work in addition to the description provided. If you find yourself struggling, there is code at the bottom of this article that shows you what to do. <strong>DO NOT COPY AND PASTE.</strong></p>
<h2 id="using-a-promise-object-with-fetch">Using a Promise object with fetch</h2>
<p>You will now use the "fetch API" built into the browsers to do the same thing. Please refer to the documentation for the "fetch API" on MDN’s <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">Using Fetch</a> article.</p>
<blockquote>
<p>Unlike Node.js you do not have to import any modules to use fetch in the Browser, it’s built in!</p>
</blockquote>
<p>Create a new file named "promise-version.js". You will use the same HTTP method and URL as you did in the previous section. The <em>response object</em> provided by the Fetch API has a convenience property on it named <code>ok</code>. If that value is true, then the HTTP request went okay and you can get the data from the response. Otherwise, you’ll want to indicate an error. Remember that the Fetch API will <em>not</em> fail on HTTP status codes in the ranges of 400 - 499 and 500 - 599. Instead, you will have to do make your own errors if <code>ok</code> is <code>false</code>.</p>
<p>Declare and export a function named <code>getClue</code>. In the function:</p>
<ol type="1">
<li><p>Use the <code>fetch</code> method to make a "GET" request to "https://jservice.xyz/api/random-clue". You will only need to pass in the URL to the <code>fetch</code> method because, by default, it makes "GET" requests.</p></li>
<li><p>Chain a <code>then</code> method to the <code>fetch</code> invocation. The <code>then</code> should have a function as its argument. The function will take a single parameter that represents the response from the server. In the function:</p>
<ol type="1">
<li><p>If the <code>ok</code> value of the response object is <code>false</code>, throw a new <code>Error</code> object that you create using the <code>status</code> property of the response object as the argument to the <code>Error</code> constructor.</p></li>
<li><p>If the <code>ok</code> value of the response object is <code>true</code>, invoke the <code>json</code> method on the response object and return its return value which automatically parses the data from server for you.</p></li>
</ol>
<blockquote>
<p>So why don’t we just let <code>.catch</code> handle this you might be thinking? Well if we get something like a 404 back, fetch does not throw an error. Instead we’ll blindly try to parse the 404 as if it’s JSON. So we check to make sure it’s <code>ok</code> (a 200 status) and if it’s not we manually throw an error.</p>
</blockquote></li>
<li><p>Return the object created by calling the <code>fetch</code> method and its <code>then</code> handler.</p></li>
</ol>
<p>In the "game.js" file, import the <code>getClue</code> function from the "promise-version.js" file and alias it as <code>getClueFromPromise</code>.</p>
<p>Create a click handler for the button with the id "use-promise". In that event handler, call the <code>getClueFromPromise</code> function that you just imported.</p>
<p>Chain a <code>then</code> handler onto the function call which will receive the clue object as it’s parameter. In that function handler, set the content (<code>innerHTML</code>) of the <code>div</code> elements with the following ids to the values of the corresponding properties in the deserialized object:</p>
<ul>
<li>#question</li>
<li>#answer</li>
<li>#value</li>
<li>#categoryTitle</li>
</ul>
<p>For the <code>div</code> with the id "invalid-count", if the key "invalid_count" exists on the clue object and is greater than zero, then set the <code>innerHTML</code> of "invalid-count" to "invalid". Otherwise, set it to "valid".</p>
<p>After that, chain a <code>catch</code> handler after the <code>then</code> handler. Have it print out to the console the <code>message</code> property of any error it gets.</p>
<p>You might notice this last step of setting the <code>innerHTML</code> of the elements is the exact same thing we did for <code>XMLHttpRequest</code>!</p>
<p>Since we don’t want to repeat ourselves, refactor this code into its own helper function that extracts values from the clue object and sets the HTML elements with those values. Then, in the two places where you get a clue object from the different asynchronous methods, call that function.</p>
<p>The solution code is in the last sections of this page.</p>
<h2 id="using-async-and-await">Using async and await</h2>
<p>You will now use the "fetch API" built into the browsers to do the same thing but you will use the "async/await" keywords in modern JavaScript.</p>
<p>Create a new file named "async-await-version.js". In it, declare and export an <em>async</em> function named <code>getClue</code> using ES6 Module format.</p>
<blockquote>
<p>(Yes, you can totally export an async function!)</p>
</blockquote>
<p>In the function:</p>
<ol type="1">
<li><p>Declare a constant named "response" and set it to the awaited value of the proper call to fetch with the URL "https://jservice.xyz/api/random-clue".</p></li>
<li><p>If the response is not <code>ok</code>, throw a new <code>Error</code> object that you create using the <code>status</code> property of the response object as the argument to the <code>Error</code> constructor.</p></li>
<li><p>If the response is <code>ok</code>, then return the awaited value of an invocation of the <code>json</code> method of the response object.</p></li>
</ol>
<p>In the "game.js" file, import the <code>getClue</code> function from the "async-await-version.js" file and alias it as <code>getClueFromAsyncFunction</code>.</p>
<p>Create an <em>async</em> click handler for the button with the id "use-async-await".</p>
<blockquote>
<p>Hint: you can even make arrow functions async by putting the <code>async</code> keyword in front of them! Fancy!</p>
</blockquote>
<p>In that event handler, write a <code>try</code>/<code>catch</code> block. In the <code>try</code>, get the value returned from awaiting the <code>getClueFromAsyncFunction</code> function.</p>
<p>Set the value to a variable named "clue". Pass that object into the function that you refactored in the last step that takes clue objects and sets the corresponding HTML elements to the appropriate property values.</p>
<p>In the catch block have it print out to the console the message property of any error it gets.</p>
<h2 id="make-it-a-game">Make it a game</h2>
<p>Start off a player’s score as zero. Hide the answer div by adding a CSS selector named <code>.is-hidden</code> with a property <code>display: none</code> to your <code>game.css</code> file. Set the class <code>is-hidden</code> on the <code>#answer</code> and <code>#check-response</code> elements in your <code>index.html</code>.</p>
<p>Add a click handler for <code>#check-response</code>. In that click handler, compare the value the player typed into the <code>textarea</code> with the id <code>player-response</code> with the <code>innerHTML</code> in the #answer element.</p>
<blockquote>
<p>Hint: you might have to use the <code>trim()</code> method on the strings to remove leading and trailing spaces from the user’s typed answer and maybe even the answer div <code>innerHTML</code></p>
</blockquote>
<p>If they’re the same, add the value of the clue (from the <code>#value</code>) to the player’s score; otherwise, subtract the value of the clue from the player’s score.</p>
<p>Remove the "is-hidden" class from <code>#answer</code>. Add the "is-hidden" class to <code>#check-response</code>.</p>
<p>After a player clicks one of the "Use a" buttons to get a clue and a clue is returned, remove the "is-hidden" class from <code>#check-response</code> and set the <code>value</code> of the <code>textarea</code> to an empty string to clear out the previous answer.</p>
<p>Also, add the "is-hidden" to <code>#answer</code> to hide the answer until after the player checks their response. You can do this in your existing function which updates the HTML when you load a new clue.</p>
<blockquote>
<p>Hint: Another way to check the answer would be to create a global <code>currentClue</code> variable and set it with the current clue everytime you fetch a new clue from the server. Then you’ll be able to easily compare the current clue with the players’s answer from the <code>textarea</code></p>
</blockquote>
<h2 id="bonus-round-make-a-progressively-enhanced-application">Bonus round: make a progressively enhanced application</h2>
<p>Preserve the player’s score between page refreshes.</p>
<p>Preserve the current clue between page refreshes. Try all three methods below using the communication paradigm (Callback, Promise or, async/await) you like most.</p>
<ul>
<li>Store <em>just</em> the id. Then, when the page loads, if the id exists in the local storage, have it call "https://jservice.xyz/api/clues/:id" using a "GET" HTTP method. Replace the ":id" in the URL with the id that you got from local storage.</li>
<li>Store the entire clue data in local storage and just plop it into the HTML if it exists.</li>
<li>Use progressive data display. Store the entire clue in local storage and put it into the HTML when the page loads. Then, make an HTTP request to the URL in step 1. When you get the data back, update what’s in local storage and what the player sees on the screen with the most recent data available.</li>
</ul>
<h2 id="nightmare-round-mark-clues-as-invalid">Nightmare round: mark clues as invalid</h2>
<p>Add three buttons to your form to mark the clue as invalid, one each that will use <code>XMLHttpRequest</code> callbacks, Promise objects, and <code>async</code>/<code>await</code> methods. Create methods in each of the communication modules to make an HTTP request with a method of "DELETE" to the URL "https://jservice.xyz/api/clues/:id" where ":id" is replaced with the value of the id of the current clue.</p>
<h2 id="nightmare-round-create-new-clues">Nightmare round: create new clues</h2>
<p>Add a form that lets you add clues to the service using the "POST" method of the URL "https://jservice.xyz/api/clues". Create a form that allows a person to put in an answer, a question, a value, and the id of a category (number). When They click a button, read that information from the form elements, create an object with the following key/value pairs, and submit it using the "POST" to the indicated URL.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb107-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb107-2" title="2">  <span class="dt">&quot;answer&quot;</span><span class="fu">:</span> <span class="er">string</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb107-3" title="3">  <span class="dt">&quot;question&quot;</span><span class="fu">:</span> <span class="er">string</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb107-4" title="4">  <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="er">number</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb107-5" title="5">  <span class="dt">&quot;categoryId&quot;</span><span class="fu">:</span> <span class="er">number</span></a>
<a class="sourceLine" id="cb107-6" title="6"><span class="fu">}</span></a></code></pre></div>
<p>If everything works, you should get back a "201 Created" with the content of the newly-created question. You should then display it as the current question. Do this for all three types of communication paradigms, as well: <code>XMLHttpRequest</code> callbacks, Promise objects, and <code>async</code>/<code>await</code> methods.</p>
<h2 id="code-samples">Code samples</h2>
<p>These are provided as references as you work through the project. Please try to solve the problems yourself before using these code examples. They do not show you the answers for the bonus or nightmare rounds.</p>
<h3 id="using-a-callback-1">Using a callback</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb108-1" title="1"><span class="co">// callback-version.js</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="im">export</span> <span class="kw">function</span> <span class="at">getClue</span>(callback) <span class="op">{</span></a>
<a class="sourceLine" id="cb108-3" title="3">  <span class="kw">const</span> xhr <span class="op">=</span> <span class="kw">new</span> <span class="at">XMLHttpRequest</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb108-4" title="4"></a>
<a class="sourceLine" id="cb108-5" title="5">  <span class="va">xhr</span>.<span class="at">addEventListener</span>(<span class="st">&#39;readystatechange&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb108-6" title="6">    <span class="cf">if</span> (<span class="va">xhr</span>.<span class="at">readyState</span> <span class="op">!==</span> <span class="va">XMLHttpRequest</span>.<span class="at">DONE</span>) <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb108-7" title="7"></a>
<a class="sourceLine" id="cb108-8" title="8">    <span class="cf">if</span> (<span class="va">xhr</span>.<span class="at">status</span> <span class="op">!==</span> <span class="dv">200</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb108-9" title="9">      <span class="at">callback</span>(<span class="va">xhr</span>.<span class="at">status</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb108-10" title="10">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb108-11" title="11">      <span class="kw">const</span> clue <span class="op">=</span> <span class="va">JSON</span>.<span class="at">parse</span>(<span class="va">xhr</span>.<span class="at">responseText</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb108-12" title="12">      <span class="at">callback</span>(<span class="kw">null</span><span class="op">,</span> clue)<span class="op">;</span></a>
<a class="sourceLine" id="cb108-13" title="13">    <span class="op">}</span></a>
<a class="sourceLine" id="cb108-14" title="14">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb108-15" title="15"></a>
<a class="sourceLine" id="cb108-16" title="16">  <span class="va">xhr</span>.<span class="at">open</span>(<span class="st">&#39;GET&#39;</span><span class="op">,</span> <span class="st">&#39;https://jservice.xyz/api/random-clue&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb108-17" title="17">  <span class="va">xhr</span>.<span class="at">send</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb108-18" title="18"><span class="op">}</span></a></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb109-1" title="1"><span class="co">// game.js</span></a>
<a class="sourceLine" id="cb109-2" title="2"><span class="im">import</span> <span class="op">{</span> getClue <span class="im">as</span> getClueFromCallback <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./callback-version.js&#39;</span></a>
<a class="sourceLine" id="cb109-3" title="3"></a>
<a class="sourceLine" id="cb109-4" title="4">document</a>
<a class="sourceLine" id="cb109-5" title="5">  .<span class="at">getElementById</span>(<span class="st">&#39;use-callback&#39;</span>)</a>
<a class="sourceLine" id="cb109-6" title="6">  .<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb109-7" title="7">    <span class="at">getClueFromCallback</span>((err<span class="op">,</span> clue) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb109-8" title="8">      <span class="cf">if</span> (err <span class="op">!==</span> <span class="kw">null</span>) <span class="cf">return</span> <span class="va">console</span>.<span class="at">error</span>(err)<span class="op">;</span></a>
<a class="sourceLine" id="cb109-9" title="9"></a>
<a class="sourceLine" id="cb109-10" title="10">      <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;answer&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">answer</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-11" title="11">      <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;value&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">value</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-12" title="12">      <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;category-title&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="va">category</span>.<span class="at">title</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-13" title="13">      <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;invalid-count&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">invalid_count</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-14" title="14">      <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;question&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">question</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-15" title="15">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb109-16" title="16">  <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="using-a-promise">Using a Promise</h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb110-1" title="1"><span class="co">// promise-version.js</span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="im">export</span> <span class="kw">function</span> <span class="at">getClue</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb110-3" title="3">  <span class="cf">return</span> <span class="at">fetch</span>(<span class="st">&#39;https://jservice.xyz/api/random-clue&#39;</span>)</a>
<a class="sourceLine" id="cb110-4" title="4">    .<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb110-5" title="5">      <span class="cf">if</span> (<span class="op">!</span><span class="va">response</span>.<span class="at">ok</span>) <span class="cf">throw</span> <span class="kw">new</span> <span class="at">Error</span>(<span class="va">response</span>.<span class="at">status</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb110-6" title="6"></a>
<a class="sourceLine" id="cb110-7" title="7">      <span class="cf">return</span> <span class="va">response</span>.<span class="at">json</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb110-8" title="8">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb110-9" title="9"><span class="op">}</span></a></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb111-1" title="1"><span class="co">// game.js</span></a>
<a class="sourceLine" id="cb111-2" title="2"><span class="im">import</span> <span class="op">{</span> getClue <span class="im">as</span> getClueFromCallback <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./callback-version.js&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb111-3" title="3"><span class="im">import</span> <span class="op">{</span> getClue <span class="im">as</span> getClueFromPromise <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./promise-version.js&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb111-4" title="4"></a>
<a class="sourceLine" id="cb111-5" title="5"><span class="kw">function</span> <span class="at">setHtmlFromClue</span>(clue) <span class="op">{</span></a>
<a class="sourceLine" id="cb111-6" title="6">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;answer&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">answer</span><span class="op">;</span></a>
<a class="sourceLine" id="cb111-7" title="7">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;value&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">value</span><span class="op">;</span></a>
<a class="sourceLine" id="cb111-8" title="8">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;category-title&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="va">category</span>.<span class="at">title</span><span class="op">;</span></a>
<a class="sourceLine" id="cb111-9" title="9">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;question&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">question</span><span class="op">;</span></a>
<a class="sourceLine" id="cb111-10" title="10"></a>
<a class="sourceLine" id="cb111-11" title="11">  <span class="kw">let</span> validity <span class="op">=</span> <span class="st">&#39;valid&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb111-12" title="12">  <span class="cf">if</span> (<span class="va">clue</span>.<span class="at">invalid_count</span> <span class="op">&amp;&amp;</span> <span class="va">clue</span>.<span class="at">invalid_count</span> <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb111-13" title="13">    validity <span class="op">=</span> <span class="st">&#39;invalid&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb111-14" title="14">  <span class="op">}</span></a>
<a class="sourceLine" id="cb111-15" title="15">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;invalid-count&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> validity<span class="op">;</span></a>
<a class="sourceLine" id="cb111-16" title="16"><span class="op">}</span></a>
<a class="sourceLine" id="cb111-17" title="17"></a>
<a class="sourceLine" id="cb111-18" title="18">document</a>
<a class="sourceLine" id="cb111-19" title="19">  .<span class="at">getElementById</span>(<span class="st">&#39;use-callback&#39;</span>)</a>
<a class="sourceLine" id="cb111-20" title="20">  .<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb111-21" title="21">    <span class="at">getClueFromCallback</span>((err<span class="op">,</span> clue) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb111-22" title="22">      <span class="cf">if</span> (err <span class="op">!==</span> <span class="kw">null</span>) <span class="cf">return</span> <span class="va">console</span>.<span class="at">error</span>(err)<span class="op">;</span></a>
<a class="sourceLine" id="cb111-23" title="23">      <span class="at">setHtmlFromClue</span>(clue)<span class="op">;</span></a>
<a class="sourceLine" id="cb111-24" title="24">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb111-25" title="25">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb111-26" title="26"></a>
<a class="sourceLine" id="cb111-27" title="27">document</a>
<a class="sourceLine" id="cb111-28" title="28">  .<span class="at">getElementById</span>(<span class="st">&#39;use-promise&#39;</span>)</a>
<a class="sourceLine" id="cb111-29" title="29">  .<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb111-30" title="30">    <span class="at">getClueFromPromise</span>()</a>
<a class="sourceLine" id="cb111-31" title="31">      .<span class="at">then</span>(clue <span class="kw">=&gt;</span> <span class="at">setHtmlFromClue</span>(clue))</a>
<a class="sourceLine" id="cb111-32" title="32">      .<span class="at">catch</span>(err <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">error</span>(<span class="va">err</span>.<span class="at">message</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb111-33" title="33"></a>
<a class="sourceLine" id="cb111-34" title="34">    <span class="co">// Could also be the following code. Why?</span></a>
<a class="sourceLine" id="cb111-35" title="35">    <span class="co">// getClueFromPromise()</span></a>
<a class="sourceLine" id="cb111-36" title="36">    <span class="co">//   .then(setHtmlFromClue)</span></a>
<a class="sourceLine" id="cb111-37" title="37">    <span class="co">//   .catch(err =&gt; console.error(err.message));</span></a>
<a class="sourceLine" id="cb111-38" title="38">  <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="using-asyncawait">Using async/await</h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb112-1" title="1"><span class="co">// async-await-version.js</span></a>
<a class="sourceLine" id="cb112-2" title="2"><span class="im">export</span> <span class="kw">async</span> <span class="kw">function</span> <span class="at">getClue</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb112-3" title="3">  <span class="kw">const</span> response <span class="op">=</span> <span class="cf">await</span> <span class="at">fetch</span>(<span class="st">&quot;https://jservice.xyz/api/random-clue&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb112-4" title="4">  <span class="cf">if</span> (<span class="op">!</span><span class="va">response</span>.<span class="at">ok</span>) <span class="cf">throw</span> <span class="kw">new</span> <span class="at">Error</span>(<span class="va">response</span>.<span class="at">status</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb112-5" title="5">  <span class="cf">return</span> <span class="cf">await</span> <span class="va">response</span>.<span class="at">json</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb112-6" title="6"><span class="op">}</span></a></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb113-1" title="1"><span class="co">// game.js</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="im">import</span> <span class="op">{</span> getClue <span class="im">as</span> getClueFromCallback <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./callback-version.js&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-3" title="3"><span class="im">import</span> <span class="op">{</span> getClue <span class="im">as</span> getClueFromPromise <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./promise-version.js&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-4" title="4"><span class="im">import</span> <span class="op">{</span> getClue <span class="im">as</span> getClueFromAsyncFunction <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./async-await-version.js&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-5" title="5"></a>
<a class="sourceLine" id="cb113-6" title="6"><span class="kw">function</span> <span class="at">setHtmlFromClue</span>(clue) <span class="op">{</span></a>
<a class="sourceLine" id="cb113-7" title="7">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;answer&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">answer</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-8" title="8">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;value&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">value</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-9" title="9">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;category-title&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="va">category</span>.<span class="at">title</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-10" title="10">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;question&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> <span class="va">clue</span>.<span class="at">question</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-11" title="11"></a>
<a class="sourceLine" id="cb113-12" title="12">  <span class="kw">let</span> validity <span class="op">=</span> <span class="st">&#39;valid&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-13" title="13">  <span class="cf">if</span> (<span class="va">clue</span>.<span class="at">invalid_count</span> <span class="op">&amp;&amp;</span> <span class="va">clue</span>.<span class="at">invalid_count</span> <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb113-14" title="14">    validity <span class="op">=</span> <span class="st">&#39;invalid&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-15" title="15">  <span class="op">}</span></a>
<a class="sourceLine" id="cb113-16" title="16">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;invalid-count&#39;</span>).<span class="at">innerHTML</span> <span class="op">=</span> validity<span class="op">;</span></a>
<a class="sourceLine" id="cb113-17" title="17"><span class="op">}</span></a>
<a class="sourceLine" id="cb113-18" title="18"></a>
<a class="sourceLine" id="cb113-19" title="19">document</a>
<a class="sourceLine" id="cb113-20" title="20">  .<span class="at">getElementById</span>(<span class="st">&#39;use-callback&#39;</span>)</a>
<a class="sourceLine" id="cb113-21" title="21">  .<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb113-22" title="22">    <span class="at">getClueFromCallback</span>((err<span class="op">,</span> clue) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb113-23" title="23">      <span class="cf">if</span> (err <span class="op">!==</span> <span class="kw">null</span>) <span class="cf">return</span> <span class="va">console</span>.<span class="at">error</span>(err)<span class="op">;</span></a>
<a class="sourceLine" id="cb113-24" title="24">      <span class="at">setHtmlFromClue</span>(clue)<span class="op">;</span></a>
<a class="sourceLine" id="cb113-25" title="25">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb113-26" title="26">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb113-27" title="27"></a>
<a class="sourceLine" id="cb113-28" title="28">document</a>
<a class="sourceLine" id="cb113-29" title="29">  .<span class="at">getElementById</span>(<span class="st">&#39;use-promise&#39;</span>)</a>
<a class="sourceLine" id="cb113-30" title="30">  .<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb113-31" title="31">    <span class="at">getClueFromPromise</span>()</a>
<a class="sourceLine" id="cb113-32" title="32">      .<span class="at">then</span>(clue <span class="kw">=&gt;</span> <span class="at">setHtmlFromClue</span>(clue))</a>
<a class="sourceLine" id="cb113-33" title="33">      .<span class="at">catch</span>(err <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">error</span>(<span class="va">err</span>.<span class="at">message</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb113-34" title="34">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb113-35" title="35"></a>
<a class="sourceLine" id="cb113-36" title="36">document</a>
<a class="sourceLine" id="cb113-37" title="37">  .<span class="at">getElementById</span>(<span class="st">&#39;use-async-await&#39;</span>)</a>
<a class="sourceLine" id="cb113-38" title="38">  .<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb113-39" title="39">    <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb113-40" title="40">      <span class="kw">const</span> clue <span class="op">=</span> <span class="cf">await</span> <span class="at">getClueFromAsyncFunction</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb113-41" title="41">      <span class="at">setHtmlFromClue</span>(clue)<span class="op">;</span></a>
<a class="sourceLine" id="cb113-42" title="42">    <span class="op">}</span> <span class="cf">catch</span> (e) <span class="op">{</span></a>
<a class="sourceLine" id="cb113-43" title="43">      <span class="va">console</span>.<span class="at">error</span>(<span class="va">e</span>.<span class="at">message</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb113-44" title="44">    <span class="op">}</span></a>
<a class="sourceLine" id="cb113-45" title="45">  <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<hr />
<h1 id="week-06-day-4-unit-testing---day-1" data-ignore="true">WEEK-06 DAY-4<br><em>Unit Testing - Day 1</em></h1>
<hr />
<h1 id="testing-learning-objectives">Testing Learning Objectives</h1>
<p><strong>The objective of this lesson</strong> is to ensure that you understand the fundamentals of testing and are capable of reading and solving specs. <strong>This lesson is relevant</strong> to you because good testing is one of the foundations of being a good developer.</p>
<p>When you finish, you should be able to:</p>
<ul>
<li>Explain the "red-green-refactor" loop of test-driven development.</li>
<li>Identify the definitions of SyntaxError, ReferenceError, and TypeError</li>
<li>Create, modify, and get to pass a suite of Mocha tests</li>
<li>Use Chai to structure your tests using behavior-driven development principles.</li>
<li>Use the pre- and post-test hooks provided by Mocha fundamentals of testing and are capable of reading and solving specs. <strong>This lesson is relevant</strong> to you because good testing is one of the foundations of being a good developer.</li>
</ul>
<p>When you finish, you should be able to:</p>
<ul>
<li>Explain the "red-green-refactor" loop of test-driven development.</li>
<li>Identify the definitions of SyntaxError, ReferenceError, and TypeError</li>
<li>Create, modify, and get to pass a suite of Mocha tests</li>
<li>Use Chai to structure your tests using behavior-driven development principles.</li>
<li>Use the pre- and post-test hooks provided by Mocha</li>
</ul>
<hr />
<h1 id="all-about-testing">All About Testing!</h1>
<p>In your daily life you have encountered tests before - though school, work, or even through trivia, a test is a way to ensure something is correct. In your programming careers so far you’ve tested most of your work by hand. Testing one function at a time can be tedious, repetitive, and worst of all, it is a method vulnerable to both false positives and false negatives.</p>
<p>Let’s talk about <em>automated testing</em> - the how, the what, and most importantly the <strong>why</strong>. The general idea across all testing frameworks is to allow developers to write code that would specify the behavior of a function or module or class. We’ve reached a point in software development where developers can now run test code against their application code and have confidence that their code will work as intended.</p>
<p>When you finish this reading you should be able to paraphrase the how and why we test as well as how to read automated tests without necessarily knowing the syntax.</p>
<h2 id="why-do-we-test">Why do we test?</h2>
<p>Yes, making sure the dang thing actually works is important. But beyond the obvious, why take the time to write tests?</p>
<ul>
<li><p><em>To make sure the dang thing works</em></p>
<p>Yes, that’s obvious, but dagnabit, it’s important!</p></li>
<li><p><em>Increase flexibility &amp; reduce fear (of code)</em></p>
<p>You’ve written a whole bunch of functionality, multiple other developers have worked on the code, you’re deep into the project… And then you realize you have to refactor big chunks of it. Without automated tests, you’ll be walking on eggshells, frightened of the codebase and the various landmines that are surely lying in wait.</p>
<p>With tests, you can aggressively refactor with confidence. If anything breaks, you’ll know. And you’ll know exactly what the expectations are for the module you’re refactoring, so as long as it meets the specs, you’re good.</p></li>
</ul>
<blockquote>
<p>When you are writing automated tests for an application you are writing the <em>specfications</em> of how that application should behave. In the software industry automated tests are often called "specs", which is short for the word "specification".</p>
</blockquote>
<ul>
<li><p><em>Make collaboration easier</em></p>
<p>Complex applications are built by teams of developers. It may be that not all those developers will actually get the chance to talk to one another (they’re busy, they may live in different places, some of them may have left the company, new people just joined, it’s a huge project, etc.).</p>
<p>Specs allow teams to have confidence that each module performs a specific task and reduces the need for expensive coordination. The specs themselves become an effective form of communication.</p></li>
<li><p><em>Produce documentation</em></p>
<p>If the tests are written well, the tests can serve as documentation for the codebase. Need to know what such and such module does? Check out the specs. This is related to easing collaboration.</p></li>
</ul>
<h2 id="how-we-test">How we Test</h2>
<h3 id="testing-frameworks-vs-assertion-libraries">Testing frameworks vs Assertion libraries</h3>
<p>An important distinction to understand is the difference between a <em>testing framework</em> and an <em>assertion library</em>. The job of a testing framework is to <strong>run</strong> tests and present them to a user. An assertion library is the backbone of any written test - it is the code that we use to <strong>write</strong> our tests. Assertion libraries will do the heavy lifting of comparing and verifying our code. Some testing frameworks will have built in assertion libraries, others will need you to import an assertion library to use.</p>
<h3 id="mocha">Mocha</h3>
<p><a href="https://mochajs.org/#getting-started"><code>Mocha</code></a> is a JavaScript <em>testing framework</em> that specializes in <em>running</em> tests and presenting them in an organized user friendly way. The <code>Mocha</code> testing framework is widely used because of it’s flexibility. <code>Mocha</code> supports a whole variety of different assertion libraries and DSL interfaces for writing tests in the way the best suites the developer.</p>
<p>When writing tests with Mocha we will be using <code>Mocha</code>’s <a href="https://en.wikipedia.org/wiki/Domain-specific_language">DSL</a> (Domain Specific Language). A Domain Specific Language refers to a computer language specialized for a particular purpose - in <code>Mocha</code>’s case the DSL has been engineered for providing structure for writing tests. A DSL is it’s own language that will usually be familiar but syntactically a little different from the languages you know. That being said you don’t have to worry about memorizing every single piece of syntax for writing tests - just get a good grasp of the basics of testing and use the documentation to fill in any knowledge gaps.</p>
<p>You’ve seen what <code>Mocha</code> looks like already because all the specs for your assessments and projects so far have been written utilizing <code>Mocha</code> as the testing framework.</p>
<p>We’ll be talking more about different assertion libraries a little later when we talk about <em>writing</em> tests.</p>
<h2 id="what-do-we-test">What do we test?</h2>
<p>So now that we talked about why we test and what we use to test…what exactly do we test?</p>
<h3 id="test-the-public-interface">Test the public interface</h3>
<p>When you’re trying to figure out what you should be testing, ask yourself, "What is (or will be) the public interface of the module or class I’m writing?" That is, what are the functions that the outside world will have access to and rely on?</p>
<p>Ideally, you’d have thorough test coverage on the entire public interface. When that’s not possible, ensure that your tests cover the most important and/or complex parts of that interface - that is, the pieces that you need to make sure work as intended (and expected).</p>
<p>Kent Dodds has a <a href="https://kentcdodds.com/blog/how-to-know-what-to-test">great article</a> on how to identify what you should be testing.</p>
<h3 id="the-testing-pyramid">The testing pyramid</h3>
<p>A common metaphor used to group software tests into separate levels of testing is the testing pyramid.</p>
<figure>
<img src="https://2.bp.blogspot.com/-YTzv_O4TnkA/VTgexlumP1I/AAAAAAAAAJ8/57-rnwyvP6g/s1600/image02.png" alt="test-pry" /><figcaption>test-pry</figcaption>
</figure>
<p>Let’s quickly go over each level before talking about the pyramid as a whole:</p>
<ul>
<li><strong>Unit Tests</strong>: The smallest unit of testing - used to test the smallest pieces of your application in isolation to ensure each piece works before you attempt to put those pieces together. Each unit test should focus on testing <strong>one</strong> thing. These are generally the fastest tests to write and run.</li>
<li><strong>Integration Tests</strong>: Once you have your unit tests in place you know each piece works in isolation - but what about when those pieces interact with each other? Integration tests are the next level up, they will test the interactions between two pieces of your application. Integration tests will ensure the units you’ve written work coherently together.</li>
<li><strong>End-to-End (E2E) Tests</strong>: End-to-end tests are the highest level of testing - these will test the whole of your application. End-to-end tests are the closest automated tests come to testing the an actual user experience of your application. These are generally the slowest tests to write and run.</li>
</ul>
<p>For a real life example of how you’d utilize each of these tests imagine coding a Chess game and wanting to test it. Unit tests would be best for testing each class your wrote in isolation - like ensuring each piece’s instance methods work as you expect them to before involving them with any other pieces. Next you’d write integration tests - so you’d want to ensure that each piece instance interacted correctly with the <code>Board</code> class. The final level would be End-to-End tests which would be like testing a round of chess - testing the <code>Board</code>, <code>Game</code>, and <code>Piece</code> classes all working together.</p>
<p>According to the testing pyramid - you want to have a solid base of a lot of Unit tests, then a medium amount of integration tests built upon that base, then finally a smaller amount of End-to-End tests. Writing tests in this way is practical for a couple of reasons. As we said before, unit tests ensure each piece of your application works in isolation - if you know each piece works then you can more easily find errors. Unit tests are also <em>fast</em>. The bigger your application gets the longer your testing suite will take to run - if all your tests are end-to-end tests your tests could be running for <strong>hours</strong>.</p>
<p>Here is a great blog from google about why they use the <a href="https://testing.googleblog.com/2015/04/just-say-no-to-more-end-to-end-tests.html">testing pyramid</a>.</p>
<h2 id="reading-tests">Reading Tests</h2>
<p>No matter what kind of test you are encountering the most important thing about a test is that it is <strong>readable</strong> and <strong>understandable</strong>. Good tests use descriptive strings to enumerate what they are testing as well as how they are testing it.</p>
<p>We’ll be diving more into the actual syntax of writing tests soon but for right now let’s see what you can glean without knowing the syntax:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb114-1" title="1"><span class="at">describe</span>(<span class="st">&quot;avgValue()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb114-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should return the average of an array of numbers&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb114-3" title="3">    <span class="va">assert</span>.<span class="at">equal</span>(<span class="at">avgValue</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">20</span>])<span class="op">,</span> <span class="dv">15</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb114-4" title="4">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb114-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>So without knowing the specfic syntax we can tell a few things from the outset - the outer function has a string with the name of a function <code>avgValue()</code> which is most likely the function we will be testing. Next we see a description string <code>should return the average of an array of numbers</code>.</p>
<p>So even without understanding the syntax for the test above we can tell <em>what</em> we are testing - the <code>avgValue</code> function, and how we are testing it - <code>should return the average of an array of numbers</code>.</p>
<p>Being able to read tests is an important skill. You’ll sometimes find yourself working with unfamiliar testing libraries, but if the test is well written you should be able to determine what the test is doing regardless of the syntax it uses.</p>
<p>Below we’ve re-written the above example using the Ruby language testing library RSpec:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb115-1" title="1">describe <span class="st">&quot;avg_value&quot;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb115-2" title="2">  it <span class="st">&quot;should return the average of an array of numbers&quot;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb115-3" title="3">    expect(avg_value([<span class="dv">10</span>, <span class="dv">20</span>])).to eq(<span class="dv">15</span>)</a>
<a class="sourceLine" id="cb115-4" title="4">  <span class="kw">end</span></a>
<a class="sourceLine" id="cb115-5" title="5"><span class="kw">end</span></a></code></pre></div>
<p>Now you probably don’t know Ruby - but using the same methods of deduction as we used above we can figure out what is being testing in the above snippet. The outer block mentions <code>avg_value</code> which is probably the method or function being tested and the inner block says how things are being tested - <code>"should return the average of an array of numbers"</code>. Without knowing the language, or the testing library, we can still figure out generally what what is being tested. That is the important thing about reading tests - having the patience to parse the information before you.</p>
<h2 id="what-you-learned-1">What you learned</h2>
<p>We covered a high level overview of testing - the <em>why</em>, the <em>what</em> and the <em>how</em> of testing as well as the basics of how to read a test regardless of the syntax used in writing that test.</p>
<hr />
<h1 id="test-driven-development">Test-Driven Development</h1>
<p>At this point of the course you have all encountered an automated test also known as a "spec" - short for specification. In software engineering a collection of automated tests, also known as test suites, are a common way to ensure that when a piece of code is run it will perform the minimum of a specified set of behaviors. We’ve used the JavaScript testing framework, Mocha, up to this point to test the behavior of functions of all kinds from <code>myForEach</code> to <code>avgValue</code> to ensure each function runs as intended.</p>
<p>The main question we should be able to answer when writing any piece of code is: what does this code do? How should this code behave? One of the popular ways to answer this question is through a software development process called Test-driven development or TDD. TDD is a quick repetitive cycle that revolves around <em>first</em> determining what a piece of code should do and writing tests for that behavior <em>before actually writing any code</em>.</p>
<p><em>Test-driven development</em> dictates that tests, not application code, should be written first, and then application code should only be written to pass the already written tests. When you finish this reading you should be able to identify the three steps of Test Driven Development as well as identify the advantages of using TDD to write code.</p>
<h2 id="motivations-for-tdd">Motivations for TDD</h2>
<p>Imagine being handed a file of 10 functions that all invoke each other and being told to add a new function to the mix and ensure all the previous functions work properly. First you’d have to figure out what each function actually did, then determine if they did what they were supposed to do. Sounds like a total pain right? A modern web application is thousands of lines of code that are worked on and maintained by teams of developers. Using TDD is one way for developers to ensure that the code written by every member of their team is testable and modular.</p>
<p>Here are some of the biggest motivations for why developers use test-driven development:</p>
<ol type="1">
<li>Writing tests before code ensures that the code written <em>works</em>.
<ul>
<li>Code written to pass specs is guaranteed to be testable.</li>
<li>Code with pre-written tests easily allows other developers to add and test new code while ensuring nothing else breaks along the way.</li>
</ul></li>
<li>Only required code is written.
<ul>
<li>In the face of having to write tests for every piece of added functionality TDD can help reduce bloated un-needed functionality.</li>
<li>TDD and YAGNI ("you ain’t gonna need it") go hand in hand!</li>
</ul></li>
<li>TDD helps enforce code modularity.
<ul>
<li>A TDD developer is forced to think about their application in small, testable chunks - this ensures the developer will write each chunk to be modular and capable of individual testing.</li>
</ul></li>
<li>Better understanding of <em>what</em> the code should be doing.
<ul>
<li>Writing tests for a piece of code ensures that the developer writing that code knows what the piece of code is trying to achieve.</li>
</ul></li>
</ol>
<p>Now that we’ve covered why developers would want to use TDD let’s go into <em>how</em> to do TDD.</p>
<h2 id="the-three-steps-of-tdd-red-green-refactor">The three steps of TDD: red, green, refactor!</h2>
<figure>
<img src="https://-open-assets.s3-us-west-1.amazonaws.com/Module-JavaScript/testing/assets/rgr.png" alt="tdd-cycle" /><figcaption>tdd-cycle</figcaption>
</figure>
<p>The Test-driven development workflow can be broken down intro three simple steps. <strong>Red, Green, Refactor</strong>:</p>
<ol type="1">
<li><strong>Red</strong>: Write the tests and watch them fail (a failing test is red). It’s important to ensure the tests initially fail so that you don’t have false positives.</li>
<li><strong>Green</strong>: Write the minimum amount of code to ensure the tests pass (a passing test will be green).</li>
<li><strong>Refactor</strong>: Refactor the code you just wrote. Your job is not over when the tests pass! One of the most important things you do as a software developer is to ensure the code you write is easy to maintain and read.</li>
</ol>
<p>Generally, the TDD workflow loop of Red, Green, Refactor is quick. TDD developers will write small tests ensuring each individual part of their application works properly and their code looks good before moving on - making for a short development cycle.</p>
<h2 id="what-you-learned-2">What you learned</h2>
<p>TDD stands for test-driven development. TDD is a repetitive process that revolves around three steps: Red, Green, Refactor.</p>
<hr />
<h1 id="a-comedy-of-errors-in-javascript">A Comedy of Errors in JavaScript</h1>
<p>You know that feeling when you’ve just finished your perfect function then you go to run your code and: BAM! A big error is thrown? We all have felt that pain from the starting student to the experienced engineer. Runtime errors are a part of daily life when writing code. It is now time to dive into what each type of error you encounter means in order to more quickly and efficiently fix the problem that created that error.</p>
<p>When you finish this reading you should be able to: identify the difference between <code>SyntaxError</code>, <code>ReferenceError</code>, and <code>TypeError</code>s as well as create and <code>throw</code> new errors.</p>
<h2 id="javascript-errors">JavaScript Errors</h2>
<p>In JavaScript the <code>Error</code> constructor function is responsible for creating different instances of <code>Error</code> objects. The <code>Error</code> object is how JavaScript deals with runtime errors and the <em>type</em> of error created and thrown will attempt to communicate <em>why</em> that error occurred.</p>
<h3 id="creating-your-own-errors">Creating your own errors</h3>
<p>Since the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error"><code>Error</code></a> constructor is just a constructor function we can use it to create new <code>Error</code> object instances with the following syntax:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">new</span> <span class="at">Error</span>([message[<span class="op">,</span> fileName[<span class="op">,</span> lineNumber]]])</a></code></pre></div>
<p>As seen above you can optionally supply a <code>message</code>, <code>fileName</code> and <code>lineNumber</code> where the error occurred. The <code>Error</code> constructor is also somewhat unique in that you can call it with or without the <code>new</code> keyword and it will return a new <code>Error</code> object:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">const</span> first <span class="op">=</span> <span class="at">Error</span>(<span class="st">&quot;I am an error object!&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb117-2" title="2"><span class="kw">const</span> second <span class="op">=</span> <span class="kw">new</span> <span class="at">Error</span>(<span class="st">&quot;I am too an error object!&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb117-3" title="3"></a>
<a class="sourceLine" id="cb117-4" title="4"><span class="va">console</span>.<span class="at">log</span>(first)<span class="op">;</span> <span class="co">// Error: I am an error object!</span></a>
<a class="sourceLine" id="cb117-5" title="5"><span class="va">console</span>.<span class="at">log</span>(second)<span class="op">;</span> <span class="co">// Error: I am too an error object!</span></a></code></pre></div>
<p>Let’s take a look at what we can do with our newly created <code>Error</code> objects.</p>
<h3 id="throwing-your-own-errors">Throwing your own errors</h3>
<p>Tired of JavaScript being the only one to throw errors? Well you can too! Using the keyword <code>throw</code> you can throw your own runtime errors that will stop program execution.</p>
<p>Let’s take a look at the syntax for <code>throw</code>:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">function</span> <span class="at">giveMeNumber</span>(num) <span class="op">{</span></a>
<a class="sourceLine" id="cb118-2" title="2">  <span class="cf">if</span> (<span class="kw">typeof</span> num <span class="op">!==</span> <span class="st">&quot;number&quot;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb118-3" title="3">    <span class="cf">throw</span> <span class="kw">new</span> <span class="at">Error</span>(<span class="st">&quot;Give me a number!&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb118-4" title="4">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb118-5" title="5">    <span class="cf">return</span> <span class="st">&quot;yay number!&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb118-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb118-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb118-8" title="8"></a>
<a class="sourceLine" id="cb118-9" title="9"><span class="va">console</span>.<span class="at">log</span>(<span class="at">giveMeNumber</span>(<span class="dv">1</span>))<span class="op">;</span> <span class="co">// prints &quot;yay number!&quot;;</span></a>
<a class="sourceLine" id="cb118-10" title="10"><span class="va">console</span>.<span class="at">log</span>(<span class="at">giveMeNumber</span>(<span class="st">&quot;apple&quot;</span>))<span class="op">;</span> <span class="co">// Uncaught Error: Give me a number!</span></a>
<a class="sourceLine" id="cb118-11" title="11"><span class="va">console</span>.<span class="at">log</span>(<span class="at">giveMeNumber</span>(<span class="dv">1</span>))<span class="op">;</span> <span class="co">// doesn&#39;t get run</span></a></code></pre></div>
<p>Now as we can see in the above example throwing an error is a powerful tool that stops program execution. If we wanted to throw an error <em>without</em> stopping program execution we can use a <code>try...catch</code> block.</p>
<p>Let’s look at the syntax for using the <code>try...catch</code> block syntax:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb119-1" title="1"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb119-2" title="2">  <span class="co">// statements that will be attempted to here</span></a>
<a class="sourceLine" id="cb119-3" title="3"><span class="op">}</span> <span class="cf">catch</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb119-4" title="4">  <span class="co">// if an error is thrown it will be &quot;caught&quot;</span></a>
<a class="sourceLine" id="cb119-5" title="5">  <span class="co">// allowing the program to continue execution</span></a>
<a class="sourceLine" id="cb119-6" title="6">  <span class="co">// these statements will be run and the program will continue!</span></a>
<a class="sourceLine" id="cb119-7" title="7"><span class="op">}</span></a></code></pre></div>
<p>We normally use <code>try...catch</code> blocks with functions that might throw an error. Let’s look at an example where an error <em>will not</em> be thrown:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">function</span> <span class="at">safeDivide</span>(a<span class="op">,</span> b) <span class="op">{</span></a>
<a class="sourceLine" id="cb120-2" title="2">  <span class="cf">if</span> (b <span class="op">===</span> <span class="dv">0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb120-3" title="3">    <span class="cf">throw</span> <span class="kw">new</span> <span class="at">Error</span>(<span class="st">&quot;cannot divide by zero&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb120-4" title="4">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb120-5" title="5">    <span class="cf">return</span> a / b<span class="op">;</span></a>
<a class="sourceLine" id="cb120-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb120-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb120-8" title="8"></a>
<a class="sourceLine" id="cb120-9" title="9"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb120-10" title="10">  <span class="va">console</span>.<span class="at">log</span>(<span class="at">safeDivide</span>(<span class="dv">30</span><span class="op">,</span> <span class="dv">5</span>))<span class="op">;</span> <span class="co">// prints 6</span></a>
<a class="sourceLine" id="cb120-11" title="11"><span class="op">}</span> <span class="cf">catch</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb120-12" title="12">  <span class="va">console</span>.<span class="at">error</span>(<span class="va">error</span>.<span class="at">name</span> <span class="op">+</span> <span class="st">&quot;: &quot;</span> <span class="op">+</span> <span class="va">error</span>.<span class="at">message</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb120-13" title="13"><span class="op">}</span></a>
<a class="sourceLine" id="cb120-14" title="14"></a>
<a class="sourceLine" id="cb120-15" title="15"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;hello&quot;</span>)<span class="op">;</span> <span class="co">// prints hello</span></a></code></pre></div>
<p><strong>Note</strong>: We can use <code>console.error</code> instead of <code>console.log</code> to make logged errors more noticeable.</p>
<p>Above you can see our <code>safeDivide</code> function ran as expected. Now let’s see what happens when an error will be thrown and <strong>caught</strong> inside a <code>try...catch</code> block:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">function</span> <span class="at">safeDivide</span>(a<span class="op">,</span> b) <span class="op">{</span></a>
<a class="sourceLine" id="cb121-2" title="2">  <span class="cf">if</span> (b <span class="op">===</span> <span class="dv">0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb121-3" title="3">    <span class="cf">throw</span> <span class="kw">new</span> <span class="at">Error</span>(<span class="st">&quot;cannot divide by zero&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb121-4" title="4">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb121-5" title="5">    <span class="cf">return</span> a / b<span class="op">;</span></a>
<a class="sourceLine" id="cb121-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb121-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb121-8" title="8"></a>
<a class="sourceLine" id="cb121-9" title="9"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb121-10" title="10">  <span class="va">console</span>.<span class="at">log</span>(<span class="at">safeDivide</span>(<span class="dv">30</span><span class="op">,</span> <span class="dv">0</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb121-11" title="11"><span class="op">}</span> <span class="cf">catch</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb121-12" title="12">  <span class="va">console</span>.<span class="at">error</span>(<span class="va">error</span>.<span class="at">name</span> <span class="op">+</span> <span class="st">&quot;: &quot;</span> <span class="op">+</span> <span class="va">error</span>.<span class="at">message</span>)<span class="op">;</span> <span class="co">// Error: cannot divide by zero</span></a>
<a class="sourceLine" id="cb121-13" title="13"><span class="op">}</span></a>
<a class="sourceLine" id="cb121-14" title="14"><span class="co">// the above error will be caught allowing our program to continue!</span></a>
<a class="sourceLine" id="cb121-15" title="15"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;hello&quot;</span>)<span class="op">;</span> <span class="co">// prints  &quot;hello&quot;</span></a></code></pre></div>
<p>Those are the basics of creating and throwing your own errors. You can <code>throw</code> your newly created <code>Error</code> to stop program execution or use a <code>try...catch</code> block to catch your error and continue running your code. Now that we’ve learned how to create new errors let’s go over the core errors built into JavaScript and what they signify.</p>
<h2 id="types-of-javascript-errors">Types of JavaScript errors</h2>
<p>There are seven core errors you’ll encounter in JavaScript and each type of error will try to communicate why that error occurred:</p>
<ol type="1">
<li><code>SyntaxError</code> - represents an error in the syntax of the code.</li>
<li><code>ReferenceError</code> - represents an error thrown when an invalid reference is made.</li>
<li><code>TypeError</code> - represents an error when a variable or parameter is not of a valid type.</li>
<li><code>RangeError</code> - representing an error for when a numeric variable or parameter is outside of its valid range.</li>
<li><code>InternalError</code> - represents an error in the internal JavaScript engine.</li>
<li><code>EvalError</code> - represents an error with the global <code>eval</code> function.</li>
<li><code>URIError</code> - represents an error that occurs when <code>encodeURI()</code> or <code>decodeURI()</code> are passed invalid parameters.</li>
</ol>
<p>For this reading we’ll be going in depth of the three most common errors you have encountered so far: <code>SyntaxError</code>, <code>ReferenceError</code>, and <code>TypeError</code>.</p>
<h3 id="syntaxerror">SyntaxError</h3>
<p>A SyntaxError is thrown when the JavaScript engine attempts to parse code that does not conform to the syntax of the JavaScript language. When learning the JavaScript language this error is a constant companion for any missing <code>}</code> or misspelled <code>function</code> keywords.</p>
<p>Let’s look at a piece of code that would throw a syntax error:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb122-1" title="1">funtion <span class="at">broken</span> () <span class="op">{</span> <span class="co">// Uncaught SyntaxError: Unexpected identifier</span></a>
<a class="sourceLine" id="cb122-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;I&#39;m broke&quot;</span>)</a>
<a class="sourceLine" id="cb122-3" title="3"><span class="op">}</span></a></code></pre></div>
<p>Another example with an extra curly brace <code>}</code>:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">function</span> <span class="at">broken</span> () <span class="op">{</span> <span class="co">// Uncaught SyntaxError: Unexpected identifier</span></a>
<a class="sourceLine" id="cb123-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;I&#39;m broke&quot;</span>)</a>
<a class="sourceLine" id="cb123-3" title="3"><span class="op">}</span>} <span class="co">// Uncaught SyntaxError: Unexpected token &#39;}&#39;</span></a></code></pre></div>
<p>The examples go on and on - you can count on a <code>SyntaxError</code> to be thrown whenever you attempt to run code that is not syntactically correct JavaScript.</p>
<p><strong>Important!</strong> One thing to note about Syntax Errors is that many of them can’t be caught using <code>try</code> <code>catch</code> blocks.</p>
<p>For instance, the following code will throw a <code>SyntaxError</code> and no matter how hard you try, you can’t catch it.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb124-1" title="1"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb124-2" title="2">    <span class="cf">if</span> (<span class="kw">true</span> <span class="op">{</span> <span class="co">// throws &quot;SyntaxError: Unexpected token &#39;{&#39;&quot;</span></a>
<a class="sourceLine" id="cb124-3" title="3">        <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;SyntaxErrors are the worst!&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb124-4" title="4">    <span class="op">}</span></a>
<a class="sourceLine" id="cb124-5" title="5"><span class="op">}</span> <span class="cf">catch</span> (e) <span class="op">{</span></a>
<a class="sourceLine" id="cb124-6" title="6">    <span class="va">console</span>.<span class="at">log</span>(e)<span class="op">;</span></a>
<a class="sourceLine" id="cb124-7" title="7"><span class="op">}</span></a></code></pre></div>
<p>The missing parenthesis after <code>true</code> will throw a <code>SyntaxError</code> but can’t be caught by the <code>catch</code> block.</p>
<p>This is because this kind of <code>SyntaxError</code> happens at <em>compile time</em> not <em>run time</em>. Any errors that happen at <em>compile time</em> can’t be caught using <code>try</code> <code>catch</code> blocks.</p>
<h3 id="referenceerror">ReferenceError</h3>
<p>Straight from the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError">MDN docs</a>: "The <code>ReferenceError</code> object represents an error when a non-existent variable is referenced." This is the error that you’ll encounter when attempting to reference a variable that does not exist (either within your current scope or at all).</p>
<p>Let’s take a took at some examples for the causes of this error. One common cause for this error is misspelling a variable name:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">function</span> <span class="at">callPuppy</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb125-2" title="2">  <span class="kw">const</span> puppy <span class="op">=</span> <span class="st">&quot;puppy&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb125-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(pupy)<span class="op">;</span></a>
<a class="sourceLine" id="cb125-4" title="4"><span class="op">}</span></a>
<a class="sourceLine" id="cb125-5" title="5"></a>
<a class="sourceLine" id="cb125-6" title="6"><span class="at">callPuppy</span>()<span class="op">;</span> <span class="co">// ReferenceError: pupy is not defined</span></a></code></pre></div>
<p>Another common cause for a thrown <code>ReferenceError</code> is attempting to access a variable that is not in scope:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">function</span> <span class="at">callPuppy</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb126-2" title="2">  <span class="kw">const</span> puppy <span class="op">=</span> <span class="st">&quot;puppy&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb126-3" title="3"><span class="op">}</span></a>
<a class="sourceLine" id="cb126-4" title="4"></a>
<a class="sourceLine" id="cb126-5" title="5"><span class="va">console</span>.<span class="at">log</span>(puppy)<span class="op">;</span> <span class="co">// ReferenceError: puppy is not defined</span></a></code></pre></div>
<p>The aptly named <code>ReferenceError</code> will be thrown whenever you attempt to <em>reference</em> a variable that doesn’t exist.</p>
<h3 id="typeerror">TypeError</h3>
<p>A <code>TypeError</code> is commonly thrown for a couple of reasons:</p>
<ol type="1">
<li>When an operation cannot be performed because the operand is a value of the wrong type.</li>
<li>When you are attempting to modify a value that cannot be changed.</li>
</ol>
<p>Let’s look at a couple of examples that will each throw a <code>TypeError</code> for a different reason. Below we are attempting an operation (in this case a function call) on a value of the wrong type:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">let</span> dog<span class="op">;</span> <span class="co">// Remember unassigned variables are undefined!</span></a>
<a class="sourceLine" id="cb127-2" title="2"></a>
<a class="sourceLine" id="cb127-3" title="3"><span class="at">dog</span>()<span class="op">;</span> <span class="co">// TypeError: dog is not a function</span></a></code></pre></div>
<p>In the above example we attempt to invoke a declared but not assigned variable (which will evaluate to <code>undefined</code>). This will cause a <code>TypeError</code> because <code>undefined</code> cannot be invoked - it is the wrong type.</p>
<p>Next let’s look at a example of attempting to change a value that cannot be changed:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">const</span> puppy <span class="op">=</span> <span class="st">&quot;puppy&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb128-2" title="2"></a>
<a class="sourceLine" id="cb128-3" title="3">puppy <span class="op">=</span> <span class="st">&quot;apple&quot;</span><span class="op">;</span> <span class="co">// TypeError: Assignment to constant variable.</span></a></code></pre></div>
<p>Attempting te reassign a <code>const</code> declared variable will result in a <code>TypeError</code>. You’ve probably run into many other examples of <code>TypeError</code> yourself but, the most important thing to know is that a <code>TypeError</code> is thrown when you attempting to perform an operation on the wrong type of value.</p>
<h3 id="catching-known-errors">Catching known errors</h3>
<p>Now that we’ve covered the the names of common JavaScript errors as well as how to use a <code>try...catch</code> block we can combine these two ideas to catch specific types of errors using <code>instanceof</code>:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">function</span> <span class="at">callThatArg</span>(arg) <span class="op">{</span></a>
<a class="sourceLine" id="cb129-2" title="2">  <span class="at">arg</span>()<span class="op">;</span> <span class="co">// this will cause a TypeError because callThatArg is being passed a number</span></a>
<a class="sourceLine" id="cb129-3" title="3"><span class="op">}</span></a>
<a class="sourceLine" id="cb129-4" title="4"></a>
<a class="sourceLine" id="cb129-5" title="5"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb129-6" title="6">  <span class="at">callThatArg</span>(<span class="dv">42</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb129-7" title="7">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;call successful&quot;</span>)<span class="op">;</span> <span class="co">// this line never executes</span></a>
<a class="sourceLine" id="cb129-8" title="8"><span class="op">}</span> <span class="cf">catch</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb129-9" title="9">  <span class="cf">if</span> (error <span class="kw">instanceof</span> TypeError) <span class="op">{</span></a>
<a class="sourceLine" id="cb129-10" title="10">    <span class="va">console</span>.<span class="at">error</span>(<span class="vs">`Wrong Type: </span><span class="sc">${</span><span class="va">error</span>.<span class="at">message</span><span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span> <span class="co">// prints: Wrong Type: arg is not a function</span></a>
<a class="sourceLine" id="cb129-11" title="11">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb129-12" title="12">    <span class="va">console</span>.<span class="at">error</span>(<span class="va">error</span>.<span class="at">message</span>)<span class="op">;</span> <span class="co">// prints out any errors that aren&#39;t TypeErrors;</span></a>
<a class="sourceLine" id="cb129-13" title="13">  <span class="op">}</span></a>
<a class="sourceLine" id="cb129-14" title="14"><span class="op">}</span></a>
<a class="sourceLine" id="cb129-15" title="15"></a>
<a class="sourceLine" id="cb129-16" title="16"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;done&quot;</span>)<span class="op">;</span> <span class="co">// prints: done</span></a></code></pre></div>
<h2 id="what-you-learned-3">What you learned</h2>
<p>If you read an error and know <em>why</em> that error is being thrown it’ll be much easier to find the cause of the problem! In this reading we went over how to create and throw new <code>Error</code> objects as well as the definitions for some of the most common types of errors: <code>SyntaxError</code>, <code>ReferenceError</code>, and <code>TypeError</code>s.</p>
<hr />
<h1 id="practice-writing-tests">Practice: Writing Tests</h1>
<p>For weeks you have been using one of JavaScript’s most popular test frameworks, <code>Mocha</code>, to run tests that ensure a function you’ve written works as expected. It’s time to dive deeper into <strong>how</strong> to write our own tests using <code>Mocha</code> as our test framework coupled with Assertion libraries such as the built-in <code>Assert</code> module of Node or the <code>Chai</code> library.</p>
<p>For the rest of the readings in this section we will be covering how to write tests. These readings will be done in the style of a code-along demo so make sure you follow these in order. When you have finished the next series of reading you should know how to:</p>
<ul>
<li>properly format and denote your mocha tests using <code>describe</code>, <code>context</code> and <code>it</code> blocks</li>
<li>write tests for individual functions as well as writing tests for class instance and static methods</li>
<li>test that functions will throw certain errors</li>
<li>use <code>chai-spies</code> to test how many times a function has been called</li>
<li>recognize and utilize the Mocha hooks: <code>before</code>, <code>beforeEach</code>, <code>after</code>, and <code>afterEach</code></li>
</ul>
<p>In this reading we’ll be covering:</p>
<ul>
<li>the file structure of testing with <code>Mocha</code></li>
<li>testing with <code>Mocha</code> and Node’s built-in <code>Assert</code> module</li>
</ul>
<h2 id="part-zero-testing-file-structure">Part Zero: Testing file structure</h2>
<p>We find that reading about testing is best understood when you can play around within the functions being tested so for that reason this reading will be in the style of a code along demo. We started this reading by created a directory called <code>testing-demo</code> where all the code within this reading will be written.</p>
<p>Let’s start off with how to write tests for a basic function. Say we’ve been handed a directory with a function to test <code>problems/reverse-string.js</code>. Below is the named function we’ll be testing, <code>reverseString</code>, which will intake a string argument and then reverse it:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb130-1" title="1"><span class="co">// in testing-demo/problems/reverse-string.js</span></a>
<a class="sourceLine" id="cb130-2" title="2"></a>
<a class="sourceLine" id="cb130-3" title="3"><span class="kw">const</span> reverseString <span class="op">=</span> str <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb130-4" title="4">  <span class="co">// throws a specific error unless the the incoming arg is a string</span></a>
<a class="sourceLine" id="cb130-5" title="5">  <span class="cf">if</span> (<span class="kw">typeof</span> str <span class="op">!==</span> <span class="st">&quot;string&quot;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb130-6" title="6">    <span class="cf">throw</span> <span class="kw">new</span> <span class="at">TypeError</span>(<span class="st">&quot;this function only accepts string args&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb130-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb130-8" title="8"></a>
<a class="sourceLine" id="cb130-9" title="9">  <span class="cf">return</span> str</a>
<a class="sourceLine" id="cb130-10" title="10">    .<span class="at">split</span>(<span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb130-11" title="11">    .<span class="at">reverse</span>()</a>
<a class="sourceLine" id="cb130-12" title="12">    .<span class="at">join</span>(<span class="st">&quot;&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb130-13" title="13"><span class="op">};</span></a>
<a class="sourceLine" id="cb130-14" title="14"></a>
<a class="sourceLine" id="cb130-15" title="15"><span class="co">// note this function is being exported!</span></a>
<a class="sourceLine" id="cb130-16" title="16"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> reverseString<span class="op">;</span></a></code></pre></div>
<p>How would you go about testing the above function? Let’s start by setting up our file system correctly. Whenever you are running tests with <code>Mocha</code> the important thing to know is that the <code>Mocha</code> CLI will automatically be looking for a directory named <code>test</code>.</p>
<p>The created <code>test</code> directory’s file structure should mirror that of the files you intend to test - with each test file appending the word "spec" to the end of the file name. So for the above example we would create <code>test/reverse-string-spec.js</code> which should be on the same level as the <code>problems</code> directory.</p>
<p>Our file structure should look like this:</p>
<pre class="plaintext"><code>testing-demo
  └──
  problems
    └── reverse-string.js
  test
    └── reverse-string-spec.js</code></pre>
<p>Take a moment to ensure your file structure looks like the one above and that you’ve copied and pasted the <code>reverseString</code> function into the <code>reverse-string.js</code> file. Now that we’ve ensured our file structure is correct let’s write some tests!</p>
<h2 id="part-one-writing-tests-with-mocha-and-assert">Part One: Writing tests with Mocha and Assert</h2>
<p>The first step in any testing workflow is initializing our test file. Now let’s make a clear distinction before moving forward - <code>Mocha</code> is a test framework that specializes in <em>running</em> tests and presenting them in an organized user friendly way. The code responsible for actually verifying things for us will come from using an <em>Assertion Library</em>. Assertion Libraries will do the heavy lifting of comparing and verifying code while <code>Mocha</code> will run those tests and then present them to us.</p>
<p>The tests we’ll be writing for this next section will use Node’s built-in <code>Assert</code> module as our Assertion Library.</p>
<p>So inside of <code>test/reverse-string-spec.js</code> at the top of the file we will require the <code>assert</code> module and the function we intend to test:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">const</span> assert <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;assert&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb132-2" title="2"><span class="co">// this is a relative path to the function&#39;s location</span></a>
<a class="sourceLine" id="cb132-3" title="3"><span class="kw">const</span> reverseString <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;../problems/reverse-string.js&quot;</span>)<span class="op">;</span></a></code></pre></div>
<p>Take a moment to open up the <a href="https://mochajs.org/#getting-started"><code>Mocha</code></a> documentation - it will come in handy as a reference for the syntax we’ll be using. The <code>Mocha</code> DSL (Domain Specific Language) comes with a few different interfaces or "flavors" of their DSL for our purposes we’ll be structuring our tests using the <a href="https://mochajs.org/#bdd">BDD interface</a>.</p>
<p>The <code>describe</code> function is an organizational function that accepts a descriptive string and a callback. We’ll use the <code>describe</code> function to <strong>describe</strong> what we will be testing - in this case the <code>reverseString</code> function:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb133-1" title="1"><span class="co">// test/reverse-string-spec.js</span></a>
<a class="sourceLine" id="cb133-2" title="2"></a>
<a class="sourceLine" id="cb133-3" title="3"><span class="kw">const</span> assert <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;assert&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="kw">const</span> reverseString <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;../problems/reverse-string.js&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb133-5" title="5"></a>
<a class="sourceLine" id="cb133-6" title="6"><span class="at">describe</span>(<span class="st">&quot;reverseString()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{}</span>)<span class="op">;</span></a></code></pre></div>
<p>The callback handed to the <code>describe</code> function will be where we insert our actual tests. We can now use the <code>it</code> function - the <code>it</code> function is an organizational function we will use to wrap around each test we write. The <code>it</code> function accepts a descriptive string and callback to set up our test:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb134-1" title="1"><span class="at">describe</span> (<span class="st">&#39;reverseString()&#39;</span><span class="op">,</span> <span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb134-2" title="2">  <span class="at">it</span>(<span class="st">&#39;should reverse the input string&#39;</span><span class="op">,</span> <span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb134-3" title="3">    <span class="co">// a test will go here!</span></a>
<a class="sourceLine" id="cb134-4" title="4">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb134-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>The code written above will serve as a great template for future tests we wish to write. Finally, we can insert the actual test we intend to write within the callback handed to the <code>it</code> function. We’ll use the <a href="https://nodejs.org/api/assert.html#assert_assert_equal_actual_expected_message"><code>assert.strictEqual</code></a> function which allows you to compare one value with another value. We’ll use <code>assert.strictEqual</code> to compare two strings - one from our function’s result and our expected result which we will we define ourselves:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb135-1" title="1"><span class="co">// remember we required the assert module at the top of this file</span></a>
<a class="sourceLine" id="cb135-2" title="2"><span class="at">describe</span>(<span class="st">&quot;reverseString()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb135-3" title="3">  <span class="at">it</span>(<span class="st">&quot;should reverse the input string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb135-4" title="4">    <span class="kw">let</span> test <span class="op">=</span> <span class="at">reverseString</span>(<span class="st">&quot;hello&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb135-5" title="5">    <span class="kw">let</span> result <span class="op">=</span> <span class="st">&quot;olleh&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb135-6" title="6">    <span class="co">// the line below is where the actual test is!</span></a>
<a class="sourceLine" id="cb135-7" title="7">    <span class="va">assert</span>.<span class="at">strictEqual</span>(test<span class="op">,</span> result)<span class="op">;</span></a>
<a class="sourceLine" id="cb135-8" title="8">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb135-9" title="9"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now if we run <code>mocha</code> in the upper most <code>testing-demo</code> directory we will see:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb136-1" title="1"><span class="fu">reverseString()</span></a>
<a class="sourceLine" id="cb136-2" title="2">  ✓ <span class="ex">should</span> reverse the input string</a>
<a class="sourceLine" id="cb136-3" title="3"></a>
<a class="sourceLine" id="cb136-4" title="4"></a>
<a class="sourceLine" id="cb136-5" title="5"><span class="ex">1</span> passing (5ms)</a></code></pre></div>
<p>We now have a working spec! Take notice of how <code>Mocha</code> structures its response in exactly the way we nested our test. The outer <code>describe</code> function’s message of <code>reverseString()</code> is on the upper level and the inner <code>it</code> function’s message of <code>should reverse the input string</code> is nested within.</p>
<p>Strictly speaking we aren’t required to nest our <code>it</code> functions within <code>describe</code> functions but it is best practice to do so. As you can see yourself - it will make your tests a lot easier to read!</p>
<p>Let’s add one more spec for <code>reverseString</code>, we’ll do this by adding another <code>it</code> function within the <code>describe</code> callback:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb137-1" title="1"><span class="at">describe</span>(<span class="st">&quot;reverseString()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb137-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should reverse the input string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb137-3" title="3">    <span class="kw">let</span> test <span class="op">=</span> <span class="at">reverseString</span>(<span class="st">&quot;hello&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb137-4" title="4">    <span class="kw">let</span> result <span class="op">=</span> <span class="st">&quot;olleh&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb137-5" title="5"></a>
<a class="sourceLine" id="cb137-6" title="6">    <span class="va">assert</span>.<span class="at">strictEqual</span>(test<span class="op">,</span> result)<span class="op">;</span></a>
<a class="sourceLine" id="cb137-7" title="7">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb137-8" title="8"></a>
<a class="sourceLine" id="cb137-9" title="9">  <span class="at">it</span>(<span class="st">&quot;should reverse the input string and output the same capitalization&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb137-10" title="10">    <span class="kw">let</span> test <span class="op">=</span> <span class="at">reverseString</span>(<span class="st">&quot;Apple&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb137-11" title="11">    <span class="kw">let</span> result <span class="op">=</span> <span class="st">&quot;elppA&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb137-12" title="12"></a>
<a class="sourceLine" id="cb137-13" title="13">    <span class="va">assert</span>.<span class="at">strictEqual</span>(test<span class="op">,</span> result)<span class="op">;</span></a>
<a class="sourceLine" id="cb137-14" title="14">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb137-15" title="15"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Running the <code>mocha</code> command again will return:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb138-1" title="1"><span class="fu">reverseString()</span></a>
<a class="sourceLine" id="cb138-2" title="2">  ✓ <span class="ex">should</span> reverse the input string</a>
<a class="sourceLine" id="cb138-3" title="3">  ✓ <span class="ex">should</span> reverse the input string and output the same capitalization</a>
<a class="sourceLine" id="cb138-4" title="4"></a>
<a class="sourceLine" id="cb138-5" title="5"></a>
<a class="sourceLine" id="cb138-6" title="6"><span class="ex">2</span> passing (11ms)</a></code></pre></div>
<p>Looking good so far - head to the next reading to learn how to test errors.</p>
<hr />
<h1 id="writing-tests">Writing Tests</h1>
<p>In this reading we’ll be covering:</p>
<ul>
<li>how to test errors using <code>Mocha</code> and <code>Assert</code></li>
<li>test organization using <code>context</code> functions</li>
</ul>
<h2 id="part-two-testing-errors">Part Two: Testing errors</h2>
<p>Let’s jump right in where we left off! We’ve written a couple of nice <em>unit tests</em> - ensuring that this function works in isolation by testing the input we provided matches the expected output. One aspect of this function is not yet being tested - the error thrown when the argument is not of type <code>String</code>:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb139-1" title="1"><span class="co">// str is the passed in parameter</span></a>
<a class="sourceLine" id="cb139-2" title="2"><span class="cf">if</span> (<span class="kw">typeof</span> str <span class="op">!==</span> <span class="st">&quot;string&quot;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb139-3" title="3">  <span class="cf">throw</span> <span class="kw">new</span> <span class="at">TypeError</span>(<span class="st">&quot;this function only accepts string args&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb139-4" title="4"><span class="op">}</span></a></code></pre></div>
<h3 id="organizing-tests">Organizing tests</h3>
<p>Now the above error actually sets up two <em>different</em> scenarios - one where the incoming argument is a string and the second where the incoming argument isn’t a string and an error is thrown. We can denote these two different states by adding an additional level of organizational nesting to our tests. You can nest <code>describe</code> function callbacks arbitrarily deep - but this quickly becomes unreadable. When nesting, we make use of the <code>context</code> function, which is an alias for the <code>describe</code> function - the <code>context</code> function denotes that we are setting up the <strong>context</strong> for a particular set of tests.</p>
<p>Let’s refactor our tests from before with some <code>context</code> functions before moving on:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb140-1" title="1"><span class="at">describe</span>(<span class="st">&quot;reverseString()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb140-2" title="2">  <span class="at">context</span>(<span class="st">&quot;given a string argument&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb140-3" title="3">    <span class="at">it</span>(<span class="st">&quot;should reverse the given string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb140-4" title="4">      <span class="kw">let</span> test <span class="op">=</span> <span class="at">reverseString</span>(<span class="st">&quot;hello&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb140-5" title="5">      <span class="kw">let</span> result <span class="op">=</span> <span class="st">&quot;olleh&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb140-6" title="6"></a>
<a class="sourceLine" id="cb140-7" title="7">      <span class="va">assert</span>.<span class="at">strictEqual</span>(test<span class="op">,</span> result)<span class="op">;</span></a>
<a class="sourceLine" id="cb140-8" title="8">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb140-9" title="9"></a>
<a class="sourceLine" id="cb140-10" title="10">    <span class="at">it</span>(<span class="st">&quot;should reverse the given string and output the same capitalization&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb140-11" title="11">      <span class="kw">let</span> test <span class="op">=</span> <span class="at">reverseString</span>(<span class="st">&quot;Apple&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb140-12" title="12">      <span class="kw">let</span> result <span class="op">=</span> <span class="st">&quot;elppA&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb140-13" title="13">      <span class="va">assert</span>.<span class="at">strictEqual</span>(test<span class="op">,</span> result)<span class="op">;</span></a>
<a class="sourceLine" id="cb140-14" title="14">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb140-15" title="15">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb140-16" title="16"></a>
<a class="sourceLine" id="cb140-17" title="17">  <span class="at">context</span>(<span class="st">&quot;given an argument that is not a string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb140-18" title="18"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Running the above test will give us this readable output:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb141-1" title="1"><span class="fu">reverseString()</span></a>
<a class="sourceLine" id="cb141-2" title="2">  <span class="ex">given</span> a string argument</a>
<a class="sourceLine" id="cb141-3" title="3">    ✓ <span class="ex">should</span> reverse the given string</a>
<a class="sourceLine" id="cb141-4" title="4">    ✓ <span class="ex">should</span> reverse the given string and output the same capitalization</a>
<a class="sourceLine" id="cb141-5" title="5">  <span class="ex">given</span> an argument that is not a string</a>
<a class="sourceLine" id="cb141-6" title="6"></a>
<a class="sourceLine" id="cb141-7" title="7"><span class="ex">2</span> passing (11ms)</a></code></pre></div>
<h3 id="testing-errors">Testing errors</h3>
<p>Nice now that we have our <code>context</code> functions in place we can work on our second scenario where the incoming argument is <em>not</em> a string. When using an assertion library like Node’s built in <a href="https://nodejs.org/api/assert.html#assert_assert"><code>Assert</code></a> we will have access to many functions that will allow us the flexibility to test all kinds of things. For testing errors using Node’s built in <code>Assert</code> module we can use the <a href="https://nodejs.org/api/assert.html#assert_assert_throws_fn_error_message"><code>assert.throws</code></a> function.</p>
<p>Now we’ll setup up our <code>it</code> function within the <code>context</code> function we setup above:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb142-1" title="1"><span class="at">context</span>(<span class="st">&quot;given an argument that is not a string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb142-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should throw a TypeError when given an argument that is not a string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb142-3" title="3">    <span class="va">assert</span>.<span class="at">throws</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb142-4" title="4">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb142-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The <code>assert.throws</code> function works different from the <code>assert.strictEqual</code> function in that it does not compare the return value of a function, but it attempts to invoke a function in order to verify that it will throw a particular error. The <code>assert.throws</code> function accepts a function as the first argument, then the error that should be thrown as the second argument with an optional error message as our third argument.</p>
<p>So following that logic, we can test the <code>TypeError</code> error thrown by <code>reverseString</code> with something like this:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb143-1" title="1"><span class="at">context</span>(<span class="st">&quot;given an argument that is not a string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb143-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should throw a TypeError when given an argument that is not a string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb143-3" title="3">    <span class="va">assert</span>.<span class="at">throws</span>(<span class="at">reverseString</span>(<span class="dv">3</span>)<span class="op">,</span> TypeError)<span class="op">;</span></a>
<a class="sourceLine" id="cb143-4" title="4">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb143-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>However, when we run the <code>mocha</code> command we will get:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb144-1" title="1"><span class="fu">reverseString()</span></a>
<a class="sourceLine" id="cb144-2" title="2"><span class="co">#  etc.</span></a>
<a class="sourceLine" id="cb144-3" title="3">  <span class="ex">given</span> an argument that is not a string</a>
<a class="sourceLine" id="cb144-4" title="4">    <span class="ex">1</span>) <span class="ex">should</span> throw a TypeError when given an argument that is not a string</a>
<a class="sourceLine" id="cb144-5" title="5"></a>
<a class="sourceLine" id="cb144-6" title="6"></a>
<a class="sourceLine" id="cb144-7" title="7"><span class="ex">2</span> passing (11ms)</a>
<a class="sourceLine" id="cb144-8" title="8"><span class="ex">1</span> failing</a>
<a class="sourceLine" id="cb144-9" title="9"></a>
<a class="sourceLine" id="cb144-10" title="10"><span class="ex">1</span>) <span class="fu">reverseString()</span></a>
<a class="sourceLine" id="cb144-11" title="11">    <span class="ex">given</span> an argument that is not a string should throw a TypeError when given an</a>
<a class="sourceLine" id="cb144-12" title="12">    <span class="ex">argument</span> that is not a string:</a>
<a class="sourceLine" id="cb144-13" title="13">    <span class="ex">TypeError</span>: this function only accepts string args</a></code></pre></div>
<p>We are failing the above spec because we passed the invoked version of the <code>reverseString</code> function with a number argument - which as we know will throw a <code>TypeError</code> and halt program execution. This is a common mistake made everyday by developers when writing tests. We can get around this by wrapping our error expecting function within another function. This will ensure we can still invoke the <code>reverseString</code> function with an argument but not throw the error until <code>assert.throws</code> is ready to catch it.</p>
<p>We can also add the explicit error message that <code>reverseString</code> throws to make our spec as specific as possible:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb145-1" title="1"><span class="at">context</span>(<span class="st">&quot;given an argument that is not a string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb145-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should throw a TypeError when given an argument that is not a string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb145-3" title="3">    <span class="va">assert</span>.<span class="at">throws</span>(</a>
<a class="sourceLine" id="cb145-4" title="4">      <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb145-5" title="5">        <span class="at">reverseString</span>(<span class="dv">3</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb145-6" title="6">      <span class="op">},</span></a>
<a class="sourceLine" id="cb145-7" title="7">      TypeError<span class="op">,</span></a>
<a class="sourceLine" id="cb145-8" title="8">      <span class="st">&quot;this function only accepts string args&quot;</span></a>
<a class="sourceLine" id="cb145-9" title="9">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb145-10" title="10">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb145-11" title="11"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now when we run <code>mocha</code> we will see:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb146-1" title="1"><span class="at">reverseString</span>()</a>
<a class="sourceLine" id="cb146-2" title="2">  given a string argument</a>
<a class="sourceLine" id="cb146-3" title="3">    ✓ should reverse the given string</a>
<a class="sourceLine" id="cb146-4" title="4">    ✓ should reverse the given string and output the same capitalization</a>
<a class="sourceLine" id="cb146-5" title="5">  given an argument that is not a string</a>
<a class="sourceLine" id="cb146-6" title="6">    ✓ should <span class="cf">throw</span> a TypeError when given an argument that is not a string</a>
<a class="sourceLine" id="cb146-7" title="7"></a>
<a class="sourceLine" id="cb146-8" title="8"></a>
<a class="sourceLine" id="cb146-9" title="9"><span class="dv">3</span> <span class="at">passing</span> (13ms)</a></code></pre></div>
<p>Awesome! So we’ve covered writing unit tests using <code>describe</code>, <code>context</code>, and <code>it</code> functions for organization. We have also covered how to test for equality and thrown errors using Node’s built-in assertion library, <code>Assert</code>.</p>
<p>Head to the next reading to learn about how to test classes using <code>Mocha</code> and another assertion library named <code>Chai</code>.</p>
<hr />
<h1 id="writing-tests-1">Writing Tests</h1>
<p>In this reading we’ll be covering:</p>
<ul>
<li>how to test classes using <code>Mocha</code> and <code>Chai</code></li>
</ul>
<h2 id="part-three-testing-classes-using-mocha-and-chai">Part Three: Testing classes using Mocha and Chai</h2>
<p>Let’s expand our knowledge of testing syntax by testing some classes! In order to fully test a class, we’ll be looking to test that class’s instance and static methods. Create a new file in the <code>problems</code> folder - <code>dog.js</code>. We’ll use the following code for the rest of our tests so make sure to copy it over:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb147-1" title="1"><span class="co">// testing-demo/problems/dog.js</span></a>
<a class="sourceLine" id="cb147-2" title="2"></a>
<a class="sourceLine" id="cb147-3" title="3"><span class="kw">class</span> Dog <span class="op">{</span></a>
<a class="sourceLine" id="cb147-4" title="4">  <span class="at">constructor</span>(name) <span class="op">{</span></a>
<a class="sourceLine" id="cb147-5" title="5">    <span class="kw">this</span>.<span class="at">name</span> <span class="op">=</span> name<span class="op">;</span></a>
<a class="sourceLine" id="cb147-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb147-7" title="7"></a>
<a class="sourceLine" id="cb147-8" title="8">  <span class="at">bark</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb147-9" title="9">    <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span><span class="kw">this</span>.<span class="at">name</span><span class="sc">}</span><span class="vs"> is barking`</span><span class="op">;</span></a>
<a class="sourceLine" id="cb147-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb147-11" title="11"></a>
<a class="sourceLine" id="cb147-12" title="12">  <span class="at">chainChaseTail</span>(num) <span class="op">{</span></a>
<a class="sourceLine" id="cb147-13" title="13">    <span class="cf">if</span> (<span class="kw">typeof</span> num <span class="op">!==</span> <span class="st">&quot;number&quot;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb147-14" title="14">      <span class="cf">throw</span> <span class="kw">new</span> <span class="at">TypeError</span>(<span class="st">&quot;please only use numbers for this function&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb147-15" title="15">    <span class="op">}</span></a>
<a class="sourceLine" id="cb147-16" title="16">    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> num<span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb147-17" title="17">      <span class="kw">this</span>.<span class="at">chaseTail</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb147-18" title="18">    <span class="op">}</span></a>
<a class="sourceLine" id="cb147-19" title="19">  <span class="op">}</span></a>
<a class="sourceLine" id="cb147-20" title="20"></a>
<a class="sourceLine" id="cb147-21" title="21">  <span class="at">chaseTail</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb147-22" title="22">    <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`</span><span class="sc">${</span><span class="kw">this</span>.<span class="at">name</span><span class="sc">}</span><span class="vs"> is chasing their tail`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb147-23" title="23">  <span class="op">}</span></a>
<a class="sourceLine" id="cb147-24" title="24"></a>
<a class="sourceLine" id="cb147-25" title="25">  <span class="kw">static</span> <span class="at">cleanDogs</span>(dogs) <span class="op">{</span></a>
<a class="sourceLine" id="cb147-26" title="26">    <span class="kw">let</span> cleanDogs <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb147-27" title="27">    <span class="va">dogs</span>.<span class="at">forEach</span>(dog <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb147-28" title="28">      <span class="kw">let</span> dogStr <span class="op">=</span> <span class="vs">`I cleaned </span><span class="sc">${</span><span class="va">dog</span>.<span class="at">name</span><span class="sc">}</span><span class="vs">&#39;s paws.`</span><span class="op">;</span></a>
<a class="sourceLine" id="cb147-29" title="29">      <span class="va">cleanDogs</span>.<span class="at">push</span>(dogStr)<span class="op">;</span></a>
<a class="sourceLine" id="cb147-30" title="30">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb147-31" title="31">    <span class="cf">return</span> cleanDogs<span class="op">;</span></a>
<a class="sourceLine" id="cb147-32" title="32">  <span class="op">}</span></a>
<a class="sourceLine" id="cb147-33" title="33"><span class="op">}</span></a>
<a class="sourceLine" id="cb147-34" title="34"></a>
<a class="sourceLine" id="cb147-35" title="35"><span class="co">// ensure to export our class!</span></a>
<a class="sourceLine" id="cb147-36" title="36"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> Dog<span class="op">;</span></a></code></pre></div>
<p>To test this class we’ll create a new file in our <code>test</code> directory - <code>dog-spec.js</code> so your file structure should now look like this:</p>
<pre class="plaintext"><code>testing-demo
  └──
  problems
    └── reverse-string.js
    └── dog.js
  test
    └── reverse-string-spec.js
    └── dog-spec.js</code></pre>
<p>Let’s now set up our <code>dog-spec.js</code> file. For this example we’ll get experience using another assertion library named <a href="https://www.chaijs.com/"><code>Chai</code></a>. As you’ll soon see, the Chai library comes with a lot more built-in more functionality than Node’s <code>Assert</code> module.</p>
<p>Now since <code>Chai</code> is another external library we’ll need to import it in order to use it. We need to run a few commands to first create a <code>package.json</code> and then we can import the <code>chai</code> library. Start off by running <code>npm init --y</code> in the top level directory (<code>testing-demo</code>) to create a <code>package.json</code> file. After that is finished you can import the <code>Chai</code> library by running <code>npm install chai</code>.</p>
<p>Here is what that will look like in your terminal:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb149-1" title="1"><span class="ex">~</span> <span class="ex">testing-demo</span> $ npm init --y</a>
<a class="sourceLine" id="cb149-2" title="2"><span class="ex">Wrote</span> to /testing-demo/problems/package.json:</a>
<a class="sourceLine" id="cb149-3" title="3"></a>
<a class="sourceLine" id="cb149-4" title="4"><span class="kw">{</span></a>
<a class="sourceLine" id="cb149-5" title="5">  <span class="st">&quot;name&quot;</span>: <span class="st">&quot;testing-demo&quot;</span>,</a>
<a class="sourceLine" id="cb149-6" title="6">  <span class="st">&quot;version&quot;</span>: <span class="st">&quot;1.0.0&quot;</span>,</a>
<a class="sourceLine" id="cb149-7" title="7">  <span class="st">&quot;description&quot;</span>: <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb149-8" title="8">  <span class="st">&quot;main&quot;</span>: <span class="st">&quot;index.js&quot;</span>,</a>
<a class="sourceLine" id="cb149-9" title="9">  <span class="st">&quot;directories&quot;</span>: <span class="kw">{</span></a>
<a class="sourceLine" id="cb149-10" title="10">    <span class="st">&quot;test&quot;</span>: <span class="st">&quot;test&quot;</span></a>
<a class="sourceLine" id="cb149-11" title="11">  <span class="kw">}</span>,</a>
<a class="sourceLine" id="cb149-12" title="12">  <span class="st">&quot;scripts&quot;</span>: <span class="kw">{</span></a>
<a class="sourceLine" id="cb149-13" title="13">    <span class="st">&quot;test&quot;</span>: <span class="st">&quot;echo </span><span class="dt">\&quot;</span><span class="st">Error: no test specified</span><span class="dt">\&quot;</span><span class="st"> &amp;&amp; exit 1&quot;</span></a>
<a class="sourceLine" id="cb149-14" title="14">  <span class="kw">}</span>,</a>
<a class="sourceLine" id="cb149-15" title="15">  <span class="st">&quot;keywords&quot;</span>: [],</a>
<a class="sourceLine" id="cb149-16" title="16">  <span class="st">&quot;author&quot;</span>: <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb149-17" title="17">  <span class="st">&quot;license&quot;</span>: <span class="st">&quot;ISC&quot;</span></a>
<a class="sourceLine" id="cb149-18" title="18"><span class="kw">}</span></a>
<a class="sourceLine" id="cb149-19" title="19"></a>
<a class="sourceLine" id="cb149-20" title="20"><span class="ex">~</span> <span class="ex">testing-demo</span> $ npm install chai</a></code></pre></div>
<p>Now that we’ve installed <code>Chai</code> we can set up our test file. Create a new file in the <code>test</code> folder named <code>dog-spec.js</code> We’ll require the <code>expect</code> module from Chai for our assertions, import our <code>Dog</code> class, and set up our outer <code>describe</code> function for testing the <code>Dog</code> class:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb150-1" title="1"><span class="co">// testing-demo/test/dog-spec.js</span></a>
<a class="sourceLine" id="cb150-2" title="2"></a>
<a class="sourceLine" id="cb150-3" title="3"><span class="co">// set up chai</span></a>
<a class="sourceLine" id="cb150-4" title="4"><span class="kw">const</span> chai <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;chai&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb150-5" title="5"><span class="kw">const</span> expect <span class="op">=</span> <span class="va">chai</span>.<span class="at">expect</span><span class="op">;</span></a>
<a class="sourceLine" id="cb150-6" title="6"></a>
<a class="sourceLine" id="cb150-7" title="7"><span class="co">// don&#39;t forget to import the class you are testing!</span></a>
<a class="sourceLine" id="cb150-8" title="8"><span class="kw">const</span> Dog <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;../problems/dog.js&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb150-9" title="9"></a>
<a class="sourceLine" id="cb150-10" title="10"><span class="co">// our outer describe for the whole Dog class</span></a>
<a class="sourceLine" id="cb150-11" title="11"><span class="at">describe</span>(<span class="st">&quot;Dog&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{}</span>)<span class="op">;</span></a></code></pre></div>
<p>So the first thing we’ll generally want to test on classes is their <code>constructor</code> functions - we need to make sure new instances have the correct properties and that those properties are being set properly before we can test anything else. For the <code>Dog</code> class it looks like a name is accepted on instantiation, so let’s test that!</p>
<p>We’ll start with a nested describe function within our outer <code>Dog</code> describe function:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb151-1" title="1"><span class="at">describe</span>(<span class="st">&quot;Dog&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb151-2" title="2">  <span class="at">describe</span>(<span class="st">&quot;Dog Constructor Function&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb151-3" title="3">    <span class="at">it</span>(<span class="st">&#39;should have a &quot;name&quot; property&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb151-4" title="4">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb151-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now we are using a different assertion library so we’ll be working with some different syntax. Open up the <a href="https://www.chaijs.com/api/bdd/"><code>Chai Expect</code></a> documentation for reference, we won’t be going into tons of detail into every function we use with Chai because Chai allows for a lot of smaller chainable functions and we know you have lives outide this reading.</p>
<p>The nice thing about Chai is that the chainable functions available will often read like English. Check out the right column of this handy <a href="https://devhints.io/chai">Chai cheatsheet</a> for a quick and easy reference on chainable functions.</p>
<p>We’ll start our first spec off by using the <a href="https://www.chaijs.com/api/bdd/#method_property"><code>property</code></a> matcher to ensure that a newly instantiated object has a specified property:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb152-1" title="1"><span class="at">describe</span>(<span class="st">&quot;Dog&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb152-2" title="2">  <span class="at">describe</span>(<span class="st">&quot;Dog Constructor Function&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb152-3" title="3">    <span class="at">it</span>(<span class="st">&#39;should have a &quot;name&quot; property&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb152-4" title="4">      <span class="kw">const</span> layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb152-5" title="5">      <span class="co">// all our of chai tests will begin with the expect function</span></a>
<a class="sourceLine" id="cb152-6" title="6">      <span class="co">// .to and .have are Chai chainable functions</span></a>
<a class="sourceLine" id="cb152-7" title="7">      <span class="co">// .property is the matcher we are using</span></a>
<a class="sourceLine" id="cb152-8" title="8">      <span class="at">expect</span>(layla).<span class="va">to</span>.<span class="va">have</span>.<span class="at">property</span>(<span class="st">&quot;name&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb152-9" title="9">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb152-10" title="10">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb152-11" title="11"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now to test our new spec we can run just the Dog class specs by running <code>mocha test/dog-spec.js</code> from our top level directory. Running that command we’ll see:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb153-1" title="1"><span class="ex">Dog</span></a>
<a class="sourceLine" id="cb153-2" title="2">  <span class="ex">Dog</span> Constructor Function</a>
<a class="sourceLine" id="cb153-3" title="3">    ✓ <span class="ex">should</span> have a <span class="st">&quot;name&quot;</span> property</a>
<a class="sourceLine" id="cb153-4" title="4"></a>
<a class="sourceLine" id="cb153-5" title="5"></a>
<a class="sourceLine" id="cb153-6" title="6"><span class="ex">1</span> passing (8ms)</a></code></pre></div>
<p>Nice! We tested that the name property exists on a new dog instance. Next, we can make sure our name is set properly with another test:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb154-1" title="1"><span class="at">describe</span>(<span class="st">&quot;Dog Constructor Function&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb154-2" title="2">  <span class="at">it</span>(<span class="st">&#39;should have a &quot;name&quot; property&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb154-3" title="3">    <span class="kw">const</span> layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb154-4" title="4">    <span class="at">expect</span>(layla).<span class="va">to</span>.<span class="va">have</span>.<span class="at">property</span>(<span class="st">&quot;name&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb154-5" title="5">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb154-6" title="6"></a>
<a class="sourceLine" id="cb154-7" title="7">  <span class="at">it</span>(<span class="st">&#39;should set the &quot;name&quot; property when a new dog is created&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb154-8" title="8">    <span class="kw">const</span> layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb154-9" title="9">    <span class="co">// we are using the eql function to compare the value of layla.name</span></a>
<a class="sourceLine" id="cb154-10" title="10">    <span class="co">// with the provided string</span></a>
<a class="sourceLine" id="cb154-11" title="11">    <span class="at">expect</span>(<span class="va">layla</span>.<span class="at">name</span>).<span class="va">to</span>.<span class="at">eql</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb154-12" title="12">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb154-13" title="13"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Running the above using <code>mocha</code> we’ll see both of our specs passing! Now take extra note of the fact that we are defining the same variable twice using <code>const</code> within the above <code>it</code> callbacks. This is important to note because it underlines the fact that each of the unit tests you write will have their own scope - meaning that they are each independent of the specs that came before or after them.</p>
<p>Head to the next reading to refactor some of the code we just wrote using <code>Mocha</code> hooks!</p>
<hr />
<h1 id="writing-tests-2">Writing Tests</h1>
<p>This will be the final demo in our writing tests series! In this reading we’ll be covering:</p>
<ul>
<li>Using <code>Mocha</code> Hooks to DRY up testing</li>
<li>Using <code>Chai Spies</code> to "spy" on functions to see how many times they’ve been invoked</li>
</ul>
<h2 id="part-four-mocha-hooks-and-chai-spies">Part Four: Mocha Hooks and Chai Spies</h2>
<p>Let’s jump right back in. We’ve written some nice unit tests up to this point:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb155-1" title="1"><span class="at">describe</span>(<span class="st">&quot;Dog Constructor Function&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb155-2" title="2">  <span class="at">it</span>(<span class="st">&#39;should have a &quot;name&quot; property&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb155-3" title="3">    <span class="kw">const</span> layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb155-4" title="4">    <span class="at">expect</span>(layla).<span class="va">to</span>.<span class="va">have</span>.<span class="at">property</span>(<span class="st">&quot;name&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb155-5" title="5">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb155-6" title="6"></a>
<a class="sourceLine" id="cb155-7" title="7">  <span class="at">it</span>(<span class="st">&#39;should set the &quot;name&quot; property when a new dog is created&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb155-8" title="8">    <span class="kw">const</span> layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb155-9" title="9">    <span class="co">// we are using the eql function to compare the value of layla.name</span></a>
<a class="sourceLine" id="cb155-10" title="10">    <span class="co">// with the provided string</span></a>
<a class="sourceLine" id="cb155-11" title="11">    <span class="at">expect</span>(<span class="va">layla</span>.<span class="at">name</span>).<span class="va">to</span>.<span class="at">eql</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb155-12" title="12">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb155-13" title="13"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>This is how unit tests are supposed to work, buuuut it will be annoying over time if we have to define a new <code>Dog</code> instance in <em>every single spec</em>. <code>Mocha</code> has some built in functionality to help us with this problem though: Mocha Hooks!</p>
<h3 id="introducing-mocha-hooks">Introducing Mocha Hooks</h3>
<p><a href="https://mochajs.org/#hooks">Mocha Hooks</a> give you a convenient way to do set up prior to running a related group of specs or to do some clean up after running those specs. Using hooks helps to keep your testing code DRY so you don’t unnecessarily repeat set up and clean up code within each test.</p>
<p>Mocha Hooks have very descriptive function names and two levels of granularity - before/after each block of tests <em>or</em> before/after each test:</p>
<ol type="1">
<li>the hooks <code>before</code> and <code>after</code> will be invoked either before or after the block of tests is run (depending on which function is used)</li>
<li>the hooks <code>beforeEach</code> and <code>afterEach</code> will be invoked either before or after <strong>each</strong> test (depending on which function is used)</li>
</ol>
<p>Let’s look at a simple example that uses each of the available hooks to log a message to the console. Two placeholder tests are also defined to help demonstrate the differences between the available hooks:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb156-1" title="1"><span class="kw">const</span> assert <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;assert&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-2" title="2"></a>
<a class="sourceLine" id="cb156-3" title="3"><span class="at">describe</span>(<span class="st">&#39;Hooks demo&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb156-4" title="4">  <span class="at">before</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb156-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Before hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-7" title="7"></a>
<a class="sourceLine" id="cb156-8" title="8">  <span class="at">beforeEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb156-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Before each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-10" title="10">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-11" title="11"></a>
<a class="sourceLine" id="cb156-12" title="12">  <span class="at">afterEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb156-13" title="13">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;After each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-14" title="14">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-15" title="15"></a>
<a class="sourceLine" id="cb156-16" title="16">  <span class="at">after</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb156-17" title="17">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;After hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-18" title="18">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-19" title="19"></a>
<a class="sourceLine" id="cb156-20" title="20">  <span class="at">it</span>(<span class="st">&#39;Placeholder one&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb156-21" title="21">    <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-22" title="22">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-23" title="23"></a>
<a class="sourceLine" id="cb156-24" title="24">  <span class="at">it</span>(<span class="st">&#39;Placeholder two&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb156-25" title="25">    <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-26" title="26">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb156-27" title="27"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Running the above spec produces the following output:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb157-1" title="1">  <span class="ex">Hooks</span> demo</a>
<a class="sourceLine" id="cb157-2" title="2"><span class="ex">Before</span> hook...</a>
<a class="sourceLine" id="cb157-3" title="3"><span class="ex">Before</span> each hook...</a>
<a class="sourceLine" id="cb157-4" title="4">    ✓ <span class="ex">Placeholder</span> one</a>
<a class="sourceLine" id="cb157-5" title="5"><span class="ex">After</span> each hook...</a>
<a class="sourceLine" id="cb157-6" title="6"><span class="ex">Before</span> each hook...</a>
<a class="sourceLine" id="cb157-7" title="7">    ✓ <span class="ex">Placeholder</span> two</a>
<a class="sourceLine" id="cb157-8" title="8"><span class="ex">After</span> each hook...</a>
<a class="sourceLine" id="cb157-9" title="9"><span class="ex">After</span> hook...</a>
<a class="sourceLine" id="cb157-10" title="10"></a>
<a class="sourceLine" id="cb157-11" title="11"></a>
<a class="sourceLine" id="cb157-12" title="12">  <span class="ex">2</span> passing (5ms)</a></code></pre></div>
<p>Notice that the <code>before</code> and <code>after</code> hooks only ran once while the <code>beforeEach</code> and <code>afterEach</code> hooks each ran once per test.</p>
<p>Hooks are defined within a <code>describe</code> or <code>context</code> function. While hooks can be defined before, after, or interspersed with your tests, keeping all of your hooks together (before or after your tests) will help others to read and understand your code.</p>
<p>Defining hooks out of their logical order has no effect on when they’re ran. Consider the following example that defines an <code>afterHook</code> before a <code>beforeEach</code> hook:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb158-1" title="1"><span class="kw">const</span> assert <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;assert&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-2" title="2"></a>
<a class="sourceLine" id="cb158-3" title="3"><span class="at">describe</span>(<span class="st">&#39;Hooks demo&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-4" title="4">  <span class="at">afterEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;After each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-7" title="7"></a>
<a class="sourceLine" id="cb158-8" title="8">  <span class="at">beforeEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Before each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-10" title="10">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-11" title="11"></a>
<a class="sourceLine" id="cb158-12" title="12">  <span class="at">it</span>(<span class="st">&#39;Placeholder one&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-13" title="13">    <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-14" title="14">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-15" title="15"></a>
<a class="sourceLine" id="cb158-16" title="16">  <span class="at">it</span>(<span class="st">&#39;Placeholder two&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-17" title="17">    <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-18" title="18">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-19" title="19"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Running the above spec produces the following output:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb159-1" title="1">  <span class="ex">Hooks</span> demo</a>
<a class="sourceLine" id="cb159-2" title="2"><span class="ex">Before</span> each hook...</a>
<a class="sourceLine" id="cb159-3" title="3">    ✓ <span class="ex">Placeholder</span> one</a>
<a class="sourceLine" id="cb159-4" title="4"><span class="ex">After</span> each hook...</a>
<a class="sourceLine" id="cb159-5" title="5"><span class="ex">Before</span> each hook...</a>
<a class="sourceLine" id="cb159-6" title="6">    ✓ <span class="ex">Placeholder</span> two</a>
<a class="sourceLine" id="cb159-7" title="7"><span class="ex">After</span> each hook...</a>
<a class="sourceLine" id="cb159-8" title="8"></a>
<a class="sourceLine" id="cb159-9" title="9"></a>
<a class="sourceLine" id="cb159-10" title="10">  <span class="ex">2</span> passing (6ms)</a></code></pre></div>
<p>The order of your hooks only matters when you define multiple hooks of the same type. When a hook type is defined more than once, they’ll be ran in the order that they’re defined in:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb160-1" title="1"><span class="kw">const</span> assert <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;assert&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb160-2" title="2"></a>
<a class="sourceLine" id="cb160-3" title="3"><span class="at">describe</span>(<span class="st">&#39;Hooks demo&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb160-4" title="4">  <span class="at">beforeEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb160-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Before each hook #1...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb160-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb160-7" title="7"></a>
<a class="sourceLine" id="cb160-8" title="8">  <span class="at">beforeEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb160-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Before each hook #2...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb160-10" title="10">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb160-11" title="11"></a>
<a class="sourceLine" id="cb160-12" title="12">  <span class="at">it</span>(<span class="st">&#39;Placeholder one&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb160-13" title="13">    <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb160-14" title="14">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb160-15" title="15"></a>
<a class="sourceLine" id="cb160-16" title="16">  <span class="at">it</span>(<span class="st">&#39;Placeholder two&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb160-17" title="17">    <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb160-18" title="18">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb160-19" title="19"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Running the above spec produces the following output:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb161-1" title="1">  <span class="ex">Hooks</span> demo</a>
<a class="sourceLine" id="cb161-2" title="2"><span class="ex">Before</span> each hook <span class="co">#1...</span></a>
<a class="sourceLine" id="cb161-3" title="3"><span class="ex">Before</span> each hook <span class="co">#2...</span></a>
<a class="sourceLine" id="cb161-4" title="4">    ✓ <span class="ex">Placeholder</span> one</a>
<a class="sourceLine" id="cb161-5" title="5"><span class="ex">Before</span> each hook <span class="co">#1...</span></a>
<a class="sourceLine" id="cb161-6" title="6"><span class="ex">Before</span> each hook <span class="co">#2...</span></a>
<a class="sourceLine" id="cb161-7" title="7">    ✓ <span class="ex">Placeholder</span> two</a>
<a class="sourceLine" id="cb161-8" title="8"></a>
<a class="sourceLine" id="cb161-9" title="9"></a>
<a class="sourceLine" id="cb161-10" title="10">  <span class="ex">2</span> passing (5ms)</a></code></pre></div>
<p>You can also define hooks within nested <code>describe</code> or <code>context</code> functions:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">const</span> assert <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;assert&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-2" title="2"></a>
<a class="sourceLine" id="cb162-3" title="3"><span class="at">describe</span>(<span class="st">&#39;Hooks demo&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-4" title="4">  <span class="at">before</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Before hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-7" title="7"></a>
<a class="sourceLine" id="cb162-8" title="8">  <span class="at">beforeEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Before each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-10" title="10">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-11" title="11"></a>
<a class="sourceLine" id="cb162-12" title="12">  <span class="at">afterEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-13" title="13">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;After each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-14" title="14">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-15" title="15"></a>
<a class="sourceLine" id="cb162-16" title="16">  <span class="at">after</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-17" title="17">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;After hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-18" title="18">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-19" title="19"></a>
<a class="sourceLine" id="cb162-20" title="20">  <span class="at">it</span>(<span class="st">&#39;Placeholder one&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-21" title="21">    <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-22" title="22">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-23" title="23"></a>
<a class="sourceLine" id="cb162-24" title="24">  <span class="at">it</span>(<span class="st">&#39;Placeholder two&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-25" title="25">    <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-26" title="26">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-27" title="27"></a>
<a class="sourceLine" id="cb162-28" title="28">  <span class="at">describe</span>(<span class="st">&#39;nested tests&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-29" title="29">    <span class="at">before</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-30" title="30">      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Nested before hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-31" title="31">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-32" title="32">  </a>
<a class="sourceLine" id="cb162-33" title="33">    <span class="at">beforeEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-34" title="34">      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Nested before each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-35" title="35">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-36" title="36">  </a>
<a class="sourceLine" id="cb162-37" title="37">    <span class="at">afterEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-38" title="38">      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Nested after each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-39" title="39">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-40" title="40">  </a>
<a class="sourceLine" id="cb162-41" title="41">    <span class="at">after</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-42" title="42">      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Nested after hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-43" title="43">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-44" title="44"></a>
<a class="sourceLine" id="cb162-45" title="45">    <span class="at">it</span>(<span class="st">&#39;Placeholder one&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-46" title="46">      <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-47" title="47">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-48" title="48">  </a>
<a class="sourceLine" id="cb162-49" title="49">    <span class="at">it</span>(<span class="st">&#39;Placeholder two&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb162-50" title="50">      <span class="va">assert</span>.<span class="at">equal</span>(<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-51" title="51">    <span class="op">}</span>)<span class="op">;</span>  </a>
<a class="sourceLine" id="cb162-52" title="52">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb162-53" title="53"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Running the above spec produces the following output:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb163-1" title="1">  <span class="ex">Hooks</span> demo</a>
<a class="sourceLine" id="cb163-2" title="2"><span class="ex">Before</span> hook...</a>
<a class="sourceLine" id="cb163-3" title="3"><span class="ex">Before</span> each hook...</a>
<a class="sourceLine" id="cb163-4" title="4">    ✓ <span class="ex">Placeholder</span> one</a>
<a class="sourceLine" id="cb163-5" title="5"><span class="ex">After</span> each hook...</a>
<a class="sourceLine" id="cb163-6" title="6"><span class="ex">Before</span> each hook...</a>
<a class="sourceLine" id="cb163-7" title="7">    ✓ <span class="ex">Placeholder</span> two</a>
<a class="sourceLine" id="cb163-8" title="8"><span class="ex">After</span> each hook...</a>
<a class="sourceLine" id="cb163-9" title="9">    <span class="ex">nested</span> tests</a>
<a class="sourceLine" id="cb163-10" title="10"><span class="ex">Nested</span> before hook...</a>
<a class="sourceLine" id="cb163-11" title="11"><span class="ex">Before</span> each hook...</a>
<a class="sourceLine" id="cb163-12" title="12"><span class="ex">Nested</span> before each hook...</a>
<a class="sourceLine" id="cb163-13" title="13">      ✓ <span class="ex">Placeholder</span> one</a>
<a class="sourceLine" id="cb163-14" title="14"><span class="ex">Nested</span> after each hook...</a>
<a class="sourceLine" id="cb163-15" title="15"><span class="ex">After</span> each hook...</a>
<a class="sourceLine" id="cb163-16" title="16"><span class="ex">Before</span> each hook...</a>
<a class="sourceLine" id="cb163-17" title="17"><span class="ex">Nested</span> before each hook...</a>
<a class="sourceLine" id="cb163-18" title="18">      ✓ <span class="ex">Placeholder</span> two</a>
<a class="sourceLine" id="cb163-19" title="19"><span class="ex">Nested</span> after each hook...</a>
<a class="sourceLine" id="cb163-20" title="20"><span class="ex">After</span> each hook...</a>
<a class="sourceLine" id="cb163-21" title="21"><span class="ex">Nested</span> after hook...</a>
<a class="sourceLine" id="cb163-22" title="22"><span class="ex">After</span> hook...</a>
<a class="sourceLine" id="cb163-23" title="23"></a>
<a class="sourceLine" id="cb163-24" title="24"></a>
<a class="sourceLine" id="cb163-25" title="25">  <span class="ex">4</span> passing (7ms)</a></code></pre></div>
<p>Notice that the <code>before</code> and <code>after</code> hooks defined in the top-level <code>describe</code> function run only once while the <code>beforeEach</code> and <code>afterEach</code> hooks run before and after (respectively) for each of the tests defined in the top-level <code>describe</code> function <em>and</em> for each of the tests defined in the nested <code>describe</code> function.</p>
<blockquote>
<p>While the need to define nested hooks won’t come up very often (especially when you’re just starting out with unit testing), it is very helpful to be able to define a <code>beforeEach</code> hook in a top-level <code>describe</code> function that will run before every test in that block <em>and</em> before every test within nested <code>describe</code> or <code>context</code> functions (you’ll do exactly that in just a bit).</p>
</blockquote>
<p>You can also optionally pass a description for a hook or a named function:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb164-1" title="1"><span class="at">beforeEach</span>(<span class="st">&#39;My hook description&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb164-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Before each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb164-3" title="3"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb164-4" title="4"></a>
<a class="sourceLine" id="cb164-5" title="5"><span class="at">beforeEach</span>(<span class="kw">function</span> <span class="at">myHookName</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb164-6" title="6">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Before each hook...&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb164-7" title="7"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>If an error occurs with executing the hook, the hook description or function name will display in the console along with the error information to assist with debugging.</p>
<h3 id="using-the-beforeeach-mocha-hook">Using the <code>beforeEach</code> Mocha Hook</h3>
<p>Let’s go back to our spec and see how we can use hooks to DRY up our code. Here’s where we left off:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb165-1" title="1"><span class="at">describe</span>(<span class="st">&quot;Dog Constructor Function&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb165-2" title="2">  <span class="at">it</span>(<span class="st">&#39;should have a &quot;name&quot; property&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb165-3" title="3">    <span class="kw">const</span> layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb165-4" title="4">    <span class="at">expect</span>(layla).<span class="va">to</span>.<span class="va">have</span>.<span class="at">property</span>(<span class="st">&quot;name&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb165-5" title="5">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb165-6" title="6"></a>
<a class="sourceLine" id="cb165-7" title="7">  <span class="at">it</span>(<span class="st">&#39;should set the &quot;name&quot; property when a new dog is created&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb165-8" title="8">    <span class="kw">const</span> layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb165-9" title="9">    <span class="co">// we are using the eql function to compare the value of layla.name</span></a>
<a class="sourceLine" id="cb165-10" title="10">    <span class="co">// with the provided string</span></a>
<a class="sourceLine" id="cb165-11" title="11">    <span class="at">expect</span>(<span class="va">layla</span>.<span class="at">name</span>).<span class="va">to</span>.<span class="at">eql</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb165-12" title="12">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb165-13" title="13"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Let’s refactor our code to use a <code>beforeEach</code> hook to assign the value of our new dog instance:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb166-1" title="1"><span class="at">describe</span>(<span class="st">&quot;Dog&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb166-2" title="2">  <span class="co">// we&#39;ll declare our variable here to ensure it&#39;s available within the scope</span></a>
<a class="sourceLine" id="cb166-3" title="3">  <span class="co">// of all the specs below</span></a>
<a class="sourceLine" id="cb166-4" title="4">  <span class="kw">let</span> layla<span class="op">;</span></a>
<a class="sourceLine" id="cb166-5" title="5"></a>
<a class="sourceLine" id="cb166-6" title="6">  <span class="co">// now for each test below we&#39;ll create a new instance to ensure each of our</span></a>
<a class="sourceLine" id="cb166-7" title="7">  <span class="co">// dog instances is exactly the same</span></a>
<a class="sourceLine" id="cb166-8" title="8">  <span class="at">beforeEach</span>(<span class="st">&quot;set up a dog instance&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb166-9" title="9">    layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb166-10" title="10">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb166-11" title="11"></a>
<a class="sourceLine" id="cb166-12" title="12">  <span class="at">describe</span>(<span class="st">&quot;Dog Constructor Function&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb166-13" title="13">    <span class="at">it</span>(<span class="st">&#39;should have a &quot;name&quot; property&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb166-14" title="14">      <span class="at">expect</span>(layla).<span class="va">to</span>.<span class="va">have</span>.<span class="at">property</span>(<span class="st">&quot;name&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb166-15" title="15">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb166-16" title="16"></a>
<a class="sourceLine" id="cb166-17" title="17">    <span class="at">it</span>(<span class="st">&#39;should set the &quot;name&quot; property when a new dog is created&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb166-18" title="18">      <span class="at">expect</span>(<span class="va">layla</span>.<span class="at">name</span>).<span class="va">to</span>.<span class="at">eql</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb166-19" title="19">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb166-20" title="20">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb166-21" title="21"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now let’s write a test from the next method on the <code>Dog</code> class: <code>Dog.prototype.bark()</code>. For testing classes we’ll create a new <code>describe</code> function to test each individual method. We’ll now write our unit test inside taking advantage of our <code>beforeEach</code> hook:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb167-1" title="1"><span class="at">describe</span>(<span class="st">&quot;Dog&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb167-2" title="2">  <span class="kw">let</span> layla<span class="op">;</span></a>
<a class="sourceLine" id="cb167-3" title="3"></a>
<a class="sourceLine" id="cb167-4" title="4">  <span class="at">beforeEach</span>(<span class="st">&quot;set up a dog instance&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb167-5" title="5">    layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb167-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb167-7" title="7"></a>
<a class="sourceLine" id="cb167-8" title="8">  <span class="co">// etc, etc.</span></a>
<a class="sourceLine" id="cb167-9" title="9"></a>
<a class="sourceLine" id="cb167-10" title="10">  <span class="at">describe</span>(<span class="st">&quot;prototype.bark()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb167-11" title="11">    <span class="at">it</span>(<span class="st">&quot;should return a string with the name of the dog barking&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb167-12" title="12">      <span class="at">expect</span>(<span class="va">layla</span>.<span class="at">bark</span>()).<span class="va">to</span>.<span class="at">eql</span>(<span class="st">&quot;Layla is barking&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb167-13" title="13">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb167-14" title="14">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb167-15" title="15"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Not only are we avoiding repeating our setup code within each test but we’ve improved the readability of our code by making it more self-descriptive. The code that runs before each test is literally contained with a hook named <code>beforeEach</code>!</p>
<p>The <code>after</code> and <code>afterEach</code> hooks are generally used less often than the <code>before</code> and <code>beforeEach</code> hooks. Most of the time, it’s preferable to avoid using the <code>after</code> and <code>afterEach</code> hooks to perform clean up tasks after your tests. Instead, simply use the <code>before</code> and <code>beforeEach</code> hooks to create a clean starting point for each of your tests. Doing this will ensure that your tests run in a consistent, predictable manner.</p>
<h3 id="using-chai-spies">Using Chai Spies</h3>
<p>Sweet - let’s now look to the next method on the <code>Dog.prototype</code> - <code>Dog.prototype.chainChaseTail</code>. This instance method intakes a number (num) and will then invoke the <code>Dog.prototype.chaseTail</code> function <code>num</code> number of times. The <code>chaseTail</code> function will just <code>console.log</code> a string - meaning that we have no function output to test. The <code>Dog.prototype.chainChaseTail</code> function will additionally throw a <code>TypeError</code> if the incoming argument is not a number.</p>
<p>We’ll start by setting up our outer <code>describe</code> block for the <code>prototype.chainChaseTail</code> method. Next we’ll add two <code>context</code> functions for our two contexts - valid <strong>or</strong> invalid parameters:</p>
<blockquote>
<p><code>context</code> is just an alias for <code>describe</code> it’s just another way to make your tests more understandable and readable, in this case we are testing our method with different parameters, and thus in different contexts. (not to be confused with "context" in the javascript sense of the value of <code>this</code>)</p>
</blockquote>
<div class="sourceCode" id="cb168"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb168-1" title="1"><span class="at">describe</span>(<span class="st">&quot;prototype.chainChaseTail()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb168-2" title="2">  <span class="at">context</span>(<span class="st">&quot;with an invalid parameter&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb168-3" title="3">  <span class="at">context</span>(<span class="st">&quot;with a valid number parameter&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb168-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>We’ll start by writing our test for when the method is invoked with invalid parameters. To do this we’ll use Chai’s <a href="https://www.chaijs.com/api/bdd/#method_throw"><code>throw</code></a> method ensuring to wrap our error throwing function in another function:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb169-1" title="1"><span class="at">context</span>(<span class="st">&quot;with an invalid parameter&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb169-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should throw a TypeError when given an argument that is not a number&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb169-3" title="3">    <span class="at">expect</span>(() <span class="kw">=&gt;</span> <span class="va">layla</span>.<span class="at">chainChaseTail</span>(<span class="st">&quot;3&quot;</span>)).<span class="va">to</span>.<span class="at">throw</span>(TypeError)<span class="op">;</span></a>
<a class="sourceLine" id="cb169-4" title="4">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb169-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<blockquote>
<p>Note here we are passing the literal string <code>"3"</code> not the number 3.</p>
</blockquote>
<p>Nice, now we can concentrate on our other context with a valid parameter - and how to go about testing this function. In order to test <code>chainChaseTail</code> properly we’ll need to see <em>how many times</em> the <code>chaseTail</code> method is invoked. Which means we’ll need to import another library that will add extra functionality to <code>Chai</code>. We’ll import the <a href="https://www.chaijs.com/plugins/chai-spies/"><code>Chai Spies</code></a> library using <code>npm install chai-spies</code> in our top level directory.</p>
<p>Now we’ll insert a few lines of code to the top of file to set up our shiny new Chai Spies:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb170-1" title="1"><span class="co">// top of dog-spec.js</span></a>
<a class="sourceLine" id="cb170-2" title="2"><span class="kw">const</span> chai <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;chai&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb170-3" title="3"><span class="kw">const</span> expect <span class="op">=</span> <span class="va">chai</span>.<span class="at">expect</span><span class="op">;</span></a>
<a class="sourceLine" id="cb170-4" title="4"><span class="kw">const</span> spies <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;chai-spies&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb170-5" title="5"><span class="va">chai</span>.<span class="at">use</span>(spies)<span class="op">;</span></a></code></pre></div>
<p>We now have access to the <code>chai-spies</code> module in our tests. The <code>Chai Spies</code> library provides a lot of added functionality including the ability to determine if a function has been called and how many times that function has been called.</p>
<p>So let’s get started spying! We’ll setup our <code>it</code> function with an appropriate string:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb171-1" title="1"><span class="at">context</span>(<span class="st">&quot;with a valid number parameter&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb171-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should call the chaseTail method n times&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb171-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now in order to spy on a function we first need to tell Chai which function we’d like to spy on using the <code>chai.spy.on</code> method. In this case we’d like to spy on the instance of a Dog that will be invoking the <code>chainChaseTail</code> method to determine how many times the <code>chaseTail</code> method is then invoked.</p>
<p>So we will set up our spy on the dog instance in question, as well as tell our chai spy which method to keep track of:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb172-1" title="1"><span class="at">context</span>(<span class="st">&quot;with a valid number parameter&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb172-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should call the chaseTail method n times&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb172-3" title="3">    <span class="co">// the first argument will be the instance we are spying on</span></a>
<a class="sourceLine" id="cb172-4" title="4">    <span class="co">// the second argument will be the method we want to keep track of</span></a>
<a class="sourceLine" id="cb172-5" title="5">    <span class="kw">const</span> chaseTailSpy <span class="op">=</span> <span class="va">chai</span>.<span class="va">spy</span>.<span class="at">on</span>(layla<span class="op">,</span> <span class="st">&quot;chaseTail&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb172-6" title="6">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb172-7" title="7"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now that our spy is set up we now need make sure our dog instance will actually call the <code>chainChaseTail</code> function! Otherwise our spy won’t have anything to spy on:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb173-1" title="1"><span class="at">context</span>(<span class="st">&quot;with a valid number parameter&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb173-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should call the chaseTail method n times&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb173-3" title="3">    <span class="kw">const</span> chaseTailSpy <span class="op">=</span> <span class="va">chai</span>.<span class="va">spy</span>.<span class="at">on</span>(layla<span class="op">,</span> <span class="st">&quot;chaseTail&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb173-4" title="4">    <span class="co">// we need to invoke chainChaseTail because that is the method that</span></a>
<a class="sourceLine" id="cb173-5" title="5">    <span class="co">// will invoke chaseTail which is the method we are spying on</span></a>
<a class="sourceLine" id="cb173-6" title="6">    <span class="va">layla</span>.<span class="at">chainChaseTail</span>(<span class="dv">3</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb173-7" title="7">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb173-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Finally, we need to add our actual test - otherwise this is all for naught! Chai has some really nice chaining methods when it comes to checking how many times a function has been invoked. Here we’ll use the method chain of <code>expect(func).to.have.been.called.exactly(n)</code> to test that the method we are spying on - <code>chaseTail</code> was invoked a certain number of times:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb174-1" title="1"><span class="at">context</span>(<span class="st">&quot;with a valid number parameter&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb174-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should call the chaseTail method n times&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb174-3" title="3">    <span class="kw">const</span> chaseTailSpy <span class="op">=</span> <span class="va">chai</span>.<span class="va">spy</span>.<span class="at">on</span>(layla<span class="op">,</span> <span class="st">&quot;chaseTail&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb174-4" title="4">    <span class="va">layla</span>.<span class="at">chainChaseTail</span>(<span class="dv">3</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb174-5" title="5">    <span class="co">// below is our actual test to see how many times our spy was invoked</span></a>
<a class="sourceLine" id="cb174-6" title="6">    <span class="at">expect</span>(chaseTailSpy).<span class="va">to</span>.<span class="va">have</span>.<span class="va">been</span>.<span class="va">called</span>.<span class="at">exactly</span>(<span class="dv">3</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb174-7" title="7">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb174-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="testing-static-methods-on-classes">Testing static methods on classes</h3>
<p>Sweet! We are almost done testing this class - just one more method to go. We’ll now work on testing the class method <code>Dog.cleanDogs</code>. To denote that this is a class method, not an instance method, our <code>describe</code> string will not use the word <code>prototype</code>:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb175-1" title="1"><span class="at">describe</span>(<span class="st">&quot;cleanDogs()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb175-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should return an array of each cleaned dog string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now the <code>Dog.cleanDogs</code> class method will intake an array of dogs and output an array where each element is a string noting that the passed in dog instance’s paws are now clean. In order to properly test this function we’ll probably want an array of more than one dog instance. Let’s create a new dog and pass an array of two dog instances to the <code>Dog.cleanDogs</code> method:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb176-1" title="1"><span class="at">describe</span>(<span class="st">&quot;cleanDogs()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb176-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should return an array of each cleaned dog string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb176-3" title="3">    <span class="kw">const</span> zoey <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Zoey&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb176-4" title="4">    <span class="kw">let</span> cleanDogsArray <span class="op">=</span> <span class="va">Dog</span>.<span class="at">cleanDogs</span>([layla<span class="op">,</span> zoey])<span class="op">;</span></a>
<a class="sourceLine" id="cb176-5" title="5">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb176-6" title="6"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Then we’ll create a variable for our expected output and compare the output we received from <code>Dog.cleanDogs</code>:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb177-1" title="1"><span class="at">describe</span>(<span class="st">&quot;cleanDogs()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb177-2" title="2">  <span class="at">it</span>(<span class="st">&quot;should return an array of each cleaned dog string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb177-3" title="3">    <span class="kw">const</span> zoey <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Zoey&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb177-4" title="4">    <span class="kw">let</span> cleanDogsArray <span class="op">=</span> <span class="va">Dog</span>.<span class="at">cleanDogs</span>([layla<span class="op">,</span> zoey])<span class="op">;</span></a>
<a class="sourceLine" id="cb177-5" title="5">    <span class="kw">let</span> result <span class="op">=</span> [<span class="st">&quot;I cleaned Layla&#39;s paws.&quot;</span><span class="op">,</span> <span class="st">&quot;I cleaned Zoey&#39;s paws.&quot;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb177-6" title="6">    <span class="at">expect</span>(cleanDogsArray).<span class="va">to</span>.<span class="at">eql</span>(result)<span class="op">;</span></a>
<a class="sourceLine" id="cb177-7" title="7">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb177-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Awesome! We have fully testing the <code>Dog</code> class’s methods and learned a lot about testing along the way.</p>
<p>Here is our full testing file so you can ensure you got everything:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb178-1" title="1"><span class="kw">const</span> chai <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;chai&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-2" title="2"><span class="kw">const</span> expect <span class="op">=</span> <span class="va">chai</span>.<span class="at">expect</span><span class="op">;</span></a>
<a class="sourceLine" id="cb178-3" title="3"><span class="kw">const</span> spies <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;chai-spies&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-4" title="4"><span class="va">chai</span>.<span class="at">use</span>(spies)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-5" title="5"></a>
<a class="sourceLine" id="cb178-6" title="6"><span class="co">// this is a relative path to the function location</span></a>
<a class="sourceLine" id="cb178-7" title="7"><span class="kw">const</span> Dog <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;../problems/dog.js&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-8" title="8"></a>
<a class="sourceLine" id="cb178-9" title="9"><span class="at">describe</span>(<span class="st">&quot;Dog&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-10" title="10">  <span class="kw">let</span> layla<span class="op">;</span></a>
<a class="sourceLine" id="cb178-11" title="11"></a>
<a class="sourceLine" id="cb178-12" title="12">  <span class="at">beforeEach</span>(<span class="st">&quot;set up a dog instance&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-13" title="13">    layla <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-14" title="14">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-15" title="15"></a>
<a class="sourceLine" id="cb178-16" title="16">  <span class="at">describe</span>(<span class="st">&quot;Dog Constructor Function&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-17" title="17">    <span class="at">it</span>(<span class="st">&#39;should have a &quot;name&quot; property&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb178-18" title="18">      <span class="at">expect</span>(layla).<span class="va">to</span>.<span class="va">have</span>.<span class="at">property</span>(<span class="st">&quot;name&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-19" title="19">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-20" title="20"></a>
<a class="sourceLine" id="cb178-21" title="21">    <span class="at">it</span>(<span class="st">&#39;should set the &quot;name&quot; property when a new dog is created&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb178-22" title="22">      <span class="at">expect</span>(<span class="va">layla</span>.<span class="at">name</span>).<span class="va">to</span>.<span class="at">eql</span>(<span class="st">&quot;Layla&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-23" title="23">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-24" title="24">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-25" title="25"></a>
<a class="sourceLine" id="cb178-26" title="26">  <span class="at">describe</span>(<span class="st">&quot;prototype.bark()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-27" title="27">    <span class="at">it</span>(<span class="st">&quot;should return a string with the name of the dog barking&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb178-28" title="28">      <span class="at">expect</span>(<span class="va">layla</span>.<span class="at">bark</span>()).<span class="va">to</span>.<span class="at">eql</span>(<span class="st">&quot;Layla is barking&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-29" title="29">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-30" title="30">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-31" title="31"></a>
<a class="sourceLine" id="cb178-32" title="32">  <span class="at">describe</span>(<span class="st">&quot;prototype.chainChaseTail()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-33" title="33">    <span class="at">context</span>(<span class="st">&quot;with a valid number parameter&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-34" title="34">      <span class="at">it</span>(<span class="st">&quot;should call the chaseTail method n times&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-35" title="35">        <span class="kw">const</span> chaseTailSpy <span class="op">=</span> <span class="va">chai</span>.<span class="va">spy</span>.<span class="at">on</span>(layla<span class="op">,</span> <span class="st">&quot;chaseTail&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-36" title="36">        <span class="va">layla</span>.<span class="at">chainChaseTail</span>(<span class="dv">3</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-37" title="37"></a>
<a class="sourceLine" id="cb178-38" title="38">        <span class="at">expect</span>(chaseTailSpy).<span class="va">to</span>.<span class="va">have</span>.<span class="va">been</span>.<span class="va">called</span>.<span class="at">exactly</span>(<span class="dv">3</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-39" title="39">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-40" title="40">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-41" title="41"></a>
<a class="sourceLine" id="cb178-42" title="42">    <span class="at">context</span>(<span class="st">&quot;with an invalid parameter&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-43" title="43">      <span class="at">it</span>(<span class="st">&quot;should throw a TypeError when given an argument that is not a number&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-44" title="44">        <span class="at">expect</span>(() <span class="kw">=&gt;</span> <span class="va">layla</span>.<span class="at">chainChaseTail</span>(<span class="st">&quot;3&quot;</span>)).<span class="va">to</span>.<span class="at">throw</span>(TypeError)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-45" title="45">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-46" title="46">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-47" title="47">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-48" title="48"></a>
<a class="sourceLine" id="cb178-49" title="49">  <span class="at">describe</span>(<span class="st">&quot;cleanDogs()&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-50" title="50">    <span class="at">it</span>(<span class="st">&quot;should return an array of each cleaned dog string&quot;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb178-51" title="51">      <span class="kw">const</span> zoey <span class="op">=</span> <span class="kw">new</span> <span class="at">Dog</span>(<span class="st">&quot;Zoey&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-52" title="52">      <span class="kw">let</span> cleanDogsArray <span class="op">=</span> <span class="va">Dog</span>.<span class="at">cleanDogs</span>([layla<span class="op">,</span> zoey])<span class="op">;</span></a>
<a class="sourceLine" id="cb178-53" title="53">      <span class="kw">let</span> result <span class="op">=</span> [<span class="st">&quot;I cleaned Layla&#39;s paws.&quot;</span><span class="op">,</span> <span class="st">&quot;I cleaned Zoey&#39;s paws.&quot;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb178-54" title="54">      <span class="at">expect</span>(cleanDogsArray).<span class="va">to</span>.<span class="at">eql</span>(result)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-55" title="55">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-56" title="56">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb178-57" title="57"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="what-you-learned-4">What you learned</h2>
<p>In the upcoming project we’ll be covering a lot more Chai syntax - but don’t worry about memorizing this syntax! The point we are trying to make is that in the future you’ll be using a variety of software testing frameworks and assertion libraries - the most important things are to know the basics of how to structure tests as well as being able to read and parse documentation to write tests.</p>
<p>In this series of readings we covered the basics of how to:</p>
<ul>
<li>properly format and denote your mocha tests using <code>describe</code>, <code>context</code> and <code>it</code> blocks</li>
<li>write tests for individual functions as well as writing tests for classes</li>
<li>use <code>chai-spies</code> to test how many times a function has been called</li>
<li>test that functions will throw certain errors</li>
<li>recognize and utilize the Mocha hooks: <code>before</code>, <code>beforeEach</code>, <code>after</code>, and <code>afterEach</code></li>
</ul>
<hr />
<h1 id="towers-of-hanoi-project-reading-and-passing-tests">Towers of Hanoi Project: Reading and Passing Tests</h1>
<p>Time to put your newfound mocha knowledge to the test! In this project you’ll be following what is now a familiar pattern - running automated tests and writing code to pass those tests. The difference this time round is that we will only provide very minimal written information for the code you’ll be writing. This project will revolve around reading the provided tests and then writing code to pass those tests.</p>
<p>We’ve provided you with a skeleton for a JavaScript version of the famous <a href="https://en.wikipedia.org/wiki/Tower_of_Hanoi">Towers of Hanoi</a> game. If you’ve never played the game take a moment to watch a quick video of how it is played or check out <a href="https://www.mathplayground.com/logic_tower_of_hanoi.html">this</a> playable version (beware the game has sound). For the version we are building, a game of Towers of Hanoi will be played using three towers and using three pieces which we’ll refer to as <code>disks</code> from now on.</p>
<p>Once you’ve downloaded the skeleton make sure you <code>npm install</code> to install the dependencies the tests will rely on. We’ll be using <a href="https://www.chaijs.com/api/bdd/"><code>Chai</code></a> in combination with <a href="https://www.chaijs.com/plugins/chai-spies/"><code>chai-spies</code></a> as our assertion libraries for this project so we recommend keeping both documentation pages open. The tests you’ll be working on will be in the <code>test/game-spec.js</code> file and you’ll be doing all your work within the <code>hanoi/hanoi-game.js</code> file. You will not need to specify any new methods upon the <code>HanoiGame</code> class - just fill in empty methods provided.</p>
<p>Carefully read each spec and concentrate on passing them one at a time in the order they are written. As always, to run the specs use the <code>mocha</code> command in the top level directory.</p>
<p>You got this! Once you’ve passed all the specs feel free to play a game of Hanoi in your terminal by running <code>node hanoi/play-script.js</code> before moving on to the next project.</p>
<p>To get the skeleton just <code>git clone</code> the repository at <a href="https://github.com/-starters/project-hanoi-game-skeleton">https://github.com/-starters/project-hanoi-game-skeleton</a></p>
<hr />
<h1 id="test-driven-development-project">Test-Driven Development Project</h1>
<p>So now it is finally time to flex your fingers and start writing some tests! For this next project we’ll be using test-driven development (TDD). A TDD approach dictates that we’ll follow the TDD workflow, meaning that you’ll need to follow the TDD workflow of <strong>Red</strong>, <strong>Green</strong>, <strong>Refactor</strong>.</p>
<figure>
<img src="https://-open-assets.s3-us-west-1.amazonaws.com/Module-JavaScript/testing/assets/rgr.png" alt="tdd-cycle" /><figcaption>tdd-cycle</figcaption>
</figure>
<p>So the three steps for approaching all of the below problems will be to:</p>
<ol type="1">
<li><strong>Red</strong>: Write the tests and watch them fail (a failing test is red).</li>
<li><strong>Green</strong>: Write the minimum amount of code to ensure the test passes.</li>
<li><strong>Refactor</strong>: Refactor the code you just wrote to make it readable and maintainable.</li>
</ol>
<p>You can assume for the rest of the project that you will be using Mocha as your testing framework, and you can use either Node’s built in <code>assert</code> module or the Chai library unless otherwise specified.</p>
<p>Before beginning to write tests we’ll start by installing the dependencies we’ll need for <code>chai</code> and <code>chai-spies</code>. Start by creating a directory for this project on your computer named <code>tdd-project</code>. Navigate into the directory in your terminal, then run <code>npm init --y</code> to create a <code>package.json</code>. Once that has been created you can install <code>chai</code> and <code>chai-spies</code> by running <code>npm install chai chai-spies</code>. Once the dependencies have been installed you are ready to start writing tests!</p>
<h2 id="phase-0-testing-the-reversestring-function">Phase 0: Testing the <code>reverseString</code> function</h2>
<p>We’ll begin by writing tests for a function named <code>reverseString</code>. Create two directories in your <code>tdd-project</code> directory - one named <code>problems</code> and one named <code>test</code>. In the <code>problems</code> directory create a new file named <code>reverse-string.js</code>, then within the <code>test</code> folder create a corresponding <code>reverse-string-spec.js</code> file.</p>
<p>This would be a good time to open up the documentation for <a href="https://mochajs.org/#bdd">Mocha</a>, <a href="https://nodejs.org/api/assert.html">Assert</a>, <a href="https://www.chaijs.com/api/bdd/">Chai</a>, and <a href="https://www.chaijs.com/plugins/chai-spies/">Chai Spies</a>. The tests you are writing today will be good practice for the <em>rest of your programming career</em> so take your time and ensure you are writing the best tests you can!</p>
<p>For this first phase feel free to use either <code>assert</code> or <code>chai</code> as your assertion library. Whichever you choose make sure you require it into <code>reverse-string-spec.js</code>.</p>
<blockquote>
<p>Hint: You can look back at the Tower of Hanoi project if you can’t remember the proper require lines for this.</p>
</blockquote>
<p>Also make sure you require your <code>reverseString</code> function so you will have it available to test.</p>
<blockquote>
<p>Hint: Since the file lives in the <code>problems</code> folder you might need to use our old friend <code>..</code> in the path.</p>
</blockquote>
<p>Now it’s your time to shine - write a test that will ensure that when given the input <code>"fun"</code> the <code>reverseString</code> function will return the reversed output (<code>nuf</code>). Now run your spec and watch it fail. If you did this correctly you should have mocha telling you <code>TypeError: reverseString is not a function</code>.</p>
<p>Remember! This is expected because we are doing test-driven development and we have written the test before we have written the <code>reverseString</code> function.</p>
<p>Now that the <em>red</em> step is complete, time to move onto the <em>green</em> step. Write the minimum amount of code to pass the spec you just wrote - make sure you remember to properly import and export your function!</p>
<blockquote>
<p>Reminder: You can run all the tests in the <code>test</code> directory by running the <code>mocha</code> command in the top level directory that the <code>test</code> directory is located within. You can also run a single test file with Mocha by specifying the file path like so: <code>mocha test/reverse-string-spec.js</code>.</p>
</blockquote>
<p>Once you’ve passed the spec you wrote it’s time to <em>refactor</em>. Take a look at your <code>reverseString</code> function and see how it could be improved to be more readable. For example: could it be more DRY?</p>
<p>Okay, let’s add another spec to this function to test how it handles errors. Use <code>chai</code> or <code>assert</code>’s <code>throws</code> function to ensure that when the <code>reverseString</code> function is invoked with an argument that is not a string it will throw a <code>TypeError</code>.</p>
<p>Nice! As you are writing these tests make sure you are following the TDD workflow and writing <em>readable</em> tests. Each of your <code>describe</code>, <code>context</code>, and <code>it</code> functions should always be passed a string that clearly indicates what is being testing.</p>
<h2 id="phase-1-testing-multiple-functions">Phase 1: Testing multiple functions</h2>
<p>Create a new file within the <code>problems</code> directory named <code>number-fun.js</code>. Make sure your create the corresponding testing file within the <code>test</code> directory. We’ll be using Node’s <code>Assert</code> for this one so be sure you import it at the top of your testing file. You’ll be testing two functions in this file so you’ll want to make sure you set up two outer <code>describe</code> blocks - one for each function.</p>
<p>We’ll start off easy by writing a spec for a function called <code>returnsThree</code>. Test that this function returns the number <code>3</code>. Now write the code to pass that spec.</p>
<p>Cool, let’s step it up a notch - in the second <code>describe</code> function you’ll be writing the tests for a function called <code>reciprocal(num)</code>. This function should intake a number and then return the <a href="https://www.mathopenref.com/reciprocal.html">reciprocal</a> of that number. Start by writing a spec to ensure that your <code>reciprocal</code> function will return the reciprocal of the given argument. For this test include more than one assertion line (<code>assert.strictEqual(value, value)</code>) within your <code>it</code> callback function to make sure your function will behave as expected with multiple inputs.</p>
<p>Now write the code to pass those tests, then refactor that code. Once you’ve finished we’ll be adding some different <strong>contexts</strong> for your <code>reciprocal</code> function. Your <code>reciprocal</code> function will now only intake arguments between 1 and 1000000. If the given argument is less than 1 or greater than 1,000,000 then a <code>TypeError</code> will be thrown with a descriptive string message.</p>
<p>In order to properly test the <code>reciprocal</code> function you’ll need to create two <code>context</code> blocks within the <code>reciprocal</code> <code>describe</code> function callback - one for invalid arguments and one for valid arguments. Move the the spec you wrote previously into the <code>context</code> callback for valid arguments. You’ll want to write at least two new specs within your invalid argument <code>context</code> block to ensure your <code>reciprocal</code> is being fully tested.</p>
<p>Once you’ve passed all your written specs and refactored move on!</p>
<h2 id="phase-2-testing-the-mymap-function">Phase 2: Testing the myMap Function</h2>
<p>Next let’s write a spec for a function you’ve all undoubtedly grown to love, good old <code>myMap</code>. Create a new file in your <code>problems</code> directory, with a corresponding file in your <code>test</code> directory for testing this function. This version of <code>myMap(array, callback)</code> will intake an array and a callback, and then return a new array where the callback has been called upon each element in the original array. The <code>myMap</code> should not mutate the original argument array.</p>
<p>We’ll be using <code>chai</code> and <code>chai-spies</code> for this series of tests.</p>
<p>Here is a quick example of how we expect this to work:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb179-1" title="1"><span class="kw">const</span> arr <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb179-2" title="2"><span class="kw">const</span> callback <span class="op">=</span> el <span class="kw">=&gt;</span> el <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb179-3" title="3"></a>
<a class="sourceLine" id="cb179-4" title="4"><span class="va">console</span>.<span class="at">log</span>(<span class="at">myMap</span>(arr<span class="op">,</span> callback))<span class="op">;</span> <span class="co">// prints [2,4,6]</span></a>
<a class="sourceLine" id="cb179-5" title="5"><span class="va">console</span>.<span class="at">log</span>(arr)<span class="op">;</span> <span class="co">// prints [1,2,3]</span></a></code></pre></div>
<p>Start off by writing your tests. You want to ensure that your <code>myMap</code> works like the built-in <code>Array#Map</code> method. Once you’ve written the test, write the code that will pass the test, then refactor.</p>
<p>Nice! Now let’s really thoroughly test the <code>myMap</code> function. However, before we do that we’ll want to make sure that any specs we write after this first spec will be working with a fresh array to ensure each unit test is done in <em>isolation</em>. The DRYest way to do this is by setting up a Mocha hook! Use the <code>beforeEach</code> Mocha hook to reassign a new instance of an <code>Array</code> each time a spec is run.</p>
<p>Now that our hook is in place we’ll write two tests:</p>
<ol type="1">
<li>Ensure that <code>myMap</code> does not mutate the passed-in array argument</li>
<li>Ensure that <code>myMap</code> does not call the built-in <code>Array#map</code></li>
<li>Ensure that the passed-in callback is invoked once for each element in the passed-in array argument.</li>
</ol>
<p>Write the first of these specs now before moving on below.</p>
<p>For the described specs for 2-3 in the above list you will be required to use <code>chai-spies</code> so make sure you have the documentation up! Approach these specs one at a time - we recommend using the <code>chai.spy.on</code> function for both of the above specs.</p>
<blockquote>
<p>Hint: In order to use <code>chai.spy.on</code> you’ll want to think carefully about <strong>what object</strong> you are spying on the methods for. For spec 3 described above you’ll need to make sure you have an object to spy on so don’t be afraid to make an object just for testing purposes.</p>
<p>Also in order to spy on a plain function instead of a property of an object you use <code>chai.spy</code> instead of <code>chai.spy.on</code> and then use the resulting spied function directly.</p>
</blockquote>
<p>Once you’ve finished the above specs and written the code to pass them make sure you refactor your code before moving on!</p>
<h2 id="phase-3-testing-classes">Phase 3: Testing Classes</h2>
<p>For this next phase you will be utilizing Chai to test a <code>Person</code> class. Create the necessary files within your <code>test</code> and <code>problems</code> directories. Work one spec at a time through the list below using Red, Green, Refactor as you go and don’t forget to use Mocha Hooks to make your specs super DRY!</p>
<p>Write specs for each of the described <code>Person</code> class methods below:</p>
<ul>
<li>The <code>Person</code> Constructor - will intake a name and age and set them as properties on the instance. Make sure you test that these properties exist on an instance, as well as ensuring they are set properly.</li>
<li><code>prototype.sayHello</code> - will return a string of the person instance’s name and a greeting message</li>
<li><code>prototype.visit(otherPerson)</code> - will return a string stating that this instance visited the passed-in person instance (i.e. <code>person1.visit(person2)</code> returns <code>Mai visited Erin</code>).</li>
<li><code>prototype.switchVisit(otherPerson)</code> - will invoke the <code>visit</code> function of the parameter (<code>otherPerson</code>), passing in the current instance as the argument.</li>
<li><code>prototype.update(obj)</code> - this method will have two contexts if the incoming argument <em>is</em> or <em>is not</em> a valid object.
<ul>
<li>A: If the incoming argument is not an object throw a new TypeError with a clear message</li>
<li>B: If the incoming argument is an object then the instance’s properties should be updated to match the passed-in object’s values as shown below.</li>
<li>C: If the incoming object does not have a name and an age property, throw a TypeError with an appropriate message</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb180"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb180-1" title="1"><span class="kw">let</span> coolPerson <span class="op">=</span> <span class="kw">new</span> <span class="at">Person</span>(<span class="st">&quot;mai&quot;</span><span class="op">,</span> <span class="dv">32</span>)<span class="op">;</span> <span class="co">// Person { name: &#39;mai&#39;, age: 32 }</span></a>
<a class="sourceLine" id="cb180-2" title="2"><span class="va">coolPerson</span>.<span class="at">update</span>(<span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;lulu&quot;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">57</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb180-3" title="3"><span class="va">console</span>.<span class="at">log</span>(coolPerson)<span class="op">;</span> <span class="co">// Person { name: &#39;lulu&#39;, age: 57 }</span></a></code></pre></div>
<ul>
<li><p><code>prototype.tryUpdate(obj)</code> - this method will call the <code>prototype.update</code> method with the incoming argument, and it will have two contexts if the invocation of <code>prototype.update</code> was or was not successful:</p>
<ul>
<li>A: If <code>prototype.update</code> is successfully invoked (it does not throw an error) then a <code>true</code> is returned indicating the update was successful (make sure that the instance was updated as well)</li>
<li>B: If <code>prototype.update</code> is not successfully invoked it should <strong>not</strong> throw an error, instead it should return <code>false</code>.</li>
</ul></li>
<li><p><code>greetAll(obj)</code> - this static method will intake an array of <code>Person</code> instances. The <code>greetAll</code> method will then call the <code>sayHello</code> method on each <code>Person</code> instance and store each returned string in an array, before finally returning an array of the stored strings.</p></li>
</ul>
<p>Once you’ve finished and you’ve refactored all your code feel free to run <code>mocha</code> and look at all those passed specs! Give yourself a pat on the back for starting your journey into TDD development.</p>
<hr />
<h1 id="week-06-day-5-unit-testing---day-2" data-ignore="true">WEEK-06 DAY-5<br><em>Unit Testing - Day 2</em></h1>
<hr />
<h1 id="well-tested-full-stack-to-do-items">Well-Tested Full-Stack To-Do Items</h1>
<p>In this project, you will test a full-stack JavaScript and HTML application! You will write tests to make sure the code that was written for the project will meet the expectations of the requirements. Your tests will not have to be exhaustive. Instead, there are guidelines for your tests in each test file. Use those guidelines to implement the Web application.</p>
<p>The upcoming video provides you a full walk-through of the system as it is created. Then, once you understand how the application works from watching it be built, you will need to apply your knowledge of writing tests.</p>
<p>It may be hard. However, stick with it. You’ll do great. Just take your time, write good tests, and you will be amazed at how much confidence that you will gain in writing code that comes together.</p>
<p>One of the ways that you can make this project more enjoyable is to vary the way that you pair on it. For each step,</p>
<ul>
<li>Discuss what the next feature is that you want to write</li>
<li>One person writes a unit test to test the code</li>
<li>Both examine the code and determine if there is any duplication to refactor into common functions or classes</li>
<li>Loop, but swap who writes the unit test and who writes the code</li>
</ul>
<p>At the end, you will leverage your test by swapping out the mechanism used to generate the HTML. This is the other part of writing good tests: tests give you the confidence to change code. If you do something that is "wrong" in that it breaks current expectations, the tests will tell you!</p>
<p>Tests are such an important part of a developers life. While some developers will complain about having to write them, when you start working on an existing "legacy" code base, making changes can cause a lot of stress unless you have the work of other developers’ tests to make sure you don’t unintentionally change a method in such a way to break code that you’re not working on.</p>
<p>To get started,</p>
<ul>
<li>clone the project from https://github.com/-starters/testing-an-existing-app-project</li>
<li>change directory into the project</li>
<li>run <code>npm install</code> to install the modules</li>
</ul>
<p>If you want to run the server, type <code>node server.js</code> and go to http://localhost:3000/items to see what it does. You can add categories, add items, search for items, and complete items.</p>
<p>The code that you will test are the functions used to create the functionality of the data and the creation of the views, not the actual HTTP server. The video after shows a person writing the entire application. You will see what each piece does. Then, you will understand the <em>intent</em> of the code that you have to test.</p>
<hr />
<h1 id="create-and-serve-the-category-screen">Create And Serve the Category Screen</h1>
<p>You’ll now write the tests for the part of the application that shows the list of categories. That code, in <strong>server.js</strong> looks like this.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb181-1" title="1"><span class="kw">const</span> filePath <span class="op">=</span> <span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">&#39;category-list-screen.html&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb181-2" title="2"><span class="kw">const</span> template <span class="op">=</span> <span class="cf">await</span> <span class="va">fs</span>.<span class="va">promises</span>.<span class="at">readFile</span>(filePath<span class="op">,</span> <span class="st">&#39;utf-8&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb181-3" title="3"><span class="kw">const</span> html <span class="op">=</span> <span class="at">mergeCategories</span>(template<span class="op">,</span> categories<span class="op">,</span> <span class="st">&#39;li&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb181-4" title="4"><span class="va">res</span>.<span class="at">setHeader</span>(<span class="st">&#39;Content-Type&#39;</span><span class="op">,</span> <span class="st">&#39;text/html&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb181-5" title="5"><span class="va">res</span>.<span class="at">writeHead</span>(<span class="dv">200</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb181-6" title="6"><span class="va">res</span>.<span class="at">write</span>(html)<span class="op">;</span></a></code></pre></div>
<p>You need to write tests for the function <code>mergeCategories()</code> for the portion that outputs the HTML for list items. Open the file <strong>test/merge-categories-spec.js</strong>. You will see</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb182-1" title="1"><span class="at">describe</span>(<span class="st">&quot;mergeCategories()&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb182-2" title="2">  <span class="at">context</span>(<span class="st">&quot;Using &lt;li&gt; tags&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb182-3" title="3">    <span class="kw">const</span> template <span class="op">=</span> <span class="vs">`</span></a>
<a class="sourceLine" id="cb182-4" title="4"><span class="vs">      &lt;div&gt;</span></a>
<a class="sourceLine" id="cb182-5" title="5"><span class="vs">        &lt;ul&gt;</span></a>
<a class="sourceLine" id="cb182-6" title="6"><span class="vs">          &lt;!-- Content here --&gt;</span></a>
<a class="sourceLine" id="cb182-7" title="7"><span class="vs">        &lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb182-8" title="8"><span class="vs">      &lt;/div&gt;</span></a>
<a class="sourceLine" id="cb182-9" title="9"><span class="vs">    `</span><span class="op">;</span></a>
<a class="sourceLine" id="cb182-10" title="10"></a>
<a class="sourceLine" id="cb182-11" title="11">    <span class="at">it</span>(<span class="st">&quot;should return no &lt;li&gt;s for no categories&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb182-12" title="12">      <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb182-13" title="13">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb182-14" title="14"></a>
<a class="sourceLine" id="cb182-15" title="15">    <span class="at">it</span>(<span class="st">&quot;should return a single &lt;li&gt; for one category&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb182-16" title="16">      <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb182-17" title="17">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb182-18" title="18"></a>
<a class="sourceLine" id="cb182-19" title="19">    <span class="at">it</span>(<span class="st">&quot;should return an &lt;li&gt; for each category&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb182-20" title="20">      <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb182-21" title="21">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb182-22" title="22">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb182-23" title="23"></a>
<a class="sourceLine" id="cb182-24" title="24">  <span class="co">// more code ...</span></a></code></pre></div>
<p>The <code>context</code> block is for writing tests for when we use <code>mergeCategories()</code> and pass it <code>&lt;li&gt;</code> tags.</p>
<p>You will need to write tests in all the <code>it</code> blocks. Just replace the <code>expect.fail</code> calls with your own tests. (<code>expect.fail</code> is a chai assertion to force a spec to fail so we are using it for all the unwritten tests so that when you run <code>npm test</code> you will see all the tests you haven’t written failing)</p>
<p>Open <strong>merge-categories.js</strong> to review the code before writing the tests.</p>
<p>The <code>mergeCategories</code> function takes a string through its <code>template</code> parameter, a list of strings through its <code>categories</code> parameter and an HTML tag through it’s <code>tagName</code> parameter.</p>
<p>It then replaces the HTML comment <code>&lt;!-- Content here ..&gt;</code> with the newly created <code>&lt;li&gt;</code> tags (one for each catagory) and returns a new string of HTML.</p>
<p>Use the <code>template</code> variable that is available to you for these tests.</p>
<h2 id="the-first-test">The first test</h2>
<p>The first test reads</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb183-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return no &lt;li&gt;s for no categories&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb183-2" title="2">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb183-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Replace the <code>expect.fail</code> line with a test that properly follows the <em>Three As</em> of unit testing.</p>
<p>In the <em>arrange</em> section, you will need to create an empty array for the <code>categories</code> and store it in a variable. You will use the variable in the action.</p>
<p>In the <em>act</em> section, you will invoke the <code>mergeCategories</code> function with the <code>template</code> as the first argument, the variable that contains an empty array as the second argument, and the string ‘li’ for the tag name as the third argument. Store the return value in a variable.</p>
<p>In the <em>assert</em> section, assert that each of the following are true using the <a href="https://www.chaijs.com/api/bdd/#method_include">include</a> assertion provided by Chai:</p>
<ul>
<li>To make sure that the method doesn’t <em>remove</em> the wrong things
<ul>
<li>Assert that it contains the string "&lt;div&gt;"</li>
<li>Assert that it contains the string "&lt;/div&gt;"</li>
<li>Assert that it contains the string "&lt;ul&gt;"</li>
<li>Assert that it contains the string "&lt;/ul&gt;"</li>
</ul></li>
<li>To make sure that the method doesn’t <em>add</em> the wrong things
<ul>
<li>Assert that it does not contain the string "&lt;li&gt;"</li>
<li>Assert that it does not contain the string "&lt;/li&gt;"</li>
</ul></li>
<li>To make sure it replaces what you expect it to replace
<ul>
<li>Assert that it does not contain the string "&lt;!– Content here –&gt;"</li>
</ul></li>
</ul>
<p>Run the test to make sure it passes.</p>
<p>Here’s what the test could look like.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb184-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return no LIs for no categories&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb184-2" title="2">  <span class="kw">const</span> categories <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb184-3" title="3">  <span class="kw">const</span> result <span class="op">=</span> <span class="at">mergeCategories</span>(template<span class="op">,</span> categories<span class="op">,</span> <span class="st">&#39;li&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb184-4" title="4">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;div&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb184-5" title="5">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;/div&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb184-6" title="6">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;ul&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb184-7" title="7">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;/ul&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb184-8" title="8">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="va">not</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;li&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb184-9" title="9">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="va">not</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;/li&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb184-10" title="10"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<blockquote>
<p>Notice we are using <code>contain</code> here instead of <code>include</code>. <code>contain</code> is an alias to <code>include</code> that chai provides, and it reads better here than <code>include</code>.</p>
</blockquote>
<h2 id="the-second-test">The second test</h2>
<p>The second test reads</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb185-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return a single &lt;li&gt; for one categories&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb185-2" title="2">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb185-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Replace the <code>expect.fail</code> line with a test that properly follows the <em>Three As</em> of unit testing.</p>
<p>In the <em>arrange</em> section, you will need to create an array for the <code>categories</code> argument that contains a single string and store it in a variable. You will use the variable in the action and the value that you typed in the assertion.</p>
<p>In the <em>act</em> section, you will invoke the <code>mergeCategories</code> function with the <code>template</code> as the first argument, the variable that contains the array with the single value as the second argument, and the string ‘li’ for the tag name as the third argument. Store the return value in a variable.</p>
<p>In the <em>assert</em> section, assert that each of the following are true using the <a href="https://www.chaijs.com/api/bdd/#method_include">include</a> assertion provided by Chai:</p>
<ul>
<li>To make sure that the method doesn’t <em>remove</em> the wrong things
<ul>
<li>Assert that it contains the string "&lt;div&gt;"</li>
<li>Assert that it contains the string "&lt;/div&gt;"</li>
<li>Assert that it contains the string "&lt;ul&gt;"</li>
<li>Assert that it contains the string "&lt;/ul&gt;"</li>
</ul></li>
<li>To make sure that the method <em>adds</em> the right things
<ul>
<li>Assert that it does contain the string "&lt;li&gt;your string here&lt;/li&gt;" where "your string here" is the single value that you placed in the array</li>
</ul></li>
<li>To make sure it replaces what you expect it to replace
<ul>
<li>Assert that it does not contain the string "&lt;!– Content here –&gt;"</li>
</ul></li>
</ul>
<p>Run the test to make sure it passes.</p>
<p>Here’s what the test could look like.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb186-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return a single LI for one categories&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb186-2" title="2">  <span class="kw">const</span> categories <span class="op">=</span> [<span class="st">&#39;Cat 1&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb186-3" title="3">  <span class="kw">const</span> result <span class="op">=</span> <span class="at">mergeCategories</span>(template<span class="op">,</span> categories<span class="op">,</span> <span class="st">&#39;li&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb186-4" title="4">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;div&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb186-5" title="5">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;/div&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb186-6" title="6">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;ul&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb186-7" title="7">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;/ul&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb186-8" title="8">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;li&gt;Cat 1&lt;/li&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb186-9" title="9"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="the-third-test">The third test</h2>
<p>The third test reads</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb187-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return an &lt;li&gt; for each category&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb187-2" title="2">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb187-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Replace the <code>expect.fail</code> line with a test that properly follows the <em>Three As</em> of unit testing.</p>
<p>In the <em>arrange</em> section, you will need to create an array for the <code>categories</code> argument that contains multiple strings and store it in a variable. You will use the variable in the action and the values that you typed in the assertion.</p>
<p>In the <em>act</em> section, you will invoke the <code>mergeCategories</code> function with the <code>template</code> as the first argument, the variable that contains the array with the multiple values as the second argument, and the string ‘li’ for the tag name as the third argument. Store the return value in a variable.</p>
<p>In the <em>assert</em> section, assert that each of the following are true using the <a href="https://www.chaijs.com/api/bdd/#method_include">include</a> assertion provided by Chai:</p>
<ul>
<li>To make sure that the method doesn’t <em>remove</em> the wrong things
<ul>
<li>Assert that it contains the string "&lt;div&gt;"</li>
<li>Assert that it contains the string "&lt;/div&gt;"</li>
<li>Assert that it contains the string "&lt;ul&gt;"</li>
<li>Assert that it contains the string "&lt;/ul&gt;"</li>
</ul></li>
<li>To make sure that the method <em>adds</em> the right things, for <em>each</em> of the values that you put in your categories array:
<ul>
<li>Assert that it does contain the string "&lt;li&gt;value n&lt;/li&gt;" where "value n" is one of the values in your array</li>
</ul></li>
<li>To make sure it replaces what you expect it to replace
<ul>
<li>Assert that it does not contain the string "&lt;!– Content here –&gt;"</li>
</ul></li>
</ul>
<p>Run the test to make sure it passes.</p>
<p>Here’s what that code could look like.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb188-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return an LI for each category&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb188-2" title="2">  <span class="kw">const</span> categories <span class="op">=</span> [<span class="st">&#39;Cat 1&#39;</span><span class="op">,</span> <span class="st">&#39;Cat 2&#39;</span><span class="op">,</span> <span class="st">&#39;Cat 3&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb188-3" title="3">  <span class="kw">const</span> result <span class="op">=</span> <span class="at">mergeCategories</span>(template<span class="op">,</span> categories<span class="op">,</span> <span class="st">&#39;li&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb188-4" title="4">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;div&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb188-5" title="5">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;/div&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb188-6" title="6">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;ul&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb188-7" title="7">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;/ul&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb188-8" title="8">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;li&gt;Cat 1&lt;/li&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb188-9" title="9">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;li&gt;Cat 2&lt;/li&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb188-10" title="10">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(<span class="st">&#39;&lt;li&gt;Cat 3&lt;/li&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb188-11" title="11"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>You have won this round!</p>
<hr />
<h1 id="save-submitted-category-information">Save Submitted Category Information</h1>
<p>You’ll now write the tests for the part of the application that saves a category when it is submitted. That code, in <strong>server.js</strong> looks like this and is what happens when a new category is sent to the server in an HTTP POST.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb189-1" title="1"><span class="cf">else</span> <span class="cf">if</span> (<span class="va">req</span>.<span class="at">url</span> <span class="op">===</span> <span class="st">&quot;/categories&quot;</span> <span class="op">&amp;&amp;</span> <span class="va">req</span>.<span class="at">method</span> <span class="op">===</span> <span class="st">&#39;POST&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb189-2" title="2">    <span class="kw">const</span> body <span class="op">=</span> <span class="cf">await</span> <span class="at">getBodyFromRequest</span>(req)<span class="op">;</span></a>
<a class="sourceLine" id="cb189-3" title="3">    <span class="kw">const</span> newCategory <span class="op">=</span> <span class="at">getValueFromBody</span>(body<span class="op">,</span> <span class="st">&#39;categoryName&#39;</span>)</a>
<a class="sourceLine" id="cb189-4" title="4">    categories <span class="op">=</span> <span class="at">saveCategories</span>(categories<span class="op">,</span> newCategory)<span class="op">;</span></a>
<a class="sourceLine" id="cb189-5" title="5">    <span class="va">res</span>.<span class="at">setHeader</span>(<span class="st">&#39;Location&#39;</span><span class="op">,</span> <span class="st">&#39;/categories&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb189-6" title="6">    <span class="va">res</span>.<span class="at">writeHead</span>(<span class="dv">302</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb189-7" title="7"><span class="op">}</span></a></code></pre></div>
<p>There are three main functions we need to test in this block of code.</p>
<p>Here’s what they all three do in a nutshell:</p>
<p><code>getBodyFromRequest</code> - Gets the raw POST body string from the HTTP POST request <code>getValueFromBody</code> - Parses this raw string into individual values representing the new categories <code>saveCategories</code> - Saves the new categories into the existing list of categories;</p>
<p>You need to write tests for all three functions <code>getBodyFromRequest</code>, <code>getValueFromBody</code>, and <code>saveCategories</code>.</p>
<h2 id="testing-getting-the-body-from-the-request-getbodyfromrequest">Testing getting the body from the request (<code>getBodyFromRequest()</code>)</h2>
<p>Open up <strong>get-body-from-request.js</strong> and review it.</p>
<p>The <code>getBodyFromRequest()</code> function takes one argument <code>req</code> which is an <a href="https://nodejs.org/api/http.html#http_class_http_incomingmessage">IncomingMessage</a> object. It returns a Promise which means it is an <em>asynchronous</em> function.</p>
<p>The <code>IncomingMessage</code> stored in <code>req</code> contains properties like <code>url</code> and <code>method</code>, but also a stream of data that was sent to us by the browser. We call this stream of data the POST "body".</p>
<p>"GET" requests have <em>no</em> data in the body, ever. "POST" submissions almost <em>always</em> contain data. Because this is a POST that the code is handling, the code needs to read <em>all</em> of the data from the stream. To do that, it listens for two events, the "data" event and the "end" event.</p>
<p>When data shows up for the server to read, it has to do it in chunks because we can’t predict how much data the browser will be sending the server and the data could be huge!</p>
<p>The code to do that is</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb190-1" title="1"><span class="va">req</span>.<span class="at">on</span>(<span class="st">&#39;data&#39;</span><span class="op">,</span> chunk <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb190-2" title="2">  data <span class="op">+=</span> chunk<span class="op">;</span></a>
<a class="sourceLine" id="cb190-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The callback will be called everytime the server receives a chunk of data from the browser. Then we just append the incoming chunk of data to the existing data variable with <code>+=</code>.</p>
<p>We will continue to do this as long as the server is still receiving chunks.</p>
<p>When the data finishes arriving at the server, the "end" event occurs. That signals the code that it has finished arriving and the Promise in the method can finish with a call to <code>resolve</code> passing it the <code>data</code>. That is this piece of code from <code>getBodyFromRequest</code>:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb191-1" title="1"><span class="va">req</span>.<span class="at">on</span>(<span class="st">&#39;end&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb191-2" title="2">  <span class="at">resolve</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb191-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>This is a hard one to test because you need to test those events. The stream of data inherits from a class <code>EventEmitter</code>. You can use an instance of the <code>EventEmitter</code> class to test this code. This is called <em>a stub</em> or <em>a fake</em> because it’s not a real <code>IncomingMessage</code>. You can trigger an event using the <code>emit</code> method which takes the name of the event as the first parameter and, as an optional second parameter, any data.</p>
<p>For Example:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb192-1" title="1"><span class="kw">const</span> fakeReq <span class="op">=</span> <span class="kw">new</span> <span class="at">EventEmitter</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb192-2" title="2"><span class="va">fakeReq</span>.<span class="at">emit</span>(<span class="st">&#39;end&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>would emit the "end" event.</p>
<p>Another thing that makes this hard is that it is an <em>asynchronous</em> test which means that you <strong>must</strong> use the <code>done</code> method that mocha provides as part of the test callback. If everything is ok, then you call <code>done</code> without any arguments. If something bad happens, you call <code>done</code> with the error message.</p>
<p>You can see an example in this <code>it</code> block from the <strong>get-body-from-request-spec.js</strong> file. The <code>done</code> function is the first argument to the <code>it</code> callback.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb193-1" title="1">  <span class="at">it</span>(<span class="st">&#39;returns an empty string for no body&#39;</span><span class="op">,</span> done <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb193-2" title="2">    <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb193-3" title="3">  <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<blockquote>
<p>This should remind you of the <code>resolve</code> function in Promises, it’s a similar pattern.</p>
</blockquote>
<h3 id="the-first-body-request-test">The first body request test</h3>
<p>For the first test, <em>returns an empty string for no body</em>, the following code uses the <code>EventEmitter</code> stored in <code>fakeReq</code> (which is created in the <code>beforeEach</code> block) as the fake request to test the <code>getBodyFromRequest</code> function.</p>
<p>Write your assertion in the <code>then</code> handler of the promise returned by <code>getBodyFromRequest</code>. Check to see if the value in <code>body</code> is an empty string. If it is, the function works as you expect and you should call <code>done()</code>. If not, you should call <code>done</code> with an error message. The comments in the <code>then</code> function are there to guide you to do that.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb194-1" title="1"><span class="at">it</span>(<span class="st">&#39;returns an empty string for no body&#39;</span><span class="op">,</span> done <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb194-2" title="2">  <span class="co">// Arrange</span></a>
<a class="sourceLine" id="cb194-3" title="3">  <span class="kw">const</span> bodyPromise <span class="op">=</span> <span class="at">getBodyFromRequest</span>(fakeReq)<span class="op">;</span></a>
<a class="sourceLine" id="cb194-4" title="4"></a>
<a class="sourceLine" id="cb194-5" title="5">  <span class="co">// Act</span></a>
<a class="sourceLine" id="cb194-6" title="6">  <span class="co">// This next line emits an event using</span></a>
<a class="sourceLine" id="cb194-7" title="7">  <span class="co">// emit(event name, optional data)</span></a>
<a class="sourceLine" id="cb194-8" title="8">  <span class="va">fakeReq</span>.<span class="at">emit</span>(<span class="st">&#39;end&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb194-9" title="9"></a>
<a class="sourceLine" id="cb194-10" title="10">  <span class="co">// Assert</span></a>
<a class="sourceLine" id="cb194-11" title="11">  bodyPromise</a>
<a class="sourceLine" id="cb194-12" title="12">    .<span class="at">then</span>(body <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb194-13" title="13">      <span class="co">// Write the following code:</span></a>
<a class="sourceLine" id="cb194-14" title="14">      <span class="co">// Determine if body is equal to &quot;&quot;</span></a>
<a class="sourceLine" id="cb194-15" title="15">      <span class="co">// If it is, call done()</span></a>
<a class="sourceLine" id="cb194-16" title="16">      <span class="co">// If it is not, call</span></a>
<a class="sourceLine" id="cb194-17" title="17">      <span class="co">//   done(`Failed. Got &quot;${body}&quot;`)</span></a>
<a class="sourceLine" id="cb194-18" title="18">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb194-19" title="19"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="the-second-body-request-test">The second body request test</h3>
<p>For the second test, <em>returns the data read from the stream</em>, use the <code>EventEmitter</code> stored in <code>fakeReq</code> as the fake request to test the <code>getBodyFromRequest</code> function. This time, though, you need to emit some "data" events before you emit the "end" event to test the data-gathering functionality of the method.</p>
<p>From the last section, you know that the signature for the <code>emit</code> method is</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb195-1" title="1"><span class="va">eventEmitter</span>.<span class="at">emit</span>(<span class="st">&#39;event name&#39;</span><span class="op">,</span> <span class="st">&#39;optional data&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>In the cases below, the event name is "data" and the optional data is stored in <code>data1</code> and <code>data2</code>. So, you should have <em>two</em> calls to <code>emit</code> before the <code>fakeReq.emit('end');</code>. You can see space for you to write those calls.</p>
<p>Then, in the <code>then</code> handler of the Promise, you should check to see if the value in <code>body</code> is the same as <code>data1 + data2</code>. If it is, the function works as you expect and you should call <code>done()</code>. If not, you should call <code>done</code> with an error message. The comments in the <code>then</code> function are there to guide you to do that.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb196-1" title="1"><span class="at">it</span>(<span class="st">&#39;returns the data read from the stream&#39;</span><span class="op">,</span> done <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb196-2" title="2">  <span class="co">// Arrange</span></a>
<a class="sourceLine" id="cb196-3" title="3">  <span class="kw">const</span> bodyPromise <span class="op">=</span> <span class="at">getBodyFromRequest</span>(fakeReq)<span class="op">;</span></a>
<a class="sourceLine" id="cb196-4" title="4">  <span class="kw">const</span> data1 <span class="op">=</span> <span class="st">&quot;This is some&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb196-5" title="5">  <span class="kw">const</span> data2 <span class="op">=</span> <span class="st">&quot; data from the browser&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb196-6" title="6"></a>
<a class="sourceLine" id="cb196-7" title="7">  <span class="co">// Act</span></a>
<a class="sourceLine" id="cb196-8" title="8">  <span class="co">// Write code to emit a &quot;data&quot; event with</span></a>
<a class="sourceLine" id="cb196-9" title="9">  <span class="co">// the data stored in data1</span></a>
<a class="sourceLine" id="cb196-10" title="10"></a>
<a class="sourceLine" id="cb196-11" title="11">  <span class="co">// Write code to emit a &quot;data&quot; event with</span></a>
<a class="sourceLine" id="cb196-12" title="12">  <span class="co">// the data stored in data2</span></a>
<a class="sourceLine" id="cb196-13" title="13"></a>
<a class="sourceLine" id="cb196-14" title="14">  <span class="va">fakeReq</span>.<span class="at">emit</span>(<span class="st">&#39;end&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb196-15" title="15"></a>
<a class="sourceLine" id="cb196-16" title="16">  <span class="co">// Assert</span></a>
<a class="sourceLine" id="cb196-17" title="17">  bodyPromise</a>
<a class="sourceLine" id="cb196-18" title="18">    .<span class="at">then</span>(body <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb196-19" title="19">      <span class="co">// Write the following code:</span></a>
<a class="sourceLine" id="cb196-20" title="20">      <span class="co">// Determine if body is equal to data1 + data2</span></a>
<a class="sourceLine" id="cb196-21" title="21">      <span class="co">// If it is, call done()</span></a>
<a class="sourceLine" id="cb196-22" title="22">      <span class="co">// If it is not, call</span></a>
<a class="sourceLine" id="cb196-23" title="23">      <span class="co">//   done(`Failed. Got &quot;${body}&quot;`)</span></a>
<a class="sourceLine" id="cb196-24" title="24">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb196-25" title="25"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="testing-getting-the-value-from-the-body-getvaluefrombody">Testing getting the value from the body (<code>getValueFromBody</code>)</h2>
<p>It’s not enough to just get the stream of raw data from the <code>POST</code> body, we also need to parse that data into the categories the user is saving.</p>
<p>When someone POSTs a form from the browser to the server, it comes to the server in a format called "x-www-form-urlencoded". This is also sometimes called a "Query String"</p>
<p>"x-www-form-urlencoded" is just a format for data just like JSON is also a format for data. This specific format is made up of key/value pairs. The key/value pairs are in the form "<em>key</em>=<em>value</em>". Those pairs are joined together in a single string by using the ampersand character. The following are valid strings contained in the "x-www-form-urlencoded" format.</p>
<ul>
<li><strong>""</strong>: The empty string is a valid x-www-form-urlencoded string.</li>
<li><strong>"name=Morgan"</strong>: The key in this case is "name" and the value is "Morgan"</li>
<li><strong>"name=Petra&amp;age=31"</strong>: There are two key/value pairs in this, "name" and "Petra", and "age" and "31"</li>
<li><strong>"name=Bess&amp;age=&amp;job=Boss"</strong>: There are three key/value pairs in this
<ul>
<li>"name" and "Bess"</li>
<li>"age" and "" (I guess they didn’t answer?)</li>
<li>"job" and "Boss"</li>
</ul></li>
</ul>
<p>If one of the values contains a character that’s not a letter or number, it’s replaced by a weird number that begins with a percent sign. That’s known as URL encoding. The most common replacement is "%20" for the space character. Here are some valid strings with that replacement.</p>
<ul>
<li><strong>"name=Chandra%20K&amp;age=13%20years%20old"</strong>: This string has two key/value pairs
<ul>
<li>"name" and "Chandra K"</li>
<li>"age" and "13 years old"</li>
</ul></li>
<li><strong>"title=Boop%20Lord"</strong>: This string has one key/value pair, "title" and "Boop Lord"</li>
</ul>
<blockquote>
<p>In the tests that you write, you will not have to write these "x-www-form-urlencoded" strings. They will be provided to you in the test. However, you should be able to read them so that you become familiar with how they &gt; work.</p>
</blockquote>
<p>Open up the <strong>get-value-from-body.js</strong> file to see the two lines of code in the <code>getValueFromBody</code> function that implement this behavior. Notice we are using the built in <code>querystring</code> module in Node.js to <code>parse()</code> our <code>x-www-form-urlencoded</code> string.</p>
<p><code>getValueFromBody</code> takes in two arguments, <code>body</code> and <code>key</code>. It then parses the <code>x-www-form-urlencoded</code> body and returns the value that cooresponds to <code>key</code>.</p>
<p>To make sure that it behaves, though, there are multiple tests in <strong>get-value-from-body-spec.js</strong> in the <strong>test</strong> directory. Let’s look at those.</p>
<p>There are five tests. The first three have the body <em>and</em> key defined for you. The last two have the body defined and you should figure out the key to test.</p>
<h3 id="the-first-test-1">The first test</h3>
<p>The first test is <em>returns an empty string for an empty body</em>. So, if the body is empty, regardless of the key, the <code>getValueFromBody</code> method returns an empty string.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb197-1" title="1"><span class="at">it</span>(<span class="st">&#39;returns an empty string for an empty body&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb197-2" title="2">  <span class="co">// Arrange</span></a>
<a class="sourceLine" id="cb197-3" title="3">  <span class="kw">const</span> body <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb197-4" title="4">  <span class="kw">const</span> key <span class="op">=</span> <span class="st">&quot;notThere&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb197-5" title="5"></a>
<a class="sourceLine" id="cb197-6" title="6">  <span class="co">// Act</span></a>
<a class="sourceLine" id="cb197-7" title="7">  <span class="co">// Write code to invoke getValueFromBody and collect</span></a>
<a class="sourceLine" id="cb197-8" title="8">  <span class="co">// the result</span></a>
<a class="sourceLine" id="cb197-9" title="9"></a>
<a class="sourceLine" id="cb197-10" title="10"></a>
<a class="sourceLine" id="cb197-11" title="11">  <span class="co">// Assert</span></a>
<a class="sourceLine" id="cb197-12" title="12">  <span class="co">// Replace the fail line with an assertion for the</span></a>
<a class="sourceLine" id="cb197-13" title="13">  <span class="co">// expected value of &quot;&quot;</span></a>
<a class="sourceLine" id="cb197-14" title="14">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb197-15" title="15"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>In this test, you need to write the code that invokes the <code>getValueFromBody</code> method with the <code>body</code> and <code>key</code> arguments. The result that comes back is what you should assert instead of just having it fail.</p>
<p>Take a moment and try to complete that on your own. The following code snippet will show you the solution, so give it a shot figuring out the two lines of code that you need to complete the previous one.</p>
<p>Here’s the solution:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb198-1" title="1"><span class="at">it</span>(<span class="st">&#39;returns an empty string for an empty body&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb198-2" title="2">  <span class="co">// Arrange</span></a>
<a class="sourceLine" id="cb198-3" title="3">  <span class="kw">const</span> body <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb198-4" title="4">  <span class="kw">const</span> key <span class="op">=</span> <span class="st">&quot;notThere&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb198-5" title="5"></a>
<a class="sourceLine" id="cb198-6" title="6">  <span class="co">// Act</span></a>
<a class="sourceLine" id="cb198-7" title="7">  <span class="co">// Write code to invoke getValueFromBody and collect</span></a>
<a class="sourceLine" id="cb198-8" title="8">  <span class="co">// the result</span></a>
<a class="sourceLine" id="cb198-9" title="9">  <span class="kw">const</span> result <span class="op">=</span> <span class="at">getValueFromBody</span>(body<span class="op">,</span> key)<span class="op">;</span></a>
<a class="sourceLine" id="cb198-10" title="10"></a>
<a class="sourceLine" id="cb198-11" title="11">  <span class="co">// Assert</span></a>
<a class="sourceLine" id="cb198-12" title="12">  <span class="co">// Replace the fail line with an assertion for the</span></a>
<a class="sourceLine" id="cb198-13" title="13">  <span class="co">// expected value of &quot;&quot;</span></a>
<a class="sourceLine" id="cb198-14" title="14">  <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">equal</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb198-15" title="15"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="the-second-test-1">The second test</h3>
<p>The second test is <em>returns an empty string for a body without the key</em>. So, if you ask for the value of a key that is not in the body, the <code>getValueFromBody</code> method returns an empty string.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb199-1" title="1"><span class="at">it</span>(<span class="st">&#39;returns an empty string for a body without the key&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb199-2" title="2">  <span class="co">// Arrange</span></a>
<a class="sourceLine" id="cb199-3" title="3">  <span class="kw">const</span> body <span class="op">=</span> <span class="st">&quot;name=Bess&amp;age=29&amp;job=Boss&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb199-4" title="4">  <span class="kw">const</span> key <span class="op">=</span> <span class="st">&quot;notThere&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb199-5" title="5"></a>
<a class="sourceLine" id="cb199-6" title="6">  <span class="co">// Act</span></a>
<a class="sourceLine" id="cb199-7" title="7">  <span class="co">// Write code to invoke getValueFromBody and collect</span></a>
<a class="sourceLine" id="cb199-8" title="8">  <span class="co">// the result</span></a>
<a class="sourceLine" id="cb199-9" title="9"></a>
<a class="sourceLine" id="cb199-10" title="10"></a>
<a class="sourceLine" id="cb199-11" title="11">  <span class="co">// Assert</span></a>
<a class="sourceLine" id="cb199-12" title="12">  <span class="co">// Replace the fail line with an assertion for the</span></a>
<a class="sourceLine" id="cb199-13" title="13">  <span class="co">// expected value of &quot;&quot;</span></a>
<a class="sourceLine" id="cb199-14" title="14">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb199-15" title="15"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>This code will look very, very similar to the last test. Complete it to make it pass.</p>
<h3 id="the-third-test-1">The third test</h3>
<p>The third test, <em>returns the value of the key in a simple body</em>, is also very similar to the past two tests. In this case, you have to compare it to the expected value "Bess".</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb200-1" title="1"><span class="at">it</span>(<span class="st">&#39;returns the value of the key in a simple body&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb200-2" title="2">  <span class="kw">const</span> body <span class="op">=</span> <span class="st">&quot;name=Bess&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb200-3" title="3">  <span class="kw">const</span> key <span class="op">=</span> <span class="st">&quot;name&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb200-4" title="4"></a>
<a class="sourceLine" id="cb200-5" title="5">  <span class="co">// Act</span></a>
<a class="sourceLine" id="cb200-6" title="6">  <span class="co">// Write code to invoke getValueFromBody and collect</span></a>
<a class="sourceLine" id="cb200-7" title="7">  <span class="co">// the result</span></a>
<a class="sourceLine" id="cb200-8" title="8"></a>
<a class="sourceLine" id="cb200-9" title="9"></a>
<a class="sourceLine" id="cb200-10" title="10">  <span class="co">// Assert</span></a>
<a class="sourceLine" id="cb200-11" title="11">  <span class="co">// Replace the fail line with an assertion for the</span></a>
<a class="sourceLine" id="cb200-12" title="12">  <span class="co">// expected value of &quot;Bess&quot;</span></a>
<a class="sourceLine" id="cb200-13" title="13">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb200-14" title="14"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="the-fourth-test">The fourth test</h3>
<p>The fourth test, <em>returns the value of the key in a complex body</em>, is also very similar to the past three tests. In this case, you have to choose a key that you want to test from the existing keys in the body and, then, the value that it has so that you can make the assertion at the end.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb201-1" title="1"><span class="at">it</span>(<span class="st">&#39;returns the value of the key in a complex body&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb201-2" title="2">  <span class="kw">const</span> body <span class="op">=</span> <span class="st">&quot;name=Bess&amp;age=29&amp;job=Boss&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb201-3" title="3">  <span class="co">// Select one of the keys in the body</span></a>
<a class="sourceLine" id="cb201-4" title="4"></a>
<a class="sourceLine" id="cb201-5" title="5">  <span class="co">// Act</span></a>
<a class="sourceLine" id="cb201-6" title="6">  <span class="co">// Write code to invoke getValueFromBody and collect</span></a>
<a class="sourceLine" id="cb201-7" title="7">  <span class="co">// the result</span></a>
<a class="sourceLine" id="cb201-8" title="8"></a>
<a class="sourceLine" id="cb201-9" title="9"></a>
<a class="sourceLine" id="cb201-10" title="10">  <span class="co">// Assert</span></a>
<a class="sourceLine" id="cb201-11" title="11">  <span class="co">// Replace the fail line with an assertion for the</span></a>
<a class="sourceLine" id="cb201-12" title="12">  <span class="co">// expected value for the key that you selected</span></a>
<a class="sourceLine" id="cb201-13" title="13">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb201-14" title="14"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="the-fifth-test">The fifth test</h3>
<p>The fifth test, <em>decodes the return value of URL encoding</em>, is also very similar to the past three tests. In this case, you will test the value of the "level" key. Complete the code with the correct assertion. Remember that <code>%20</code> should be decoded and be turned into the space character.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb202-1" title="1"><span class="at">it</span>(<span class="st">&#39;decodes the return value of URL encoding&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb202-2" title="2">  <span class="kw">const</span> body <span class="op">=</span> <span class="st">&quot;name=Bess&amp;age=29&amp;job=Boss&amp;level=Level%20Thirty-One&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb202-3" title="3">  <span class="kw">const</span> key <span class="op">=</span> <span class="st">&quot;level&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb202-4" title="4"></a>
<a class="sourceLine" id="cb202-5" title="5">  <span class="co">// Act</span></a>
<a class="sourceLine" id="cb202-6" title="6">  <span class="co">// Write code to invoke getValueFromBody and collect</span></a>
<a class="sourceLine" id="cb202-7" title="7">  <span class="co">// the result</span></a>
<a class="sourceLine" id="cb202-8" title="8"></a>
<a class="sourceLine" id="cb202-9" title="9"></a>
<a class="sourceLine" id="cb202-10" title="10">  <span class="co">// Assert</span></a>
<a class="sourceLine" id="cb202-11" title="11">  <span class="co">// Replace the fail line with an assertion for the</span></a>
<a class="sourceLine" id="cb202-12" title="12">  <span class="co">// expected value for the &quot;level&quot; key</span></a>
<a class="sourceLine" id="cb202-13" title="13">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb202-14" title="14"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="testing-saving-the-categories">Testing saving the categories</h2>
<p>Open up <strong>save-categories.js</strong> and review it. This contains a method that pushes a new category in the <code>newCategory</code> parameter onto the argument provided in <code>categories</code> (hopefully an array!). Then, it sorts the <code>categories</code> array. Finally, it returns a "clone" of the array by just creating a new array with all of the old entries. This is done to keep modifications to the old array from messing with the new array. It is an implementation detail that you just need to test for.</p>
<p>Open <strong>save-categories-spec,js</strong>. It has three tests in it for you to complete.</p>
<h3 id="the-first-test-2">The first test</h3>
<p>In the first test, you must provide the "Act" stage by calling the <code>saveCategories</code> method with the provided <code>categories</code> and <code>newCategory</code> values and store its return value in a variable named "result".</p>
<p>Of note with the first test is that the assertion (that you do not have to write) uses the "include" method to test if a value is in an array.</p>
<h3 id="the-second-test-2">The second test</h3>
<p>In the second test, you must provide the "Assert" stage by writing the assertion to test using a new method named "eql" rather than "equal". Everything else remains the same.</p>
<p>The reason that you use <a href="https://www.chaijs.com/api/bdd/#method_eql"><code>eql</code></a> instead of <code>equal</code> is the "type" of equality each one provides. The <code>equal</code> function, which you’ve used until now, compares objects and arrays only by their instance. That means equality between arrays and objects using <code>equal</code> will only pass if they’re <em>the same object in memory</em>.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb203-1" title="1"><span class="co">// Different arrays with the same content</span></a>
<a class="sourceLine" id="cb203-2" title="2"><span class="at">expect</span>([<span class="st">&#39;a&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>]).<span class="va">to</span>.<span class="at">equal</span>([<span class="st">&#39;a&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>])<span class="op">;</span> <span class="co">// =&gt; FAIL</span></a>
<a class="sourceLine" id="cb203-3" title="3"></a>
<a class="sourceLine" id="cb203-4" title="4"><span class="co">// Same arrays</span></a>
<a class="sourceLine" id="cb203-5" title="5"><span class="kw">const</span> array <span class="op">=</span> [<span class="st">&#39;a&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb203-6" title="6"><span class="at">expect</span>(array).<span class="va">to</span>.<span class="at">equal</span>(array)<span class="op">;</span> <span class="co">// =&gt; PASS</span></a></code></pre></div>
<p>The <a href="https://www.chaijs.com/api/bdd/#method_eql"><code>eql</code></a> method performs "member-wise equality". It will compare the values <em>inside</em> the array as opposed to the instance of the array. Because of that, both of the previous examples pass with the <code>eql</code> method.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb204-1" title="1"><span class="co">// Different arrays with the same content</span></a>
<a class="sourceLine" id="cb204-2" title="2"><span class="at">expect</span>([<span class="st">&#39;a&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>]).<span class="va">to</span>.<span class="at">eql</span>([<span class="st">&#39;a&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>])<span class="op">;</span> <span class="co">// =&gt; PASS</span></a>
<a class="sourceLine" id="cb204-3" title="3"></a>
<a class="sourceLine" id="cb204-4" title="4"><span class="co">// Same arrays</span></a>
<a class="sourceLine" id="cb204-5" title="5"><span class="kw">const</span> array <span class="op">=</span> [<span class="st">&#39;a&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb204-6" title="6"><span class="at">expect</span>(array).<span class="va">to</span>.<span class="at">eql</span>(array)<span class="op">;</span> <span class="co">// =&gt; PASS</span></a></code></pre></div>
<h3 id="the-third-test-2">The third test</h3>
<p>In the third test, you must provide the "Arrange" portion. Interestingly, you can really provide any array and string value. That’s an easy one.</p>
<h2 id="et-voila">Et, voila!</h2>
<p>It seems that you have fully tested all of the code that it takes to test the "save category" code. Well done!</p>
<p>You win this round, too!</p>
<hr />
<h1 id="create-and-serve-a-to-do-item-form">Create And Serve A To-Do Item Form</h1>
<p>To display the form that lets you enter new items, it has to create a dropdown that contains the categories that are in the application. This is identical in <em>intent</em> to the code that creates a list of categories to display on the category screen. Because of that, here’s the code that handles displaying the "new item" screen.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb205-1" title="1"><span class="cf">else</span> <span class="cf">if</span> (<span class="va">req</span>.<span class="at">url</span> <span class="op">===</span> <span class="st">&quot;/items/new&quot;</span> <span class="op">&amp;&amp;</span> <span class="va">req</span>.<span class="at">method</span> <span class="op">===</span> <span class="st">&#39;GET&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb205-2" title="2">  <span class="kw">const</span> filePath <span class="op">=</span> <span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">&#39;todo-form-screen.html&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb205-3" title="3">  <span class="kw">const</span> template <span class="op">=</span> <span class="cf">await</span> <span class="va">fs</span>.<span class="va">promises</span>.<span class="at">readFile</span>(filePath<span class="op">,</span> <span class="st">&#39;utf-8&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb205-4" title="4">  <span class="kw">const</span> html <span class="op">=</span> <span class="at">mergeCategories</span>(template<span class="op">,</span> categories<span class="op">,</span> <span class="st">&#39;option&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb205-5" title="5">  <span class="va">res</span>.<span class="at">setHeader</span>(<span class="st">&#39;Content-Type&#39;</span><span class="op">,</span> <span class="st">&#39;text/html&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb205-6" title="6">  <span class="va">res</span>.<span class="at">writeHead</span>(<span class="dv">200</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb205-7" title="7">  <span class="va">res</span>.<span class="at">write</span>(html)<span class="op">;</span></a>
<a class="sourceLine" id="cb205-8" title="8"><span class="op">}</span></a></code></pre></div>
<p>In this case, the <code>mergeCategories</code> method is now called with the third argument of "option" rather than "li" as it was before. This is what the last three tests in the <strong>merge-categories-spec.js</strong> file address. You will write tests that generate "option" tags rather than "li" tags. You’ll also test that the replacement correctly occurred.</p>
<p>In this case, you’ll modify the tests in the second sub-"describe" section, the one that reads "For selects".</p>
<h2 id="the-first-test-3">The first test</h2>
<p>The first test reads</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb206-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return no &lt;option&gt;s for no categories&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb206-2" title="2">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb206-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Replace the <code>expect.fail</code> line with a test that properly follows the <em>Three As</em> of unit testing.</p>
<p>In the <em>arrange</em> section, you will need to create an empty array for the <code>categories</code> and store it in a variable. You will use the variable in the action.</p>
<p>In the <em>act</em> section, you will invoke the <code>mergeCategories</code> function with the <code>template</code> as the first argument, the variable that contains an empty array as the second argument, and the string ‘option’ for the tag name as the third argument. Store the return value in a variable.</p>
<p>In the <em>assert</em> section, assert that each of the following are true in the return value that you saved in the <em>act</em> section using the <a href="https://www.chaijs.com/api/bdd/#method_include">include</a> assertion provided by Chai:</p>
<ul>
<li>To make sure that the method doesn’t <em>remove</em> the wrong things
<ul>
<li>Assert that it contains the string "&lt;div&gt;"</li>
<li>Assert that it contains the string "&lt;/div&gt;"</li>
<li>Assert that it contains the string "&lt;select&gt;"</li>
<li>Assert that it contains the string "&lt;/select&gt;"</li>
</ul></li>
<li>To make sure that the method doesn’t <em>add</em> the wrong things
<ul>
<li>Assert that it does not contain the string "&lt;option&gt;"</li>
<li>Assert that it does not contain the string "&lt;/option&gt;"</li>
</ul></li>
<li>To make sure it replaces what you expect it to replace
<ul>
<li>Assert that it does not contain the string "&lt;!– Content here –&gt;"</li>
</ul></li>
</ul>
<p>Run the test to make sure it passes.</p>
<p>Except for some string differences, this test will look nearly identical to the first test that you did for the <code>&lt;li&gt;</code> tags earlier in this project.</p>
<h2 id="the-second-test-3">The second test</h2>
<p>The second test reads</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb207-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return a single &lt;option&gt; for one category&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb207-2" title="2">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb207-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Replace the <code>expect.fail</code> line with a test that properly follows the <em>Three As</em> of unit testing.</p>
<p>In the <em>arrange</em> section, you will need to create an array for the <code>categories</code> argument that contains a single string and store it in a variable. You will use the variable in the action and the value that you typed in the assertion.</p>
<p>In the <em>act</em> section, you will invoke the <code>mergeCategories</code> function with the <code>template</code> as the first argument, the variable that contains the array with the single value as the second argument, and the string ‘option’ for the tag name as the third argument. Store the return value in a variable.</p>
<p>In the <em>assert</em> section, assert that each of the following are true using the <a href="https://www.chaijs.com/api/bdd/#method_include">include</a> assertion provided by Chai:</p>
<ul>
<li>To make sure that the method doesn’t <em>remove</em> the wrong things
<ul>
<li>Assert that it contains the string "&lt;div&gt;"</li>
<li>Assert that it contains the string "&lt;/div&gt;"</li>
<li>Assert that it contains the string "&lt;select&gt;"</li>
<li>Assert that it contains the string "&lt;/select&gt;"</li>
</ul></li>
<li>To make sure that the method <em>adds</em> the right things
<ul>
<li>Assert that it does contain the string "&lt;option&gt;your string here&lt;/option&gt;" where "your string here" is the single value that you placed in the array</li>
</ul></li>
<li>To make sure it replaces what you expect it to replace
<ul>
<li>Assert that it does not contain the string "&lt;!– Content here –&gt;"</li>
</ul></li>
</ul>
<p>Run the test to make sure it passes.</p>
<p>Except for some string differences, this test will look nearly identical to the second test that you did for the <code>&lt;li&gt;</code> tags earlier in this project.</p>
<h2 id="the-third-test-3">The third test</h2>
<p>The third test reads</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb208-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return an &lt;option&gt; for each category&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb208-2" title="2">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb208-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Replace the <code>expect.fail</code> line with a test that properly follows the <em>Three As</em> of unit testing.</p>
<p>In the <em>arrange</em> section, you will need to create an array for the <code>categories</code> argument that contains multiple strings and store it in a variable. You will use the variable in the action and the values that you typed in the assertion.</p>
<p>In the <em>act</em> section, you will invoke the <code>mergeCategories</code> function with the <code>template</code> as the first argument, the variable that contains the array with the many values as the second argument, and the string ‘option’ for the tag name as the third argument. Store the return value in a variable.</p>
<p>In the <em>assert</em> section, assert that each of the following are true using the <a href="https://www.chaijs.com/api/bdd/#method_include">include</a> assertion provided by Chai:</p>
<ul>
<li>To make sure that the method doesn’t <em>remove</em> the wrong things
<ul>
<li>Assert that it contains the string "&lt;div&gt;"</li>
<li>Assert that it contains the string "&lt;/div&gt;"</li>
<li>Assert that it contains the string "&lt;select&gt;"</li>
<li>Assert that it contains the string "&lt;/select&gt;"</li>
</ul></li>
<li>To make sure that the method <em>adds</em> the right things, for <em>each</em> of the values that you put in your categories array:
<ul>
<li>Assert that it does contain the string "&lt;option&gt;value n&lt;/option&gt;" where "value n" is one of the values in your array</li>
</ul></li>
<li>To make sure it replaces what you expect it to replace
<ul>
<li>Assert that it does not contain the string "&lt;!– Content here –&gt;"</li>
</ul></li>
</ul>
<p>Run the test to make sure it passes.</p>
<p>Except for some string differences, this test will look nearly identical to the third test that you did for the <code>&lt;li&gt;</code> tags earlier in this project.</p>
<p>You have won this round!</p>
<hr />
<h1 id="save-and-show-to-do-items">Save And Show To-Do Items</h1>
<p>In this step, you’ll test the code for two different handlers, the one that shows the screen that has the list of items on it and the one that handles the creation of a new item. Here are those two parts of the <code>if-else</code> block in <strong>server.js</strong>.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb209-1" title="1"><span class="cf">else</span> <span class="cf">if</span> (<span class="va">req</span>.<span class="at">url</span> <span class="op">===</span> <span class="st">&quot;/items&quot;</span> <span class="op">&amp;&amp;</span> <span class="va">req</span>.<span class="at">method</span> <span class="op">===</span> <span class="st">&#39;GET&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb209-2" title="2">  <span class="kw">const</span> filePath <span class="op">=</span> <span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">&#39;list-of-items-screen.html&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-3" title="3">  <span class="kw">const</span> template <span class="op">=</span> <span class="cf">await</span> <span class="va">fs</span>.<span class="va">promises</span>.<span class="at">readFile</span>(filePath<span class="op">,</span> <span class="st">&#39;utf-8&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-4" title="4">  <span class="kw">const</span> html <span class="op">=</span> <span class="at">mergeItems</span>(template<span class="op">,</span> items)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-5" title="5">  <span class="va">res</span>.<span class="at">setHeader</span>(<span class="st">&#39;Content-Type&#39;</span><span class="op">,</span> <span class="st">&#39;text/html&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-6" title="6">  <span class="va">res</span>.<span class="at">writeHead</span>(<span class="dv">200</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-7" title="7">  <span class="va">res</span>.<span class="at">write</span>(html)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb209-9" title="9"></a>
<a class="sourceLine" id="cb209-10" title="10"><span class="cf">else</span> <span class="cf">if</span> (<span class="va">req</span>.<span class="at">url</span> <span class="op">===</span> <span class="st">&quot;/items&quot;</span> <span class="op">&amp;&amp;</span> <span class="va">req</span>.<span class="at">method</span> <span class="op">===</span> <span class="st">&#39;POST&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb209-11" title="11">  <span class="kw">const</span> body <span class="op">=</span> <span class="cf">await</span> <span class="at">getBodyFromRequest</span>(req)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-12" title="12">  <span class="kw">const</span> category <span class="op">=</span> <span class="at">getValueFromBody</span>(body<span class="op">,</span> <span class="st">&#39;category&#39;</span>)</a>
<a class="sourceLine" id="cb209-13" title="13">  <span class="kw">const</span> title <span class="op">=</span> <span class="at">getValueFromBody</span>(body<span class="op">,</span> <span class="st">&#39;title&#39;</span>)</a>
<a class="sourceLine" id="cb209-14" title="14">  items <span class="op">=</span> <span class="at">saveItems</span>(items<span class="op">,</span> <span class="op">{</span> title<span class="op">,</span> category <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-15" title="15">  <span class="va">res</span>.<span class="at">setHeader</span>(<span class="st">&#39;Location&#39;</span><span class="op">,</span> <span class="st">&#39;/items&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-16" title="16">  <span class="va">res</span>.<span class="at">writeHead</span>(<span class="dv">302</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb209-17" title="17"><span class="op">}</span></a></code></pre></div>
<p>What’s really great to note here is that you have already tested <code>getBodyFromRequest</code> and <code>getValueFromBody</code>! That means, out of all that code, there are only two methods for which you must write tests! Those are <code>mergeItems</code> and <code>saveItems</code>.</p>
<h2 id="testing-the-merge-items-method">Testing the merge items method</h2>
<p>This is <em>really</em> similar to the <code>mergeCategories</code> method that you’ve now written tests for twice. But, instead of creating an <code>&lt;li&gt;</code> or an <code>&lt;option&gt;</code>, it creates a row for a table for the items that are passed in and a form that shows a button to complete the item.</p>
<p>Open <strong>merge-items.js</strong> and review that code, please. You can see the loop on lines 5 - 23 that builds the rows of the table. Then, the form is created only if the item is <em>not</em> complete. Then, the <code>&lt;tr&gt;</code> and its <code>&lt;td&gt;</code>s are created. This just means that you will want to test instead of for <code>&lt;li&gt;</code>s and <code>&lt;option&gt;</code>s, you’ll test for many <code>&lt;td&gt;</code>s that contain the expected values.</p>
<p>Open <strong>merge-items-spec.js</strong> and see that you have essentially the same tests that you had for the <code>mergeCategories</code> function. It may not surprise you to learn that <em>many</em> tests look the same, especially if they handle similar functionality. This can get monotonous, at times. It is better, though, to have the protection of tests by investing a little bit of time in writing them as opposed to spending days trying to find a bug that inadvertently got into the code base when someone was writing other code.</p>
<h3 id="the-first-test-4">The first test</h3>
<p>The first test reads</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb210-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return no &lt;tr&gt;s and no &lt;td&gt;s for no items&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb210-2" title="2">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb210-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Replace the <code>expect.fail</code> line with a test that properly follows the <em>Three As</em> of unit testing.</p>
<p>In the <em>arrange</em> section, you will need to create an empty array for the <code>items</code> and store it in a variable. You will use the variable in the action.</p>
<p>In the <em>act</em> section, you will invoke the <code>mergeItems</code> function with the <code>template</code> as the first argument and the variable that contains an empty array as the second argument. Store the return value in a variable.</p>
<p>In the <em>assert</em> section, assert that each of the following are true using the <a href="https://www.chaijs.com/api/bdd/#method_include">include</a> assertion provided by Chai on the result of the <em>act</em>:</p>
<ul>
<li>To make sure that the method doesn’t <em>remove</em> the wrong things
<ul>
<li>Assert that it contains the string "&lt;table&gt;"</li>
<li>Assert that it contains the string "&lt;/table&gt;"</li>
<li>Assert that it contains the string "&lt;tbody&gt;"</li>
<li>Assert that it contains the string "&lt;/tbody&gt;"</li>
</ul></li>
<li>To make sure that the method doesn’t <em>add</em> the wrong things
<ul>
<li>Assert that it does not contain the string "&lt;tr&gt;"</li>
<li>Assert that it does not contain the string "&lt;/tr&gt;"</li>
<li>Assert that it does not contain the string "&lt;td&gt;"</li>
<li>Assert that it does not contain the string "&lt;/td&gt;"</li>
</ul></li>
<li>To make sure it replaces what you expect it to replace
<ul>
<li>Assert that it does not contain the string "&lt;!– Content here –&gt;"</li>
</ul></li>
</ul>
<p>Run the test to make sure it passes.</p>
<p>Because you already have examples of what this looks like in <code>mergeCategories</code>, please refer to that.</p>
<h3 id="the-second-test-4">The second test</h3>
<p>The second test reads</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb211-1" title="1"><span class="at">it</span>(<span class="st">&quot;should return a single &lt;tr&gt;, four &lt;td&gt;s, and a &lt;form&gt; for one uncompleted item&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb211-2" title="2">  <span class="va">expect</span>.<span class="at">fail</span>(<span class="st">&#39;please write this test&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb211-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Replace the <code>expect.fail</code> line with a test that properly follows the <em>Three As</em> of unit testing.</p>
<p>If you look at the code in the <code>mergeItems</code> method, you can see that it relies on the item to have the following properties:</p>
<ul>
<li><code>title</code></li>
<li><code>category</code></li>
<li><code>isComplete</code></li>
</ul>
<p>In the <em>arrange</em> section, you will need to create an array for the <code>items</code> argument that contains a single item and store it in a variable. You will use the variable in the action and the value that you typed in the assertion. Something like the following would suffice.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb212-1" title="1"><span class="kw">const</span> items <span class="op">=</span> [</a>
<a class="sourceLine" id="cb212-2" title="2">  <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Title 1&#39;</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">&#39;Category 1&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb212-3" title="3">]<span class="op">;</span></a></code></pre></div>
<p>In the <em>act</em> section, you will invoke the <code>mergeItems</code> function with the <code>template</code> as the first argument and the variable that contains an array that contains a single item as the second argument.</p>
<p>In the <em>assert</em> section, assert that each of the following are true using the <a href="https://www.chaijs.com/api/bdd/#method_include">include</a> assertion provided by Chai:</p>
<ul>
<li>To make sure that the method doesn’t <em>remove</em> the wrong things
<ul>
<li>Assert that it contains the string "&lt;table&gt;"</li>
<li>Assert that it contains the string "&lt;/table&gt;"</li>
<li>Assert that it contains the string "&lt;tbody&gt;"</li>
<li>Assert that it contains the string "&lt;/tbody&gt;"</li>
</ul></li>
<li>To make sure that the method <em>adds</em> the right things
<ul>
<li>Assert that it contains the string "&lt;tr&gt;"</li>
<li>Assert that it contains the string "&lt;/tr&gt;"</li>
<li>Assert that it contains the string "&lt;td&gt;Title 1&lt;/td&gt;"</li>
<li>Assert that it contains the string "&lt;td&gt;Category 1&lt;/td&gt;"</li>
<li>Assert that it contains the string "&lt;form method="POST" action="/items/1"&gt;"</li>
</ul></li>
<li>To make sure it replaces what you expect it to replace
<ul>
<li>Assert that it does not contain the string "&lt;!– Content here –&gt;"</li>
</ul></li>
</ul>
<p>Run the test to make sure it passes.</p>
<h3 id="the-third-test-4">The third test</h3>
<p>Now, you will test that <em>no</em> form is created when an item is complete. This will be nearly identical to what you just wrote <em>except</em> that your item should have an "isComplete" property set to <code>true</code>, and you will assert that it does <em>not</em> contain the "&lt;form method="POST" action="/items/1"&gt;" string.</p>
<p>Replace the <code>expect.fail</code> line with a test that properly follows the <em>Three As</em> of unit testing.</p>
<p>In the <em>arrange</em> section, you will need to create an array for the <code>items</code> argument that contains a single item that is completed and store it in a variable. Something like the following would suffice.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb213-1" title="1"><span class="kw">const</span> items <span class="op">=</span> [</a>
<a class="sourceLine" id="cb213-2" title="2">  <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Title 1&#39;</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">&#39;Category 1&#39;</span><span class="op">,</span> <span class="dt">isComplete</span><span class="op">:</span> <span class="kw">true</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb213-3" title="3">]<span class="op">;</span></a></code></pre></div>
<p>In the <em>act</em> section, you will invoke the <code>mergeItems</code> function with the <code>template</code> as the first argument and the variable that contains an array that contains a single completed item as the second argument.</p>
<p>In the <em>assert</em> section, assert that each of the following are true using the <a href="https://www.chaijs.com/api/bdd/#method_include">include</a> assertion provided by Chai:</p>
<ul>
<li>To make sure that the method doesn’t <em>remove</em> the wrong things
<ul>
<li>Assert that it contains the string "&lt;table&gt;"</li>
<li>Assert that it contains the string "&lt;/table&gt;"</li>
<li>Assert that it contains the string "&lt;tbody&gt;"</li>
<li>Assert that it contains the string "&lt;/tbody&gt;"</li>
</ul></li>
<li>To make sure that the method <em>adds</em> the right things
<ul>
<li>Assert that it contains the string "&lt;tr&gt;"</li>
<li>Assert that it contains the string "&lt;/tr&gt;"</li>
<li>Assert that it contains the string "&lt;td&gt;Title 1&lt;/td&gt;"</li>
<li>Assert that it contains the string "&lt;td&gt;Category 1&lt;/td&gt;"</li>
</ul></li>
<li>To make sure that the method does not add the wrong things
<ul>
<li>Assert that it does not contain the string "&lt;form method="POST" action="/items/1"&gt;"</li>
</ul></li>
<li>To make sure it replaces what you expect it to replace
<ul>
<li>Assert that it does not contain the string "&lt;!– Content here –&gt;"</li>
</ul></li>
</ul>
<p>Run the test to make sure it passes.</p>
<h3 id="the-fourth-test-1">The fourth test</h3>
<p>Now, try writing the last test <code>it('should return three &lt;tr&gt;s for three items')</code> as a combination or extension of the previous two. Check to make sure that you get all of the indexes for the items that you have in your array. Make sure that the "form" elements appear for those items that are not complete.</p>
<h2 id="testing-the-save-items-method">Testing the save items method</h2>
<p>Open the <strong>save-items.js</strong> file and review the function. It merely adds a new item to the array passed in using the <code>push</code> method. Then, it creates a clone of the old array using the "spread operator". If you’re not familiar with that syntax, don’t worry. All it does is make a copy of the array.</p>
<p>Open the <strong>save-items-spec.js</strong>. You will see two methods in there. These are nearly identical to the first and last tests for the <code>saveCategories</code> method. Use the same pattern to complete those tests.</p>
<p>Just as a reminder, a solution for the <strong>save-categories-spec.js</strong> file (with comments removed) could look like this.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb214-1" title="1"><span class="at">describe</span>(<span class="st">&quot;The saveCategories function&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb214-2" title="2">  <span class="at">it</span>(<span class="st">&#39;adds the new category to the list&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb214-3" title="3">    <span class="kw">const</span> categories <span class="op">=</span> [<span class="st">&#39;Cat 3&#39;</span><span class="op">,</span> <span class="st">&#39;Cat 2&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb214-4" title="4">    <span class="kw">const</span> newCategory <span class="op">=</span> <span class="st">&#39;Cat 1&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb214-5" title="5">    <span class="kw">const</span> result <span class="op">=</span> <span class="at">saveCategories</span>(categories<span class="op">,</span> newCategory)<span class="op">;</span></a>
<a class="sourceLine" id="cb214-6" title="6">    <span class="at">expect</span>(result).<span class="va">to</span>.<span class="at">contain</span>(newCategory)<span class="op">;</span></a>
<a class="sourceLine" id="cb214-7" title="7">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb214-8" title="8"></a>
<a class="sourceLine" id="cb214-9" title="9">  <span class="at">it</span>(<span class="st">&#39;makes sure the result and the original are different&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb214-10" title="10">    <span class="kw">const</span> categories <span class="op">=</span> [<span class="st">&#39;Cat 3&#39;</span><span class="op">,</span> <span class="st">&#39;Cat 2&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb214-11" title="11">    <span class="kw">const</span> result <span class="op">=</span> <span class="at">saveCategories</span>(categories<span class="op">,</span> <span class="st">&#39;Cat 1&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb214-12" title="12">    <span class="at">expect</span>(result).<span class="va">to</span>.<span class="va">not</span>.<span class="at">equal</span>(categories)<span class="op">;</span></a>
<a class="sourceLine" id="cb214-13" title="13">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb214-14" title="14"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Your code will look a lot like this <em>except</em> you should have arrays of items and new items, not strings. Remember from the last section, an array of items might look like this:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb215-1" title="1"><span class="kw">const</span> items <span class="op">=</span> [</a>
<a class="sourceLine" id="cb215-2" title="2">  <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Title 1&#39;</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">&#39;Category 1&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb215-3" title="3">]<span class="op">;</span></a></code></pre></div>
<p>Run your tests to make sure they pass.</p>
<hr />
<h1 id="show-and-complete-a-to-do-item">Show And Complete A To-Do Item</h1>
<p>You’re almost done with testing this application! Have a look at the method that completes a to-do item.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb216-1" title="1"><span class="cf">else</span> <span class="cf">if</span> (<span class="va">req</span>.<span class="va">url</span>.<span class="at">startsWith</span>(<span class="st">&#39;/items/&#39;</span>) <span class="op">&amp;&amp;</span> <span class="va">req</span>.<span class="at">method</span> <span class="op">===</span> <span class="st">&#39;POST&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb216-2" title="2">  <span class="kw">const</span> index <span class="op">=</span> <span class="va">Number</span>.<span class="at">parseInt</span>(<span class="va">req</span>.<span class="va">url</span>.<span class="at">substring</span>(<span class="dv">7</span>)) <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb216-3" title="3">  items[index].<span class="at">isComplete</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb216-4" title="4">  <span class="va">res</span>.<span class="at">setHeader</span>(<span class="st">&#39;Location&#39;</span><span class="op">,</span> <span class="st">&#39;/items&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb216-5" title="5">  <span class="va">res</span>.<span class="at">writeHead</span>(<span class="dv">302</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb216-6" title="6"><span class="op">}</span></a></code></pre></div>
<p>That’s interesting. There’s nothing to test there, no methods. That’s some kind of wonderful! On to the next item!</p>
<hr />
<h1 id="search-for-to-do-items">Search For To-Do Items</h1>
<p>What may be the most complex set of tests to write (except that weird event emitter thing), search makes you think though what it should do in a variety of cases.</p>
<p>Here’s the relevant part of the server that handles a search query.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb217-1" title="1"><span class="cf">else</span> <span class="cf">if</span> (<span class="va">req</span>.<span class="va">url</span>.<span class="at">startsWith</span>(<span class="st">&#39;/search&#39;</span>) <span class="op">&amp;&amp;</span> <span class="va">req</span>.<span class="at">method</span> <span class="op">===</span> <span class="st">&#39;GET&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb217-2" title="2">  <span class="kw">const</span> [_<span class="op">,</span> query] <span class="op">=</span> <span class="va">req</span>.<span class="va">url</span>.<span class="at">split</span>(<span class="st">&#39;?&#39;</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb217-3" title="3">  <span class="kw">const</span> <span class="op">{</span> term <span class="op">}</span> <span class="op">=</span> <span class="va">querystring</span>.<span class="at">parse</span>(query)<span class="op">;</span></a>
<a class="sourceLine" id="cb217-4" title="4">  <span class="kw">const</span> filePath <span class="op">=</span> <span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">&#39;search-items-screen.html&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb217-5" title="5">  <span class="kw">const</span> template <span class="op">=</span> <span class="cf">await</span> <span class="va">fs</span>.<span class="va">promises</span>.<span class="at">readFile</span>(filePath<span class="op">,</span> <span class="st">&#39;utf-8&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb217-6" title="6">  <span class="kw">let</span> foundItems <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb217-7" title="7">  <span class="cf">if</span> (term) <span class="op">{</span></a>
<a class="sourceLine" id="cb217-8" title="8">    foundItems <span class="op">=</span> <span class="at">searchItems</span>(items<span class="op">,</span> term)<span class="op">;</span></a>
<a class="sourceLine" id="cb217-9" title="9">  <span class="op">}</span></a>
<a class="sourceLine" id="cb217-10" title="10">  <span class="kw">const</span> html <span class="op">=</span> <span class="at">mergeItems</span>(template<span class="op">,</span> foundItems)<span class="op">;</span></a>
<a class="sourceLine" id="cb217-11" title="11">  <span class="va">res</span>.<span class="at">setHeader</span>(<span class="st">&#39;Content-Type&#39;</span><span class="op">,</span> <span class="st">&#39;text/html&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb217-12" title="12">  <span class="va">res</span>.<span class="at">writeHead</span>(<span class="dv">200</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb217-13" title="13">  <span class="va">res</span>.<span class="at">write</span>(html)<span class="op">;</span></a>
<a class="sourceLine" id="cb217-14" title="14"><span class="op">}</span></a></code></pre></div>
<p>You’ve already tested <code>mergeItems</code>, so that’s not needed, again. The only method that you will need to test is <code>searchItems</code>.</p>
<p>Open <strong>search-items.js</strong> and review how that code is working. It takes a list of <code>items</code> and a search <code>term</code>. The first thing it does is force the term to lower case.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb218-1" title="1">term <span class="op">=</span> <span class="va">term</span>.<span class="at">toLowerCase</span>()<span class="op">;</span></a></code></pre></div>
<p>Then, it uses the <code>filter</code> function on the array to create a new array of items that meet the comparison in the function. The comparison function makes the title lower case and checks to see if the term is contained in that string.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb219-1" title="1"><span class="cf">return</span> <span class="va">items</span>.<span class="at">filter</span>(x <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb219-2" title="2">  <span class="kw">const</span> title <span class="op">=</span> <span class="va">x</span>.<span class="va">title</span>.<span class="at">toLowerCase</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb219-3" title="3">  <span class="cf">return</span> <span class="va">title</span>.<span class="at">indexOf</span>(term) <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb219-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>If the term <em>is</em> in the title, then the comparison returns <code>true</code> and the <code>filter</code> function will add it to the new array. If the term is <em>not</em> in the title, the comparison returns <code>false</code> and it is not added to the new array.</p>
<p>Here is an example. Supposed you have the following items in your array.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb220-1" title="1">[</a>
<a class="sourceLine" id="cb220-2" title="2">  <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Go grocery shopping&#39;</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">&#39;Home&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb220-3" title="3">  <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Play with my puppy&#39;</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">&#39;Pet&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb220-4" title="4">  <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Shop for a puppy bed&#39;</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">&#39;Pet&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb220-5" title="5">]</a></code></pre></div>
<p>Now, say the search term someone entered is "SHOP". This is what happens in the function.</p>
<pre><code>Convert &quot;SHOP&quot; to &quot;shop&quot;
Filter the array of items based on the term &quot;shop&quot;:
  Item 1:
    Convert &quot;Go grocery shopping&quot; to &quot;go grocery shopping&quot;
    Does it contain the term &quot;shop&quot;? YES
    Add it to the new array
  Item 2:
    Convert &quot;Play with my puppy&quot; to &quot;play with my puppy&quot;
    Does it contain the term &quot;shop&quot;? NO
  Item 3:
    Convert &quot;Shop for a puppy bed&quot; to &quot;shop for a puppy bed&quot;
    Does it contain the term &quot;shop&quot;? YES
    Add it to the new array
Return the new array that contains items 1 and 3</code></pre>
<p>So, that’s what you want to test for.</p>
<p>Open <strong>search-items-spec.js</strong>. You’ll see three tests.</p>
<p>In the first test, you are asked to fix the <em>arrange</em> step to declare <code>items</code> and <code>term</code> given the directions. This is not a trick. It’s just declaring those two variables that it’s asking you to create.</p>
<p>In the second test, fix the <em>assert</em> step to assert the proper length of the result by completely replacing the <code>expect.fail</code> line.</p>
<p>In the third test, you are asked to fix the <em>arrange</em> step by choosing a string value for <code>term</code> that makes the rest of the test pass.</p>
<h2 id="what-have-you-done">What have you done?</h2>
<p>Now that you’ve done that, you’ve won the entire game! All of the meaty logic of the game is now well tested. If someone were to come along and try to change the code, when the tests ran, it would check to make sure they didn’t accidentally break something in their earnest to add new functionality!</p>
<p>Here’s what you did:</p>
<ul>
<li>You’ve looked at, read, and understood other people’s code</li>
<li>You’ve seen and used a variety of assertions</li>
<li>You’ve seen how to do real (not fake) asynchronous testing using the <code>done</code> method</li>
<li>You’ve invested time in hardening the maintainability of an application</li>
</ul>
<p>Here’s a link to a solution. https://-open-assets.s3-us-west-1.amazonaws.com/Module-JavaScript/testing/projects/testing-an-existing-project-solution.zip</p>
<p>In the next step, you’re going to use the fact that you have tests to radically change the code.</p>
<hr />
<h1 id="refactor-to-use-a-template-engine">Refactor To Use A Template Engine</h1>
<p><strong>Note</strong>: the solution project does not have this step included in it because it changes earlier tests.</p>
<p>The hard work you’ve done with <code>mergeCategories</code> and <code>mergeItems</code> to make sure that the important parts of the HTML are generated, those are some really good tests that you’re now going to use to change the way the entire HTML is generated.</p>
<p>This is the other side of testing. When you can feel confident that what you are doing will not break the code because you have tests that tell you what to do.</p>
<p>You’re going to follow some steps to replace the HTML-generating portion of the application. The steps will be explicit, because this is less about learning a library as it is proving to yourself that tests are a good thing.</p>
<h2 id="hello-handlebars">Hello, handlebars</h2>
<p>There’s very little chance that you would create a Web application, anymore, and generate your own HTML the way it was done in the <code>mergeCategories</code> and <code>mergeItems</code> functions. Instead, you would use a "templating engine" which is a library that takes some template (with some fancy instructions) and some data and generates HTML <em>for you</em>.</p>
<p>You’ll change your tests to use a <a href="https://handlebarsjs.com/">handlebars</a> style template which looks nearly identical to HTML. This will break your tests. Then, you will change the functions to use the <a href="https://handlebarsjs.com/">handlebars</a> engine. Then, you will know that they properly handle <a href="https://handlebarsjs.com/">handlebars</a> templates, so you’ll change the HTML files to use that syntax rather than using the "&lt;!– Content here –&gt;" placeholder.</p>
<h2 id="all-you-need-to-know-about-handlebars">All you need to know about handlebars</h2>
<p>This is just an informative section so you know what will actually be going on in the tests. You’re not going to be asked to come up with any of this yourself. This is showing you how you would, in the real world, update existing code and tests in a real application.</p>
<p>When you use the handlebars engine, you pass it two things, a string that contains the template and an object that contains the data that you want to show.</p>
<p>Assume that this is your data object.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb222-1" title="1"><span class="kw">const</span> data <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb222-2" title="2">  <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Remhai&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb222-3" title="3">  <span class="dt">nicknames</span><span class="op">:</span> [ <span class="st">&#39;R&#39;</span><span class="op">,</span> <span class="st">&#39;Rem&#39;</span><span class="op">,</span> <span class="st">&#39;Remrem&#39;</span> ]<span class="op">,</span></a>
<a class="sourceLine" id="cb222-4" title="4">  <span class="dt">addresses</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb222-5" title="5">    <span class="op">{</span> <span class="dt">street</span><span class="op">:</span> <span class="st">&#39;123 Main St&#39;</span><span class="op">,</span> <span class="dt">city</span><span class="op">:</span> <span class="st">&#39;Memphis&#39;</span><span class="op">,</span> <span class="dt">state</span><span class="op">:</span> <span class="st">&#39;TN&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb222-6" title="6">    <span class="op">{</span> <span class="dt">street</span><span class="op">:</span> <span class="st">&#39;2000 9th Ave&#39;</span><span class="op">,</span> <span class="dt">city</span><span class="op">:</span> <span class="st">&#39;New York&#39;</span><span class="op">,</span> <span class="dt">state</span><span class="op">:</span> <span class="st">&#39;NY&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb222-7" title="7">  ]<span class="op">,</span></a>
<a class="sourceLine" id="cb222-8" title="8"><span class="op">};</span></a></code></pre></div>
<p>In your template, if you want to output the value in the <code>name</code> property, you just put the name of the property in double curly brackets.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb223-1" title="1"><span class="kw">&lt;div&gt;</span></a>
<a class="sourceLine" id="cb223-2" title="2">  Name: {{ name }}</a>
<a class="sourceLine" id="cb223-3" title="3"><span class="kw">&lt;/div&gt;</span></a></code></pre></div>
<p>In your template, if you want to output all of the nicknames of the person, you loop over that property using the <code>#each</code> helper like this. Then, inside the <code>#each</code> "block", you refer to the value of the string itself as <code>this</code>.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb224-1" title="1"><span class="kw">&lt;ul&gt;</span></a>
<a class="sourceLine" id="cb224-2" title="2">  {{#each nicknames}}</a>
<a class="sourceLine" id="cb224-3" title="3">    <span class="kw">&lt;li&gt;</span>{{ this }}<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb224-4" title="4">  {{/each}}</a>
<a class="sourceLine" id="cb224-5" title="5"><span class="kw">&lt;/ul&gt;</span></a></code></pre></div>
<p>In your template, if you want to output all of the addresses of the person, you loop over the property using the <code>#each</code> helper in which you will use the property names of the objects inside the array. You can use <code>@index</code> to give you the current index.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb225-1" title="1"><span class="kw">&lt;tbody&gt;</span></a>
<a class="sourceLine" id="cb225-2" title="2">  {{#each addresses}}</a>
<a class="sourceLine" id="cb225-3" title="3">    <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb225-4" title="4">      <span class="kw">&lt;td&gt;</span>{{ @index }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb225-5" title="5">      <span class="kw">&lt;td&gt;</span>{{ street }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb225-6" title="6">      <span class="kw">&lt;td&gt;</span>{{ city }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb225-7" title="7">      <span class="kw">&lt;td&gt;</span>{{ state }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb225-8" title="8">    <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb225-9" title="9">  {{/each}}</a>
<a class="sourceLine" id="cb225-10" title="10"><span class="kw">&lt;/tbody&gt;</span></a></code></pre></div>
<p>If you want to do a conditional, you can just do something like this.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb226-1" title="1">{{#if isVisible}}</a>
<a class="sourceLine" id="cb226-2" title="2">  <span class="kw">&lt;div&gt;</span>You can see me!<span class="kw">&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb226-3" title="3">{{else}}</a>
<a class="sourceLine" id="cb226-4" title="4">  <span class="kw">&lt;div&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb226-5" title="5">{{/if}}</a></code></pre></div>
<p>So, that’s <em>handlebars</em>. Again, it’s just so that you can understand the syntax of the tests and HTML that you’ll be changing.</p>
<h2 id="install-handlebars">Install handlebars</h2>
<p>You just need to use <code>npm</code> to do this. <code>npm install handlebars</code>. Yay!</p>
<p>To do some math, you’ll need to install some handlebars helpers. You just need to use <code>npm</code> to do this. <code>npm install handlebars-helpers</code>. Yay!</p>
<h2 id="now-change-your-merge-items-test">Now, change your merge items test</h2>
<p>Inside <strong>merge-items-spec.js</strong>, you will change the <code>template</code> string. And, that is all you’ll change. Instead of having the "&lt;!– Content here –&gt;", you’ll replace that with handlebars code. Then, your tests will fail. Then, you’ll make then pass. Once they pass, you’ll know you’re safe to change the <em>real</em> HTML file.</p>
<p>Update the template from what it is now to the following code.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb227-1" title="1"><span class="kw">const</span> template <span class="op">=</span> <span class="vs">`</span></a>
<a class="sourceLine" id="cb227-2" title="2"><span class="vs">  &lt;table&gt;</span></a>
<a class="sourceLine" id="cb227-3" title="3"><span class="vs">    &lt;tbody&gt;</span></a>
<a class="sourceLine" id="cb227-4" title="4"><span class="vs">      {{#each items}}</span></a>
<a class="sourceLine" id="cb227-5" title="5"><span class="vs">        &lt;tr&gt;</span></a>
<a class="sourceLine" id="cb227-6" title="6"><span class="vs">          &lt;td&gt;{{ add @index 1 }}&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb227-7" title="7"><span class="vs">          &lt;td&gt;{{ title }}&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb227-8" title="8"><span class="vs">          &lt;td&gt;{{ category }}&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb227-9" title="9"><span class="vs">          &lt;td&gt;</span></a>
<a class="sourceLine" id="cb227-10" title="10"><span class="vs">            {{#if isComplete}}</span></a>
<a class="sourceLine" id="cb227-11" title="11"><span class="vs">            {{else}}</span></a>
<a class="sourceLine" id="cb227-12" title="12"><span class="vs">              &lt;form method=&quot;POST&quot; action=&quot;/items/{{ add @index 1 }}&quot;&gt;</span></a>
<a class="sourceLine" id="cb227-13" title="13"><span class="vs">                &lt;button class=&quot;pure-button&quot;&gt;Complete&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb227-14" title="14"><span class="vs">              &lt;/form&gt;</span></a>
<a class="sourceLine" id="cb227-15" title="15"><span class="vs">            {{/if}}</span></a>
<a class="sourceLine" id="cb227-16" title="16"><span class="vs">          &lt;/td&gt;</span></a>
<a class="sourceLine" id="cb227-17" title="17"><span class="vs">        &lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb227-18" title="18"><span class="vs">      {{/each}}</span></a>
<a class="sourceLine" id="cb227-19" title="19"><span class="vs">    &lt;/tbody&gt;</span></a>
<a class="sourceLine" id="cb227-20" title="20"><span class="vs">  &lt;/table&gt;</span></a>
<a class="sourceLine" id="cb227-21" title="21"><span class="vs">`</span><span class="op">;</span></a></code></pre></div>
<p>This seems like a lot when compared to the other template we had. However, this moves all of the HTML-generation to the template. There will be no looping and string manipulation in the <code>mergeItems</code> function after you’re done with it.</p>
<p>Run your tests and make sure they fail. Without a failing test, you don’t know what to fix. And, in this case, all three tests fail.</p>
<h2 id="fix-the-merge-items-function">Fix the merge items function</h2>
<p>Now that you have this, it’s time to update the <code>mergeItems</code> function. You’ll know you’re done when the tests all pass.</p>
<p>Inside <code>mergeItems</code>, import the <em>handlebars</em> library at the top of your file, the helpers library, and then register the ‘math’ helpers with the handlebars library according to the <a href="https://github.com/helpers/handlebars-helpers#usage">helpers documentation</a>. We need this so we can use the <code>add</code> helper in the template to add <code>1</code> to the <code>@index</code>.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb228-1" title="1"><span class="kw">const</span> handlebars <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;handlebars&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb228-2" title="2"><span class="kw">const</span> helpers <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;handlebars-helpers&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb228-3" title="3"><span class="va">helpers</span>.<span class="at">math</span>(<span class="op">{</span> handlebars <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now, delete <em>everything</em> inside the function. Replace it with the following lines.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb229-1" title="1"><span class="kw">const</span> render <span class="op">=</span> <span class="va">handlebars</span>.<span class="at">compile</span>(template)<span class="op">;</span></a>
<a class="sourceLine" id="cb229-2" title="2"><span class="cf">return</span> <span class="at">render</span>(<span class="op">{</span> items <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>You’ve moved the complexity of the HTML generation from the source code to the HTML code. HTML code is easier to change because it’s only about the display and generally won’t crash your entire application.</p>
<h2 id="now-change-your-merge-categories-tests">Now, change your merge categories tests</h2>
<p>Open <strong>merge-categories-spec.js</strong>. Change the first template to this code.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb230-1" title="1"><span class="kw">const</span> template <span class="op">=</span> <span class="vs">`</span></a>
<a class="sourceLine" id="cb230-2" title="2"><span class="vs">  &lt;div&gt;</span></a>
<a class="sourceLine" id="cb230-3" title="3"><span class="vs">    &lt;ul&gt;</span></a>
<a class="sourceLine" id="cb230-4" title="4"><span class="vs">      {{#each categories}}</span></a>
<a class="sourceLine" id="cb230-5" title="5"><span class="vs">        &lt;li&gt;{{ this }}&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb230-6" title="6"><span class="vs">      {{/each}}</span></a>
<a class="sourceLine" id="cb230-7" title="7"><span class="vs">    &lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb230-8" title="8"><span class="vs">  &lt;/div&gt;</span></a>
<a class="sourceLine" id="cb230-9" title="9"><span class="vs">`</span><span class="op">;</span></a></code></pre></div>
<p>Change the second template to this code.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb231-1" title="1"><span class="kw">const</span> template <span class="op">=</span> <span class="vs">`</span></a>
<a class="sourceLine" id="cb231-2" title="2"><span class="vs">  &lt;div&gt;</span></a>
<a class="sourceLine" id="cb231-3" title="3"><span class="vs">    &lt;select&gt;</span></a>
<a class="sourceLine" id="cb231-4" title="4"><span class="vs">      {{#each categories}}</span></a>
<a class="sourceLine" id="cb231-5" title="5"><span class="vs">        &lt;option&gt;{{ this }}&lt;/option&gt;</span></a>
<a class="sourceLine" id="cb231-6" title="6"><span class="vs">      {{/each}}</span></a>
<a class="sourceLine" id="cb231-7" title="7"><span class="vs">    &lt;/select&gt;</span></a>
<a class="sourceLine" id="cb231-8" title="8"><span class="vs">  &lt;/div&gt;</span></a>
<a class="sourceLine" id="cb231-9" title="9"><span class="vs">`</span><span class="op">;</span></a></code></pre></div>
<p>Now, your merge categories tests should not work. Run them to make sure.</p>
<h2 id="fix-the-merge-categories-function">Fix the merge categories function</h2>
<p>Open <strong>merge-categories.js</strong> and import just <em>handlebars</em>. There’s no math in the templates, so there’s no need for the helpers.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb232-1" title="1"><span class="kw">const</span> handlebars <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;handlebars&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>Again, delete <em>everything</em> inside the function and replace it with the following to make the tests pass, again.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb233-1" title="1"><span class="kw">const</span> render <span class="op">=</span> <span class="va">handlebars</span>.<span class="at">compile</span>(template)<span class="op">;</span></a>
<a class="sourceLine" id="cb233-2" title="2"><span class="cf">return</span> <span class="at">render</span>(<span class="op">{</span> categories <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>AMAZING!</p>
<h2 id="what-just-happened">What just happened?</h2>
<p>You just performed a major refactor of the application and you knew you did it because you had tests to guide you during the refactor!</p>
<p>Here’s an even more amazing thing. You did it without actually running the code! You did it because you had tests that told you if the inputs and outputs matched your expectations!</p>
<p>Now, you can change the content of the HTML pages to use the new <em>handlebars</em> syntax. There are only four of them, and you can use the stuff from your tests to update the source code.</p>
<p>Open <strong>category-list-screen.html</strong> and replace the "&lt;!– Content here –&gt;" with this handlebars syntax lifted straight from the tests.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb234-1" title="1">{{#each categories}}</a>
<a class="sourceLine" id="cb234-2" title="2">  <span class="kw">&lt;li&gt;</span>{{ this }}<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb234-3" title="3">{{/each}}</a></code></pre></div>
<p>Open <strong>list-of-items-screen.html</strong> and replace the "&lt;!– Content here –&gt;" with this handlebars syntax lifted straight from the tests.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb235-1" title="1">{{#each items}}</a>
<a class="sourceLine" id="cb235-2" title="2">  <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb235-3" title="3">    <span class="kw">&lt;td&gt;</span>{{ add @index 1 }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb235-4" title="4">    <span class="kw">&lt;td&gt;</span>{{ title }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb235-5" title="5">    <span class="kw">&lt;td&gt;</span>{{ category }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb235-6" title="6">    <span class="kw">&lt;td&gt;</span></a>
<a class="sourceLine" id="cb235-7" title="7">      {{#if isComplete}}</a>
<a class="sourceLine" id="cb235-8" title="8"></a>
<a class="sourceLine" id="cb235-9" title="9">      {{else}}</a>
<a class="sourceLine" id="cb235-10" title="10">        <span class="kw">&lt;form</span><span class="ot"> method=</span><span class="st">&quot;POST&quot;</span><span class="ot"> action=</span><span class="st">&quot;/items/{{ add @index 1 }}&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb235-11" title="11">          <span class="kw">&lt;button</span><span class="ot"> class=</span><span class="st">&quot;pure-button&quot;</span><span class="kw">&gt;</span>Complete<span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb235-12" title="12">        <span class="kw">&lt;/form&gt;</span></a>
<a class="sourceLine" id="cb235-13" title="13">      {{/if}}</a>
<a class="sourceLine" id="cb235-14" title="14">    <span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb235-15" title="15">  <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb235-16" title="16">{{/each}}</a></code></pre></div>
<p>Open <strong>search-items-screen.html</strong> and replace the "&lt;!– Content here –&gt;" with this handlebars syntax lifted straight from the tests.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb236-1" title="1">{{#each items}}</a>
<a class="sourceLine" id="cb236-2" title="2">  <span class="kw">&lt;tr&gt;</span></a>
<a class="sourceLine" id="cb236-3" title="3">    <span class="kw">&lt;td&gt;</span>{{ add @index 1 }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb236-4" title="4">    <span class="kw">&lt;td&gt;</span>{{ title }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb236-5" title="5">    <span class="kw">&lt;td&gt;</span>{{ category }}<span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb236-6" title="6">    <span class="kw">&lt;td&gt;</span></a>
<a class="sourceLine" id="cb236-7" title="7">      {{#if isComplete}}</a>
<a class="sourceLine" id="cb236-8" title="8"></a>
<a class="sourceLine" id="cb236-9" title="9">      {{else}}</a>
<a class="sourceLine" id="cb236-10" title="10">        <span class="kw">&lt;form</span><span class="ot"> method=</span><span class="st">&quot;POST&quot;</span><span class="ot"> action=</span><span class="st">&quot;/items/{{ add @index 1 }}&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb236-11" title="11">          <span class="kw">&lt;button</span><span class="ot"> class=</span><span class="st">&quot;pure-button&quot;</span><span class="kw">&gt;</span>Complete<span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb236-12" title="12">        <span class="kw">&lt;/form&gt;</span></a>
<a class="sourceLine" id="cb236-13" title="13">      {{/if}}</a>
<a class="sourceLine" id="cb236-14" title="14">    <span class="kw">&lt;/td&gt;</span></a>
<a class="sourceLine" id="cb236-15" title="15">  <span class="kw">&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb236-16" title="16">{{/each}}</a></code></pre></div>
<p>Open <strong>todo-form-screen.html</strong> and replace the "&lt;!– Content here –&gt;" with this handlebars syntax lifted straight from the tests.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb237-1" title="1">{{#each categories}}</a>
<a class="sourceLine" id="cb237-2" title="2">  <span class="kw">&lt;option&gt;</span>{{ this }}<span class="kw">&lt;/option&gt;</span></a>
<a class="sourceLine" id="cb237-3" title="3">{{/each}}</a></code></pre></div>
<p>That completes the upgrade of the HTML files. You can run your server using <code>node server.js</code> and checkout that everything just works by going to http://localhost:3000/items.</p>
<h2 id="just-another-note">Just another note</h2>
<p>This may not seem very amazing to you. This unit testing <em>revolutionized</em> the way that programmers write software! The fact that you could go into a code base and run tests to see how code works, change code and know that you haven’t broken anything, that enabled people to work more confidently that they were not introducing bugs into the software as they were going along.</p>
<p>This is the stuff dreams are made of.</p>
<p>So, good work. Good work</p>
</body></html>
