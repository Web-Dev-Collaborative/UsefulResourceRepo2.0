<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
<link rel="stylesheet" href="./prism.css">
<script async defer src="./prism.js"></script>
</head>
<body>;
<h1 id="database-queries">
Database Queries
</h1>
<h2 id="topics">
Topics
</h2>
<ul>
<li>
Relational Databases
</li>
<li>
Writing Basic SQL Queries
</li>
<li>
Writing Basic Queries using Knex.js
</li>
</ul>
<h2 id="assignment">
Assignment
</h2>
<p>
For this lab you will:
</p>
<ul>
<li>
[X] write SQL statements against a pre-populated database using an online tool. Once you have the correct SQL Statement for each query, write it inside the <code>queries.sql</code> file under the appropriate heading.
</li>
<li>
[ ] write API endpoints to manage the <code>accounts</code> resource, including database logic
</li>
</ul>
<h3 id="write-basic-queries">
Write Basic Queries
</h3>
<p>
Visit <a href="https://www.w3schools.com/Sql/tryit.asp?filename=trysql_select_top">SQL Try Editor at W3Schools.com</a> using the <strong>Google Chrome (or Chromium if you use Linux) browser</strong> and write <em>SQL queries</em> for the following requirements:
</p>
<ul>
<li>
<p>
[X] find all customers with postal code 1010. Returns 3 records.
</p>
<p>
SELECT * FROM [Customers] WHERE PostalCode=‘1010’
</p>
</li>
<li>
<p>
[X] find the phone number for the supplier with the id 11. Should be (010) 9984510.
</p>
<p>
SELECT Phone FROM [Suppliers] WHERE SupplierID=‘11’
</p>
</li>
<li>
<p>
[X] list first 10 orders placed, sorted descending by the order date. The order with date 1997-02-12 should be at the top.
</p>
<p>
SELECT * FROM [Orders] ORDER BY OrderDate Desc LIMIT 10
</p>
</li>
<li>
<p>
[X] find all customers that live in London, Madrid, or Brazil. Returns 18 records.
</p>
<p>
SELECT * FROM [Customers] WHERE City=‘London’ OR City=‘Madrid’ OR Country =‘Brazil’
</p>
</li>
<li>
<p>
[X] add a customer record for <em>“The Shire”</em>, the contact name is <em>“Bilbo Baggins”</em> the address is <em>“1 Hobbit-Hole”</em> in <em>“Bag End”</em>, postal code <em>“111”</em> and the country is <em>“Middle Earth”</em>.
</p>
<p>
INSERT INTO [Customers] (CustomerName, ContactName, Address, City, PostalCode, Country) VALUES (‘The Shire’, ‘Bilbo Baggins’, ‘1 Hobbit-Hole’, ‘Bag End’, ‘111’, ‘Middle Earth’)
</p>
</li>
<li>
<p>
[X] update <em>Bilbo Baggins</em> record so that the postal code changes to <em>“11122”</em>.
</p>
<p>
UPDATE [Customers] SET PostalCode = ‘11122’ WHERE CustomerID=‘92’
</p>
</li>
</ul>
<p>
<strong>Clicking the <code>Restore Database</code> button in the page will repopulate the database with the original data and discard all changes you have made</strong>.
</p>
<h3 id="write-accounts-api">
Write Accounts API
</h3>
<ul>
<li>
[ ] Write CRUD endpoints for the <code>accounts</code> resource. Use the <code>db</code> object imported from <code>data/dbConfig.js</code> for database access via <code>knex</code>.
</li>
<li>
[ ] Manually test your endpoints with a REST client like <code>Insomnia</code> or <code>Postman</code> to check they are working as expected.
</li>
</ul>
<h4 id="accounts-schema">
Accounts Schema
</h4>
<table>
<thead>
<tr class="header">
<th>
field
</th>
<th>
data type
</th>
<th>
metadata
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
id
</td>
<td>
unsigned integer
</td>
<td>
primary key, auto-increments, generated by database
</td>
</tr>
<tr class="even">
<td>
name
</td>
<td>
string
</td>
<td>
required, unique
</td>
</tr>
<tr class="odd">
<td>
budget
</td>
<td>
numeric
</td>
<td>
required
</td>
</tr>
</tbody>
</table>
<h2 id="stretch-problems">
Stretch Problems
</h2>
<p>
The following exercises <strong>require research</strong>, the concepts needed to complete them have not been covered in class yet.
</p>
<ul>
<li>
<p>
[X] Find a query to discover how many different cities are stored in the Customers table. Repeats should not be double counted. Should be 69.
</p>
<p>
SELECT Distinct City FROM [Customers]
</p>
</li>
<li>
<p>
[X] Find all suppliers who have names longer than 20 characters. Returns 11 records.
</p>
<p>
SELECT * FROM [Suppliers] WHERE LENGTH(SupplierName) &gt; 20
</p>
</li>
<li>
<p>
[ ] Add a <code>query string</code> option to your <code>GET /api/accounts</code> endpoint. The <code>query string</code> may contain <code>limit</code>, <code>sortby</code> and <code>sortdir</code> keys. If these keys are provided, use these values to limit and sort the <code>accounts</code> which are selected from the database. Reference the docs for sorting and limiting in <code>knex</code>.
</p>
</li>
</ul>
<div id="cb1" class="sourceCode">
<pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="co">// sample req.query object</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="op">{</span></a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="dt">limit</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="dt">sortby</span><span class="op">:</span> <span class="st">&#39;id&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="dt">sortdir</span><span class="op">:</span> <span class="st">&#39;desc&#39;</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="op">}</span></a></code></pre>
</div>
</body></html>
