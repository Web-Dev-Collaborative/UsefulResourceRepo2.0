<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>res-sendFile</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <h3 id="res.sendFile">res.sendFile(path [, options] [, fn])</h3>
    <div class="doc-box doc-info" data-markdown="1">
      <p><code>res.sendFile()</code> is supported by Express v4.8.0 onwards.</p>
    </div>
    <p>
      Transfers the file at the given <code>path</code>. Sets the
      <code>Content-Type</code> response HTTP header field based on the
      filename’s extension. Unless the <code>root</code> option is set in the
      options object, <code>path</code> must be an absolute path to the file.
    </p>
    <div class="doc-box doc-warn" data-markdown="1">
      <p>
        This API provides access to data on the running file system. Ensure that
        either (a) the way in which the <code>path</code> argument was
        constructed into an absolute path is secure if it contains user input or
        (b) set the <code>root</code> option to the absolute path of a directory
        to contain access within.
      </p>
      <p>
        When the <code>root</code> option is provided, the
        <code>path</code> argument is allowed to be a relative path, including
        containing <code>..</code>. Express will validate that the relative path
        provided as <code>path</code> will resolve within the given
        <code>root</code> option.
      </p>
    </div>
    <p>
      The following table provides details on the
      <code>options</code> parameter.
    </p>
    <div class="table-scroller" data-markdown="1">
      <table>
        <colgroup>
          <col style="width: 18%" />
          <col style="width: 52%" />
          <col style="width: 13%" />
          <col style="width: 15%" />
        </colgroup>
        <thead>
          <tr class="header">
            <th>Property</th>
            <th>Description</th>
            <th>Default</th>
            <th>Availability</th>
          </tr>
        </thead>
        <tbody>
          <tr class="odd">
            <td><code>maxAge</code></td>
            <td>
              Sets the max-age property of the <code>Cache-Control</code> header
              in milliseconds or a string in
              <a href="https://www.npmjs.org/package/ms">ms format</a>
            </td>
            <td>0</td>
            <td></td>
          </tr>
          <tr class="even">
            <td><code>root</code></td>
            <td>Root directory for relative filenames.</td>
            <td></td>
            <td></td>
          </tr>
          <tr class="odd">
            <td><code>lastModified</code></td>
            <td>
              Sets the <code>Last-Modified</code> header to the last modified
              date of the file on the OS. Set <code>false</code> to disable it.
            </td>
            <td>Enabled</td>
            <td>4.9.0+</td>
          </tr>
          <tr class="even">
            <td><code>headers</code></td>
            <td>Object containing HTTP headers to serve with the file.</td>
            <td></td>
            <td></td>
          </tr>
          <tr class="odd">
            <td><code>dotfiles</code></td>
            <td>
              Option for serving dotfiles. Possible values are “allow”, “deny”,
              “ignore”.
            </td>
            <td>“ignore”</td>
            <td> </td>
          </tr>
          <tr class="even">
            <td><code>acceptRanges</code></td>
            <td>Enable or disable accepting ranged requests.</td>
            <td><code>true</code></td>
            <td>4.14+</td>
          </tr>
          <tr class="odd">
            <td><code>cacheControl</code></td>
            <td>
              Enable or disable setting <code>Cache-Control</code> response
              header.
            </td>
            <td><code>true</code></td>
            <td>4.14+</td>
          </tr>
          <tr class="even">
            <td><code>immutable</code></td>
            <td>
              Enable or disable the <code>immutable</code> directive in the
              <code>Cache-Control</code> response header. If enabled, the
              <code>maxAge</code> option should also be specified to enable
              caching. The <code>immutable</code> directive will prevent
              supported clients from making conditional requests during the life
              of the <code>maxAge</code> option to check if the file has
              changed.
            </td>
            <td><code>false</code></td>
            <td>4.16+</td>
          </tr>
        </tbody>
      </table>
    </div>
    <p>
      The method invokes the callback function <code>fn(err)</code> when the
      transfer is complete or when an error occurs. If the callback function is
      specified and an error occurs, the callback function must explicitly
      handle the response process either by ending the request-response cycle,
      or by passing control to the next route.
    </p>
    <p>
      Here is an example of using <code>res.sendFile</code> with all its
      arguments.
    </p>
    <div class="sourceCode" id="cb1">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="va">app</span>.<span class="at">get</span>(<span class="st">&#39;/file/:name&#39;</span><span class="op">,</span> <span class="kw">function</span> (req<span class="op">,</span> res<span class="op">,</span> next) <span class="op">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="kw">var</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="dt">root</span><span class="op">:</span> <span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">&#39;public&#39;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="dt">dotfiles</span><span class="op">:</span> <span class="st">&#39;deny&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="dt">headers</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-6" title="6">      <span class="st">&#39;x-timestamp&#39;</span><span class="op">:</span> <span class="va">Date</span>.<span class="at">now</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb1-7" title="7">      <span class="st">&#39;x-sent&#39;</span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb1-8" title="8">    <span class="op">}</span></a>
<a class="sourceLine" id="cb1-9" title="9">  <span class="op">}</span></a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11">  <span class="kw">var</span> fileName <span class="op">=</span> <span class="va">req</span>.<span class="va">params</span>.<span class="at">name</span></a>
<a class="sourceLine" id="cb1-12" title="12">  <span class="va">res</span>.<span class="at">sendFile</span>(fileName<span class="op">,</span> options<span class="op">,</span> <span class="kw">function</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb1-13" title="13">    <span class="cf">if</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb1-14" title="14">      <span class="at">next</span>(err)</a>
<a class="sourceLine" id="cb1-15" title="15">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-16" title="16">      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Sent:&#39;</span><span class="op">,</span> fileName)</a>
<a class="sourceLine" id="cb1-17" title="17">    <span class="op">}</span></a>
<a class="sourceLine" id="cb1-18" title="18">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb1-19" title="19"><span class="op">}</span>)</a></code></pre>
    </div>
    <p>
      The following example illustrates using <code>res.sendFile</code> to
      provide fine-grained support for serving files:
    </p>
    <div class="sourceCode" id="cb2">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="va">app</span>.<span class="at">get</span>(<span class="st">&#39;/user/:uid/photos/:file&#39;</span><span class="op">,</span> <span class="kw">function</span> (req<span class="op">,</span> res) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="kw">var</span> uid <span class="op">=</span> <span class="va">req</span>.<span class="va">params</span>.<span class="at">uid</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="kw">var</span> file <span class="op">=</span> <span class="va">req</span>.<span class="va">params</span>.<span class="at">file</span></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="va">req</span>.<span class="va">user</span>.<span class="at">mayViewFilesFrom</span>(uid<span class="op">,</span> <span class="kw">function</span> (yes) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="cf">if</span> (yes) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-7" title="7">      <span class="va">res</span>.<span class="at">sendFile</span>(<span class="st">&#39;/uploads/&#39;</span> <span class="op">+</span> uid <span class="op">+</span> <span class="st">&#39;/&#39;</span> <span class="op">+</span> file)</a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-9" title="9">      <span class="va">res</span>.<span class="at">status</span>(<span class="dv">403</span>).<span class="at">send</span>(<span class="st">&quot;Sorry! You can&#39;t see that.&quot;</span>)</a>
<a class="sourceLine" id="cb2-10" title="10">    <span class="op">}</span></a>
<a class="sourceLine" id="cb2-11" title="11">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="op">}</span>)</a></code></pre>
    </div>
    <p>
      For more information, or if you have issues or concerns, see
      <a href="https://github.com/pillarjs/send">send</a>.
    </p>
  </body>
</html>
