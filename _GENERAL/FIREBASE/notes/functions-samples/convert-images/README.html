<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="automatically-convert-images">Automatically Convert Images</h1>
<p>This sample demonstrates how to automatically convert images that are uploaded to Firebase Storage to JPEG using ImageMagick.</p>
<h2 id="functions-code">Functions Code</h2>
<p>See file <a href="functions/index.js">functions/index.js</a> for the image conversion code.</p>
<p>The image conversion is performed using ImagMagick which is installed by default on all Cloud Functions instances. This is a CLI so we execute the command from node using the <a href="https://www.npmjs.com/package/child-process-promise">child-process-promise</a> package. The image is first downloaded locally from the Firebase Storage bucket to the <code>tmp</code> folder using the <a href="https://github.com/GoogleCloudPlatform/google-cloud-node">google-cloud</a> SDK.</p>
<p>The dependencies are listed in <a href="functions/package.json">functions/package.json</a>.</p>
<h2 id="trigger-rules">Trigger rules</h2>
<p>The function triggers on upload of any file to your Firebase projectâ€™s default Cloud Storage bucket.</p>
<h2 id="deploy-and-test">Deploy and test</h2>
<p>To deploy and test the sample:</p>
<ul>
<li>Create a Firebase project on the <a href="https://console.firebase.google.com">Firebase Console</a> and visit the <strong>Storage</strong> tab.</li>
<li>Deploy your project using <code>firebase deploy</code></li>
<li>Go to the Firebase Console <strong>Storage</strong> tab and upload an image that is not a JPEG, for instance a PNG. After a short time an image with the same base name but the <code>.jpg</code> extension will be created in the same folder (make sure you refresh the UI to see the new file).</li>
</ul>
</body>
</html>
