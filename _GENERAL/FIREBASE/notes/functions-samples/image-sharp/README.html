<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="image-resizing-using-node.js-stream-and-sharp---cloud-storage-trigger">Image resizing using Node.js Stream and Sharp - Cloud Storage trigger</h1>
<p>This sample demonstrates how to use Node.js Stream to read image from Cloud Storage, generate a thumbnail image using Sharp and upload it back to Cloud Storage. This is a alternative approach for using ImageMagick, see <a href="../generate-thumbnail">generate-thumbnail</a>.</p>
<h2 id="functions-code">Functions Code</h2>
<p>See file <a href="functions/index.js">functions/index.js</a> for the thumbnail generation code.</p>
<p>The thumbnail generation is performed using <a href="https://sharp.pixelplumbing.com/en/stable/">Sharp</a>. Download, resize input/output and upload uses Node.js <a href="https://nodejs.org/api/stream.html">Stream</a></p>
<p>The dependencies are listed in <a href="functions/package.json">functions/package.json</a>.</p>
<h2 id="trigger-rules">Trigger rules</h2>
<p>The function triggers on upload of any file to your Firebase project’s default Cloud Storage bucket.</p>
<h2 id="deploy-and-test">Deploy and test</h2>
<p>To deploy and test the sample:</p>
<ol type="1">
<li>Create a Firebase project on the <a href="https://console.firebase.google.com">Firebase Console</a>.</li>
<li>Get the code, for instance using <code>git clone https://github.com/firebase/functions-samples</code></li>
<li>Enter the correct directory <code>cd functions-samples/image-sharp</code></li>
<li>If you do not have it yet, install the Firebase CLI <code>npm install -g firebase-tools</code></li>
<li>Setup the CLI to use your Firebase project using <code>firebase use --add</code> and select your Firebase project</li>
<li>Deploy your project’s code using <code>firebase deploy</code></li>
<li>Go to the Firebase Console <strong>Storage</strong> tab and upload an image. After a short time a thumbnail image with the same name but a <code>thumb_</code> prefix will be created in the same folder (make sure you refresh the UI to see the new file).</li>
</ol>
<h2 id="contributing">Contributing</h2>
<p>We’d love that you contribute to the project. Before doing so please read our <a href="../CONTRIBUTING.md">Contributor guide</a>.</p>
<h2 id="license">License</h2>
<p>© Google, 2016. Licensed under an <a href="../LICENSE">Apache-2</a> license.</p>
</body>
</html>
