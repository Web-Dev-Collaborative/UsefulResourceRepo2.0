<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="authorized-https-endpoint">Authorized HTTPS Endpoint</h1>
<p>This samples shows how to restrict an HTTPS Function to only the Firebase users of your app.</p>
<p>Only users who pass a valid Firebase ID token as a Bearer token in the <code>Authorization</code> header of the HTTP request or in a <code>__session</code> cookie are authorized to use the function.</p>
<p>Checking the ID token is done with an ExpressJs middleware that also passes the decoded ID token in the Express request object.</p>
<p>Once authorized the function respond with ‘Hello <username>’.</p>
<p>This sample comes with a simple web-based UI whose code is in <a href="public">public</a> directory that lets you sign-in Firebase and initiates an authorized XHR to the Function.</p>
<h2 id="setting-up-the-sample">Setting up the sample</h2>
<ol type="1">
<li>Create a Firebase Project using the <a href="https://console.firebase.google.com">Firebase Console</a>.</li>
<li>Enable the <strong>Google</strong> Provider in the <strong>Auth</strong> section.</li>
<li>Clone or download this repo and open the <code>authorized-https-endpoint</code> directory.</li>
<li>You must have the Firebase CLI installed. If you don’t have it install it with <code>npm install -g firebase-tools</code> and then configure it with <code>firebase login</code>.</li>
<li>Configure the CLI locally by using <code>firebase use --add</code> and select your project in the list.</li>
<li>Install dependencies locally by running: <code>cd functions; npm install; cd -</code></li>
</ol>
<h2 id="deploy-and-test">Deploy and test</h2>
<p>This sample comes with a web-based UI for testing the function. To test locally do:</p>
<ol type="1">
<li>Start serving your project locally using <code>firebase serve --only hosting,functions</code></li>
<li>Open the app in a browser at <code>http://localhost:5000</code>.</li>
<li>Sign in the web app in the browser using Google Sign-In and two authenticated requests will be performed from the client and the result will be displayed on the page, normally “Hello <user displayname>”.</li>
</ol>
<p>To deploy and test on prod do:</p>
<ol type="1">
<li>Deploy your project using <code>firebase deploy</code></li>
<li>Open the app using <code>firebase open hosting:site</code>, this will open a browser.</li>
<li>Sign in the web app in the browser using Google Sign-In and two authenticated requests will be performed from the client and the result will be displayed on the page, normally “Hello <user displayname>”.</li>
</ol>
<h2 id="contributing">Contributing</h2>
<p>We’d love that you contribute to the project. Before doing so please read our <a href="../CONTRIBUTING.md">Contributor guide</a>.</p>
<h2 id="license">License</h2>
<p>© Google, 2017. Licensed under an <a href="../LICENSE">Apache-2</a> license.</p>
</body>
</html>
